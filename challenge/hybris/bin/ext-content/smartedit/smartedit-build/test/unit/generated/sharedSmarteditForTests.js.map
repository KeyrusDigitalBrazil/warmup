{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./jsTarget/web/app/common/components/index.ts","webpack:///./jsTarget/web/app/common/components/infiniteScrolling/YInfiniteScrollingComponent.ts","webpack:///./jsTarget/web/app/common/components/languageSelector/LanguageSelectorController.ts","webpack:///./jsTarget/web/app/common/components/languageSelector/dropdown/LanguageDropdownSelectorComponent.ts","webpack:///./jsTarget/web/app/common/components/languageSelector/selector/LanguageSelectorComponent.ts","webpack:///./jsTarget/web/app/common/components/tree/types.ts","webpack:///./jsTarget/web/app/common/components/yMessage/yEventMessage/yEventMessage.ts","webpack:///./jsTarget/web/app/common/components/yMoreText/YMoreTextComponent.ts","webpack:///./jsTarget/web/app/common/directives/CompileHtmlDirective.ts","webpack:///./jsTarget/web/app/common/directives/index.ts","webpack:///./jsTarget/web/app/common/dtos/Cloneable.ts","webpack:///./jsTarget/web/app/common/dtos/IPermissionsDto.ts","webpack:///./jsTarget/web/app/common/dtos/TruncatedText.ts","webpack:///./jsTarget/web/app/common/dtos/ValidationError.ts","webpack:///./jsTarget/web/app/common/dtos/forcedImport.ts","webpack:///./jsTarget/web/app/common/dtos/index.ts","webpack:///./jsTarget/web/app/common/index.ts","webpack:///./jsTarget/web/app/common/modules/index.ts","webpack:///./jsTarget/web/app/common/modules/translations/TranslationFile.ts","webpack:///./jsTarget/web/app/common/modules/translations/translateStaticFilesLoader.ts","webpack:///./jsTarget/web/app/common/modules/translations/translationServiceModule.ts","webpack:///./jsTarget/web/app/common/services/ConfigModule.ts","webpack:///./jsTarget/web/app/common/services/PolyfillService.ts","webpack:///./jsTarget/web/app/common/services/PriorityService.ts","webpack:///./jsTarget/web/app/common/services/SmarteditBootstrapGateway.ts","webpack:///./jsTarget/web/app/common/services/SmarteditCommonsModule.ts","webpack:///./jsTarget/web/app/common/services/SmarteditRootModule.ts","webpack:///./jsTarget/web/app/common/services/SystemEventService.ts","webpack:///./jsTarget/web/app/common/services/annotationService.ts","webpack:///./jsTarget/web/app/common/services/auth/AuthorizationService.ts","webpack:///./jsTarget/web/app/common/services/cache/CacheAction.ts","webpack:///./jsTarget/web/app/common/services/cache/CacheService.ts","webpack:///./jsTarget/web/app/common/services/cache/EvictionTag.ts","webpack:///./jsTarget/web/app/common/services/cache/actions/frequentlyChangingContent.ts","webpack:///./jsTarget/web/app/common/services/cache/actions/index.ts","webpack:///./jsTarget/web/app/common/services/cache/actions/rarelyChangingContent.ts","webpack:///./jsTarget/web/app/common/services/cache/cachedAnnotation.ts","webpack:///./jsTarget/web/app/common/services/cache/engine/CacheEngine.ts","webpack:///./jsTarget/web/app/common/services/cache/engine/DefaultCacheTiming.ts","webpack:///./jsTarget/web/app/common/services/cache/engine/index.ts","webpack:///./jsTarget/web/app/common/services/cache/index.ts","webpack:///./jsTarget/web/app/common/services/cache/tags/authorizationEvictionTag.ts","webpack:///./jsTarget/web/app/common/services/cache/tags/catalogEvictionTag.ts","webpack:///./jsTarget/web/app/common/services/cache/tags/contentCatalogUpdateEvictionTag.ts","webpack:///./jsTarget/web/app/common/services/cache/tags/index.ts","webpack:///./jsTarget/web/app/common/services/cache/tags/pageEvictionTag.ts","webpack:///./jsTarget/web/app/common/services/cache/tags/userEvictionTag.ts","webpack:///./jsTarget/web/app/common/services/crossFrame/CrossFrameEventService.ts","webpack:///./jsTarget/web/app/common/services/crossFrame/CrossFrameEventServiceGateway.ts","webpack:///./jsTarget/web/app/common/services/dependencyInjection/DINameUtils.ts","webpack:///./jsTarget/web/app/common/services/dependencyInjection/ISeComponent.ts","webpack:///./jsTarget/web/app/common/services/dependencyInjection/SeComponent.ts","webpack:///./jsTarget/web/app/common/services/dependencyInjection/SeDirective.ts","webpack:///./jsTarget/web/app/common/services/dependencyInjection/SeInjectable.ts","webpack:///./jsTarget/web/app/common/services/dependencyInjection/SeModule.ts","webpack:///./jsTarget/web/app/common/services/dependencyInjection/di.ts","webpack:///./jsTarget/web/app/common/services/dependencyInjection/types.ts","webpack:///./jsTarget/web/app/common/services/deprecate.ts","webpack:///./jsTarget/web/app/common/services/dragAndDrop/IDragAndDropScrollingService.ts","webpack:///./jsTarget/web/app/common/services/dragAndDrop/InViewElementObserver.ts","webpack:///./jsTarget/web/app/common/services/dragAndDrop/index.ts","webpack:///./jsTarget/web/app/common/services/flaws/FlawInjectionInterceptor.ts","webpack:///./jsTarget/web/app/common/services/flaws/flawInjectionInterceptorModule.ts","webpack:///./jsTarget/web/app/common/services/forcedImport.ts","webpack:///./jsTarget/web/app/common/services/gateway/GatewayFactory.ts","webpack:///./jsTarget/web/app/common/services/gateway/GatewayProxy.ts","webpack:///./jsTarget/web/app/common/services/gateway/MessageGateway.ts","webpack:///./jsTarget/web/app/common/services/gateway/index.ts","webpack:///./jsTarget/web/app/common/services/gatewayProxiedAnnotation.ts","webpack:///./jsTarget/web/app/common/services/httpErrorInterceptor/default/retryInterceptor/OperationContextService.ts","webpack:///./jsTarget/web/app/common/services/httpErrorInterceptor/default/retryInterceptor/operationContextAnnotation.ts","webpack:///./jsTarget/web/app/common/services/index.ts","webpack:///./jsTarget/web/app/common/services/instrumentation.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IAlertService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/ICatalogService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IDecorator.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IExperienceService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IFeature.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IFeatureService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/INotificationMouseLeaveDetectionService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/INotificationService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IPageInfoService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IPermissionService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IPreviewService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/ISessionService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/ISharedDataService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IStorageService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IUrlService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/IWaitDialogService.ts","webpack:///./jsTarget/web/app/common/services/interfaces/index.ts","webpack:///./jsTarget/web/app/common/services/language/LanguageService.ts","webpack:///./jsTarget/web/app/common/services/language/LanguageServiceGateway.ts","webpack:///./jsTarget/web/app/common/services/perspectives/IPerspectiveService.ts","webpack:///./jsTarget/web/app/common/services/rest/AbstractCachedRestService.ts","webpack:///./jsTarget/web/app/common/services/rest/CommonsRestServiceModule.ts","webpack:///./jsTarget/web/app/common/services/rest/PermissionsRestService.ts","webpack:///./jsTarget/web/app/common/services/rest/daos/ContentCatalogRestService.ts","webpack:///./jsTarget/web/app/common/services/rest/daos/ProductCatalogRestService.ts","webpack:///./jsTarget/web/app/common/services/rest/rest.ts","webpack:///./jsTarget/web/app/common/services/storage/index.ts","webpack:///./jsTarget/web/app/common/services/storage/manager/NamespacedStorageManager.ts","webpack:///./jsTarget/web/app/common/services/storage/manager/StorageManagerFactory.ts","webpack:///./jsTarget/web/app/common/services/storage/manager/StorageNamespaceConverter.ts","webpack:///./jsTarget/web/app/common/services/testModeService.ts","webpack:///./jsTarget/web/app/common/services/text/textTruncateService.ts","webpack:///./jsTarget/web/app/common/services/wizard/DefaultWizardActionStrategy.ts","webpack:///./jsTarget/web/app/common/services/wizard/ModalWizard.ts","webpack:///./jsTarget/web/app/common/services/wizard/ModalWizardControllerFactory.ts","webpack:///./jsTarget/web/app/common/services/wizard/WizardActions.ts","webpack:///./jsTarget/web/app/common/services/wizard/WizardService.ts","webpack:///./jsTarget/web/app/common/services/wizard/WizardServiceModule.ts","webpack:///./jsTarget/web/app/common/utils/CryptographicUtils.ts","webpack:///./jsTarget/web/app/common/utils/DiscardablePromiseUtils.ts","webpack:///./jsTarget/web/app/common/utils/FunctionsUtils.ts","webpack:///./jsTarget/web/app/common/utils/StringUtils.ts","webpack:///./jsTarget/web/app/common/utils/UrlUtils.ts","webpack:///./jsTarget/web/app/common/utils/WindowUtils.ts","webpack:///./jsTarget/web/app/common/utils/functionsModule.ts","webpack:///./jsTarget/web/app/common/utils/index.ts","webpack:///./smartedit-build/test/unit/coreAnnotationsHelper.ts","webpack:///./smartedit-build/test/unit/domHelper.ts","webpack:///./smartedit-build/test/unit/index.ts","webpack:///./smartedit-build/test/unit/jQueryHelper.ts","webpack:///./smartedit-build/test/unit/logHelper.ts","webpack:///./smartedit-build/test/unit/promiseHelper.ts","webpack:///./smartedit-build/test/unit/setupUnitTestEnv.ts","webpack:///./smartedit-build/test/unit/sharedSmarteditForTests.ts","webpack:///external \"angular\"","webpack:///external \"CryptoJS\"","webpack:///external \"jasmine\""],"names":[],"mappings":";AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,kDAA0C,gCAAgC;AAC1E;AACA;;AAEA;AACA;AACA;AACA,gEAAwD,kBAAkB;AAC1E;AACA,yDAAiD,cAAc;AAC/D;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iDAAyC,iCAAiC;AAC1E,wHAAgH,mBAAmB,EAAE;AACrI;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;;AAGA;AACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAEkD;AAExB;AACqC;AACF;AAGT;AACe;AACQ;;;;;;;;;;;;;;;;;;;;;;ACNpB;AAU1D;;;;;;;;;;;;;;;;;;;;;GAqBG;AAcF;IA4BA,gBAAgB;IAChB,qCACS,QAAiC,EACjC,MAA+B,EAC/B,MAAuB,EACvB,uBAAgD,EAChD,QAAyB,EACjC,kBAAgC,EAChC,QAAiE,EACjE,eAAgC;QAPxB,aAAQ,GAAR,QAAQ,CAAyB;QACjC,WAAM,GAAN,MAAM,CAAyB;QAC/B,WAAM,GAAN,MAAM,CAAiB;QACvB,4BAAuB,GAAvB,uBAAuB,CAAyB;QAChD,aAAQ,GAAR,QAAQ,CAAiB;QAhClC,gBAAgB;QACT,oBAAe,GAAG,gCAAgC,CAAC;QAI1D,gBAAgB;QACT,cAAS,GAAG,KAAK,CAAC;QAkBjB,0BAAqB,GAAG,GAAG,CAAC;QAanC,IAAI,CAAC,WAAW,GAAG,kBAAkB,EAAE,CAAC;QAExC,4DAA4D;QAE5D,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACzC,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,EAAE;YACjC,IAAI,CAAC,UAAU,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,qBAAqB,CAAC,CAAC;SACnF;IAEF,CAAC;IAED,gBAAgB;IAChB,gDAAU,GAAV;QACC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,IAAI,IAAI,CAAC;QACpC,IAAI,CAAC,SAAS,EAAE,CAAC;IAClB,CAAC;IAED,gBAAgB;IAChB,8CAAQ,GAAR;QAAA,iBAgCC;QA9BA,IAAI,IAAI,CAAC,cAAc,EAAE;YACxB,OAAO;SACP;QAED,IAAI,CAAC,cAAc,GAAG,IAAI,CAAC;QAC3B,IAAI,CAAC,WAAW,EAAE,CAAC;QACnB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC;QAE5B,IAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,WAAW,CAAC,EAC9G,UAAC,IAAa;YAEb,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,UAAC,OAAU;gBAC/B,OAAO,CAAC,iBAAiB,GAAG,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;YAClD,CAAC,CAAC,CAAC;YAEH,IAAM,aAAa,GAAG,KAAI,CAAC,MAAM,CAAC,YAAY,CAAC,IAAI,CAAC,OAAO,EAAE,KAAI,CAAC,OAAO,CAAC,KAAK,EAAE,mBAAoD,CAAC,CAAC;YACvI,IAAI,KAAI,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE;gBACxC,KAAK,CAAC,SAAS,CAAC,IAAI,CAAC,KAAK,CAAC,KAAI,CAAC,OAAO,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;aAC9D;YAED;;;;;eAKG;YACH,KAAI,CAAC,QAAQ,CAAC;gBACb,KAAI,CAAC,cAAc,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,IAAI,KAAI,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,KAAK,IAAI,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;YAClI,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;IACL,CAAC;IAED,gBAAgB;IAChB,+CAAS,GAAT;QACC,IAAM,YAAY,GAAG,IAAI,CAAC,SAAS,CAAC;QAEpC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,IAAI,CAAC,CAAC;QACnC,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,EAAE,CAAC;QACxB,IAAI,CAAC,WAAW,GAAG,CAAC,CAAC,CAAC;QACtB,IAAI,CAAC,cAAc,GAAG,KAAK,CAAC;QAC5B,IAAI,CAAC,IAAI,CAAC,SAAS,IAAI,IAAI,CAAC,QAAQ,EAAE;YACrC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,GAAG,IAAI,CAAC,eAAe,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;YACvE,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;SACtB;aAAM;YACN,IAAI,CAAC,SAAS,CAAC,SAAS,GAAG,CAAC,CAAC;SAC7B;QAED,IAAI,YAAY,EAAE;YACjB,8EAA8E;YAC9E,IAAI,CAAC,QAAQ,EAAE,CAAC;SAChB;IACF,CAAC;IA9GY,2BAA2B;QAbxC,oGAAW,CAAC;YACZ,WAAW,EAAE,iCAAiC;YAC9C,MAAM,EAAE;gBACP,UAAU;gBACV,QAAQ;gBACR,WAAW;gBACX,YAAY;gBACZ,WAAW;gBACX,4BAA4B;gBAC5B,mBAAmB;aACnB;SACD,CAAC;QACF,eAAe;OACD,2BAA2B,CAgHxC;IAAD,kCAAC;CAAA;AAhHwC;;;;;;;;;;;;;AC/CzC;AAAA;AAAA,eAAe;AACf;IAOC,oCACS,qBAA6B,EAC7B,eAAgC,EAChC,sBAA8C,EAC9C,EAAqB;QAHrB,0BAAqB,GAArB,qBAAqB,CAAQ;QAC7B,oBAAe,GAAf,eAAe,CAAiB;QAChC,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,OAAE,GAAF,EAAE,CAAmB;QATvB,qBAAgB,GAAqB,IAAI,CAAC;QAC1C,cAAS,GAAuB,EAAE,CAAC;IASvC,CAAC;IAEJ,4CAAO,GAAP;QAAA,iBAUC;QATA,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC;YACX,IAAI,CAAC,eAAe,CAAC,gBAAgB,EAAE;YACvC,IAAI,CAAC,eAAe,CAAC,mBAAmB,EAAE;SAC1C,CAAC,CAAC,IAAI,CAAC,UAAC,EAAkD;gBAAjD,eAAO,EAAE,iBAAS;YAC3B,KAAI,CAAC,SAAS,GAAO,SAAS,QAAC,CAAC;YAChC,KAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,sBAAsB,GAAG,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,IAAI,CAAC,qBAAqB,EAAE,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;IACvI,CAAC;IAED,+CAAU,GAAV;QACC,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAC/B,CAAC;IAED;;;OAGG;IACH,uDAAkB,GAAlB,UAAmB,QAA0B;QAC5C,IAAI,CAAC,eAAe,CAAC,0BAA0B,CAAC,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAED;;;;;;OAMG;IACO,uEAAkC,GAA5C,UAA6C,gBAAkC,EAAE,SAA6B;QAC7G,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,UAAC,QAAQ,IAAK,eAAQ,KAAK,gBAAgB,EAA7B,CAA6B,CAAC,CAAC,IAAI,CAAC,UAAC,CAAC,EAAE,CAAC;YACrG,OAAO,CAAC,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC;QAC3C,CAAC,CAAC,CAAC;QACH,gBAAgB,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;QAE3C,OAAO,gBAAgB,CAAC;IACzB,CAAC;IAED;;;;;OAKG;IACK,wDAAmB,GAA3B,UAA4B,OAAe;QAA3C,iBAaC;QAZA,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,uBAAuB,CAAC,OAAO,CAAC,CAAC;QAE9D,IAAI,IAAI,CAAC,gBAAgB,EAAE;YAC1B,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,kCAAkC,CAAC,IAAI,CAAC,gBAAgB,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;YAChG,OAAO;SACP;QAED,mGAAmG;QACnG,IAAI,CAAC,eAAe,CAAC,uBAAuB,EAAE,CAAC,IAAI,CAAC,UAAC,IAAY;YAChE,KAAI,CAAC,gBAAgB,GAAG,KAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;YAC3D,KAAI,CAAC,SAAS,GAAG,KAAI,CAAC,kCAAkC,CAAC,KAAI,CAAC,gBAAgB,EAAE,KAAI,CAAC,SAAS,CAAC,CAAC;QACjG,CAAC,CAAC,CAAC;IACJ,CAAC;IAED;;;;;OAKG;IACK,4DAAuB,GAA/B,UAAgC,OAAe;QAC9C,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,UAAC,QAAQ,IAAK,eAAQ,CAAC,OAAO,KAAK,OAAO,EAA5B,CAA4B,CAAC,CAAC;IACxE,CAAC;IAED;;OAEG;IACK,yDAAoB,GAA5B;QAAA,iBAIC;QAHA,IAAI,CAAC,eAAe,CAAC,gBAAgB,EAAE,CAAC,IAAI,CAAC,UAAC,OAAe;YAC5D,KAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC;QACnC,CAAC,CAAC,CAAC;IACJ,CAAC;IAEF,iCAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3GD;;;;;;;;;GASG;AACH;;;;;;;;;GASG;AACsG;AAChC;AAMxE;IAAuD,qDAA0B;IAEjF,2CACC,qBAA6B,EAC7B,eAAgC,EAChC,sBAA8C,EAC9C,EAAqB;eAErB,kBAAM,qBAAqB,EAAE,eAAe,EAAE,sBAAsB,EAAE,EAAE,CAAC;IAC1E,CAAC;IAES,8EAAkC,GAA5C,UAA6C,gBAAkC,EAAE,SAA6B;QAC7G,OAAO,IAAI,CAAC,SAAS,CAAC;IACvB,CAAC;IAbY,iCAAiC;QAJ9C,6DAAW,CAAC;YACZ,WAAW,EAAE,uCAAuC;SACpD,CAAC;QACF,eAAe;OACD,iCAAiC,CAe9C;IAAD,wCAAC;CAAA,CAfuD,sFAA0B,GAejF;AAf8C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3B/C;;;;;;;;;GASG;AACH;;;;;;;;;GASG;AACqF;AACf;AAMxE;IAA+C,6CAA0B;IAEzE,mCACC,qBAA6B,EAC7B,eAAgC,EAChC,sBAA8C,EAC9C,EAAqB;eAErB,kBAAM,qBAAqB,EAAE,eAAe,EAAE,sBAAsB,EAAE,EAAE,CAAC;IAC1E,CAAC;IATY,yBAAyB;QAJtC,8DAAW,CAAC;YACZ,WAAW,EAAE,+BAA+B;SAC5C,CAAC;QACF,eAAe;OACD,yBAAyB,CAWtC;IAAD,gCAAC;CAAA,CAX+C,sFAA0B,GAWzE;AAXsC;;;;;;;;;;;;;ACfvC;AAAA;AAAA;;;;;;;;;;GAUG;AACH;IACC;IACC;;;;;;OAMG;IACI,UAAoB;IAC3B;;;;;;OAMG;IACI,gBAA0B;IACjC;;;;;;OAMG;IACI,QAAgB;IACvB;;;;;;OAMG;IACI,kBAAwB;IAC/B;;;;;;OAMG;IACI,kBAAwB;QAhCxB,eAAU,GAAV,UAAU,CAAU;QAQpB,qBAAgB,GAAhB,gBAAgB,CAAU;QAQ1B,aAAQ,GAAR,QAAQ,CAAQ;QAQhB,uBAAkB,GAAlB,kBAAkB,CAAM;QAQxB,uBAAkB,GAAlB,kBAAkB,CAAM;IAC7B,CAAC;IACL,oBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvDqF;AAItF;;;;;;;;;;;;;;;;GAgBG;AAyBF;IAYA,gBAAgB;IAChB,gCAAoB,kBAAsC;QAAtC,uBAAkB,GAAlB,kBAAkB,CAAoB;QAXnD,SAAI,GAAW,MAAM,CAAC;QAGtB,SAAI,GAAY,KAAK,CAAC;IAS7B,CAAC;IAED,2CAAU,GAAV,UAAW,UAAoC;QAA/C,iBAcC;QAbA,IAAI,UAAU,CAAC,SAAS,EAAE;YACzB,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC9B,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,YAAY,EACpG,UAAC,OAAe,EAAE,SAAc,IAAK,YAAI,CAAC,gBAAgB,CAAC,OAAO,EAAE,SAAS,CAAC,EAAzC,CAAyC,CAAC,CAAC;SACjF;QACD,IAAI,UAAU,CAAC,SAAS,EAAE;YACzB,IAAI,CAAC,sBAAsB,EAAE,CAAC;YAC9B,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,UAAU,CAAC,SAAS,CAAC,YAAY,EACpG,cAAM,YAAI,CAAC,IAAI,GAAG,KAAK,EAAjB,CAAiB,CAAC,CAAC;SAC1B;QACD,IAAI,IAAI,CAAC,SAAS,EAAE;YACnB,IAAI,CAAC,SAAS,EAAE,CAAC;SACjB;IACF,CAAC;IAED,wCAAO,GAAP;QACC,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,KAAK,MAAM,IAAI,IAAI,CAAC,WAAW,KAAK,IAAI,CAAC;IACtE,CAAC;IAED,2CAAU,GAAV;QACC,IAAI,CAAC,sBAAsB,EAAE,CAAC;QAC9B,IAAI,CAAC,sBAAsB,EAAE,CAAC;IAC/B,CAAC;IAED,gDAAe,GAAf;QACC,OAAO,OAAO,IAAI,CAAC,WAAW,KAAK,QAAQ,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,GAAG,CAAC,CAAC;IAC5E,CAAC;IAED,0CAAS,GAAT;QACC,OAAO,OAAO,IAAI,CAAC,KAAK,KAAK,QAAQ,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC;IAChE,CAAC;IAED,iDAAgB,GAAhB,UAAiB,OAAe,EAAE,SAA6B;QAC9D,IAAI,SAAS,CAAC,WAAW,IAAI,SAAS,CAAC,WAAW,CAAC,MAAM,EAAE;YAC1D,IAAI,CAAC,WAAW,GAAG,SAAS,CAAC,WAAW,CAAC;SACzC;QACD,IAAI,SAAS,CAAC,KAAK,IAAI,SAAS,CAAC,KAAK,CAAC,MAAM,EAAE;YAC9C,IAAI,CAAC,KAAK,GAAG,SAAS,CAAC,KAAK,CAAC;SAC7B;QACD,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;QACjB,IAAI,IAAI,CAAC,SAAS,EAAE;YACnB,IAAI,CAAC,SAAS,EAAE,CAAC;SACjB;IACF,CAAC;IAEO,uDAAsB,GAA9B;QACC,IAAI,IAAI,CAAC,0BAA0B,EAAE;YACpC,IAAI,CAAC,0BAA0B,EAAE,CAAC;SAClC;IACF,CAAC;IAEO,uDAAsB,GAA9B;QACC,IAAI,IAAI,CAAC,0BAA0B,EAAE;YACpC,IAAI,CAAC,0BAA0B,EAAE,CAAC;SAClC;IACF,CAAC;IAxEY,sBAAsB;QAxBnC,6GAAW,CAAC;YACZ,QAAQ,EAAE,6bAYN;YACJ,MAAM,EAAE;gBACP,SAAS;gBACT,UAAU;gBACV,gBAAgB;gBAChB,cAAc;gBACd,cAAc;gBACd,gBAAgB;aAChB;SACD,CAAC;QACF,eAAe;OACD,sBAAsB,CA0EnC;IAAD,6BAAC;CAAA;AA1EmC;;;;;;;;;;;;;;;;;;;;;;;AC7CuD;AAGJ;AAEvF;;;;;;;;;;;;;;GAcG;AAOF;IAcA,4BACS,mBAAwC,EACxC,UAA+C,EAC/C,EAAqB;QAFrB,wBAAmB,GAAnB,mBAAmB,CAAqB;QACxC,eAAU,GAAV,UAAU,CAAqC;QAC/C,OAAE,GAAF,EAAE,CAAmB;QAdvB,gBAAW,GAAY,KAAK,CAAC;QAI5B,gBAAW,GAAY,KAAK,CAAC;IAUJ,CAAC;IAElC,oCAAO,GAAP;QAAA,iBASC;QARA,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,IAAI,GAAG,CAAC;QAC/B,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,IAAI,uBAAuB,CAAC;QACzE,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,IAAI,uBAAuB,CAAC;QACzE,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,mBAAmB,CAAC,qBAAqB,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC1G,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,aAAa,CAAC,WAAW,EAAE,CAAC;QACpD,IAAI,CAAC,eAAe,EAAE,CAAC,IAAI,CAAC;YAC3B,KAAI,CAAC,gBAAgB,EAAE,CAAC;QACzB,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,6CAAgB,GAAhB;QACC,IAAI,IAAI,CAAC,WAAW,EAAE;YACrB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,kBAAkB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,aAAa,CAAC,gBAAgB,EAAE,CAAC;YAC/G,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC;YACpE,IAAI,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,WAAW,CAAC;SACrC;IACF,CAAC;IAED,4CAAe,GAAf;QAAA,iBAUC;QATA,IAAM,iBAAiB,GAA4B,EAAE,CAAC;QACtD,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,UAAC,KAAa;YAC1E,KAAI,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,IAAI,KAAK,CAAC;QAC1C,CAAC,CAAC,CAAC;QACH,IAAM,QAAQ,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,gBAAgB,CAAC,CAAC,IAAI,CAAC,UAAC,KAAa;YAC1E,KAAI,CAAC,SAAS,GAAG,KAAI,CAAC,SAAS,IAAI,KAAK,CAAC;QAC1C,CAAC,CAAC,CAAC;QACH,iBAAiB,CAAC,IAAI,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;QAC3C,OAAO,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,iBAAiB,CAAC,CAAC;IACvC,CAAC;IAhDY,kBAAkB;QAN/B,oGAAW,CAAC;YACZ,WAAW,EAAE,uBAAuB;YACpC,MAAM,EAAE,CAAC,MAAM,EAAE,SAAS,EAAE,oBAAoB,EAAE,oBAAoB,EAAE,YAAY,CAAC;YACrF,SAAS,EAAE,CAAC,sGAAmB,CAAC;SAChC,CAAC;QACF,eAAe;OACD,kBAAkB,CAiD/B;IAAD,yBAAC;CAAA;AAjD+B;;;;;;;;;;;;;;;;;;;;;;ACrCsD;AAEtF;;;;;;;;;GASG;AACH;;;;;;;;;;;;;;;GAeG;AAMF;IAEA,8BACS,QAAiC,EACjC,MAAsB,EACtB,QAA6B,EAC7B,MAA2B;QAH3B,aAAQ,GAAR,QAAQ,CAAyB;QACjC,WAAM,GAAN,MAAM,CAAgB;QACtB,aAAQ,GAAR,QAAQ,CAAqB;QAC7B,WAAM,GAAN,MAAM,CAAqB;IAEpC,CAAC;IAED,wCAAS,GAAT;QAAA,iBAQC;QAPA,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,MAAM,CACzB,UAAC,KAAK,IAAK,YAAK,CAAC,KAAK,CAAC,KAAI,CAAC,MAAM,CAAC,WAAW,CAAC,EAApC,CAAoC,EAC/C,UAAC,KAAK;YACL,KAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;YAC1B,KAAI,CAAC,QAAQ,CAAC,KAAI,CAAC,QAAQ,CAAC,QAAQ,EAAS,CAAC,CAAC,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QACrE,CAAC,CACD,CAAC;IACH,CAAC;IAlBY,oBAAoB;QAJjC,6GAAW,CAAC;YACZ,QAAQ,EAAE,gBAAgB;SAC1B,CAAC;QACF,eAAe;OACD,oBAAoB,CAmBjC;IAAD,2BAAC;CAAA;AAnBiC;;;;;;;;;;;;;ACjClC;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACoC;;;;;;;;;;;;;;;;;;;;;;ACEuC;AAE9E;;;;;;GAMG;AAGF;IAEA,wBAAoB,MAAuB;QAAvB,WAAM,GAAN,MAAM,CAAiB;IAC3C,CAAC;IAED;;;;;;;;;;OAUG;IACH,sCAAa,GAAb,UAAc,KAAU;QAAxB,iBAiCC;QA/BA,IAAM,IAAI,GAAG,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,KAAK,EAAE,UAAC,KAAK;YACnD,IAAI,KAAK,KAAK,SAAS,IAAI,KAAK,KAAK,IAAI,IAAI,CAAC,KAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE;gBACrE,eAAe;gBACf,IAAI,KAAK,CAAC,IAAI,EAAE;oBACf,OAAO,IAAI,CAAC;iBACZ;qBAAM,IAAI,OAAO,KAAK,KAAK,UAAU,EAAE;oBACvC,OAAO,IAAI,CAAC;iBACZ;qBAAM,IAAI,KAAI,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;oBACxC,OAAO,IAAI,CAAC;oBACZ,aAAa;iBACb;qBAAM,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,KAAK,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE;oBACzF,OAAO,IAAI,CAAC;iBACZ;qBAAM;oBACN,OAAO,KAAK,CAAC;iBACb;aACD;iBAAM;gBACN,OAAO,KAAK,CAAC;aACb;QACF,CAAC,CAAC,CAAC;QACH,IAAI,IAAI,KAAK,SAAS,IAAI,IAAI,KAAK,IAAI,IAAI,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,EAAE;YAClE,OAAO,IAAI,CAAC;SACZ;aAAM,IAAI,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,OAAO,EAAE,EAAE,uCAAuC;YAClG,OAAO,IAAI,CAAC,GAAG,CAAC,UAAC,YAAiB,IAAK,YAAI,CAAC,aAAa,CAAC,YAAY,CAAC,EAAhC,CAAgC,CAAc,CAAC;SACtF;aAAM,EAAE,OAAO;YACf,OAAO,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,UAAC,KAAK,EAAE,SAAS;gBAChD,IAAI,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;oBACjC,KAAK,CAAC,SAAS,CAAC,GAAG,KAAI,CAAC,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;iBACvD;gBACD,OAAO,KAAK,CAAC;YACd,CAAC,EAAE,EAAa,CAAC,CAAC;SAClB;IACF,CAAC;IAEO,oCAAW,GAAnB,UAAoB,KAAU;QAC7B,OAAO,OAAO,KAAK,KAAK,QAAQ,IAAI,OAAO,KAAK,KAAK,QAAQ,IAAI,OAAO,KAAK,KAAK,SAAS,CAAC;IAC7F,CAAC;IArDY,cAAc;QAF3B,qGAAY,EAAE;QACf,eAAe;OACD,cAAc,CAuD3B;IAAD,qBAAC;CAAA;AAvD2B;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvB5B;;;;;;;;;GASG;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACTH;AAAA;AAAA;;;;;;;;;GASG;AACH;;;;;;;GAOG;AACH;IACC,uBAAoB,IAAiB,EAAU,aAA0B,EAAU,SAAkB,EAAU,QAAqB;QAAhH,gCAAiB;QAAU,kDAA0B;QAAsC,wCAAqB;QAAhH,SAAI,GAAJ,IAAI,CAAa;QAAU,kBAAa,GAAb,aAAa,CAAa;QAAU,cAAS,GAAT,SAAS,CAAS;QAAU,aAAQ,GAAR,QAAQ,CAAa;QACnI,0DAA0D;QAC1D,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,IAAI,IAAI,EAAE,CAAC;QAC5B,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,IAAI,EAAE,CAAC;IAC/C,CAAC;IAEM,0CAAkB,GAAzB;QACC,OAAO,IAAI,CAAC,IAAI,CAAC;IAClB,CAAC;IAEM,wCAAgB,GAAvB;QACC,OAAO,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,QAAQ,CAAC;IAC3C,CAAC;IAEM,mCAAW,GAAlB;QACC,OAAO,IAAI,CAAC,SAAS,CAAC;IACvB,CAAC;IACF,oBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;ACpCD;;;;;;;;;GASG;;;;;;;;;;;;;ACTH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAEH;;;;;;;;GAQG;AACkB;AACD;AACC;AACM;AACX;AACI;AACE;AACH;AACE;AACD;AACO;;;;;;;;;;;;;AC9B3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAEqB;AAG8B;AAOR;;;;;;;;;;;;;ACrB9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAEH,SAAS;AACc;AACI;AACE;AACA;AACH;AACF;;;;;;;;;;;;;ACjBxB;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACqD;;;;;;;;;;;;;ACVxD;AAAA;AAAA;;;;;;;;;GASG;AACH,gBAAgB;AAChB;IACC,yBAAmB,MAAc,EAAS,MAAc,EAAS,GAAY;QAA1D,WAAM,GAAN,MAAM,CAAQ;QAAS,WAAM,GAAN,MAAM,CAAQ;QAAS,QAAG,GAAH,GAAG,CAAS;IAC7E,CAAC;IACF,sBAAC;AAAD,CAAC;;;;;;;;;;;;;;ACdD;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACgC;AAIe;AAGlD,gBAAgB;AACT,SAAS,2BAA2B,CAAC,EAAqB,EAAE,MAAuB,EAAE,kBAAuC;IAClI,UAAU,CAAC;IACX,OAAO,WAAW,CAAC,IAAI,CAAC,SAAS,EAAE,EAAE,EAAE,MAAM,EAAE,kBAAkB,CAAC,CAAC;AACpE,CAAC;AAED;;;;GAIG;AACH,SAAS,WAAW,CAAC,EAAqB,EAAE,MAAuB,EAAE,kBAAuC,EAAE,OAA2B;IAExI,IAAI,CAAC,OAAO,IAAI,CAAC,CAAC,+CAAe,CAAC,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,gDAAgB,CAAC,OAAO,CAAC,MAAM,CAAC,IAAI,CAAC,gDAAgB,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE;QAC9H,MAAM,IAAI,KAAK,CAAC,kFAAkF,CAAC,CAAC;KACpG;IAED,OAAO,CAAC,KAAK,GAAG,OAAO,CAAC,KAAK,IAAI,CAAC,IAAI,gEAAe,CAAC,OAAO,CAAC,MAAM,EAAE,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;IAEvF,IAAM,IAAI,GAAG,UAAS,IAAqB;QAE1C,IAAI,CAAC,IAAI,IAAI,CAAC,CAAC,gDAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,gDAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE;YAChF,MAAM,IAAI,KAAK,CAAC,kFAAkF,CAAC,CAAC;SACpG;QAED,IAAI,OAAO,GAAG;YACb,IAAI,CAAC,MAAM;YACX,OAAO,CAAC,GAAG;YACX,IAAI,CAAC,MAAM;SACX,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;QAEX,IAAI,gDAAgB,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,EAAE;YAClE,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC;SACnC;QAED,OAAO,kBAAkB,CAAC,GAAG,CAAmB,OAAO,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;IAC7E,CAAC,CAAC;IAEF,IAAM,QAAQ,GAAyC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,UAAC,IAAqB;QAC9F,OAAO,IAAI,CAAC,IAAI,gEAAe,CAAC,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC;IACzE,CAAC,CAAC,CAAC;IAEH,OAAO,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,UAAC,IAAwB;QACrD,IAAM,UAAU,GAAG,EAAsB,CAAC;QAE1C,IAAI,CAAC,OAAO,CAAC,UAAC,KAAuB;YACpC,OAAO,KAAK,CAAC,SAAS,CAAC;YACvB,OAAO,KAAK,CAAC,QAAQ,CAAC;YACtB,MAAM,CAAC,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC;QACjC,CAAC,CAAC,CAAC;QACH,OAAO,UAAU,CAAC;IACnB,CAAC,CAAC,CAAC;AACJ,CAAC;;;;;;;;;;;;;;;;;;;;;;;ACrED;;;;;;;;;GASG;AACuE;AACD;AAEzE;;;;;;;;;;GAUG;AA6BH;IAAA;IAAuC,CAAC;IAA3B,wBAAwB;QA3BpC,iGAAQ,CAAC;YACT,OAAO,EAAE,CAAC,wBAAwB,EAAE,uBAAuB,EAAE,wBAAwB,CAAC;YACtF,SAAS,EAAE,CAAC,uFAA2B,CAAC;YACxC,MAAM,EAAE,UAAC,kBAAuB,EAAE,WAAmB,EAAE,gBAAwB;gBAC9E,UAAU,CAAC;gBACL;;mBAEG;gBACT,kBAAkB,CAAC,oBAAoB,CAAC;oBACvC,MAAM,EAAE,GAAG,GAAG,WAAW,GAAG,GAAG;oBAC/B,MAAM,EAAE,EAAE;iBACV,CAAC,CAAC;gBAEH,kDAAkD;gBAClD,kBAAkB,CAAC,iBAAiB,CAAC,gBAAgB,CAAC,CAAC;gBAEvD,kFAAkF;gBAClF,mEAAmE;gBACnE,iEAAiE;gBACjE,0JAA0J;gBAC1J,kBAAkB,CAAC,wBAAwB,CAAC,kBAAkB,CAAC,CAAC;YACjE,CAAC;YACD,UAAU,EAAE,UAAC,uBAA4B,EAAE,iBAAyB,EAAE,iBAAsB;gBAC3F,UAAU,CAAC;gBACX,uBAAuB,CAAC,QAAQ,CAAC,iBAAiB,EAAE,iBAAiB,CAAC,OAAO,CAAC,CAAC;YAChF,CAAC;SACD,CAAC;OACW,wBAAwB,CAAG;IAAD,+BAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;ACzCqC;AAC1E,gBAAgB;AAChB,SAAS,iBAAiB,CAAC,IAAyB;IACnD,UAAU,CAAC;IAEX,IAAM,cAAc,GAAG;QACtB,+BAA+B;KAC/B,CAAC;IAEF,IAAM,uBAAuB,GAAG;QAC/B,oBAAoB;QACpB,0BAA0B,CAAC,oCAAoC;KAC/D,CAAC;IACF,OAAO,SAAS,gBAAgB,CAAC,SAAc,EAAE,KAAU;QAEpD;;;WAGG;QACT,IAAI,cAAc,CAAC,IAAI,CAAC,UAAC,OAAO,IAAK,cAAO,CAAC,IAAI,CAAC,SAAS,CAAC,EAAvB,CAAuB,CAAC,EAAE;YAC9D,OAAO;SACP;QAED,IAAI,uBAAuB,CAAC,IAAI,CAAC,UAAC,OAAO,IAAK,cAAO,CAAC,IAAI,CAAC,SAAS,CAAC,EAAvB,CAAuB,CAAC,EAAE;YACvE,IAAI,CAAC,KAAK,CAAC,qBAAmB,SAAW,CAAC,CAAC;YAC3C,OAAO;SACP;QAED,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;IACvB,CAAC,CAAC;AACH,CAAC;AAED,SAAS,WAAW,CAAC,KAAU;IAC9B,OAAO,KAAK,CAAC,cAAc,CAAC,SAAS,CAAC,CAAC;AACxC,CAAC;AACD;;;GAGG;AACH,SAAS,uBAAuB,CAC/B,EAAqB,EACrB,IAAyB,EACzB,MAAuB,EACvB,OAA8B;IAE9B,IAAM,sBAAsB,GAAG,UAAC,KAAU;QACzC,IAAI,SAAS,KAAK,KAAK,IAAI,UAAU,KAAK,KAAK,EAAE;YAChD,IAAI,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE;gBAChC,IAAI,CAAC,WAAW,CAAC,KAAK,CAAC,EAAE;oBACxB,IAAI,CAAC,KAAK,CAAC,kCAAgC,IAAI,CAAC,SAAS,CAAC,KAAK,CAAG,CAAC,CAAC;iBACpE;aACD;iBAAM,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,KAAK,CAAC,EAAE;gBACpC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;aAClB;SACD;QACD,OAAO,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;IACzB,CAAC,CAAC;IAEF,IAAM,OAAO,GAAG,OAAO,CAAC,IAAI,CAAC;IAE7B,OAAO,CAAC,IAAI,GAAG,UAAS,eAAe,EAAE,gBAAgB,EAAE,cAAc;QACxE,IAAM,eAAe,GAAG,gBAAgB,CAAC,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,sBAAsB,CAAC;QACrF,OAAO,OAAO,CAAC,IAAI,CAAC,IAAI,EAAE,eAAe,EAAE,eAAe,EAAE,cAAc,CAAC,CAAC;IAC7E,CAAC,CAAC;IACF,OAAO,OAAO,CAAC;AAChB,CAAC;AAED,gBAAgB;AAmEhB;IAAA;IAA2B,CAAC;IAAf,YAAY;QAlExB,iGAAQ,CAAC;YACT,SAAS,EAAE;gBACV,iBAAiB;aACjB;YACD;;;eAGG;YACH,MAAM,EAAE,UAAC,UAA8B,EAAE,QAAsC;gBAC9E,UAAU,CAAC;gBAEX,UAAU,CAAC,0BAA0B,CAAC,IAAI,CAAC,CAAC;gBAE5C,QAAQ,CAAC,SAAS,CAAC,IAAI,EAAE,UACxB,SAA4B,EAC5B,IAAyB,EACzB,MAAuB;oBAEvB,UAAU,CAAC;oBAEX,IAAM,YAAY,GAAG,SAAS,CAAC,IAAI,CAAC;oBACpC,SAAS,CAAC,IAAI,GAAG;wBAChB,IAAI,SAAS,CAAC,CAAC,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE;4BACvC,OAAO,uBAAuB,CAAC,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,CAAC;yBAC7F;6BAAM;4BACN,OAAO,YAAY,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;yBAC3C;oBACF,CAAC,CAAC;oBAEF,IAAM,WAAW,GAAG,SAAS,CAAC,GAAG,CAAC;oBAClC,SAAS,CAAC,GAAG,GAAG;wBACf,OAAO,uBAAuB,CAAC,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE,WAAW,CAAC,KAAK,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC,CAAC;oBAClG,CAAC,CAAC;oBAEF,IAAM,aAAa,GAAG,SAAS,CAAC,KAAK,CAAC;oBACtC,SAAS,CAAC,KAAK,GAAG;wBACjB,IAAM,QAAQ,GAAG,aAAa,CAAC,IAAI,CAAC,SAAS,CAAC,EAAE,CAAC;wBAEjD,uBAAuB,CAAC,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE,QAAQ,CAAC,OAAO,CAAC,CAAC;wBAEnE,OAAO,QAAQ,CAAC;oBACjB,CAAC,CAAC;oBAEF,OAAO,SAAS,CAAC;gBAClB,CAAC,CAAC,CAAC;gBAEH,QAAQ,CAAC,SAAS,CAAC,UAAU,EAAE,UAC9B,SAAkC,EAClC,EAAqB,EACrB,IAAyB,EACzB,MAAuB;oBAEvB,UAAU,CAAC;oBAEX,IAAM,eAAe,GAAG,SAAS,CAAC;oBAElC,SAAS,cAAc;wBACtB,OAAO,uBAAuB,CAAC,EAAE,EAAE,IAAI,EAAE,MAAM,EAAE,eAAe,CAAC,KAAK,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC,CAAC;oBAC/F,CAAC;oBAED,MAAM,CAAC,KAAK,CAAC,cAAc,EAAE,eAAe,CAAC,CAAC;oBAE9C,OAAO,cAAc,CAAC;gBACvB,CAAC,CAAC,CAAC;YACJ,CAAC;SACD,CAAC;OACW,YAAY,CAAG;IAAD,mBAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;ACtI6B;AAEtD,eAAe;AAGd;IAEA,yBACS,cAAmB,EACnB,eAAgC;QADhC,mBAAc,GAAd,cAAc,CAAK;QACnB,oBAAe,GAAf,eAAe,CAAiB;IACtC,CAAC;IAEJ,kDAAwB,GAAxB;QACC,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,CAAC;IACvE,CAAC;IAED,mDAAyB,GAAzB;QACC,OAAO,CAAC,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,IAAI,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC,SAAS,EAAE,CAAC;IACvG,CAAC;IAED,yDAA+B,GAA/B;QACC,OAAO,IAAI,CAAC,cAAc,CAAC,IAAI,EAAE,CAAC;IACnC,CAAC;IAjBY,eAAe;QAF5B,4EAAY,EAAE;QACf,eAAe;OACD,eAAe,CAmB5B;IAAD,sBAAC;CAAA;AAnB4B;;;;;;;;;;;;;;;;;;;;;;ACLyB;AACtD;;;;;GAKG;AAGF;IAEA,yBAAoB,MAAW;QAAX,WAAM,GAAN,MAAM,CAAK;IAE/B,CAAC;IACD;;;;;;;;;;;;;OAaG;IACH,8BAAI,GAAJ,UAA6B,SAAc,EAAE,SAAyB;QAAtE,iBASC;QAT4C,4CAAyB;QAErE,OAAO,SAAS,CAAC,IAAI,CAAC,UAAC,KAAmB,EAAE,KAAmB;YAC9D,IAAI,MAAM,GAAW,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC;YACrD,IAAI,MAAM,KAAK,CAAC,EAAE;gBACjB,MAAM,GAAG,KAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,YAAY,CAAC,KAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,CAAC;aAC7D;YACD,OAAO,MAAM,CAAC;QACf,CAAC,CAAC,CAAC;IACJ,CAAC;IA5BY,eAAe;QAF5B,4EAAY,EAAE;QACf,eAAe;OACD,eAAe,CA8B5B;IAAD,sBAAC;CAAA;AA9B4B;;;;;;;;;;;;;ACpB7B;AAAA;AAAA;AAAA;;;;;;;;;GASG;;;;;;;AAGmD;AAIrD;IACA,mCAAY,cAA8B;QACzC,OAAO,cAAc,CAAC,aAAa,CAAC,oBAAoB,CAAC,CAAC;IAC3D,CAAC;IAHY,yBAAyB;QAFtC,4EAAY,EAAE;QACf,eAAe;OACD,yBAAyB,CAItC;IAAD,gCAAC;CAAA;AAJsC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChBvC;;;;;;;;;GASG;AACmC;AACtC,4DAAS,EAAE,CAAC;AAQyB;AAGA;AAEsC;AACc;AACjC;AACC;AACE;AACc;AACvB;AACQ;AACgC;AACJ;AAC1C;AAC6C;AACQ;AAEjG;;;;;;GAMG;AAkCH;IAAA;IAAqC,CAAC;IAAzB,sBAAsB;QAjClC,wEAAQ,CAAC;YACT,OAAO,EAAE;gBACR,yEAAmB;gBACnB,iHAAwB;gBACxB,sEAAe;gBACf,qGAA8B;gBAC9B,iBAAiB;gBACjB,yBAAyB;gBACzB,mBAAmB;gBACnB,eAAe;gBACf,eAAe;gBACf,wGAAwB;gBACxB,2DAAY;gBACZ,WAAW;gBACX,YAAY;aACZ;YACD,SAAS,EAAE;gBACV,yGAAoB;gBACpB,sEAAkB;gBAClB,uGAA6B;gBAC7B,yFAAsB;gBACtB,uFAAsB;gBACtB,yEAAe;aACf;YACD,YAAY,EAAE;gBACb,gFAAoB;gBACpB,uFAA2B;gBAC3B,kFAAsB;gBACtB,8EAAkB;gBAClB,6FAAiC;gBACjC,qFAAyB;aACzB;SACD,CAAC;OACW,sBAAsB,CAAG;IAAD,6BAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;AC9EnC;;;;;;;;;GASG;AACwE;AACzB;AACK;AACyD;AACa;AAE7H;;;;;GAKG;AAqBH;IADA,gBAAgB;IAChB;IAAkC,CAAC;IAAtB,mBAAmB;QApB/B,wEAAQ,CAAC;YACT,OAAO,EAAE;gBACR,yBAAyB;gBACzB,iBAAiB;gBACjB,mBAAmB;gBACnB,eAAe;gBACf,eAAe;aACf;YACD,SAAS,EAAE;gBACV,uDAAc;gBACd,qDAAY;gBACZ,yFAA+B;gBAC/B,8HAAuB;gBACvB,2IAAiC;aACjC;YACD,UAAU,EAAE,UAAC,+BAAoC,EAAE,iCAAsC;gBACxF,UAAU,CAAC;YACZ,CAAC;SACD,CAAC;QACF,gBAAgB;OACH,mBAAmB,CAAG;IAAD,0BAAC;CAAA;AAAH;;;;;;;;;;;;;AC1ChC;AAAA;AAAA;AAAA;;;;;;;;;GASG;;;;;;;AAImD;AAItD;;;;;;;;GAQG;AAGF;IAEA,gBAAgB;IAChB,4BACS,QAAiC,EACjC,EAAqB,EACrB,IAAyB,EACzB,SAAc;QAHd,aAAQ,GAAR,QAAQ,CAAyB;QACjC,OAAE,GAAF,EAAE,CAAmB;QACrB,SAAI,GAAJ,IAAI,CAAqB;QACzB,cAAS,GAAT,SAAS,CAAK;QAEtB,IAAI,CAAC,cAAc,GAAG,EAAE,CAAC;IAC1B,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,oCAAO,GAAP,UAAQ,OAAe,EAAE,IAAU;QAClC,IAAI,CAAC,OAAO,EAAE;YACb,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,uDAAuD,GAAG,IAAI,CAAC,CAAC;SAChF;aAAM;YACN,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBAC5E,OAAO,IAAI,CAAC,oBAAoB,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;aAChD;SACD;QACD,OAAO,IAAI,CAAC,EAAE,CAAC,IAAI,EAAE,CAAC;IACvB,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,2CAAc,GAAd,UAAe,OAAe,EAAE,IAAU;QACzC,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IACpC,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,yCAAY,GAAZ,UAAa,OAAe,EAAE,IAAU;QACvC,IAAM,QAAQ,GAA0B,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC;QACxD,IAAI,CAAC,QAAQ,CAAC;YACb,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,IAAI,CAC/B,UAAS,YAAiB;gBACzB,QAAQ,CAAC,OAAO,CAAC,YAAY,CAAC,CAAC;YAChC,CAAC,EACD,UAAS,MAAW;gBACnB,QAAQ,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;YACzB,CAAC,CACD,CAAC;QACH,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC;QACjB,OAAO,QAAQ,CAAC,OAAO,CAAC;IACzB,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,4CAAe,GAAf,UAAgB,OAAe,EAAE,IAAU;QAC1C,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;IACzC,CAAC;IAED;;;;;;;;;;;;OAYG;IACH,sCAAS,GAAT,UAAU,OAAe,EAAE,OAAqB;QAAhD,iBAgBC;QAfA,IAAI,aAAyB,CAAC;QAC9B,IAAI,CAAC,OAAO,IAAI,CAAC,OAAO,EAAE;YACzB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,+CAA+C,GAAG,OAAO,CAAC,CAAC;SAC3E;aAAM;YACN,8DAA8D;YAC9D,IAAI,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,KAAK,SAAS,EAAE;gBAC/C,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC;aAClC;YACD,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAE3C,aAAa,GAAG;gBACf,KAAI,CAAC,YAAY,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;YACrC,CAAC,CAAC;SACF;QACD,OAAO,aAAa,CAAC;IACtB,CAAC;IAED;;;;;;;;;;;;OAYG;IACH,iDAAoB,GAApB,UAAqB,OAAe,EAAE,OAAqB;QAC1D,OAAO,IAAI,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;IACzC,CAAC;IAEO,yCAAY,GAApB,UAAqB,OAAe,EAAE,OAAqB;QAC1D,IAAM,aAAa,GAAG,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC;QACnD,IAAM,KAAK,GAAG,aAAa,CAAC,CAAC,CAAC,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;QACjF,IAAI,KAAK,IAAI,CAAC,EAAE;YACf,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;SAC9C;aAAM;YACN,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,yCAAyC,GAAG,OAAO,GAAG,yBAAyB,CAAC,CAAC;SAChG;IACF,CAAC;IAEO,iDAAoB,GAA5B,UAA6B,OAAe,EAAE,IAAU;QAAxD,iBASC;QARA,OAAO,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,IAAI,CAAC,cAAc,CAAC,OAAO,CAAC,CAAC,GAAG,CAAC,UAAC,YAA0B;YAC9E,IAAM,cAAc,GAAG,KAAI,CAAC,SAAS,CAAC,YAAY,CAAC,CAAC;YACpD,OAAO,cAAc,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;QACtC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,UAAC,OAAY;YACrB,OAAO,KAAI,CAAC,EAAE,CAAC,IAAI,CAAC,OAAO,CAAC,GAAG,EAAE,CAAC,CAAC;QACpC,CAAC,EAAE,UAAC,MAAW;YACd,OAAO,KAAI,CAAC,EAAE,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;QAC/B,CAAC,CAAC,CAAC;IACJ,CAAC;IArKY,kBAAkB;QAF/B,4EAAY,EAAE;QACf,eAAe;OACD,kBAAkB,CAsK/B;IAAD,yBAAC;CAAA;AAtK+B;;;;;;;;;;;;;AC5BhC;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAGkE;AAuDrE,gBAAgB;AAChB,IAAK,cAGJ;AAHD,WAAK,cAAc;IAClB,2CAAyB;IACzB,6CAA2B;AAC5B,CAAC,EAHI,cAAc,KAAd,cAAc,QAGlB;AAED,IAAM,MAAM,GAAqB,MAAc,CAAC,eAAe,CAAC;AAEhE;;;;;;;GAOG;AACH;IAAA;QAEiB,wBAAmB,GAAG,mBAAmB,CAAC;QAC1C,6BAAwB,GAAG,qBAAqB,CAAC;QAEjE;;;;;;;;;WASG;QACH,wBAAmB,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;QAEpE;;;;;;;;;;WAUG;QACH,yBAAoB,GAAG,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,yBAAyB,EAAE,UAAS,MAAW,EAAE,YAAoB;YAC/G,OAAO,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,GAAG,YAAY,CAAC;QACxD,CAAC,CAAC,CAAC;QAEK,mBAAc,GAAmB,IAAI,oFAAc,EAAE,CAAC;QAEtD,yBAAoB,GAAG,EAAgE,CAAC;IAyQjG,CAAC;IAvQA;;;;;;;;;;OAUG;IACH,8CAAkB,GAAlB,UAAmB,MAAW,EAAE,UAA0C;QACzE,IAAM,aAAa,GAAkB,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;QACtE,IAAM,cAAc,GAAY,UAAkB,CAAC,cAAc,CAAC;QAClE,IAAI,aAAa,EAAE;YAClB,IAAI,cAAc,IAAI,aAAa,EAAE;gBACpC,OAAO,aAAa,CAAC,cAAc,CAAC,CAAC;aACrC;SACD;aAAM;YACN,OAAO,IAAI,CAAC;SACZ;IACF,CAAC;IAED;;;;;;;;;;;OAWG;IACH,+CAAmB,GAAnB,UAAoB,MAAW,EAAE,YAAoB,EAAE,UAA2C;QACjG,IAAM,aAAa,GAAkB,IAAI,CAAC,oBAAoB,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QACrF,IAAM,cAAc,GAAY,UAAkB,CAAC,cAAc,CAAC;QAClE,IAAI,aAAa,EAAE;YAClB,IAAI,cAAc,IAAI,aAAa,EAAE;gBACpC,OAAO,aAAa,CAAC,cAAc,CAAC,CAAC;aACrC;SACD;aAAM;YACN,OAAO,IAAI,CAAC;SACZ;IACF,CAAC;IAED;;;;;;;;;;OAUG;IACH,8CAAkB,GAAlB,UAAmB,MAAW,EAAE,UAA0C;QACzE,IAAM,aAAa,GAAkB,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,CAAC;QACtE,OAAO,CAAE,UAAkB,CAAC,cAAc,IAAI,aAAa,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;IAC7E,CAAC;IAED;;;;;;;;;;;OAWG;IACH,+CAAmB,GAAnB,UAAoB,MAAW,EAAE,YAAoB,EAAE,UAA2C;QACjG,IAAM,aAAa,GAAkB,IAAI,CAAC,oBAAoB,CAAC,MAAM,EAAE,YAAY,CAAC,CAAC;QACrF,OAAO,CAAE,UAAkB,CAAC,cAAc,IAAI,aAAa,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;IAC7E,CAAC;IAED;;;;;;;;;;OAUG;IACH,qDAAyB,GAAzB,UAA0B,IAAY,EAAE,iBAAyC;QAChF,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,GAAG,iBAAiB,CAAC;QACpD,OAAO,iBAAiB,CAAC;IAC1B,CAAC;IAED;;;;;;;;;;;;;;;OAeG;IAGH,qDAAyB,GAAzB,UAA0B,IAAY;QACrC,IAAM,QAAQ,GAAG,IAAI,CAAC;QAEtB,IAAM,sBAAsB,GAAG;YAAS,yBAAyB;iBAAzB,UAAyB,EAAzB,qBAAyB,EAAzB,IAAyB;gBAAzB,oCAAyB;;YAEhE,OAAO,UAAS,mBAAwB;gBAEvC,IAAM,cAAc,GAAG,QAAQ,CAAC,cAAc,CAAC,kBAAkB,CAAC,mBAAmB,EAAE;oBAAS,cAAc;yBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;wBAAd,yBAAc;;oBAE7G,IAAM,iBAAiB,GAAG,QAAQ,CAAC,oBAAoB,CAAC,IAAI,CAA2B,CAAC;oBACxF,IAAI,iBAAiB,EAAE;wBACtB,4GAA4G;wBAC5G,6GAA6G;wBAC7G,2DAA2D;wBAC3D,IAAM,MAAM,GAAG,iBAAiB,CAAC,eAAe,CAAC,CAAC,IAAI,EAAE,mBAAmB,EAAE,IAAI,CAAC,CAAC;wBACnF,IAAI,MAAM,EAAE;4BACX,OAAO,MAAM,CAAC;yBACd;qBACD;yBAAM;wBACN,MAAM,IAAI,KAAK,CAAC,iBAAe,IAAI,sBAAiB,mBAAmB,CAAC,IAAI,yFAAsF,CAAC,CAAC;qBACpK;gBACF,CAAC,CAAC,CAAC;gBAEH,IAAI,QAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,mBAAmB,CAAC,IAAI,CAAC,mBAAmB,CAAC,OAAO,IAAI,CAAC,QAAQ,CAAC,cAAc,CAAC,cAAc,EAAE,EAAE;oBAC3I,MAAM,IAAI,KAAK,CAAI,mBAAmB,CAAC,IAAI,6CAAwC,IAAI,8EAA2E,CAAC,CAAC;iBACpK;gBAED;;;;mBAIG;gBACH,MAAM,CAAC,KAAK,CAAC,cAAc,EAAE,mBAAmB,CAAC,CAAC;gBAElD,IAAM,uBAAuB,GAAG,QAAQ,CAAC,sBAAsB,CAAC,mBAAmB,CAAC,CAAC;gBAErF,OAAO,CAAC,cAAc,CAAC,QAAQ,CAAC,wBAAwB,EAAE,uBAAuB,EAAE,cAAc,CAAC,CAAC;gBAEnG,OAAO,CAAC,cAAc,CAAC,cAAc,CAAC,KAAK,GAAG,GAAG,GAAG,IAAI,EAAE,eAAe,EAAE,uBAAuB,CAAC,CAAC;gBAEpG,gCAAgC;gBAChC,OAAO,cAAc,CAAC;YACvB,CAAC,CAAC;QACH,CAAC,CAAC;QACD,sBAA8B,CAAC,cAAc,GAAG,IAAI,CAAC;QACtD,OAAO,sBAAsB,CAAC;IAC/B,CAAC;IAED;;;;;;;;;;OAUG;IACH,sDAA0B,GAA1B,UAA2B,IAAY,EAAE,iBAA0C;QAClF,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,GAAG,iBAAiB,CAAC;QACpD,OAAO,iBAAiB,CAAC;IAC1B,CAAC;IAED;;;;;;;;;;;;;;;OAeG;IACH,sDAA0B,GAA1B,UAA2B,IAAY;QACtC,IAAM,QAAQ,GAAG,IAAI,CAAC;QAEtB,IAAM,uBAAuB,GAAG;YAAS,yBAAyB;iBAAzB,UAAyB,EAAzB,qBAAyB,EAAzB,IAAyB;gBAAzB,oCAAyB;;YAEjE;;;eAGG;YACH,OAAO,UAAC,MAAW,EAAE,YAAoB,EAAE,UAAyD;gBAEnG,IAAM,cAAc,GAAG,UAAU,CAAC,KAAK,CAAC;gBAExC,UAAU,CAAC,KAAK,GAAG;oBAClB,IAAM,iBAAiB,GAA4B,QAAQ,CAAC,oBAAoB,CAAC,IAAI,CAA4B,CAAC;oBAElH,IAAI,iBAAiB,EAAE;wBACtB,OAAO,iBAAiB,CAAC,eAAe,CAAC,CAAC,IAAI,EAAE,YAAY,EAAE,cAAc,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,SAAS,CAAC,CAAC;qBACpG;yBAAM;wBACN,MAAM,IAAI,KAAK,CAAC,iBAAe,IAAI,kGAA+F,CAAC,CAAC;qBACpI;gBACF,CAAC,CAAC;gBAEF,OAAO,CAAC,cAAc,CAAC,cAAc,CAAC,MAAM,GAAG,GAAG,GAAG,IAAI,EAAE,eAAe,EAAE,MAAM,EAAE,YAAY,CAAC,CAAC;YACnG,CAAC,CAAC;QACH,CAAC,CAAC;QACD,uBAA+B,CAAC,cAAc,GAAG,IAAI,CAAC;QACvD,OAAO,uBAAuB,CAAC;IAChC,CAAC;IAED;;;;;;;;;;OAUG;IACI,kDAAsB,GAA7B,UAA8B,MAAW;QACxC,OAAO,OAAO,CAAC,WAAW,CAAC,IAAI,CAAC,wBAAwB,EAAE,MAAM,CAAC,IAAI,MAAM,CAAC;IAC7E,CAAC;IAEO,oDAAwB,GAAhC,UAAiC,MAAW;QAC3C,IAAM,mBAAmB,GAAG,IAAI,CAAC,sBAAsB,CAAC,MAAM,CAAC,CAAC;QAChE,IAAM,aAAa,GAAkB,EAAE,CAAC;QAExC,OAAO,CAAC,eAAe,CAAC,mBAAmB,CAAC;aAC1C,MAAM,CAAC,UAAC,GAAW,IAAK,UAAG,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,cAAc,CAAC,KAAK,CAAC,EAA/C,CAA+C,CAAC;aACxE,GAAG,CAAC,UAAC,GAAW;YAChB,aAAa,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,WAAW,CAAC,GAAG,EAAE,mBAAmB,CAAC,CAAC;QAClF,CAAC,CAAC,CAAC;QACJ,OAAO,aAAa,CAAC;IACtB,CAAC;IAEO,qDAAyB,GAAjC,UAAkC,MAAW,EAAE,YAAoB;QAClE,IAAM,aAAa,GAAkB,EAAE,CAAC;QAExC,OAAO,CAAC,eAAe,CAAC,MAAM,CAAC,SAAS,EAAE,YAAY,CAAC;aACrD,MAAM,CAAC,UAAC,GAAW,IAAK,UAAG,CAAC,QAAQ,EAAE,CAAC,UAAU,CAAC,cAAc,CAAC,MAAM,CAAC,EAAhD,CAAgD,CAAC;aACzE,GAAG,CAAC,UAAC,GAAW;YAChB,aAAa,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,OAAO,CAAC,WAAW,CAAC,GAAG,EAAE,MAAM,CAAC,SAAS,EAAE,YAAY,CAAC,CAAC;QAC7F,CAAC,CAAC,CAAC;QAEJ,OAAO,aAAa,CAAC;IACtB,CAAC;IAEF,wBAAC;AAAD,CAAC;;AAED,qBAAqB,CAAC;AACf,IAAM,iBAAiB,GAAsB,IAAI,iBAAiB,EAAE,CAAC;AAC3E,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,iBAAiB,GAAG,iBAAiB,CAAC;;;;;;;;;;;;;;;;;;;;;;ACnYvE;;;;;;;;;GASG;AAC2E;AAQ9E;;;;;;;GAOG;AAGF;IAIA,8BACS,IAAyB,EACzB,cAA+B,EAC/B,sBAA8C;QAF9C,SAAI,GAAJ,IAAI,CAAqB;QACzB,mBAAc,GAAd,cAAc,CAAiB;QAC/B,2BAAsB,GAAtB,sBAAsB,CAAwB;IACvD,CAAC;6BARY,oBAAoB;IAU9B;;;;;;;;;;;;;OAaG;IACC,mDAAoB,GAA3B,UAA4B,eAAyB;QAArD,iBAgBC;QAdA,IAAI,CAAC,eAAe,CAAC,MAAM,IAAI,eAAe,CAAC,MAAM,GAAG,CAAC,EAAE;YAC1D,MAAM,sBAAoB,CAAC,4BAA4B,CAAC;SACxD;QAED,IAAM,SAAS,GAAG,UAAC,WAA0C;YAC5D,OAAO,KAAI,CAAC,sBAAsB,CAAC,WAAW,EAAE,eAAe,CAAC,CAAC;QAClE,CAAC,CAAC;QAEF,IAAM,OAAO,GAAG;YACf,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,0FAA0F,GAAG,eAAe,CAAC,QAAQ,EAAE,CAAC,CAAC;YACzI,OAAO,KAAK,CAAC;QACd,CAAC,CAAC;QAEF,OAAO,IAAI,CAAC,cAAc,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,SAAS,EAAE,OAAO,CAAC,CAAC;IACtE,CAAC;IAEE;;;OAGG;IACE,kDAAmB,GAA3B,UAA4B,iBAAgD,EAAE,cAAsB;QACnG,IAAM,UAAU,GAAgC,iBAAiB,CAAC,WAAW,CAAC,IAAI,CAAC,UAAC,MAAmC,IAAK,aAAM,CAAC,GAAG,CAAC,WAAW,EAAE,KAAK,cAAc,CAAC,WAAW,EAAE,EAAzD,CAAyD,CAAC,CAAC;QAEvL,OAAO,CAAC,CAAC,UAAU,IAAI,UAAU,CAAC,KAAK,KAAK,MAAM,CAAC;IACpD,CAAC;IAEE;;;;OAIG;IACE,qDAAsB,GAA9B,UAA+B,iBAAgD,EAAE,eAAyB;QACzG,IAAI,aAAa,GAAG,CAAC,CAAC,eAAe,IAAI,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC;QACpE,IAAI,KAAK,GAAG,CAAC,CAAC;QAEd,OAAO,aAAa,IAAI,KAAK,GAAG,eAAe,CAAC,MAAM,EAAE;YACvD,aAAa,GAAG,aAAa,IAAI,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,EAAE,eAAe,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;SACvG;QAED,OAAO,aAAa,CAAC;IACtB,CAAC;IAEE;;;OAGG;IACE,6CAAc,GAAtB,UAAuB,eAAyB;QAAhD,iBAYC;QAXA,OAAO,IAAI,CAAC,cAAc,CAAC,kBAAkB,EAAE,CAAC,IAAI,CAAC,UAAC,IAAY;YACjE,IAAI,CAAC,IAAI,EAAE;gBACV,OAAO,EAAC,WAAW,EAAE,EAAE,EAAC,CAAC;aACzB;YACD,OAAO,KAAI,CAAC,sBAAsB,CAAC,GAAG,CAAC;gBACtC,IAAI;gBACJ,eAAe,EAAE,eAAe,CAAC,IAAI,CAAC,GAAG,CAAC;aAC1C,CAAC,CAAC,IAAI,CAAC,UAAC,QAAuC;gBAC/C,OAAO,QAAQ,CAAC;YACjB,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;IACJ,CAAC;;IAlFa,iDAA4B,GAAG,IAAI,KAAK,CAAC,2CAA2C,CAAC,CAAC;IAFvF,oBAAoB;QAFjC,qGAAY,EAAE;QACf,eAAe;OACD,oBAAoB,CAsFjC;IAAD,2BAAC;CAAA;AAtFiC;;;;;;;;;;;;;AC5BlC;AAAA;AAAA;;;;;;;;;GASG;AAEH;;;;;GAKG;AACH;IAIC,qBAAY,IAAY;QACvB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IAClB,CAAC;IAEF,kBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;ACFkC;AAYnC;;;;;;GAMG;AAGF;IAKA,gBAAgB;IAChB,sBACS,EAAqB,EACrB,IAAyB,EACzB,MAAuB,EACvB,MAA4B,EAC5B,cAA8B,EAC9B,sBAA8C,EAC9C,WAAwB;QANxB,OAAE,GAAF,EAAE,CAAmB;QACrB,SAAI,GAAJ,IAAI,CAAqB;QACzB,WAAM,GAAN,MAAM,CAAiB;QACvB,WAAM,GAAN,MAAM,CAAsB;QAC5B,mBAAc,GAAd,cAAc,CAAgB;QAC9B,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,gBAAW,GAAX,WAAW,CAAa;QAXzB,uBAAkB,GAAyB,EAAE,CAAC;QAC9C,mBAAc,GAAa,EAAE,CAAC;QAWrC,IAAI,CAAC,2BAA2B,EAAE,CAAC;IACpC,CAAC;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;OAoCG;IACI,+BAAQ,GAAf,UAAgB,IAAqB,EAAE,WAAyB;QAC/D,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC;YAC/B,IAAI;YACJ,WAAW;SACX,CAAC,CAAC;QACH,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;OAEG;IACI,6BAAM,GAAb,UAAmC,OAAY,EAAE,UAAkB,EAAE,cAAqC,EAAE,mBAA0B,EAAE,YAA2B,EAAE,IAAmB;QAEvL,IAAM,eAAe,GAAG,IAAI,CAAC,cAAc,CAAC,0BAA0B,CAAC,OAAO,CAAC,CAAC;QAChF,IAAM,YAAY,GAAW,MAAM,CAAC,IAAI,CAAC,eAAe,GAAG,UAAU,CAAC,GAAG,IAAI,CAAC,MAAM,CAAC,mBAAmB,CAAC,CAAC;QAE1G,IAAM,KAAK,GAAoB,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;QAC1E,IAAM,IAAI,GAAoB,KAAK,IAAI;YACtC,EAAE,EAAE,YAAY;YAChB,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE;YAC/B,YAAY,EAAE,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC;YAClD,KAAK,EAAE,IAAI;YACX,aAAa,EAAE,IAAI;YACnB,UAAU,EAAE,IAAI;SAChB,CAAC;QAEF,IAAI,CAAC,KAAK,EAAE;YACX,IAAM,WAAW,GAAiB,IAAI,CAAC,6BAA6B,CAAC,YAAY,CAAC,CAAC;YACnF,IAAI,CAAC,WAAW,EAAE;gBACjB,MAAM,IAAI,KAAK,CAAC,4CAA4C,CAAC,CAAC;aAC9D;YACD,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;YAEzB,IAAI,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,EAAE,WAAW,EAAE,cAAc,CAAC,IAAI,OAAnB,cAAc,GAAM,SAAS,SAAK,mBAAmB,GAAE,CAAC;YAEpG,IAAI,CAAC,uBAAuB,CAAC,IAAI,CAAC,CAAC;SACnC;QAED,OAAO,IAAI,CAAC,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IACtC,CAAC;IAED;;;;;;;OAOG;IACI,4BAAK,GAAZ;QAAa,sBAA8B;aAA9B,UAA8B,EAA9B,qBAA8B,EAA9B,IAA8B;YAA9B,iCAA8B;;;QAC1C,IAAM,IAAI,GAAa,IAAI,CAAC,yBAAyB,CAAC,YAAY,CAAC,CAAC;QACpE,UAAI,CAAC,WAAW,EAAC,KAAK,WAAI,IAAI,EAAE;IACjC,CAAC;IAES,8CAAuB,GAAjC,UAAkC,IAAmB;QAArD,iBAYC;QAXA,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,CAAC,MAAM,CAAC,UAAC,OAAO;YACnD,OAAO,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC,OAAO,CAAC,UAAC,OAAO;YAClB,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,gCAA8B,OAAS,CAAC,CAAC;YACzD,KAAI,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;YAClC,KAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,OAAO,EAAE,UAAC,GAAW,EAAE,IAAe;gBAC3E,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,6BAA2B,OAAS,CAAC,CAAC;gBACtD,KAAI,CAAC,WAAW,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;gBAChC,OAAO,KAAI,CAAC,EAAE,CAAC,IAAI,CAAY,EAAE,CAAC,CAAC;YACpC,CAAC,CAAC,CAAC;QACJ,CAAC,CAAC,CAAC;IACJ,CAAC;IAES,gDAAyB,GAAnC,UAAoC,IAAmB;QAAvD,iBAMC;;QALA,IAAI,IAAI,IAAI,IAAI,CAAC,MAAM,EAAE;YACxB,OAAO,UAAI,CAAC,MAAM,EAAC,KAAK,WAAI,IAAI,CAAC,GAAG,CAAC,UAAC,CAAC,IAAK,YAAI,CAAC,wBAAwB,CAAC,CAAC,CAAC,EAAhC,CAAgC,CAAC,EAAE;SAC/E;aAAM;YACN,OAAO,EAAE,CAAC;SACV;IACF,CAAC;IAES,+CAAwB,GAAlC,UAAmC,GAAgB;QAAnD,iBAEC;;QADA,OAAO,UAAI,CAAC,MAAM,EAAC,KAAK,YAAC,CAAC,GAAG,CAAC,KAAK,CAAC,SAAK,CAAC,GAAG,CAAC,WAAW,CAAC,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,GAAG,CAAC,UAAC,CAAC,IAAK,YAAI,CAAC,wBAAwB,CAAC,CAAC,CAAC,EAAhC,CAAgC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,GAAE;IACjI,CAAC;IAES,oDAA6B,GAAvC,UAAwC,YAA2B;QAClE,IAAM,SAAS,GAAuB,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAC,oBAAoB,IAAK,2BAAoB,CAAC,IAAI,CAAC,YAAY,CAAC,EAAvC,CAAuC,CAAC,CAAC;QACtI,OAAO,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC;IACjD,CAAC;IAES,kDAA2B,GAArC;QACC,IAAM,kBAAkB,GAAG,IAAI,4EAAkB,CAAC,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,EAAE,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,CAAC;QAC5F,IAAM,8BAA8B,GAAoB,UAAC,YAA2B;YACnF,OAAO,YAAY,CAAC,IAAI,CAAC,UAAC,WAAW,IAAK,kBAAW,CAAC,IAAI,KAAK,mFAAyB,EAA9C,CAA8C,CAAC,KAAK,IAAI,CAAC;QACpG,CAAC,CAAC;QACF,IAAI,CAAC,QAAQ,CAAC,8BAA8B,EAAE,kBAAkB,CAAC,CAAC;IACnE,CAAC;IAjJY,YAAY;QAFzB,8EAAY,EAAE;QACf,eAAe;OACD,YAAY,CAkJzB;IAAD,mBAAC;CAAA;AAlJyB;;;;;;;;;;;;;AC5C1B;AAAA;AAAA;;;;;;;;;GASG;AAEH;;;;;;;;;;GAUG;AACH;IAoBC,qBAAY,IAAkD;QAC7D,IAAI,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;QACxB,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;IACrC,CAAC;IACF,kBAAC;AAAD,CAAC;;;;;;;;;;;;;;AC9CD;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACwC;AAE3C,qBAAqB,CAAC;AACf,IAAM,6BAA6B,GAAW,2BAA2B,CAAC;AAEjF,qBAAqB,CAAC;AACf,IAAM,yBAAyB,GAAG,IAAI,wDAAW,CAAC,6BAA6B,CAAC,CAAC;AACvF,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,6BAA6B,GAAG,6BAA6B,CAAC;AAC9F,MAAc,CAAC,gBAAgB,CAAC,yBAAyB,GAAG,yBAAyB,CAAC;;;;;;;;;;;;;ACnBvF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACyC;AACJ;;;;;;;;;;;;;ACXxC;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACwC;AAE3C,qBAAqB,CAAC;AACtB,gBAAgB;AACT,IAAM,yBAAyB,GAAW,uBAAuB,CAAC;AAEzE,qBAAqB,CAAC;AACf,IAAM,qBAAqB,GAAG,IAAI,wDAAW,CAAC,yBAAyB,CAAC,CAAC;AAC/E,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,yBAAyB,GAAG,yBAAyB,CAAC;AACtF,MAAc,CAAC,gBAAgB,CAAC,qBAAqB,GAAG,qBAAqB,CAAC;;;;;;;;;;;;;ACpB/E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACoD;AAKG;AAE1D,IAAM,MAAM,GAAqB,MAAc,CAAC,eAAe,CAAC;AAEhE,+EAA+E;AAC/E,+EAA+E;AAC/E,+EAA+E;AAE/E,IAAM,yBAAyB,GAAG,aAAa,CAAC;AAEhD;;;;;;;;;;GAUG;AACH,qBAAqB,CAAC;AACf,IAAM,WAAW,GAAG,oEAAiB,CAAC,yBAAyB,CAAC,yBAAyB,CAA8E,CAAC;AAE/K,qBAAqB,CAAC;AACf,SAAS,4BAA4B,CAAC,IAAyB;IACrE,UAAU,CAAC;IACX,OAAO,oEAAiB,CAAC,yBAAyB,CAAC,yBAAyB,EAAE,UAAC,gBAAkE;QAChJ,OAAO,UAAS,QAAa,EAAE,mBAAyC,EAAE,mBAA0B;YACnG,mBAAmB,CAAC,IAAI,OAAxB,mBAAmB,GAAM,QAAQ,SAAK,mBAAmB,GAAE;YAE3D,QAAQ,CAAC,WAAW,GAAG,gBAAgB,CAAC,CAAC,CAAC,CAAC;YAE3C,IAAI,CAAC,KAAK,CAAC,yBAAuB,IAAI,CAAC,SAAS,CAAC,QAAQ,CAAC,WAAW,CAAC,kBAAa,oEAAc,CAAC,0BAA0B,CAAC,QAAQ,CAAG,EAAE,QAAQ,CAAC,CAAC;QACrJ,CAAC,CAAC;IACH,CAAC,CAAC,CAAC;AACJ,CAAC;AAED,+EAA+E;AAC/E,+EAA+E;AAC/E,+EAA+E;AAE/E,IAAM,oBAAoB,GAAG,QAAQ,CAAC;AAEtC;;;;;;;;;;;;GAYG;AACH,qBAAqB,CAAC;AACf,IAAM,MAAM,GAAG,oEAAiB,CAAC,0BAA0B,CAAC,oBAAoB,CAA+E,CAAC;AAEvK,qBAAqB,CAAC;AACf,SAAS,uBAAuB,CAAC,YAA0B;IACjE,UAAU,CAAC;IACX,OAAO,oEAAiB,CAAC,0BAA0B,CAAC,oBAAoB,EAAE,UAAC,gBAAkE;QAE5I,OAAO,UAAS,MAAW,EAAE,YAAoB,EAAE,cAAoC,EAAE,mBAA+B;YAEvH,IAAI,OAAO,GAAkB,EAAE,CAAC;YAChC,IAAI,IAAI,GAAkB,EAAE,CAAC;YAE7B,IAAI,gBAAgB,CAAC,CAAC,CAAC,EAAE;gBACxB,OAAO,GAAG,gBAAgB,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;gBACtC,IAAI,GAAG,gBAAgB,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;aAChC;YAED,IAAI,MAAM,CAAC,WAAW,EAAE;gBACvB,IAAI,MAAM,CAAC,WAAW,CAAC,OAAO,EAAE;oBAC/B,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC;iBAClE;gBACD,IAAI,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE;oBAC5B,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC,CAAC,CAAC;iBACzD;aACD;YAED,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE;gBACpB,IAAM,eAAe,GAAG,oEAAc,CAAC,0BAA0B,CAAC,MAAM,CAAC,CAAC;gBAC1E,MAAM,IAAI,KAAK,CAAC,YAAU,YAAY,YAAO,eAAe,gIAA6H,CAAC,CAAC;aAC3L;YACD,OAAO,YAAY,CAAC,MAAM,CAAC,MAAM,EAAE,YAAY,EAAE,cAAc,EAAE,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,KAAK,CAAC,mBAAmB,CAAC,EAAE,OAAO,EAAE,IAAI,CAAC,CAAC;QACnI,CAAC,CAAC;IACH,CAAC,CAAC,CAAC;AACJ,CAAC;AACD,+EAA+E;AAC/E,+EAA+E;AAC/E,+EAA+E;AAE/E,IAAM,mBAAmB,GAAG,iBAAiB,CAAC;AAC9C;;;;;;;;;GASG;AACH,qBAAqB,CAAC;AACf,IAAM,eAAe,GAAG,UAAS,GAAiB;IACxD,OAAO,oEAAiB,CAAC,0BAA0B,CAAC,mBAAmB,CAAC,CAAC,GAAG,CAAC,CAAC;AAC/E,CAAC,CAAC;AAEF,qBAAqB,CAAC;AACf,SAAS,gCAAgC,CAAC,YAA0B;IAC1E,UAAU,CAAC;IACX,OAAO,oEAAiB,CAAC,0BAA0B,CAAC,mBAAmB,EAAE,UAAC,gBAA+B;QAExG,OAAO,UAAS,MAAW,EAAE,YAAoB,EAAE,cAAoC,EAAE,mBAA+B;YAEvH,IAAI,IAAI,GAAkB,EAAE,CAAC;YAE7B,IAAM,GAAG,GAAgB,gBAAgB,CAAC,CAAC,CAAC,CAAC;YAC7C,IAAI,CAAC,GAAG,EAAE;gBACT,IAAI,MAAM,CAAC,WAAW,IAAI,MAAM,CAAC,WAAW,CAAC,IAAI,EAAE;oBAClD,IAAI,GAAG,MAAM,CAAC,WAAW,CAAC,IAAI,CAAC;iBAC/B;aACD;iBAAM;gBACN,IAAI,GAAG,CAAC,GAAG,CAAC,CAAC;aACb;YAED,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;gBACjB,MAAM,IAAI,KAAK,CAAC,YAAU,YAAY,YAAO,MAAM,CAAC,WAAW,CAAC,IAAI,kJAA+I,CAAC,CAAC;aACrN;YAED,IAAM,cAAc,GAAG,cAAc,CAAC,KAAK,CAAC,SAAS,EAAE,mBAAmB,CAAC,CAAC;YAC5E,IAAI,cAAc,IAAI,cAAc,CAAC,IAAI,EAAE;gBAC1C,OAAO,cAAc,CAAC,IAAI,CAAC,UAAC,KAAU;oBACrC,YAAY,CAAC,KAAK,OAAlB,YAAY,EAAU,IAAI,EAAE;oBAC5B,OAAO,KAAK,CAAC;gBACd,CAAC,CAAC,CAAC;aACH;iBAAM;gBACN,YAAY,CAAC,KAAK,OAAlB,YAAY,EAAU,IAAI,EAAE;gBAC5B,OAAO,cAAc,CAAC;aACtB;QAEF,CAAC,CAAC;IACH,CAAC,CAAC,CAAC;AACJ,CAAC;AAEA,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,WAAW,GAAG,WAAW,CAAC;AAC1D,MAAc,CAAC,gBAAgB,CAAC,4BAA4B,GAAG,4BAA4B,CAAC;AAC5F,MAAc,CAAC,gBAAgB,CAAC,MAAM,GAAG,MAAM,CAAC;AAChD,MAAc,CAAC,gBAAgB,CAAC,uBAAuB,GAAG,uBAAuB,CAAC;AAClF,MAAc,CAAC,gBAAgB,CAAC,eAAe,GAAG,eAAe,CAAC;AAClE,MAAc,CAAC,gBAAgB,CAAC,gCAAgC,GAAG,gCAAgC,CAAC;;;;;;;;;;;;;ACpJrG;AAAA;AAAA,gBAAgB;AAChB,gBAAgB;AAChB;IAIC,qBACS,EAAqB,EACrB,IAAyB;QADzB,OAAE,GAAF,EAAE,CAAmB;QACrB,SAAI,GAAJ,IAAI,CAAqB;QAJ1B,wBAAmB,GAAyB,EAAE,CAAC;QAKtD,IAAI,CAAC,4BAA4B,EAAE,CAAC;IACrC,CAAC;IAEM,6BAAO,GAAd,UAAe,IAAqB,EAAE,WAAyB,EAAE,OAAqC;QACrG,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,EAAE;YACnC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC;gBAC7B,IAAI;gBACJ,WAAW;gBACX,OAAO;gBACP,SAAS,EAAE,KAAK;gBAChB,UAAU,EAAE,KAAK;gBACjB,KAAK,EAAE,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE;aACtB,CAAC,CAAC;SACH;aAAM;YACN,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,8CAA4C,IAAI,CAAC,EAAI,CAAC,CAAC;SACtE;IACF,CAAC;IAEM,iCAAW,GAAlB,UAAmB,EAAU;QAC5B,IAAM,KAAK,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,UAAC,GAAG,IAAK,UAAG,CAAC,IAAI,CAAC,EAAE,KAAK,EAAE,EAAlB,CAAkB,CAAC,CAAC;QACzE,OAAO,KAAK,CAAC,CAAC,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC;IAClC,CAAC;IAEM,4BAAM,GAAb,UAAiB,IAAqB;QACrC,IAAM,GAAG,GAAG,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC,CAAC;QAC9D,IAAI,GAAG,CAAC,SAAS,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;YAC5C,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;SAC9B;aAAM,IAAI,CAAC,GAAG,CAAC,UAAU,EAAE;YAC3B,GAAG,CAAC,UAAU,GAAG,IAAI,CAAC;YACtB,IAAI,CAAC,YAAY,CAAC,GAAG,CAAC,CAAC;SACvB;QACD,OAAO,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC;IAC1B,CAAC;IAEM,2BAAK,GAAZ;QAAA,iBAMC;QANY,cAAiB;aAAjB,UAAiB,EAAjB,qBAAiB,EAAjB,IAAiB;YAAjB,yBAAiB;;QAC7B,IAAI,CAAC,OAAO,CAAC,UAAC,GAAG;YAChB,KAAI,CAAC,mBAAmB;iBACtB,MAAM,CAAC,UAAC,GAAG,IAAK,UAAG,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,EAAvC,CAAuC,CAAC;iBACxD,OAAO,CAAC,UAAC,GAAG,IAAK,YAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC,KAAI,CAAC,YAAY,CAAC,GAAG,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,EAA/D,CAA+D,CAAC,CAAC;QACrF,CAAC,CAAC,CAAC;IACJ,CAAC;IAED,wFAAwF;IAC9E,kDAA4B,GAAtC;QAAA,iBAMC;QALA,WAAW,CAAC;YACX,KAAI,CAAC,mBAAmB;iBACtB,MAAM,CAAC,UAAC,GAAG,IAAK,YAAI,CAAC,WAAW,CAAC,GAAG,CAAC,IAAI,CAAC,EAA1B,CAA0B,CAAC;iBAC3C,OAAO,CAAC,UAAC,GAAG,IAAK,YAAI,CAAC,YAAY,CAAC,GAAG,CAAC,EAAtB,CAAsB,CAAC,CAAC;QAC5C,CAAC,EAAE,WAAW,CAAC,2BAA2B,CAAC,CAAC;IAC7C,CAAC;IAES,kCAAY,GAAtB,UAA0B,GAAuB;QAAjD,iBAcC;QAbA,GAAG,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,UAAC,KAAgB;YACnC,4DAA4D;YAC5D,GAAG,CAAC,WAAW,CAAC,MAAM,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;YACjC,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;YACvB,GAAG,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;YAC1C,GAAG,CAAC,SAAS,GAAG,IAAI,CAAC;YACrB,GAAG,CAAC,UAAU,GAAG,KAAK,CAAC;YACvB,GAAG,CAAC,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;QAC1B,CAAC,EAAE,UAAC,CAAM;YACT,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,mDAAiD,GAAG,CAAC,IAAI,CAAC,EAAI,EAAE,CAAC,CAAC,CAAC;YACnF,OAAO,GAAG,CAAC,IAAI,CAAC,KAAK,CAAC;YACtB,GAAG,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QACrB,CAAC,CAAC,CAAC;IACJ,CAAC;IAEO,gCAAU,GAAlB,UAAmB,IAAqB;QACvC,OAAO,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;IACtE,CAAC;IAEO,iCAAW,GAAnB,UAAoB,IAAqB;QACxC,OAAO,CAAC,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC,UAAU,CAAC,IAAI,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;IACnE,CAAC;IAEO,kCAAY,GAApB,UAAqB,IAAqB;QACzC,OAAO,IAAI,CAAC,mBAAmB,CAAC,SAAS,CAAC,UAAC,CAAC,IAAK,QAAC,CAAC,IAAI,CAAC,EAAE,KAAK,IAAI,CAAC,EAAE,EAArB,CAAqB,CAAC,CAAC;IACzE,CAAC;IAnFuB,uCAA2B,GAAW,KAAK,CAAC;IAoFrE,kBAAC;CAAA;AArFuB;;;;;;;;;;;;;ACZxB;AAAA;AAAA;IAIC,4BAAY,aAAqB,EAAE,UAAkB;QACpD,2EAA2E;QAC3E,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QAEnC,gEAAgE;QAChE,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;IAC9B,CAAC;IAED,mCAAM,GAAN,UAAO,IAAqB;QAC3B,IAAI,CAAC,aAAa,GAAG,IAAI,CAAC,aAAa,CAAC;QACxC,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC;IACnC,CAAC;IACF,yBAAC;AAAD,CAAC;;;;;;;;;;;;;;AC5BD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAC2B;AACO;;;;;;;;;;;;;ACXrC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACgC;AACL;AACC;AACD;AACJ;AACD;AACF;;;;;;;;;;;;;AChBvB;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACwC;AAE3C,kDAAkD;AAClD,qBAAqB,CAAC;AACf,IAAM,wBAAwB,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,uBAAuB,EAAC,CAAC,CAAC;AACzF,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,wBAAwB,GAAG,wBAAwB,CAAC;;;;;;;;;;;;;AChBrF;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACwC;AACO;AAElD,qBAAqB,CAAC;AACf,IAAM,wBAAwB,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,4BAA4B,EAAC,CAAC,CAAC;AAC/F,qBAAqB,CAAC;AACf,IAAM,kBAAkB,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,eAAe,EAAE,WAAW,EAAE,CAAC,wBAAwB,EAAE,gEAAe,CAAC,EAAC,CAAC,CAAC;AAErI,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,wBAAwB,GAAG,wBAAwB,CAAC;AACpF,MAAc,CAAC,gBAAgB,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;;;;;;;;;;;;;ACpBzE;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACwC;AAE3C,qBAAqB,CAAC;AACf,IAAM,+BAA+B,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,8BAA8B,EAAC,CAAC,CAAC;AAEvG,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,+BAA+B,GAAG,+BAA+B,CAAC;;;;;;;;;;;;;AChBnG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACwC;AACN;AACH;AACA;AACgB;;;;;;;;;;;;;ACdlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACwC;AAE3C,qBAAqB,CAAC;AACf,IAAM,uBAAuB,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,oBAAoB,EAAC,CAAC,CAAC;AACtF,qBAAqB,CAAC;AACf,IAAM,uBAAuB,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,oBAAoB,EAAC,CAAC,CAAC;AACtF,qBAAqB,CAAC;AACf,IAAM,qBAAqB,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,oBAAoB,EAAC,CAAC,CAAC;AACpF,qBAAqB,CAAC;AACf,IAAM,uBAAuB,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,qBAAqB,EAAC,CAAC,CAAC;AACvF,qBAAqB,CAAC;AACf,IAAM,qBAAqB,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,aAAa,EAAC,CAAC,CAAC;AAC7E,qBAAqB,CAAC;AACf,IAAM,eAAe,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,iBAAiB,EAAE,WAAW,EAAE,CAAC,uBAAuB,EAAE,uBAAuB,EAAE,qBAAqB,CAAC,EAAC,CAAC,CAAC;AAElK,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,uBAAuB,GAAG,uBAAuB,CAAC;AAClF,MAAc,CAAC,gBAAgB,CAAC,uBAAuB,GAAG,uBAAuB,CAAC;AAClF,MAAc,CAAC,gBAAgB,CAAC,qBAAqB,GAAG,qBAAqB,CAAC;AAC9E,MAAc,CAAC,gBAAgB,CAAC,uBAAuB,GAAG,uBAAuB,CAAC;AAClF,MAAc,CAAC,gBAAgB,CAAC,qBAAqB,GAAG,qBAAqB,CAAC;AAC9E,MAAc,CAAC,gBAAgB,CAAC,eAAe,GAAG,eAAe,CAAC;;;;;;;;;;;;;AC/BnE;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACwC;AAC3C,kDAAkD;AAC3C,IAAM,eAAe,GAAG,IAAI,wDAAW,CAAC,EAAC,KAAK,EAAE,kBAAkB,EAAC,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;ACArB;AAIvD;;;;;;;;GAQG;AAGF;IAEA,gBAAgB;IAChB,gCACS,EAAqB,EACrB,kBAAsC,EACtC,6BAA6C,EAC7C,WAAwB;QAHxB,OAAE,GAAF,EAAE,CAAmB;QACrB,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,kCAA6B,GAA7B,6BAA6B,CAAgB;QAC7C,gBAAW,GAAX,WAAW,CAAa;IAC9B,CAAC;IAED;;;;;;;;;;;;;;;OAeG;IACN,wCAAO,GAAP,UAAQ,OAAe,EAAE,IAAU;QAClC,IAAM,QAAQ,GAAG,CAAC,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC;QAEvE,IAAI,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE,EAAE;YACvC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,6BAA6B,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC,CAAC;SACzE;QAED,OAAO,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IAC9B,CAAC;IAEE;;;;;;;;;;;;;;;OAeG;IACN,0CAAS,GAAT,UAA+B,OAAe,EAAE,OAAiC;QAChF,IAAM,+BAA+B,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;QAC5F,IAAM,0CAA0C,GAAG,IAAI,CAAC,6BAA6B,CAAC,SAAS,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC;QAElH,IAAM,aAAa,GAAG;YACrB,+BAA+B,EAAE,CAAC;YAClC,0CAA0C,EAAE,CAAC;QAC9C,CAAC,CAAC;QAEF,OAAO,aAAa,CAAC;IACtB,CAAC;IA9DY,sBAAsB;QAFnC,4EAAY,EAAE;QACf,eAAe;OACD,sBAAsB,CA+DnC;IAAD,6BAAC;CAAA;AA/DmC;;;;;;;;;;;;;AC3BpC;AAAA;AAAA;AAAA;;;;;;;;;GASG;;;;;;;AAGoD;AAEvD,gBAAgB;AAGf;IACA,uCACC,iBAAyB,EACzB,cAA8B;QAE9B,OAAO,cAAc,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC;IACxD,CAAC;IANY,6BAA6B;QAF1C,4EAAY,EAAE;QACf,eAAe;OACD,6BAA6B,CAO1C;IAAD,oCAAC;CAAA;AAP0C;;;;;;;;;;;;;ACjB3C;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACkE;AAGd;AAEvD,gBAAgB;AAChB;IAAA;IAsCA,CAAC;IApCA,wCAAkB,GAAlB,UAAmB,oBAAmC;QACrD,OAAO,IAAI,CAAC,SAAS,CAAC,oBAAoB,CAAC,CAAC,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;IACjG,CAAC;IAED,sCAAgB,GAAhB,UAAiB,kBAA6C;QAC7D,OAAO,IAAI,CAAC,SAAS,CAAC,kBAAkB,CAAC,CAAC;IAC3C,CAAC;IAED,mDAAmD;IACnD,+BAAS,GAAT,UAAU,WAAsC;QAC/C,IAAM,mBAAmB,GAAG,oEAAiB,CAAC,sBAAsB,CAAC,WAAW,CAAC,CAAC;QAClF,IAAM,YAAY,GAAG,oFAAc,CAAC,kBAAkB,CAAC,mBAAmB,CAAC,CAAC;QAC5E,OAAO,IAAI,CAAC,iBAAiB,CAAC,YAAY,CAAC,CAAC;IAC7C,CAAC;IAED,6CAA6C;IAC7C,uCAAiB,GAAjB,UAAkB,YAAoB;QACrC,IAAM,SAAS,GAAG,YAAY,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,YAAY,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC;QACzF,OAAO,SAAS,CAAC;IAClB,CAAC;IAED;;;;OAIG;IACH,wCAAwC;IACxC,uCAAiB,GAAjB,UAAkB,iBAAyC;QAC1D,IAAM,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC,CAAC;QAClD,IAAM,GAAG,GAAG,OAAO,CAAC,OAAO,CAAC,WAAW,EAAE,EAAE,CAAC,CAAC;QAC7C,OAAO;YACN,OAAO,EAAE,GAAG;YACZ,QAAQ,EAAE,iBAAiB,CAAC,OAAO,CAAC;SACpC,CAAC;IACH,CAAC;IAEF,kBAAC;AAAD,CAAC;;AAED,qBAAqB,CAAC;AACf,IAAM,WAAW,GAAG,IAAI,WAAW,EAAE,CAAC;AAG5C,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,WAAW,GAAG,WAAW,CAAC;;;;;;;;;;;;AC7D3D;;;;;;;;;GASG;;;;;;;;;;;;;ACGH;AAAA;AAAA;AAAA;AAAyE;AACJ;AAGrE;;;;;;;;;;;;;;;;GAgBG;AACH,qBAAqB,CAAC;AACf,IAAM,WAAW,GAAG,UAAS,UAAiC;IACpE,OAAO,UAA4C,oBAAuB;QAEzE,IAAM,SAAS,GAA8B;YAC5C,UAAU,EAAE,oBAAoB;YAChC,YAAY,EAAE,OAAO;YACrB,UAAU,EAAE,IAAI;YAChB,QAAQ,EAAE,2EAAsB,CAAC,UAAU,CAAC,MAAM,CAAC;YACnD,OAAO,EAAE,UAAU,CAAC,OAA2B;SAC/C,CAAC;QAEF,IAAI,UAAU,CAAC,WAAW,EAAE;YAC3B,SAAS,CAAC,WAAW,GAAG,UAAU,CAAC,WAAW,CAAC;SAC/C;aAAM,IAAI,UAAU,CAAC,QAAQ,EAAE;YAC/B,SAAS,CAAC,QAAQ,GAAG,UAAU,CAAC,QAAQ,CAAC;SACzC;QACD,IAAM,OAAO,GAAG,uEAAkB,CAAC,UAAU,CAAC,QAAQ,EAAE,oBAAoB,CAAC,CAAC;QAE9E,IAAI,OAAO,CAAC,QAAQ,KAAK,GAAG,EAAE;YAC7B,IAAM,aAAa,GAAG,oFAAc,CAAC,kBAAkB,CAAC,oBAAoB,CAAC,CAAC;YAC9E,MAAM,IAAI,KAAK,CAAC,eAAa,aAAa,sHAAmH,CAAC,CAAC;SAC/J;QAED,oBAAoB,CAAC,aAAa,GAAG,OAAO,CAAC,IAAI,CAAC;QAClD,oBAAoB,CAAC,UAAU,GAAG,SAAS,CAAC;QAE5C,sCAAsC;QACtC,oBAAoB,CAAC,eAAe,GAAG,UAAU,CAAC,eAAe,CAAC;QAClE,oBAAoB,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC;QAEtD,OAAO,oBAAoB,CAAC;IAC7B,CAAC,CAAC;AACH,CAAC,CAAC;AACD,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,WAAW,GAAG,WAAW,CAAC;;;;;;;;;;;;;ACxD3D;AAAA;AAAA;AAAA;AAAA;AAAA;AAAqE;AAE3B;AAE1C,gBAAgB;AACT,IAAM,sBAAsB,GAAG,UAAS,MAAgB;IAC9D,IAAI,QAA0B,CAAC;IAE/B,IAAI,MAAM,IAAK,MAAc,CAAC,MAAM,EAAE;QACrC,QAAQ,GAAG,MAAM,CAAC,MAAM,CAAC,UAAC,IAAS,EAAE,OAAO;YAC3C,IAAM,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;YACrD,IAAI,eAAe,GAAG,MAAM,CAAC,MAAM,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;YAChD,IAAI,CAAC,eAAe,CAAC,UAAU,CAAC,GAAG,CAAC;mBAChC,CAAC,eAAe,CAAC,UAAU,CAAC,GAAG,CAAC;mBAChC,CAAC,eAAe,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;gBACrC,eAAe,GAAG,GAAG,GAAG,eAAe,CAAC;aACxC;YACD,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC,GAAG,eAAe,CAAC;YAClC,OAAO,IAAI,CAAC;QACb,CAAC,EAAE,EAAE,CAAC,CAAC;KACP;IACD,OAAO,QAAQ,CAAC;AACjB,CAAC,CAAC;AAEF,gBAAgB;AACT,IAAM,kBAAkB,GAAG,UAAS,QAAgB,EAAE,YAA2B;IAEvF,IAAM,6BAA6B,GAAG,gBAAgB,CAAC;IACvD,IAAM,2BAA2B,GAAG,YAAY,CAAC;IACjD,IAAM,MAAM,GAAI,MAAc,CAAC,eAAe,CAAC;IAE/C,IAAI,CAAC,QAAQ,EAAE;QACd,OAAO,EAAC,IAAI,EAAE,wDAAW,CAAC,kBAAkB,CAAC,YAAY,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAC,CAAC;KAC3E;SAAM,IAAI,QAAQ,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;QACpC,OAAO,EAAC,IAAI,EAAE,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAC,CAAC;KACtE;SAAM,IAAI,6BAA6B,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;QACxD,OAAO,EAAC,IAAI,EAAE,MAAM,CAAC,SAAS,CAAC,6BAA6B,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAC,CAAC;KAChG;SAAM,IAAI,2BAA2B,CAAC,IAAI,CAAC,QAAQ,CAAC,EAAE;QACtD,OAAO,EAAC,IAAI,EAAE,MAAM,CAAC,SAAS,CAAC,2BAA2B,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,QAAQ,EAAE,GAAG,EAAC,CAAC;KAC9F;SAAM;QACN,IAAM,kBAAkB,GAAG,oFAAc,CAAC,kBAAkB,CAAC,YAAY,CAAC,CAAC;QAC3E,MAAM,IAAI,KAAK,CAAC,iBAAe,kBAAkB,0CAAqC,QAAQ,2FAChB,CAAC,CAAC;KAChF;AACF,CAAC,CAAC;AAEF;;;;;;;;;;;;;;;;;;;;;;;;;;;;GA4BG;AACH,qBAAqB,CAAC;AACf,IAAM,WAAW,GAAG,UAAS,UAAiC;IACpE,OAAO,UAAS,oBAA4C;QAE3D,IAAM,SAAS,GAAuB;YACrC,UAAU,EAAE,oBAAoB;YAChC,KAAK,EAAE,EAAE;YACT,gBAAgB,EAAE,sBAAsB,CAAC,UAAU,CAAC,MAAM,CAAC,IAAI,IAAI;YACnE,OAAO,EAAE,UAAU,CAAC,OAAO;SAC3B,CAAC;QAEF,IAAM,OAAO,GAAG,kBAAkB,CAAC,UAAU,CAAC,QAAQ,EAAE,oBAAoB,CAAC,CAAC;QAE9E,SAAS,CAAC,QAAQ,GAAG,OAAO,CAAC,QAAQ,CAAC;QAEtC,oBAAoB,CAAC,aAAa,GAAG,OAAO,CAAC,IAAI,CAAC;QAClD,oBAAoB,CAAC,UAAU,GAAG,SAAS,CAAC;QAE5C,sCAAsC;QACtC,oBAAoB,CAAC,SAAS,GAAG,UAAU,CAAC,SAAS,CAAC;QAEtD,OAAO,oBAAoB,CAAC;IAC7B,CAAC,CAAC;AACH,CAAC,CAAC;AACD,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,sBAAsB,GAAG,sBAAsB,CAAC;AAChF,MAAc,CAAC,gBAAgB,CAAC,kBAAkB,GAAG,kBAAkB,CAAC;AACxE,MAAc,CAAC,gBAAgB,CAAC,WAAW,GAAG,WAAW,CAAC;;;;;;;;;;;;;AClH3D;AAAA;AAAA;;;;;;;;;GASG;AAEH;;;;;;;;GAQG;AACH,qBAAqB,CAAC;AACf,IAAM,YAAY,GAAG;IAC3B,OAAO,UAAS,mBAAwB;QACvC,OAAO,mBAAmB,CAAC;IAC5B,CAAC,CAAC;AACH,CAAC,CAAC;AACD,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,YAAY,GAAG,YAAY,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3B7D;;;;;;;;;GASG;AACH,8CAA8C;AACX;AACkC;AAC3B;AAe1C,IAAM,gBAAgB,GAElB,EAAE,CAAC;AAEP;;;;;;;;;;;;;;;;;;;;GAoBG;AAEH,qBAAqB,CAAC;AACf,IAAM,QAAQ,GAAG,UAAS,UAMhC;IACA,OAAO,UAAyC,iBAAoB;QAEnE,IAAM,YAAY,GAAG,wDAAW,CAAC,SAAS,CAAC,iBAAiB,CAAC,CAAC;QAC9D,IAAM,eAAe,GAAG,UAAU,EAAE,CAAC;QACrC,IAAM,UAAU,GAAa,EAAE,CAAC;QAEhC,IAAI,UAAU,CAAC,OAAO,EAAE;YACvB,UAAU,CAAC,OAAO,CAAC,OAAO,CAAC,UAAC,eAAe,EAAE,KAAK;gBAEjD,IAAM,2BAA2B,GAAG,UAAC,QAA6B;oBACjE,IAAM,cAAc,GAAG,wDAAW,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;oBACvD,MAAM,IAAI,KAAK,CAAI,cAAc,kCAA6B,YAAY,8DAA2D,CAAC,CAAC;gBACxI,CAAC,CAAC;gBAEF,IAAI,UAAU,CAAC;gBACf,IAAI,OAAO,eAAe,KAAK,QAAQ,EAAE;oBACxC,UAAU,GAAG,eAAe,CAAC;iBAC7B;qBAAM,IAAI,OAAO,eAAe,KAAK,UAAU,EAAE;oBACjD,UAAU,GAAI,eAAuC,CAAC,UAAU,CAAC;oBACjE,IAAI,CAAC,UAAU,EAAE;wBAChB,2BAA2B,CAAC,eAAe,CAAC,CAAC;qBAC7C;iBACD;qBAAM,IAAI,eAAe,IAAI,eAAe,CAAC,QAAQ,EAAE;oBACvD,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,UAAU,EAAE;wBACzC,2BAA2B,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;qBACtD;oBAED,IAAM,uBAAuB,GAAG,wDAAW,CAAC,SAAS,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;oBAChF,IAAM,mBAAmB,GAAG,eAAe,CAAC,MAAM,CAAC,uBAAuB,CAAC,CAAC;oBAE5E,UAAU,GAAG,mBAAmB,CAAC,IAAI,CAAC;oBAEtC,IAAI,eAAe,CAAC,SAAS,EAAE;wBAC9B,2BAA2B,CAAC,mBAAmB,EAAE,eAAe,CAAC,SAAS,CAAC,CAAC;qBAC5E;iBACD;qBAAM;oBACN,MAAM,IAAI,KAAK,CAAC,0BAAwB,eAAe,kBAAa,KAAK,kBAAa,YAAY,2DAAwD,CAAC,CAAC;iBAC5J;gBACD,IAAI,UAAU,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,EAAE;oBACxC,MAAM,IAAI,KAAK,CAAC,YAAU,UAAU,yCAAoC,YAAc,CAAC,CAAC;iBACxF;gBACD,UAAU,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAC7B,CAAC,CAAC,CAAC;SACH;QAED,IAAM,MAAM,GAAG,eAAe,CAAC,MAAM,CAAC,YAAY,EAAE,UAAU,CAAC,CAAC;QAEhE,IAAI,UAAU,CAAC,SAAS,EAAE;YACzB,2BAA2B,CAAC,MAAM,EAAE,UAAU,CAAC,SAAS,CAAC,CAAC;SAC1D;QAED,IAAI,UAAU,CAAC,YAAY,EAAE;YAC5B,UAAU,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,IAAI;gBACpC,6BAA6B,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;YAC7C,CAAC,CAAC,CAAC;SACH;QAED,IAAI,UAAU,CAAC,MAAM,EAAE;YACtB,MAAM,CAAC,MAAM,CAAC,UAAU,CAAC,MAAM,CAAC,CAAC;SACjC;QAED,IAAI,UAAU,CAAC,UAAU,EAAE;YAC1B,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,UAAU,CAAC,CAAC;SAClC;QAED,iBAAiB,CAAC,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC;QAC3C,OAAO,iBAAiB,CAAC;IAC1B,CAAC,CAAC;AAEH,CAAC,CAAC;AAEF,SAAS,2BAA2B,CAAC,MAAuB,EAAE,SAAuB;IACpF,SAAS,CAAC,OAAO,CAAC,UAAC,QAAoB,EAAE,KAAa;QACrD,IAAM,UAAU,GAAG,MAAM,CAAC,IAAI,CAAC;QAE/B,IAAI,CAAC,QAAQ,EAAE;YACd,MAAM,IAAI,KAAK,CACd,qCAAmC,KAAK,6BAAwB,UAAU,wNAE+B,CACzG,CAAC;SACF;QAED,IAAK,QAA2B,CAAC,OAAO,IAAI,CAAE,QAA4B,CAAC,QAAQ;YAClF,CAAE,QAA4B,CAAC,QAAQ,IAAI,CAAE,QAA8B,CAAC,UAAU,EAAE;YACxF,MAAM,IAAI,KAAK,CACd,kCAAiC,QAA2B,CAAC,OAAO,6BAAwB,UAAU,uGACX,CAC3F,CAAC;SACF;QAED,IAAK,QAAoE,CAAC,KAAK,EAAE;YAChF,QAAQ,GAAI,QAAkE,CAAC;YAC/E,wBAAwB,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;SAC3C;aAAM;YACN,mBAAmB,CAAC,MAAM,EAAE,QAAQ,CAAC,CAAC;SACtC;IACF,CAAC,CAAC,CAAC;AACJ,CAAC;AAED,SAAS,mBAAmB,CAAC,MAAuB,EAAE,QAAoB;IACzE,IAAK,QAA4B,CAAC,QAAQ,EAAE;QAE3C,QAAQ,GAAG,QAA2B,CAAC;QACvC,MAAM,CAAC,QAAQ,CAAC,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;KAErD;SAAM,IAAK,QAA4B,CAAC,QAAQ,EAAE;QAElD,QAAQ,GAAG,QAA2B,CAAC;QACvC,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,EAAE,QAAQ,CAAC,QAAQ,CAAC,CAAC;KAEpD;SAAM,IAAK,QAA8B,CAAC,UAAU,EAAE;QACtD,QAAQ,GAAG,QAA6B,CAAC;QAEzC,IAAM,aAAa,GAAG,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,UAAU,CAAC,IAAI,QAAQ,CAAC,UAAU,CAAC,OAAO,CAAC;QAExF,IAAI,aAAa,IAAI,QAAQ,CAAC,IAAI,EAAE;YACnC,MAAM,KAAK,CAAC,4BAA0B,QAAQ,CAAC,OAAO,iHACgB,CAAC,CAAC;SACxE;QAED,IAAM,YAAY,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,UAAC,UAA8C;YACrG,OAAO,OAAO,UAAU,KAAK,QAAQ,CAAC,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC,wDAAW,CAAC,gBAAgB,CAAC,UAAU,CAAC,CAAC;QAC/F,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QAER,sFAAsF;QACtF,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,OAAO,EAAE,aAAa,CAAC,CAAC,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAK,YAAY,SAAE,QAAQ,CAAC,UAAU,EAAC,CAAC,CAAC;KAC/G;SAAM;QACN,QAAQ,GAAG,QAAqC,CAAC;QAEjD,IAAM,WAAW,GAAG,wDAAW,CAAC,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QAE3D,MAAM,CAAC,OAAO,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;KACtC;AACF,CAAC;AAED,SAAS,wBAAwB,CAAC,MAAuB,EAAE,QAA+D;IACzH,IAAM,oBAAoB,GAAG,MAAM,CAAC,IAAI,GAAG,QAAQ,CAAC,OAAO,CAAC;IAC5D,IAAI,YAAY,GAAG,gBAAgB,CAAC,oBAAoB,CAAC,CAAC;IAE1D,IAAI,CAAC,YAAY,EAAE;QAClB,YAAY,GAAG,EAAE,CAAC;KAClB;IAED,IAAM,qBAAqB,GAAG,oBAAoB,GAAG,oFAAc,CAAC,SAAS,EAAE,CAAC,QAAQ,EAAE,CAAC;IAE3F,YAAY,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;IACzC,gBAAgB,CAAC,oBAAoB,CAAC,GAAG,YAAY,CAAC;IAEtD,IAAM,UAAU,GAAG;QAClB,OAAO,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;IACjC,CAAC,CAAC;IAEF,mBAAmB,CAAC,MAAM,eAAM,QAAQ,IAAE,OAAO,EAAE,qBAAqB,IAAE,CAAC;IAC3E,mBAAmB,CAAC,MAAM,EAAE;QAC3B,OAAO,EAAE,QAAQ,CAAC,OAAO;QACzB,UAAU;QACV,IAAI,EAAE,YAAY;KAClB,CAAC,CAAC;AACJ,CAAC;AAED,SAAS,6BAA6B,CAAC,MAAuB,EAAE,SAA0D;IAEzH,IAAM,UAAU,GAAG,SAAS,CAAC,UAAU,CAAC;IACxC,IAAI,CAAC,UAAU,EAAE;QAChB,IAAM,wBAAwB,GAAG,oFAAc,CAAC,kBAAkB,CAAC,SAAS,CAAC,CAAC;QAC9E,MAAM,IAAI,KAAK,CAAI,wBAAwB,qCAAgC,MAAM,CAAC,IAAI,iFAA8E,CAAC,CAAC;KACtK;IAED,IAAI,SAAS,CAAC,SAAS,EAAE;QACxB,2BAA2B,CAAC,MAAM,EAAE,SAAS,CAAC,SAAS,CAAC,CAAC;KACzD;IAED,IAAM,aAAa,GAAI,SAAoC,CAAC,aAAa,CAAC;IAC1E,IAAM,aAAa,GAAI,SAAoC,CAAC,aAAa,CAAC;IAE1E,IAAI,aAAa,EAAE;QAClB,MAAM,CAAC,SAAS,CAAC,aAAa,EAAE,UAAuC,CAAC,CAAC;QAEzE,OAAO,SAAS,CAAC,UAAU,CAAC;QAE5B,IAAM,eAAe,GAAI,SAAoC,CAAC,eAAe,CAAC;QAC9E,IAAI,eAAe,EAAE;YACpB,eAAe,CAAC,OAAO,CAAC,UAAC,cAAmB;gBAC3C,6BAA6B,CAAC,MAAM,EAAE,cAAc,CAAC,CAAC;YACvD,CAAC,CAAC,CAAC;SAEH;QACD,OAAQ,SAAoC,CAAC,eAAe,CAAC;KAC7D;SAAM,IAAI,aAAa,EAAE;QACzB,MAAM,CAAC,SAAS,CAAC,aAAa,EAAE,cAAM,iBAAgC,EAAhC,CAAgC,CAAC,CAAC;KACxE;AACF,CAAC;AAED,wBAAwB;AACvB,QAAgB,CAAC,UAAU,GAAG;IAC9B,OAAO,oCAAO,CAAC;AAChB,CAAC,CAAC;AAEF,SAAS,UAAU;IAClB,OAAQ,QAAgB,CAAC,UAAU,EAAE,CAAC;AACvC,CAAC;AAEA,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,QAAQ,GAAG,QAAQ,CAAC;AACpD,MAAc,CAAC,gBAAgB,CAAC,2BAA2B,GAAG,2BAA2B,CAAC;AAC1F,MAAc,CAAC,gBAAgB,CAAC,mBAAmB,GAAG,mBAAmB,CAAC;AAC1E,MAAc,CAAC,gBAAgB,CAAC,wBAAwB,GAAG,wBAAwB,CAAC;AACpF,MAAc,CAAC,gBAAgB,CAAC,6BAA6B,GAAG,6BAA6B,CAAC;AAC9F,MAAc,CAAC,gBAAgB,CAAC,UAAU,GAAG,UAAU,CAAC;;;;;;;;;;;;;AC/QzD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAC4B;AACD;AACA;AAEH;AAEG;;;;;;;;;;;;AChB9B;;;;;;;;;GASG;;;;;;;;;;;;;ACTH;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACH,8CAA8C;AACX;AAEnC;;;;;;GAMG;AACH,eAAe;AACf,IAAM,mBAAmB,GAAG;IAC3B,8CAAc,CAAC,oBAAoB,EAAE,CAAC,wBAAwB,CAAC,CAAC,CAAC;IACjE,8CAAc,CAAC,8BAA8B,EAAE,CAAC,wBAAwB,CAAC,CAAC,CAAC;IAC3E,8CAAc,CAAC,uBAAuB,EAAE,CAAC,wBAAwB,CAAC,CAAC,CAAC;IACpE,8CAAc,CAAC,sBAAsB,EAAE,CAAC,wBAAwB,CAAC,CAAC,CAAC;IACnE,8CAAc,CAAC,sBAAsB,EAAE,CAAC,qBAAqB,CAAC,CAAC,CAAC;IAChE,8CAAc,CAAC,oBAAoB,EAAE,CAAC,qBAAqB,CAAC,CAAC,CAAC;IAC9D,8CAAc,CAAC,+BAA+B,EAAE,CAAC,qBAAqB,CAAC,CAAC,CAAC;IACzE,8CAAc,CAAC,mBAAmB,EAAE,CAAC,wBAAwB,CAAC,CAAC,CAAC;IAChE,8CAAc,CAAC,iBAAiB,EAAE,CAAC,wBAAwB,CAAC,CAAC,CAAC;AAC/D,CAAC,CAAC;AAEF;;;;;;GAMG;AACH,eAAe;AACR,SAAS,mBAAmB;IAClC,8CAAc,CAAC,kCAAkC,EAAE,CAAC,wBAAwB,CAAC,CAAC,CAAC;IAC/E,8CAAc,CAAC,iCAAiC,EAAE,CAAC,6BAA6B,CAAC,CAAC,CAAC;IACnF,8CAAc,CAAC,4BAA4B,EAAE,CAAC,6BAA6B,CAAC,CAAC,CAAC;IAC9E,8CAAc,CAAC,qBAAqB,EAAE,CAAC,sBAAsB,CAAC,CAAC,CAAC;IAChE,8CAAc,CAAC,4BAA4B,EAAE,CAAC,yBAAyB,CAAC,CAAC,CAAC;IAC1E,8CAAc,CAAC,gCAAgC,EAAE,CAAC,yBAAyB,CAAC,CAAC,CAAC;IAC9E,8CAAc,CAAC,4BAA4B,EAAE,CAAC,yBAAyB,CAAC,CAAC,CAAC;IAC1E,8CAAc,CAAC,iCAAiC,EAAE,CAAC,6BAA6B,CAAC,CAAC,CAAC;IACnF,8CAAc,CAAC,iCAAiC,EAAE,CAAC,6BAA6B,CAAC,CAAC,CAAC;IACnF,8CAAc,CAAC,+BAA+B,EAAE,CAAC,6BAA6B,CAAC,CAAC,CAAC;IACjF,8CAAc,CAAC,+BAA+B,EAAE,CAAC,6BAA6B,CAAC,CAAC,CAAC;IACjF,8CAAc,CAAC,iCAAiC,EAAE,CAAC,6BAA6B,CAAC,CAAC,CAAC;IACnF,8CAAc,CAAC,oCAAoC,EAAE,CAAC,qBAAqB,CAAC,CAAC,CAAC;IAC9E,8CAAc,CAAC,wBAAwB,EAAE,CAAC,qBAAqB,CAAC,CAAC,CAAC;IAClE,8CAAc,CAAC,0BAA0B,EAAE,CAAC,qBAAqB,CAAC,CAAC,CAAC;IACpE,8CAAc,CAAC,qBAAqB,EAAE,CAAC,wBAAwB,CAAC,CAAC,CAAC;AACnE,CAAC;AAEM,IAAM,SAAS,GAAG;IACxB,mBAAmB,EAAE,CAAC;IACtB,mBAAmB,EAAE,CAAC;AACvB,CAAC,CAAC;;;;;;;;;;;;;AClBF;AAAA;AAAO,IAAM,cAAc,GAAG;IAC7B,IAAI,EAAE,MAAwB;IAC9B,UAAU,EAAE,WAA6B;IACzC,SAAS,EAAE,UAA4B;IACvC,UAAU,EAAE,WAA6B;CACzC,CAAC;;;;;;;;;;;;;;;;;;;;;;ACrCqD;AAEvD,IAAM,8CAA8C,GAAG;IACtD,oCAAoC;IACpC,0DAA0D;IAC1D,IAAI,EAAE,IAAmB;IAEzB,8EAA8E;IAC9E,4EAA4E;IAC5E,kFAAkF;IAClF,iEAAiE;IACjE,SAAS,EAAE,CAAC;CACgB,CAAC;AAE9B;;GAEG;AACH,IAAM,UAAU,GAAG;IAClB,OAAO,EAAE,CAAC;IACV,SAAS,EAAE,CAAC;IACZ,IAAI,EAAE,CAAC;CACP,CAAC;AAEF;;EAEE;AACF,IAAM,0CAA0C,GAAG;IAC/C;;UAEM;IACT,UAAU,EAAE,KAAK;IACd;;UAEM;IACT,iBAAiB,EAAE,KAAK;IACrB;;UAEM;IACT,SAAS,EAAE,IAAI;IACf,aAAa,EAAE,KAAK;IACjB;;UAEM;IACT,OAAO,EAAE,IAAI;CACb,CAAC;AAMF;;;;;;;;GAQG;AAGF;IAqBA,gBAAgB;IAChB,+BACS,IAAyB,EACzB,SAAmC,EACnC,2BAAqF,EACrF,MAAuB,EACvB,OAAqB,EACrB,OAAY,EACZ,kBAAsF;QANtF,SAAI,GAAJ,IAAI,CAAqB;QACzB,cAAS,GAAT,SAAS,CAA0B;QACnC,gCAA2B,GAA3B,2BAA2B,CAA0D;QACrF,WAAM,GAAN,MAAM,CAAiB;QACvB,YAAO,GAAP,OAAO,CAAc;QACrB,YAAO,GAAP,OAAO,CAAK;QACZ,uBAAkB,GAAlB,kBAAkB,CAAoE;QAjB/F;;;WAGG;QACK,oBAAe,GAAmB,EAAE,CAAC;QAGrC,cAAS,GAAa,EAAE,CAAC;IAYjC,CAAC;IAED;;;;;;;;;;OAUG;IACH,gDAAgB,GAAhB,UAAiB,aAA6B;QAA9C,iBASC;QARA,IAAM,gCAAgC,GAAG,QAAQ,CAAC,gBAAgB,CAAC,aAAa,CAAC,CAAC,EAAE,aAAa,CAAC,CAAC,CAAC,CAAC;QACrG,gIAAgI;QAChI,oJAAoJ;QACpJ,0EAA0E;QAC1E,OAAO,gCAAgC,IAAI,IAAI,CAAC,iBAAiB,EAAE;aACjE,IAAI,CAAC,UAAC,SAAS;YACf,OAAO,KAAI,CAAC,kBAAkB,CAAC,aAAa,EAAE,SAAwB,CAAC,CAAC;QACzE,CAAC,CAAC,CAAC;IACL,CAAC;IAED;;;;;;;OAOG;IACH,2CAAW,GAAX,UAAY,QAAgB;QAC3B,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE;YACvE,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;YAC9B,IAAI,CAAC,OAAO,EAAE,CAAC;SACf;IACF,CAAC;IAED;;;;;;;OAOG;IACH,8CAAc,GAAd;QACC,OAAO,IAAI,CAAC,eAAe;aACzB,GAAG,CAAC,UAAC,OAAO,IAAK,cAAO,CAAC,SAAS,EAAjB,CAAiB,CAAC,CAAC;IACvC,CAAC;IAED;;;;;;;OAOG;IACH,iDAAiB,GAAjB;QACC,OAAO,IAAI,CAAC,eAAe;aACzB,MAAM,CAAC,UAAC,OAAO,IAAK,cAAO,CAAC,cAAc,EAAtB,CAAsB,CAAC;aAC3C,GAAG,CAAC,UAAC,OAAO,IAAK,cAAO,CAAC,SAAS,EAAjB,CAAiB,CAAC,CAAC;IACvC,CAAC;IAGO,uCAAO,GAAf;QACC,IAAI,CAAC,YAAY,EAAE,CAAC;QACpB,IAAI,CAAC,YAAY,EAAE,CAAC;IACrB,CAAC;IAED;;OAEG;IACK,4CAAY,GAApB;QACC,mCAAmC;QACnC,IAAI,IAAI,CAAC,gBAAgB,EAAE;YAC1B,IAAI,CAAC,gBAAgB,CAAC,UAAU,EAAE,CAAC;YACnC,OAAO,IAAI,CAAC,gBAAgB,CAAC;SAC7B;QAED,IAAI,IAAI,CAAC,oBAAoB,EAAE;YAC9B,IAAI,CAAC,oBAAoB,CAAC,UAAU,EAAE,CAAC;YACvC,OAAO,IAAI,CAAC,oBAAoB,CAAC;SACjC;QAED,IAAI,CAAC,eAAe,GAAG,EAAE,CAAC;IAC3B,CAAC;IAED;;;;OAIG;IACK,4CAAY,GAApB;QAAA,iBAyBC;QAvBA,IAAI,CAAC,IAAI,CAAC,gBAAgB,EAAE;YAC3B,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;YAE7F,IAAI,CAAC,IAAI,CAAC,oBAAoB,EAAE;gBAC/B,yFAAyF;gBACzF,oGAAoG;gBACpG,qGAAqG;gBACrG,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,wBAAwB,CAAC,UAAC,OAAO;oBACjE,OAAO;yBACL,MAAM,CAAC,UAAC,KAAK,IAAK,YAAI,CAAC,oBAAoB,CAAC,KAAK,CAAC,MAAM,CAAC,EAAvC,CAAuC,CAAC;yBAC1D,OAAO,CAAC,UAAC,KAAK;wBACd,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;oBAC1B,CAAC,CAAC,CAAC;gBACL,CAAC,CAAC,CAAC;aACH;YAED,kEAAkE;YAClE,8KAA8K;YAC9K,IAAI,CAAC,oBAAoB,EAAE,CAAC,OAAO,CAAC,UAAC,SAAsB;gBAC1D,KAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;YAC9C,CAAC,CAAC,CAAC;SAEH;IACF,CAAC;IAED;;OAEG;IACK,6DAA6B,GAArC,UAAsC,SAA2B,EAAE,SAAkB;QAArF,iBAiCC;QAhCA,IAAM,OAAO,GAAG,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,MAAM,CAAC,UAAC,QAAQ;YAC7D,uDAAuD;YACvD,OAAO,QAAQ,CAAC,IAAI,KAAK,WAAW;mBAChC,CAAC,CAAC,CAAC,CAAC,SAAS,IAAI,QAAQ,CAAC,UAAU,IAAI,QAAQ,CAAC,UAAU,CAAC,MAAM,CAAC;uBAClE,CAAC,CAAC,SAAS,IAAI,QAAQ,CAAC,YAAY,IAAI,QAAQ,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC;QAC7E,CAAC,CAAC,CAAC,GAAG,CAAC,UAAC,QAAwB;YAG/B,IAAM,QAAQ,GAAG,KAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,QAAQ,CAAC,UAAU,CAAC,CAAC,CAAC,QAAQ,CAAC,YAAY,CAAC;iBACtH,MAAM,CAAC,UAAC,IAAiB;gBACzB,OAAO,IAAI,CAAC,QAAQ,KAAK,UAAU,CAAC,OAAO,CAAC;YAC7C,CAAC,CAAC;iBACD,MAAM,CAAC,UAAC,IAAiB,IAAK,YAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,EAA/B,CAA+B,CAAC;iBAC9D,GAAG,CAAC,UAAC,KAAkB;gBACvB,OAAO,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,KAAI,CAAC,uBAAuB,CAAC,KAAK,CAAC,CAAC,CAAC;YAC5D,CAAC,CAAC,CAAC;iBACF,IAAI,CAAC,KAAI,CAAC,2BAA2B,EAAE,CAAC;gBACzC,6EAA6E;iBAC5E,OAAO,EAAE,CAAC;YACZ,OAAO,QAAQ,CAAC;QACjB,CAAC,CAAC,CAAC,CAAC;QAEJ;;;;;WAKG;QAEH,OAAO,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,OAAO,EAAE,UAAC,MAAmB,EAAE,MAAmB;YAC7E,OAAO,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,IAAI,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC;QAC3D,CAAC,CAAC,CAAC;IACJ,CAAC;IAED;;;;OAIG;IACK,yDAAyB,GAAjC,UAAkC,SAA2B;QAA7D,iBAcC;QAbA,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,CAAC;QAE3B,IAAI,CAAC,6BAA6B,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC,OAAO,CAAC,UAAC,IAAiB;YAC7E,KAAI,CAAC,oBAAoB,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;QACzC,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,6BAA6B,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC,OAAO,CAAC,UAAC,IAAiB;YAC9E,IAAM,cAAc,GAAG,KAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,CAAC;YAC5D,IAAI,cAAc,KAAK,CAAC,CAAC,EAAE;gBAC1B,KAAI,CAAC,eAAe,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;aAC/C;QACF,CAAC,CAAC,CAAC;IAEJ,CAAC;IAED;;;;OAIG;IACK,4CAAY,GAApB,UAAqB,KAAgC;QAEpD,IAAM,cAAc,GAAG,IAAI,CAAC,yBAAyB,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QAEpE,IAAI,cAAc,KAAK,CAAC,CAAC,EAAE;YAC1B,IAAI,CAAC,KAAK,CAAC,iBAAiB,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE;gBAC7D,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,cAAc,EAAE,CAAC,CAAC,CAAC;aAE/C;iBAAM;gBACN,IAAI,CAAC,eAAe,CAAC,cAAc,CAAC,CAAC,cAAc,GAAG,CAAC,CAAC,KAAK,CAAC,iBAAiB,CAAC;aAChF;SACD;aAAM,IAAI,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,MAAM,CAAC,EAAE,EAAC,8FAA8F;YACtI,IAAI,CAAC,eAAe,CAAC,IAAI,CAAC;gBACzB,SAAS,EAAE,KAAK,CAAC,MAAM;gBACvB,cAAc,EAAE,CAAC,CAAC,KAAK,CAAC,iBAAiB;aACzB,CAAC,CAAC;SACnB;IACF,CAAC;IAED,sFAAsF;IACtF,sFAAsF;IACtF,sFAAsF;IAEtF;;OAEG;IACK,oDAAoB,GAA5B,UAA6B,QAA0B;QACtD,IAAM,gBAAgB,GAAG,IAAI,gBAAgB,CAAC,QAAQ,CAAC,CAAC;QACxD,gBAAgB,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,EAAE,0CAA0C,CAAC,CAAC;QACpF,OAAO,gBAAgB,CAAC;IACzB,CAAC;IAED;;OAEG;IACK,wDAAwB,GAAhC,UAAiC,QAAsC;QACtE,OAAO,IAAI,oBAAoB,CAAC,QAAQ,EAAE,8CAA8C,CAAC,CAAC;IAC3F,CAAC;IAGO,kDAAkB,GAA1B;QACC,OAAO,IAAI,CAAC,SAAS,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;IACjC,CAAC;IAEO,oDAAoB,GAA5B,UAA6B,SAAkB;QAC9C,OAAO,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC;IAC9D,CAAC;IAEO,oDAAoB,GAA5B;QACC,OAAO,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC,CAAC;IAC5E,CAAC;IAEO,uDAAuB,GAA/B,UAAgC,SAAsB;QACrD,OAAO,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,kBAAkB,EAAE,CAAC,CAAC,CAAC;IAC5F,CAAC;IAEO,yDAAyB,GAAjC,UAAkC,SAAkB;QACnD,OAAO,IAAI,CAAC,eAAe,CAAC,SAAS,CAAC,UAAS,GAAG;YACjD,OAAO,SAAS,KAAK,GAAG,CAAC,SAAS,CAAC;QACpC,CAAC,CAAC,CAAC;IACJ,CAAC;IAEO,wCAAQ,GAAhB,UAAiB,SAAkB;QAClC,OAAO,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC;IAC5D,CAAC;IAzRY,qBAAqB;QAFlC,8EAAY,EAAE;QACf,eAAe;OACD,qBAAqB,CA0RlC;IAAD,4BAAC;CAAA;AA1RkC;;;;;;;;;;;;;AC1EnC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAC4C;AACP;;;;;;;;;;;;;;;;;;;;;;ACXsC;AAgB9E;;;GAGG;AACH,gBAAgB;AAGf;IAYA,kCACS,IAAyB,EACzB,iBAAsB;QADtB,SAAI,GAAJ,IAAI,CAAqB;QACzB,sBAAiB,GAAjB,iBAAiB,CAAK;QALvB,qBAAgB,GAAgD,EAAE,CAAC;QACnE,sBAAiB,GAAiD,EAAE,CAAC;QAM5E,IAAI,CAAC,UAAU,GAAG,MAAM,CAAC;QACzB,IAAI,CAAC,UAAU,CAAC,WAAW,GAAG,CAAC,CAAC;QAChC,IAAI,CAAC,UAAU,CAAC,cAAc,GAAG,CAAC,CAAC;QACnC,IAAI,CAAC,UAAU,CAAC,YAAY,GAAG,CAAC,CAAC;QACjC,IAAI,CAAC,UAAU,CAAC,eAAe,GAAG,CAAC,CAAC;QAEpC,IAAI,CAAC,OAAO,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACvC,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IAE1C,CAAC;iCAzBY,wBAAwB;IA2BrC,sDAAmB,GAAnB,UAAoB,QAAmD;QACtE,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACtC,CAAC;IAED,uDAAoB,GAApB,UAAqB,QAAoD;QACxE,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IACvC,CAAC;IAED,0CAAO,GAAP,UAAQ,MAA8B;QAAtC,iBAsBC;QApBA,IAAI,0BAAwB,CAAC,WAAW,KAAK,CAAC,IAAI,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,EAAE;YACtG,OAAO,IAAI,CAAC,iBAAiB,CAAC,aAAa,CAAC,MAAM,EAAE;gBAEnD,KAAI,CAAC,UAAU,CAAC,WAAW,EAAE,CAAC;gBAC9B,IAAI,KAAI,CAAC,wBAAwB,CAAC,0BAAwB,CAAC,WAAW,CAAC,EAAE;oBACxE,KAAI,CAAC,UAAU,CAAC,cAAc,EAAE,CAAC;oBAEjC,IAAM,eAAe,GAAG,KAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,UAAC,QAAQ,IAAK,eAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,EAArB,CAAqB,CAAC,CAAC;oBACxF,IAAI,eAAe,EAAE;wBACpB,MAAM,GAAG,eAAe,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;wBACxC,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,sBAAmB,MAAM,CAAC,GAAK,CAAC,CAAC;qBACjD;iBAED;gBAED,OAAO,MAAM,CAAC;YACf,CAAC,CAAC,CAAC;SACH;aAAM;YACN,OAAO,MAAM,CAAC;SACd;IACF,CAAC;IAED,2CAAQ,GAAR,UAAS,QAAoC;QAC5C,IAAI,0BAAwB,CAAC,WAAW,KAAK,CAAC,IAAI,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,MAAM,CAAC,EAAE;YAElH,IAAI,CAAC,UAAU,CAAC,YAAY,EAAE,CAAC;YAC/B,IAAI,IAAI,CAAC,wBAAwB,CAAC,0BAAwB,CAAC,WAAW,CAAC,EAAE;gBACxE,IAAI,CAAC,UAAU,CAAC,eAAe,EAAE,CAAC;gBAElC,IAAM,gBAAgB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,UAAC,QAAQ,IAAK,eAAQ,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,EAA9B,CAA8B,CAAC,CAAC;gBACnG,IAAI,gBAAgB,EAAE;oBACrB,QAAQ,GAAG,gBAAgB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC;oBAC7C,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,uBAAoB,QAAQ,CAAC,MAAM,CAAC,GAAK,CAAC,CAAC;iBAC3D;aACD;YAED,OAAO,QAAQ,CAAC;SAChB;aAAM;YACN,OAAO,QAAQ,CAAC;SAChB;IACF,CAAC;IAEO,iDAAc,GAAtB,UAAuB,MAA8B;QACpD,OAAO,MAAM,CAAC,GAAG;eACb,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;mBAClC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CACnC,CAAC;IACJ,CAAC;IAEO,kDAAe,GAAvB,UAAwB,QAAoC;QAC3D,OAAO,QAAQ,CAAC,MAAM,IAAI,QAAQ,CAAC,MAAM,CAAC,GAAG;eACzC,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;eAC3C,QAAQ,CAAC,OAAO,CAAC,cAAc,CAAC;eAChC,QAAQ,CAAC,OAAO,CAAC,cAAc,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;IAC3D,CAAC;IAEO,yCAAM,GAAd,UAAe,MAA8B;QAC5C,OAAO,MAAM,CAAC,MAAM,KAAK,KAAK,CAAC;IAChC,CAAC;IAEO,2DAAwB,GAAhC,UAAiC,eAAuB;QACvD,OAAO,IAAI,CAAC,MAAM,EAAE,IAAI,GAAG,GAAG,eAAe,CAAC;IAC/C,CAAC;;IAjGD;;OAEG;IACY,oCAAW,GAAG,CAAC,CAAC;IALlB,wBAAwB;QAFrC,qGAAY,EAAE;QACf,eAAe;OACD,wBAAwB,CAsGrC;IAAD,+BAAC;CAAA;AAtGqC;;;;;;;;;;;;;;;;;;;;;;;ACZiD;AACnB;AAEpE,gBAAgB;AAuBhB;IAAA;IAA6C,CAAC;IAAjC,8BAA8B;QAtB1C,iGAAQ,CAAC;YACT,OAAO,EAAE;gBACR,yBAAyB;aACzB;YACD,SAAS,EAAE,CAAC,kFAAwB,CAAC;YACrC,MAAM,EAAE,UAAC,aAAoC;gBAC5C,UAAU,CAAC;gBACX,aAAa,CAAC,YAAY,CAAC,IAAI,CAAC,4FAAW,CAAC,gBAAgB,CAAC,kFAAwB,CAAC,CAAC,CAAC;YACzF,CAAC;YACD,UAAU,EAAE,UAAC,wBAAkD;gBAC9D,UAAU,CAAC;gBACX,mBAAmB;gBACnB,wBAAwB,CAAC,mBAAmB,CAAC;oBAC5C,IAAI,EAAE,UAAC,MAA8B,IAAK,wBAAiB,CAAC,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,EAAlC,CAAkC;oBAC5E,MAAM,EAAE,UAAC,MAA8B;wBACtC,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,mBAAmB,EAAE,QAAQ,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,GAAG,CAAC,CAAC;wBACrF,OAAO,MAAM,CAAC;oBACf,CAAC;iBACD,CAAC,CAAC;YAEJ,CAAC;SACD,CAAC;OACW,8BAA8B,CAAG;IAAD,qCAAC;CAAA;AAAH;;;;;;;;;;;;;ACrC3C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAEH;;;;;;;;GAQG;AAC0D;AACO;AACC;AACT;AACE;AACA;AACM;AACO;AAClB;AACC;AACH;AACO;AACF;AACD;AACA;AACN;AACO;AACD;AACD;AACA;AACJ;AACQ;AACU;AACQ;;;;;;;;;;;;;;;;;;;;;;;AChCP;AAGhB;AAEzD;;;;;;;;;;GAUG;AAGF;IAIA,gBAAgB;IAChB,wBACS,EAAqB,EACrB,IAAyB,EACzB,OAA+B,EAC/B,SAAwC,EACxC,QAAiC,EACjC,kBAAsC,EACtC,cAA8B,EAC9B,SAAc,EACd,aAAkB,EAClB,QAAa,EACb,WAAwB,EACxB,0CAAkD,EAClD,2BAAmC;QAZnC,OAAE,GAAF,EAAE,CAAmB;QACrB,SAAI,GAAJ,IAAI,CAAqB;QACzB,YAAO,GAAP,OAAO,CAAwB;QAC/B,cAAS,GAAT,SAAS,CAA+B;QACxC,aAAQ,GAAR,QAAQ,CAAyB;QACjC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,cAAS,GAAT,SAAS,CAAK;QACd,kBAAa,GAAb,aAAa,CAAK;QAClB,aAAQ,GAAR,QAAQ,CAAK;QACb,gBAAW,GAAX,WAAW,CAAa;QACxB,+CAA0C,GAA1C,0CAA0C,CAAQ;QAClD,gCAA2B,GAA3B,2BAA2B,CAAQ;QAhBpC,sBAAiB,GAA6B,EAAE,CAAC;IAiBtD,CAAC;IAED;;;;;;;;OAQG;IAEN,qCAAY,GAAZ;QAAA,iBA8BC;QA5BA,IAAM,oBAAoB,GAAa,EAAE,CAAC;QAE1C,sCAAsC;QACtC,IAAI,CAAC,OAAO,CAAC,gBAAgB,CAAC,SAAS,EAAE,UAAC,CAAe;YAExD,IAAI,KAAI,CAAC,UAAU,CAAC,CAAC,CAAC,MAAM,CAAC,EAAE;gBAC9B,0BAA0B;gBAC1B,IAAM,OAAK,GAA4B,CAAC,CAAC,IAAI,CAAC;gBAE9C,IAAI,oBAAoB,CAAC,OAAO,CAAC,OAAK,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE;oBAChD,OAAO;iBACP;gBACD,oBAAoB,CAAC,IAAI,CAAC,OAAK,CAAC,EAAE,CAAC,CAAC;gBACpC,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,8BAA8B,EAAE,OAAK,CAAC,OAAO,CAAC,CAAC;gBAE/D,IAAM,SAAS,GAAW,OAAK,CAAC,SAAS,CAAC;gBAC1C,IAAM,OAAO,GAAmB,KAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;gBAClE,IAAI,CAAC,OAAO,EAAE;oBACb,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,8BAA8B,GAAG,SAAS,GAAG,8BAA8B,CAAC,CAAC;oBAC7F,OAAO;iBACP;gBAED,OAAO,CAAC,YAAY,CAAC,OAAK,CAAC,CAAC;aAC5B;iBAAM;gBACN,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,wEAAwE,CAAC,CAAC;aAC1F;QAEF,CAAC,EAAE,KAAK,CAAC,CAAC;IACX,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,sCAAa,GAAb,UAAc,SAAiB;QAC9B,IAAI,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE;YACtC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,sBAAsB,GAAG,SAAS,GAAG,mBAAmB,CAAC,CAAC;YAC1E,OAAO,IAAI,CAAC;SACZ;QAED,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,GAAG,IAAI,8DAAc,CAAC,IAAI,CAAC,EAAE,EAAE,IAAI,CAAC,IAAI,EAAE,IAAI,CAAC,QAAQ,EACvF,IAAI,CAAC,kBAAkB,EAAE,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,WAAW,EAC9D,IAAI,CAAC,2BAA2B,EAAE,SAAS,CAAC,CAAC;QAE9C,OAAO,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;IAC1C,CAAC;IAEE;;OAEG;IACE,mCAAU,GAAlB,UAAmB,MAAc;QAAjC,iBAMC;QALA,IAAM,sBAAsB,GAAa,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,0CAA0C,CAAC,CAAC,CAAC;YAC7G,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,0CAA0C,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC;QAC1E,OAAO,IAAI,CAAC,QAAQ,EAAE,IAAI,IAAI,CAAC,SAAS,EAAE,KAAK,MAAM,IAAI,CAAC,sBAAsB,CAAC,IAAI,CAAC,UAAC,UAAkB;YACxG,OAAO,KAAI,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACpD,CAAC,CAAC,CAAC,CAAC;IACL,CAAC;IAlGY,cAAc;QAF3B,4EAAY,EAAE;QACf,eAAe;OACD,cAAc,CAmG3B;IAAD,qBAAC;CAAA;AAnG2B;;;;;;;;;;;;;AC7B5B;AAAA;AAAA;AAAA;;;;;;;;;GASG;;;;;;;AAKsD;AAGzD;;;;;;;;;;;;;;GAcG;AAGF;IAIA,sBACS,IAAyB,EACzB,EAAqB,EACrB,SAAc,EACd,OAAY,EACZ,cAA8B,EAC9B,cAA8B;QAL9B,SAAI,GAAJ,IAAI,CAAqB;QACzB,OAAE,GAAF,EAAE,CAAmB;QACrB,cAAS,GAAT,SAAS,CAAK;QACd,YAAO,GAAP,OAAO,CAAK;QACZ,mBAAc,GAAd,cAAc,CAAgB;QAC9B,mBAAc,GAAd,cAAc,CAAgB;QAR/B,wBAAmB,GAAG,CAAC,kBAAkB,EAAE,4BAA4B,EAAE,mBAAmB,CAAC,CAAC;IASnG,CAAC;IAED;;;;;;;;;;;;;;OAcG;IAEN,qCAAc,GAAd,UAA0C,OAAU,EAAE,aAAwB,EAAE,SAAkB;QAAlG,iBA+BC;QA7BA,IAAM,IAAI,GAAG,SAAS,IAAI,OAAO,CAAC,SAAS,CAAC;QAE5C,IAAI,CAAC,IAAI,EAAE;YACV,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,2FAAwF,aAAa,IAAI,aAAa,CAAC,MAAM,CAAC,CAAC,CAAC,aAAa,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,EAAE,CAAE,CAAC,CAAC;YAChL,OAAO,IAAI,CAAC;SACZ;QAED,IAAM,OAAO,GAAmB,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,IAAI,CAAC,CAAC;QAExE,IAAI,UAAU,GAAG,aAAa,CAAC;QAC/B,IAAI,CAAC,UAAU,EAAE;YAChB,UAAU,GAAG,EAAE,CAAC;YAChB,KAAK,IAAM,GAAG,IAAI,OAAO,EAAE;gBAC1B,IAAI,OAAO,OAAO,CAAC,GAAG,CAAC,KAAK,UAAU,IAAI,CAAC,IAAI,CAAC,qBAAqB,CAAC,GAAG,CAAC,EAAE;oBAC3E,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;iBACrB;aACD;SACD;QAED,UAAU,CAAC,OAAO,CAAC,UAAC,MAAgC;YACnD,IAAI,OAAO,OAAO,CAAC,MAAM,CAAC,KAAK,UAAU,EAAE;gBAC1C,IAAI,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,OAAO,CAAC,MAAM,CAAQ,CAAC,EAAE;oBACxD,KAAI,CAAC,YAAY,CAAC,MAAM,EAAE,OAAO,EAAE,OAAO,CAAC,CAAC;iBAC5C;qBAAM;oBACN,OAAO,CAAC,MAAM,CAAC,GAAG,KAAI,CAAC,SAAS,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE,OAAO,CAAC,CAAC;oBAC3D,OAAO,CAAC,SAAS,CAAC,MAAM,EAAE,KAAI,CAAC,eAAe,CAAC,IAAI,CAAC,IAAI,EAAE,MAAM,EAAE,OAAO,CAAC,CAAC,CAAC;iBAC5E;aACD;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IAEO,4CAAqB,GAA7B,UAA8B,GAAW;QACxC,OAAO,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,IAAI,GAAG,CAAC,UAAU,CAAC,GAAG,CAAC,IAAI,GAAG,KAAK,QAAQ,IAAI,GAAG,KAAK,QAAQ,CAAC;IAClH,CAAC;IAEO,sCAAe,GAAvB,UAA2B,MAAgC,EAAE,OAAU,EAAE,OAAe,EAAE,IAA4B;QACrH,OAAQ,OAAO,CAAC,MAAM,CAAS,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,SAAS,CAAC,CAAC;IAChE,CAAC;IAEO,mCAAY,GAApB,UAAwB,MAAgC,EAAE,OAAU,EAAE,OAAuB;QAA7F,iBAmBC;QAlBA,OAAO,OAAO,CAAC,MAAM,CAAC,CAAC;QAEvB,OAAO,CAAC,MAAM,CAAC,GAAG,CAAC;YAAC,cAAoB;iBAApB,UAAoB,EAApB,qBAAoB,EAApB,IAAoB;gBAApB,yBAAoB;;YACvC,OAAO,OAAO,CAAC,OAAO,CAAC,MAAM,EAAE;gBAC9B,SAAS,EAAE,IAAI;aACF,CAAC,CAAC,IAAI,CAAC,UAAC,YAAuB;gBAC5C,IAAI,CAAC,KAAI,CAAC,OAAO,CAAC,YAAY,CAAC,EAAE;oBAChC,OAAQ,YAAoB,CAAC,SAAS,CAAC;oBACvC,OAAQ,YAAoB,CAAC,QAAQ,CAAC;iBACtC;gBACD,OAAO,YAAY,CAAC;YACrB,CAAC,EAAE,UAAC,KAAU;gBACb,IAAI,KAAK,EAAE;oBACV,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,+CAA6C,OAAO,CAAC,SAAS,gBAAW,MAAM,uBAAkB,IAAM,CAAC,CAAC;iBACzH;gBACD,OAAO,KAAI,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;YAC9B,CAAC,CAAC,CAAC;QACJ,CAAC,CAAQ,CAAC;IACX,CAAC;IAzFY,YAAY;QAFzB,4EAAY,EAAE;QACf,eAAe;OACD,YAAY,CA0FzB;IAAD,mBAAC;CAAA;AA1FyB;;;;;;;;;;;;;;;;;;;;;;;;AClC1B;;;;;;;;;GASG;AACgC;AAGsB;AAgBzD;;;;;;;;;;;;;;;;;;GAkBG;AAIF;IAUA,gBAAgB;IAChB,wBACS,EAAqB,EACrB,IAAyB,EACzB,QAAiC,EACjC,kBAAsC,EACtC,cAA8B,EAC9B,WAAwB,EACxB,2BAAmC,EAC3B,SAAiB;QAPzB,OAAE,GAAF,EAAE,CAAmB;QACrB,SAAI,GAAJ,IAAI,CAAqB;QACzB,aAAQ,GAAR,QAAQ,CAAyB;QACjC,uBAAkB,GAAlB,kBAAkB,CAAoB;QACtC,mBAAc,GAAd,cAAc,CAAgB;QAC9B,gBAAW,GAAX,WAAW,CAAa;QACxB,gCAA2B,GAA3B,2BAA2B,CAAQ;QAC3B,cAAS,GAAT,SAAS,CAAQ;QAjB1B,qCAAgC,GAAW,wBAAwB,CAAC;QACpE,4BAAuB,GAAW,eAAe,CAAC;QAClD,YAAO,GAAW,SAAS,CAAC;QAC5B,YAAO,GAAW,SAAS,CAAC;QAC5B,gBAAW,GAAW,CAAC,CAAC;QAExB,sBAAiB,GAAgD,EAAE,CAAC;IAYzE,CAAC;IAED;;;;;;;;;;;;;;;;;;OAkBG;IACN,gCAAO,GAAP,UAAuD,OAAe,EAAE,KAAU,EAAE,OAAmB,EAAE,EAAW;QAApH,iBAyDC;QAzDmF,qCAAmB;QAEtG,IAAI,CAAC,OAAO,EAAE;YACb,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,2EAAyE,KAAO,CAAC,CAAC;YAClG,OAAO,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,EAAU,CAAC,CAAC;SAChC;QAED,IAAM,IAAI,GAAc,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;QAEjE,IAAI,CAAC,8CAAc,CAAC,IAAI,EAAE,KAAK,CAAC,EAAE;YACjC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,mFAAiF,IAAI,CAAC,SAAS,gBAAW,OAAO,MAAG,EAAE,IAAI,CAAC,CAAC;SAC3I;QAED,IAAM,QAAQ,GAAiC,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAiC,IAAK,IAAI,CAAC,EAAE,CAAC,KAAK,EAAyC,CAAC;QACrK,IAAI,MAAc,CAAC;QAEnB,IAAI;YAEH,MAAM,GAAG,IAAI,CAAC,WAAW,CAAC,eAAe,EAAE,CAAC;YAC5C,IAAI,CAAC,MAAM,EAAE;gBACZ,MAAM,IAAI,KAAK,CAAC,sCAAsC,CAAC,CAAC;aACxD;YAED,EAAE,GAAG,EAAE,IAAI,IAAI,CAAC,mBAAmB,EAAE,CAAC;YACtC,IAAI;gBACH,MAAM,CAAC,WAAW,CAAC;oBAClB,EAAE;oBACF,SAAS,EAAE,IAAI,CAAC,SAAS;oBACzB,OAAO;oBACP,IAAI;iBACuB,EAAE,GAAG,CAAC,CAAC;aACnC;YAAC,OAAO,CAAC,EAAE;gBACX,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;gBACnB,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,iEAA+D,IAAI,CAAC,SAAS,eAAU,OAAO,eAAY,EAAE,IAAI,CAAC,CAAC;aAClI;YAED,IAAI,CAAC,iBAAiB,CAAC,EAAE,CAAC,GAAG,QAAQ,CAAC;YAEtC,kEAAkE;YAClE,IAAI,CAAC,QAAQ,CAAC;gBACb,IAAI,CAAC,QAAQ,CAAC,YAAY,IAAI,OAAO,KAAK,KAAI,CAAC,uBAAuB,IAAI,OAAO,KAAK,KAAI,CAAC,gCAAgC,EAAE,EAAE,gBAAgB;oBAC9I,IAAI,OAAO,GAAG,KAAI,CAAC,WAAW,EAAE;wBAE/B,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,8BAA8B,EAAE,OAAO,CAAC,CAAC;wBAEjF,KAAI,CAAC,OAAO,CAAC,OAAO,EAAE,IAAI,EAAE,EAAE,OAAO,EAAE,EAAE,CAAC,CAAC;qBAE3C;yBAAM;wBACN,QAAQ,CAAC,MAAM,EAAE,CAAC;qBAClB;iBACD;YACF,CAAC,EAAE,IAAI,CAAC,2BAA2B,CAAC,CAAC;SACrC;QAAC,OAAO,CAAC,EAAE;YACX,QAAQ,CAAC,MAAM,EAAE,CAAC;SAClB;QAED,OAAO,QAAQ,CAAC,OAAO,CAAC;IACzB,CAAC;IAEE;;;;;;;;;;;OAWG;IACN,kCAAS,GAAT,UAA+B,OAAe,EAAE,QAAkC;QACjF,IAAI,aAAyB,CAAC;QAC9B,IAAI,CAAC,OAAO,EAAE;YACb,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,+DAA+D,GAAG,OAAO,CAAC,CAAC;SAC3F;aAAM;YACN,IAAM,aAAa,GAAG,IAAI,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC;YACtD,aAAa,GAAG,IAAI,CAAC,kBAAkB,CAAC,SAAS,CAAC,aAAa,EAAE,QAAQ,CAAC,CAAC;SAC3E;QACD,OAAO,aAAa,CAAC;IACtB,CAAC;IAED,qCAAY,GAAZ,UAAa,KAA8B;QAA3C,iBA+CC;QA9CA,IAAM,SAAS,GAAG,KAAK,CAAC,IAA4E,CAAC;QACrG,IAAI,KAAK,CAAC,OAAO,KAAK,IAAI,CAAC,uBAAuB,IAAI,KAAK,CAAC,OAAO,KAAK,IAAI,CAAC,gCAAgC,EAAE;YAC9G,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,6BAA6B,EAAE,KAAK,CAAC,CAAC;YAE9E,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,gCAAgC,EAAE;gBACnD,EAAE,EAAE,KAAK,CAAC,EAAE;aACZ,CAAC,CAAC;YAEH,IAAM,aAAa,GAAG,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;YAC5D,IAAI,CAAC,kBAAkB,CAAC,YAAY,CAAC,aAAa,EAAE,KAAK,CAAC,IAAI,CAAC,CAAC,IAAI,CACnE,UAAC,4BAAuC;gBACvC,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,yBAAyB,EAAE,KAAK,CAAC,CAAC;gBAC1E,KAAI,CAAC,OAAO,CAAC,KAAI,CAAC,uBAAuB,EAAE;oBAC1C,EAAE,EAAE,KAAK,CAAC,EAAE;oBACZ,IAAI,EAAE,KAAI,CAAC,OAAO;oBAClB,4BAA4B;iBAC5B,CAAC,CAAC;YACJ,CAAC,EACD;gBACC,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,wBAAwB,EAAE,KAAK,CAAC,CAAC;gBACzE,KAAI,CAAC,OAAO,CAAC,KAAI,CAAC,uBAAuB,EAAE;oBAC1C,EAAE,EAAE,KAAK,CAAC,EAAE;oBACZ,IAAI,EAAE,KAAI,CAAC,OAAO;iBAClB,CAAC,CAAC;YACJ,CAAC,CACD,CAAC;SACF;aAAM,IAAI,KAAK,CAAC,OAAO,KAAK,IAAI,CAAC,uBAAuB,EAAE;YAE1D,IAAI,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE;gBACzC,IAAI,SAAS,CAAC,IAAI,KAAK,IAAI,CAAC,OAAO,EAAE;oBACpC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,0BAA0B,EAAE,KAAK,CAAC,CAAC;oBAC3E,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,CAAC,4BAA4B,CAAC,CAAC;iBACrF;qBAAM,IAAI,SAAS,CAAC,IAAI,KAAK,IAAI,CAAC,OAAO,EAAE;oBAC3C,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,yBAAyB,EAAE,KAAK,CAAC,CAAC;oBAC1E,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,MAAM,EAAE,CAAC;iBAC9C;gBACD,OAAO,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC;aAC5C;SAED;aAAM,IAAI,KAAK,CAAC,OAAO,KAAK,IAAI,CAAC,gCAAgC,EAAE;YACnE,IAAI,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE,CAAC,EAAE;gBACzC,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,IAAI,EAAE,0BAA0B,EAAE,KAAK,CAAC,CAAC;gBAC3E,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,EAAE,CAAC,CAAC,YAAY,GAAG,IAAI,CAAC;aACzD;SAED;IACF,CAAC;IAEO,4CAAmB,GAA3B;QACC,OAAO,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC,QAAQ,EAAE,CAAC;IACxD,CAAC;IAEO,0CAAiB,GAAzB,UAA0B,OAAe;QACxC,OAAO,IAAI,CAAC,SAAS,GAAG,GAAG,GAAG,OAAO,CAAC;IACvC,CAAC;IAlLY,cAAc;QAF3B,4EAAY,EAAE;QACf,eAAe;OACD,cAAc,CAoL3B;IAAD,qBAAC;CAAA;AApL2B;;;;;;;;;;;;;ACnD5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAE8B;AACF;AAEE;;;;;;;;;;;;;ACdjC;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAC2E;AAED;AAE7E,IAAM,kBAAkB,GAAG,gBAAgB,CAAC;AAE5C,qBAAqB,CAAC;AACf,IAAM,cAAc,GAAG,6FAAiB,CAAC,yBAAyB,CAAC,kBAAkB,CAA0C,CAAC;AAEvI,qBAAqB,CAAC;AACf,SAAS,+BAA+B,CAAC,YAA0B,EAAE,IAAyB;IACpG,UAAU,CAAC;IACX,OAAO,6FAAiB,CAAC,yBAAyB,CAAC,kBAAkB,EAAE,UAAS,gBAA2B;QAE1G,OAAO,UAAS,QAAa,EAAE,mBAAyC,EAAE,mBAA0B;YAEnG,mBAAmB,CAAC,IAAI,OAAxB,mBAAmB,GAAM,QAAQ,SAAK,mBAAmB,GAAE;YAC3D,QAAQ,CAAC,SAAS,GAAG,4FAAW,CAAC,gBAAgB,CAAC,mBAAmB,CAAC,CAAC;YAEvE,YAAY,CAAC,cAAc,CAAC,QAAQ,EAAE,gBAAgB,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC;YAC7F,kHAAkH;QACnH,CAAC,CAAC;IACH,CAAC,CAAC,CAAC;AACJ,CAAC;AAEA,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,cAAc,GAAG,cAAc,CAAC;AAChE,MAAc,CAAC,gBAAgB,CAAC,+BAA+B,GAAG,+BAA+B,CAAC;;;;;;;;;;;;;ACrCnG;AAAA;AAAA;AAAA;;;;;;;;;GASG;;;;;;;AAG2E;AAQ9E;;;;;GAKG;AAKF;IAEA,gBAAgB;IAChB,iCAAoB,MAAuB;QAAvB,WAAM,GAAN,MAAM,CAAiB;QAC1C,IAAI,CAAC,KAAK,GAAG,EAAE,CAAC;IACjB,CAAC;IACE;;;;;;;;;;;;OAYG;IACN,0CAAQ,GAAR,UAAS,GAAW,EAAE,gBAAwB;QAC7C,IAAI,OAAO,GAAG,KAAK,QAAQ,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YACxD,MAAM,IAAI,KAAK,CAAC,wDAAwD,CAAC,CAAC;SAC1E;QACD,IAAI,OAAO,gBAAgB,KAAK,QAAQ,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,gBAAgB,CAAC,EAAE;YAClF,MAAM,IAAI,KAAK,CAAC,qEAAqE,CAAC,CAAC;SACvF;QACD,IAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,UAAC,KAAK,IAAK,YAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,IAAI,IAAI,KAAK,CAAC,gBAAgB,KAAK,gBAAgB,EAAhF,CAAgF,CAAC,CAAC;QAErI,IAAI,UAAU,KAAK,CAAC,CAAC,EAAE;YACtB,OAAO,IAAI,CAAC;SACZ;QACD,IAAM,QAAQ,GAAG,IAAI,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,YAAY,EAAE,KAAK,CAAC,CAAC,CAAC;QAC9D,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC;YACf,QAAQ;YACR,gBAAgB;SAChB,CAAC,CAAC;QACH,OAAO,IAAI,CAAC;IACb,CAAC;IACE;;;;;;;;;;;OAWG;IACN,sDAAoB,GAApB,UAAqB,GAAW;QAC/B,IAAM,UAAU,GAAG,IAAI,CAAC,KAAK,CAAC,SAAS,CAAC,UAAC,KAAK,IAAK,YAAK,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG,CAAC,KAAK,IAAI,EAAjC,CAAiC,CAAC,CAAC;QACtF,OAAO,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,UAAU,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,IAAI,CAAC;IACrE,CAAC;IArDY,uBAAuB;QAFpC,qGAAY,EAAE;QACf,eAAe;OACD,uBAAuB,CAsDpC;IAAD,8BAAC;CAAA;AAtDoC;;;;;;;;;;;;;AC9BrC;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAE2E;AAG9E,IAAM,oBAAoB,GAAG,4BAA4B,CAAC;AAE1D;;;;;;;;;;;;;;GAcG;AACH,qBAAqB,CAAC;AACf,IAAM,0BAA0B,GAAG,6FAAiB,CAAC,yBAAyB,CAAC,oBAAoB,CAAyE,CAAC;AAEpL,qBAAqB,CAAC;AACf,SAAS,iCAAiC,CAAC,SAAwC,EAAE,uBAAgD,EAAE,iBAAsB;IACnK,UAAU,CAAC;IACX,OAAO,6FAAiB,CAAC,yBAAyB,CAAC,oBAAoB,EAAE,UAAS,gBAAuB;QACxG,OAAO,UAAS,QAAa,EAAE,mBAAyC,EAAE,mBAA0B;YAEnG,mBAAmB,CAAC,IAAI,OAAxB,mBAAmB,GAAM,QAAQ,SAAK,mBAAmB,GAAE;YAE3D,IAAM,GAAG,GAAW,SAAS,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,CAAC,GAAG,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC;YAElH,IAAI,OAAO,gBAAgB,CAAC,CAAC,CAAC,KAAK,QAAQ,EAAE;gBAC5C,IAAM,gBAAgB,GAAW,iBAAiB,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC;gBACxE,uBAAuB,CAAC,QAAQ,CAAC,GAAG,EAAE,gBAAgB,CAAC,CAAC;aACxD;iBAAM,IAAI,KAAK,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,IAAI,gBAAgB,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;gBAChF,gBAAgB,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,UAAC,OAAe;oBAC3C,uBAAuB,CAAC,QAAQ,CAAC,GAAG,EAAE,iBAAiB,CAAC,OAAO,CAAC,CAAC,CAAC;gBACnE,CAAC,CAAC,CAAC;aACH;QACF,CAAC,CAAC;IACH,CAAC,CAAC,CAAC;AACJ,CAAC;AACA,MAAc,CAAC,gBAAgB,GAAI,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAE,MAAc,CAAC,gBAAgB,CAAC,CAAC,CAAC,EAAE,CAAC;AAC3G,MAAc,CAAC,gBAAgB,CAAC,0BAA0B,GAAG,0BAA0B,CAAC;AACxF,MAAc,CAAC,gBAAgB,CAAC,iCAAiC,GAAG,iCAAiC,CAAC;;;;;;;;;;;;;ACxDvG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAEH,yEAAyE;AACjD;AAEiB;AACL;AACZ;AACE;AACG;AAEoC;AACU;AACc;AACE;AAC9C;AAC2C;AACf;AAEF;AAC3C;AACoF;AACyC;AACvG;AACA;AACoB;AACA;AACpB;AACpB;AACJ;AAEsC;;;;;;;;;;;;;;;;;;;;;;;;;ACzChE;;;;;;;;;GASG;AACgC;AAEkC;AACS;AA8B9E,gBAAgB;AAEhB;IAQC,yBAAoB,mBAAkD;QAAlD,wBAAmB,GAAnB,mBAAmB,CAA+B;QAN9D,6BAAwB,GAA2C,EAAE,CAAC;QACtE,uBAAkB,GAAU,EAAE,CAAC;QAC/B,mBAAc,GAAG,EAAE,CAAC;QACpB,mBAAc,GAAa,EAAE,CAAC;QAC9B,mBAAc,GAAmB,IAAI,oFAAc,EAAE,CAAC;IAEW,CAAC;IAE1E,iCAAO,GAAP,UAAQ,MAA6B,EAAE,MAAc,EAAE,MAAe;QAAtE,iBA2GC;QA1GA,IAAM,KAAK,GAAG,MAAM,IAAI,IAAI,CAAC,cAAc,CAAC;QAE5C,IAAI,MAAM,CAAC,OAAO,KAAK,SAAS,EAAE;YACjC,OAAO;SACP;QAED,IAAI,CAAC,mCAAmC,GAAG,IAAI,CAAC,mCAAmC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC/F,IAAI,CAAC,iBAAiB,GAAG,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3D,IAAI,CAAC,oBAAoB,GAAG,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACjE,IAAI,CAAC,qBAAqB,GAAG,IAAI,CAAC,qBAAqB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACnE,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3E,IAAI,CAAC,yBAAyB,GAAG,IAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QAC3E,IAAM,QAAQ,GAAG,MAAM,CAAC,QAAQ,CAAC;QAEjC,MAAM,CAAC,OAAO,CAAC,OAAO,CAAC,UAAC,UAAkB;YAEzC,KAAI,CAAC,cAAc,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAErC,IAAI,CAAC,MAAM,EAAE;gBACZ,IAAI,KAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,UAAU,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,QAAQ,CAAC,QAAQ,CAAC,EAAE;oBACvF,OAAO;iBACP;aACD;YAED,KAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;YAEzC,IAAM,YAAY,GAAG,KAAI,CAAC,iBAAiB,CAAC,UAAU,CAAC,CAAC;YACxD,8BAA8B;YAC9B,IAAM,uBAAuB,GAAG,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,uBAAuB,IAAI,EAAE,CAAC,CAAC;YAClG,IAAM,uBAAuB,GAAG,YAAY,CAAC,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,uBAAuB,IAAI,EAAE,CAAC,CAAC;YAElG,8CAA8C;YAC9C,IAAM,MAAM,GAAG,8CAAc,CAAC,UAAU,CAAC,CAAC;YAEzC,MAAc,CAAC,YAAY,CAAC,OAAO,CAAC,UAAC,MAAkC;gBACvE,IAAM,EAAE,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;gBACrB,IAAI,CAAC,SAAS,EAAE,WAAW,EAAE,SAAS,EAAE,WAAW,CAAC,CAAC,OAAO,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,EAAE;oBACtE,IAAM,IAAI,GAAG,MAAM,CAAC,CAAC,CAAC,CAAC;oBACvB,IAAM,YAAU,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;oBAC3B,IAAI,EAAE,KAAK,WAAW,EAAE;wBACvB,KAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,CAAC;qBACrC;yBAAM,IAAI,EAAE,KAAK,WAAW,EAAE;wBAC9B,KAAI,CAAC,yBAAyB,CAAC,IAAI,CAAC,CAAC;qBACrC;yBAAM;wBACN,IAAI;4BACH,IAAI,KAAI,CAAC,WAAW,CAAC,YAAU,EAAE,MAAM,CAAC,qBAAqB,EAAE,MAAM,CAAC,qBAAqB,CAAC,EAAE;gCAE7F,QAAQ,CAAC,SAAS,CAAC,YAAU,EAAE,UAAC,SAAmC;oCAElE,IAAM,gBAAgB,GAAG,KAAI,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC;oCAC9D,IAAM,SAAS,GAAiD,KAAI,CAAC,qBAAqB,CAAC,gBAAgB,EAAE,uBAAuB,EAAE,uBAAuB,CAAC,CAAC;oCAE/J,SAAS,CAAC,OAAO,CAAC,UAAC,QAAQ;wCAC1B,IAAI,CAAC,gBAAgB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,aAAa,EAAE;4CACnD,IAAM,MAAI,GAAG,KAAI,CAAC;4CAClB,IAAM,OAAO,GAAG,MAAI,CAAC,cAAc,CAAC,OAAO,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;4CACzD,IAAI,OAAO,EAAE;gDACZ,gBAAgB,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG;oDACjC,eAAe,CAAC;oDAChB,IAAM,MAAM,GAAG,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;oDAClD,MAAI,CAAC,mCAAmC,CAAC,YAAU,EAAE,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;oDACvF,OAAO,MAAM,CAAC;gDACf,CAAC,CAAC;6CACF;iDAAM;gDACN,gBAAgB,CAAC,QAAQ,CAAC,IAAI,CAAC,GAAG;oDACjC,IAAM,MAAM,GAAG,QAAQ,CAAC,EAAE,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC;oDAClD,MAAI,CAAC,mCAAmC,CAAC,YAAU,EAAE,QAAQ,CAAC,IAAI,EAAE,SAAS,EAAE,MAAM,CAAC,CAAC;oDACvF,OAAO,MAAM,CAAC;gDACf,CAAC,CAAC;6CACF;4CACD,gBAAgB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,aAAa,GAAG,IAAI,CAAC;yCACrD;oCACF,CAAC,CAAC,CAAC;oCACH,OAAO,SAAS,CAAC;gCAClB,CAAC,CAAC,CAAC;6BACH;iCAAM;gCACN,KAAI,CAAC,IAAI,CAAC,wBAAwB,GAAG,YAAU,CAAC,CAAC;6BACjD;yBACD;wBAAC,OAAO,CAAC,EAAE;4BACX,KAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BACd,KAAI,CAAC,IAAI,CAAC,6BAA6B,GAAG,YAAU,GAAG,WAAW,GAAG,EAAE,GAAG,gBAAgB,GAAG,UAAU,CAAC,CAAC;yBACzG;qBACD;iBACD;YACF,CAAC,CAAC,CAAC;YAEH,IAAI,KAAK,GAAG,CAAC,EAAE;gBACd,IAAM,WAAS,GAAG,KAAK,GAAG,CAAC,CAAC;gBAC5B,MAAM,CAAC,QAAQ,CAAC,OAAO,CAAC,UAAC,WAAmB;oBAC3C,IAAI,KAAI,CAAC,cAAc,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;2BAC/C,MAAM,CAAC,qBAAqB,CAAC,OAAO,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;2BACxD,WAAW,CAAC,OAAO,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC,EAAE;wBACvC,KAAI,CAAC,OAAO,CAAC;4BACZ,qBAAqB,EAAE,MAAM,CAAC,qBAAqB;4BACnD,qBAAqB,EAAE,MAAM,CAAC,qBAAqB;4BACnD,uBAAuB,EAAE,MAAM,CAAC,uBAAuB;4BACvD,uBAAuB,EAAE,MAAM,CAAC,uBAAuB;4BACvD,OAAO,EAAE,CAAC,WAAW,CAAC;4BACtB,QAAQ,EAAE,MAAM,CAAC,QAAQ;4BACzB,qBAAqB,EAAE,MAAM,CAAC,qBAAqB;yBACnD,EAAE,WAAS,EAAE,KAAK,CAAC,CAAC;qBACrB;gBACF,CAAC,CAAC,CAAC;aACH;QAEF,CAAC,CAAC,CAAC;IACJ,CAAC;IAEO,2CAAiB,GAAzB,UAA0B,OAAe;QACxC,OAAO,OAAO,OAAO,KAAK,QAAQ,CAAC,CAAC,CAAC;YACpC,IAAI,EAAE,OAAO;YACb,OAAO,EAAE,EAAE;YACX,OAAO,EAAE,EAAE;SACX,CAAC,CAAC,CAAC,OAAO,CAAC;IACb,CAAC;IAEO,8CAAoB,GAA5B,UAAgE,SAAY;QAC3E,OAAO,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC,SAAS,CAAC;IAC9D,CAAC;IAEO,kCAAQ,GAAhB,UAAiB,IAAY,EAAE,SAAiB;QAC/C,OAAO,CAAC,IAAI,MAAM,CAAC,SAAS,EAAE,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;IACjD,CAAC;IAEO,+CAAqB,GAA7B,UAAiE,SAAY,EAAE,uBAAiC,EAAE,uBAAiC;QAClJ,IAAM,MAAM,GAAG,EAAE,CAAC;QAElB,KAAK,IAAM,MAAM,IAAI,SAAS,EAAE;YAE/B,IAAI,OAAO,SAAS,CAAC,MAAM,CAAC,KAAK,UAAU,EAAE;gBAC5C,IAAI,IAAI,CAAC,WAAW,CAAC,MAAM,EAAE,uBAAuB,EAAE,uBAAuB,CAAC,EAAE;oBAC/E,MAAM,CAAC,IAAI,CAAC;wBACX,IAAI,EAAE,MAAM;wBACZ,EAAE,EAAE,SAAS,CAAC,MAAM,CAAmC;qBACvD,CAAC,CAAC;iBACH;aACD;SACD;QACD,OAAO,MAAM,CAAC;IACf,CAAC;IAEO,qCAAW,GAAnB,UAAoB,UAAkB,EAAE,QAAkB,EAAE,QAAkB;QAC7E,OAAO,CAAC,CAAC,QAAQ,CAAC,MAAM,IAAI,CAAC,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,QAAQ,CAAC,MAAM,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAC,CAAC;IAClK,CAAC;IAEO,0CAAgB,GAAxB,UAAyB,MAA6B;QACrD,OAAO,CAAC,CAAC,MAAM,IAAK,MAAc,CAAC,OAAO,KAAK,SAAS,CAAC;IAC1D,CAAC;IAEO,oCAAU,GAAlB,UAAmB,GAAW;QAC7B,IAAI,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,KAAK,SAAS,EAAE;YACrD,OAAO,IAAI,CAAC;SACZ;QACD,OAAO,KAAK,CAAC;IACd,CAAC;IAEO,mDAAyB,GAAjC,UAAkC,IAAW;QAC5C,IAAM,aAAa,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;QAC9B,IAAM,aAAa,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC,QAAQ,CAAC;QACvC,IAAI,CAAC,mBAAmB,CAAC,aAAa,EAAE,aAAa,CAAC,CAAC;IACxD,CAAC;IAEO,mDAAyB,GAAjC,UAAkC,IAAW;QAC5C,IAAM,aAAa,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;QAC9B,IAAI;YACH,IAAM,eAAe,GAAG,IAAI,CAAC,CAAC,CAAC,CAAC;YAChC,IAAI,eAAe,GAAG,IAAI,CAAC;YAC3B,IAAI,OAAO,eAAe,KAAK,UAAU,EAAE;gBAC1C,eAAe,GAAG,eAAe,EAAE,CAAC;aACpC;iBAAM,IAAI,eAAe,YAAY,KAAK,EAAE;gBAC5C,eAAe,GAAG,eAAe,CAAC,eAAe,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE,CAAC;aAChE;YACD,IAAI,eAAe,EAAE;gBACpB,IAAM,KAAK,GAAG,eAAe,CAAC,KAAK,CAAC;gBACpC,IAAM,gBAAgB,GAAG,eAAe,CAAC,gBAAgB,CAAC;gBAC1D,IAAI,CAAC,mBAAmB,CAAC,aAAa,EAAE,SAAS,EAAE,KAAK,EAAE,gBAAgB,CAAC,CAAC;aAC5E;SACD;QAAC,OAAO,CAAC,EAAE;YACX,IAAI,CAAC,mBAAmB,CAAC,aAAa,CAAC,CAAC;SACxC;IACF,CAAC;IAEO,6DAAmC,GAA3C,UAA4C,WAAmB,EAAE,YAAoB,EAAE,KAAiB,EAAE,MAAmC;QAA7I,iBAyDC;QAxDA,IAAM,IAAI,GAAG,IAAI,CAAC,mBAAmB,CAAC,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC;QAEzE,IAAI,GAAG,GAAW,IAAI,CAAC;QACvB,IAAI;YACH,GAAG,GAAG,WAAW,GAAG,GAAG,GAAG,YAAY,GAAG,GAAG,GAAG,8CAAc,CAAC,IAAI,CAAC,CAAC;SACpE;QAAC,OAAO,CAAC,EAAE;YACX,IAAI,CAAC,KAAK,CAAC,wBAAwB,CAAC,CAAC;YACrC,OAAO,MAAM,CAAC;SACd;QACD,IAAI,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,EAAE;YACzB,OAAO,MAAM,CAAC;SACd;QACD,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,GAAG,EAA2B,CAAC;QAEjE,IAAI,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,EAAE;YAClC,OAAO,MAAM,CAAC,IAAI,CAAC,UAAC,GAAQ;gBAC3B,IAAI;oBACH,KAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,GAAG;wBACpC,WAAW;wBACX,YAAY;wBACZ,SAAS,EAAE,IAAI;wBACf,MAAM,EAAE;4BACP,YAAY,EAAE,KAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC;yBAC3C;qBACD,CAAC;oBACF,KAAI,CAAC,IAAI,CAAC,8CAAc,CAAC,KAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;iBAC9D;gBAAC,OAAO,CAAC,EAAE;oBACX,KAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;iBAClC;gBACD,OAAO,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;YAC7B,CAAC,EAAE,UAAC,MAAa;gBAChB,KAAI,CAAC,KAAK,CAAC,gCAAgC,GAAG,MAAM,CAAC,CAAC;gBACtD,KAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,GAAG;oBACpC,WAAW;oBACX,YAAY;oBACZ,SAAS,EAAE,IAAI;oBACf,MAAM,EAAE,EAAC,YAAY,EAAE,MAAM,EAAC;iBAC9B,CAAC;gBACF,KAAI,CAAC,IAAI,CAAC,8CAAc,CAAC,KAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;gBAC9D,OAAO,OAAO,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC;YAC/B,CAAC,CAAC,CAAC;SACH;aAAM;YAEN,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,GAAG;gBACpC,WAAW;gBACX,YAAY;gBACZ,SAAS,EAAE,IAAI;gBACf,MAAM,EAAE,IAAI,CAAC,mBAAmB,CAAC,MAAM,CAAC;aACxC,CAAC;YACF,IAAI;gBACH,IAAI,CAAC,IAAI,CAAC,8CAAc,CAAC,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;aAC9D;YAAC,OAAO,CAAC,EAAE;gBACX,IAAI,CAAC,KAAK,CAAC,qBAAqB,CAAC,CAAC;aAClC;YACD,OAAO,MAAM,CAAC;SACd;IACF,CAAC;IAEO,6CAAmB,GAA3B,UAA4B,aAAqB,EAAE,QAAmB,EAAE,KAAsB,EAAE,gBAAoD;QACnJ,IAAI,CAAC,IAAI,CAAC,8CAAc,CAAC;YACxB,aAAa;YACb,QAAQ;YACR,KAAK;YACL,gBAAgB;SAChB,CAAC,CAAC,CAAC;IACL,CAAC;IAEO,8BAAI,GAAZ,UAAa,OAAe;QAC3B,2BAA2B;QAC3B,OAAO,CAAC,IAAI,CAAC,OAAO,CAAC;IACtB,CAAC;IAEO,+BAAK,GAAb,UAAc,OAAe;QAC5B,2BAA2B;QAC3B,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC;IACvB,CAAC;IA7QI,eAAe;QADpB,qGAAY,EAAE;OACT,eAAe,CA+QpB;IAAD,sBAAC;CAAA;AAED,SAAS,yBAAyB,CAAC,IAAY;IAC9C,IAAI;QACH,OAAO,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC;KAC3C;IAAC,OAAO,CAAC,EAAE;QACX;;;;WAIG;QACH,OAAO,IAAI,CAAC;KACZ;AACF,CAAC;AAED,gBAAgB;AACT,IAAM,UAAU,GAAG,UAAC,QAAa,EAAE,mBAAkD,EAAE,qBAA6B;IAC1H,UAAU,CAAC;IAEX,IAAI,yBAAyB,CAAC,gBAAgB,CAAC,KAAK,MAAM,EAAE;QAC3D,IAAI,eAAe,CAAC,mBAAmB,CAAC,CAAC,OAAO,CAAC;YAChD,qBAAqB,EAAE;gBACtB,eAAe;gBACf,+BAA+B;gBAC/B,mBAAmB;aACnB;YACD,qBAAqB,EAAE;gBACtB,eAAe;gBACf,aAAa;gBACb,YAAY;gBACZ,aAAa;gBACb,YAAY;gBACZ,OAAO;gBACP,eAAe;gBACf,eAAe;gBACf,cAAc;gBACd,cAAc;gBACd,cAAc;gBACd,eAAe;gBACf,eAAe;gBACf,aAAa;gBACb,YAAY;gBACZ,iBAAiB;gBACjB,aAAa;gBACb,WAAW;gBACX,aAAa;gBACb,cAAc;gBACd,UAAU;gBACV,YAAY;aACZ;YACD,uBAAuB,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,SAAS,CAAC;YAC/D,uBAAuB,EAAE,CAAC,MAAM,CAAC;YACjC,qBAAqB,EAAE;gBACtB,eAAe;gBACf,iBAAiB;gBACjB,qBAAqB;gBACrB,aAAa;gBACb,cAAc;gBACd,YAAY;gBACZ,WAAW;gBACX,SAAS;gBACT,kBAAkB;gBAClB,yBAAyB;gBACzB,uBAAuB;gBACvB,kBAAkB;gBAClB,SAAS;gBACT,YAAY,CAAC,6FAA6F;aAC1G;YAED,OAAO,EAAE,CAAC,qBAAqB,CAAC;YAChC,QAAQ;SACR,EAAE,EAAE,EAAE,IAAI,CAAC,CAAC;KACb;AACF,CAAC,CAAC;;;;;;;;;;;;;ACrYF;AAAA;AAAA;;;;;;;;;GASG;AACH,IAAY,kBAKX;AALD,WAAY,kBAAkB;IAC7B,mCAAa;IACb,yCAAmB;IACnB,yCAAmB;IACnB,uCAAiB;AAClB,CAAC,EALW,kBAAkB,KAAlB,kBAAkB,QAK7B;;;;;;;;;;;;;;;;;;;;;;;;ACFD;AAAA;AAAA;;;;;;;GAOG;AACH;IAAA;IA6QA,CAAC;IA3QA,2HAA2H;IAC3H,cAAc;IACd,2HAA2H;IAE3H;;;;;;;;;;;;OAYG;IACH,mDAAyB,GAAzB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED,2HAA2H;IAC3H,UAAU;IACV,2HAA2H;IAC3H;;;;;;;;;;;;;OAaG;IACH,4CAAkB,GAAlB,UAAmB,WAAyB;QAC3C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;;OAYG;IACH,mDAAyB,GAAzB,UAA0B,OAAe;QACxC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,0DAAgC,GAAhC;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;;;OAaG;IACH,6GAA6G;IAC7G,6CAAmB,GAAnB,UAAoB,OAAe,EAAE,kBAA0B;QAC9D,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;OAWG;IACH,0DAAgC,GAAhC,UAAiC,WAAyB;QACzD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;OAWG;IACH,wDAA8B,GAA9B,UAA+B,WAAyB;QACvD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,mEAAyC,GAAzC,UAA0C,gBAAwB;QACjE,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,yDAA+B,GAA/B,UAAgC,gBAAwB;QACvD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,kDAAwB,GAAxB,UAAyB,UAAuB;QAC/C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;;;;OAcG;IACH,iDAAuB,GAAvB,UAAwB,kBAA0B,EAAE,MAAe;QAClE,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;OAWG;IACH,+CAAqB,GAArB,UAAsB,WAAyB;QAC9C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;;OAYG;IACH,mDAAyB,GAAzB,UAA0B,OAAe;QACxC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,mEAAyC,GAAzC,UAA0C,gBAAwB;QACjE,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,wDAA8B,GAA9B,UAA+B,QAAoB;QAClD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEF,sBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACjSD;;;;;;;;;GASG;;;;;;;;;;;;;;;;;;;;;;;;ACIH;AAAA;AAAA;;;;;;GAMG;AAEH;IAEC,gBAAgB;IAChB,4BAAsB,MAAuB;QAAvB,WAAM,GAAN,MAAM,CAAiB;IAC7C,CAAC;IAED,eAAe;IACf,wDAA2B,GAA3B,UAA4B,sBAA8B,EAAE,MAAc;QACzE,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;OASG;IACH,iDAAoB,GAApB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,iDAAoB,GAApB,UAAqB,UAAuB;QAC3C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;OASG;IACH,qDAAwB,GAAxB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;OAUG;IACN,qDAAwB,GAAxB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;;OAYG;IACH,6CAAgB,GAAhB,UAAiB,aAAuB;QACvC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED,gBAAgB;IAChB,4DAA+B,GAA/B,UAAgC,UAAuB,EAAE,YAAoB;QAC5E,IAAM,WAAW,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,UAAU,CAAQ,CAAC;QAC7D,IAAM,eAAe,GAAiC,EAAE,CAAC;QAEzD,OAAO,WAAW,CAAC,iBAAiB,CAAC;QACrC,OAAO,WAAW,CAAC,cAAc,CAAC;QAClC,OAAO,WAAW,CAAC,kBAAkB,CAAC;QACtC,OAAO,WAAW,CAAC,WAAW,CAAC;QAC/B,OAAO,WAAW,CAAC,sBAAsB,CAAC;QAE1C,IAAI,UAAU,CAAC,sBAAsB,IAAI,UAAU,CAAC,sBAAsB,CAAC,MAAM,EAAE;YAClF,UAAU,CAAC,sBAAsB,CAAC,OAAO,CAAC,UAAC,qBAAgD;gBAC1F,eAAe,CAAC,IAAI,CAAC;oBACpB,OAAO,EAAE,qBAAqB,CAAC,OAAO;oBACtC,cAAc,EAAE,qBAAqB,CAAC,cAAc;iBACpD,CAAC,CAAC;YACJ,CAAC,CAAC,CAAC;SACH;QACD,eAAe,CAAC,IAAI,CAAC;YACpB,OAAO,EAAE,UAAU,CAAC,iBAAiB,CAAC,SAAS;YAC/C,cAAc,EAAE,UAAU,CAAC,iBAAiB,CAAC,cAAc;SAC3D,CAAC,CAAC;QAEH,WAAW,CAAC,eAAe,GAAG,eAAe,CAAC;QAC9C,WAAW,CAAC,QAAQ,GAAG,UAAU,CAAC,kBAAkB,CAAC,OAAO,CAAC;QAC7D,WAAW,CAAC,YAAY,GAAG,YAAY,CAAC;QAExC,OAAO,WAA2B,CAAC;IACpC,CAAC;IACF,yBAAC;AAAD,CAAC;;;;;;;;;;;;;AChJD;;;;;;;;;GASG;;;;;;;;;;;;;ACYH;AAAA;AAAA;;;;;;;GAOG;AACH;IAIC,gBAAgB;IAChB,yBAAoB,MAAuB,EAAU,cAA8B;QAA/D,WAAM,GAAN,MAAM,CAAiB;QAAU,mBAAc,GAAd,cAAc,CAAgB;IAAG,CAAC;IAEvF;;;;;;;;;;;;;;;;;;;;;OAqBG;IACH,kCAAQ,GAAR,UAAS,aAAuB;QAC/B,IAAI,CAAC,SAAS,CAAC,aAAa,CAAC,CAAC;QAE9B,IAAI,CAAC,gBAAgB,GAAG,IAAI,CAAC,gBAAgB,IAAI,EAAE,CAAC;QACpD,IAAI,CAAC,gBAAgB,CAAC,aAAa,CAAC,GAAG,CAAC,GAAG;YAC1C,gBAAgB,EAAE,aAAa,CAAC,gBAAgB;YAChD,iBAAiB,EAAE,aAAa,CAAC,iBAAiB;SAClD,CAAC;QAEF,OAAO,aAAa,CAAC,gBAAgB,CAAC;QACtC,OAAO,aAAa,CAAC,iBAAiB,CAAC;QAEvC,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,aAAa,CAA2B,CAAC,CAAC;IAC1G,CAAC;IAED,gCAAM,GAAN,UAAO,GAAW;QACjB,IAAI,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE;YACxD,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,gBAAgB,EAAE,CAAC;SAC9C;aAAM;YACN,IAAI,CAAC,wBAAwB,CAAC,GAAG,CAAC,CAAC;SACnC;IACF,CAAC;IAED,iCAAO,GAAP,UAAQ,GAAW;QAClB,IAAI,IAAI,CAAC,gBAAgB,IAAI,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,EAAE;YACxD,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,CAAC,iBAAiB,EAAE,CAAC;SAC/C;aAAM;YACN,IAAI,CAAC,yBAAyB,CAAC,GAAG,CAAC,CAAC;SACpC;IACF,CAAC;IAED;;;;;;;;;;;OAWG;IACH,4CAAkB,GAAlB,UAAmB,UAAkB,EAAE,YAA4B;QAClE,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;OAWG;IACH,wCAAc,GAAd,UAAe,OAAqB;QACnC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;;;;;OAeG;IACH,sCAAY,GAAZ,UAAa,SAAqB;QACjC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;OAWG;IACH,iDAAuB,GAAvB,UAAwB,GAA0B;QACjD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAES,kDAAwB,GAAlC,UAAmC,GAAW;QAC7C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACS,mDAAyB,GAAnC,UAAoC,GAAW;QAC9C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;OAGG;IACO,0CAAgB,GAA1B,UAA2B,aAA8B;QACxD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEO,mCAAS,GAAjB,UAAkB,aAAuB;QAExC,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,GAAG,CAAC,EAAE;YAC3C,MAAM,IAAI,KAAK,CAAC,iDAAiD,CAAC,CAAC;SACnE;QACD,IAAI,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,aAAa,CAAC,WAAW,CAAC,EAAE;YACnD,MAAM,IAAI,KAAK,CAAC,yDAAyD,CAAC,CAAC;SAC3E;QACD,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,aAAa,CAAC,gBAAgB,CAAC,EAAE;YAC5D,MAAM,IAAI,KAAK,CAAC,kEAAkE,CAAC,CAAC;SACpF;QACD,IAAI,CAAC,IAAI,CAAC,MAAM,CAAC,UAAU,CAAC,aAAa,CAAC,iBAAiB,CAAC,EAAE;YAC7D,MAAM,IAAI,KAAK,CAAC,mEAAmE,CAAC,CAAC;SACrF;IACF,CAAC;IACF,sBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;AClMD;AAAA;AAAA;;;;;;;;;GASG;AAeH;;;;;;;;;GASG;AACH;IAAA;IA0HA,CAAC;IAzHG;;;;;;;;;;;;;;;;;;;;;;;;;;;OA2BG;IAEN,gEAAc,GAAd,UAAe,WAAmB,EAAE,WAAmB,EAAE,QAAmB;QAC3E,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;OAOG;IACN,+DAAa,GAAb;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;OAEG;IACI,uEAAqB,GAA/B,UAAgC,KAAa;QAC5C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;OAEG;IACI,sEAAoB,GAA9B;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;OAGG;IACI,+DAAa,GAAvB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;OAGG;IACI,8DAAY,GAAtB,UAAuB,KAAiB;QAAxC,iBAUC;QARA,IAAI,CAAC,UAAU,EAAE,CAAC,IAAI,CAAC,UAAC,MAAc;YACrC,IAAM,UAAU,GAAG,MAAM,IAAI,KAAK,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC,CAAC,IAAI,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;YAC5G,IAAM,UAAU,GAAG,MAAM,IAAI,KAAK,IAAI,CAAC,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC,CAAC,IAAI,KAAK,CAAC,OAAO,GAAG,MAAM,CAAC,CAAC,GAAG,MAAM,CAAC,MAAM,CAAC,CAAC;YAE7G,IAAI,UAAU,IAAI,UAAU,EAAE;gBAC7B,KAAI,CAAC,aAAa,EAAE,CAAC;aACrB;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IAEE;;OAEG;IACI,4DAAU,GAApB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;OAEG;IACI,8DAAY,GAAtB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;OAGG;IACE,+DAAa,GAArB;QAAA,iBAYC;QAVA,IAAI,CAAC,YAAY,EAAE,CAAC,IAAI,CAAC,UAAC,QAAoB;YAC7C,IAAI,QAAQ,EAAE;gBACb,QAAQ,EAAE,CAAC;gBACX,KAAI,CAAC,aAAa,EAAE,CAAC;aACrB;iBAAM;gBACN,KAAI,CAAC,aAAa,EAAE,CAAC,IAAI,CAAC;oBACzB,KAAI,CAAC,aAAa,EAAE,CAAC;gBACtB,CAAC,CAAC,CAAC;aACH;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IACF,8CAAC;AAAD,CAAC;;;;;;;;;;;;;;AC5JD;AAAA;AAAA;;;;;;;;;GASG;AAqCH;;;;;;;;GAQG;AACH;IAAA;IAqDA,CAAC;IAnDG;;;;;;;;;;;;;;;;;;OAkBG;IACN,+CAAgB,GAAhB,UAAiB,aAAyC;QACzD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;OASG;IACN,iDAAkB,GAAlB,UAAmB,cAAsB;QACxC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;OAOG;IACN,qDAAsB,GAAtB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACF,2BAAC;AAAD,CAAC;;;;;;;;;;;;;;AChGD;AAAA;AAAA;;;;;;GAMG;AAEH;IAAA;IAiDA,CAAC;IA/CA;;;;;;;;;OASG;IACH,qCAAU,GAAV;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,sCAAW,GAAX;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,wDAA6B,GAA7B;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEF,uBAAC;AAAD,CAAC;;;;;;;;;;;;;;AChCD;AAAA;AAAA,IAAM,wBAAwB,GAAG,UAAS,iBAAuB;IAChE,IAAI,CAAC,mBAAmB,GAAG,IAAI,CAAC,mBAAmB,IAAI,EAAE,CAAC;IAC1D,IAAI,CAAC,mBAAmB,CAAC,iBAAiB,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,GAAG;QAC7D,MAAM,EAAE,iBAAiB,CAAC,MAAM;KAChC,CAAC;IACF,OAAO,iBAAiB,CAAC,MAAM,CAAC;IAEhC,OAAO,iBAAiB,CAAC;AAC1B,CAAC,CAAC;AAEF,IAAM,YAAY,GAAG,UAAS,IAAU;IACvC,IAAI,CAAC,CAAC,IAAI,CAAC,KAAK,YAAY,KAAK,CAAC,EAAE;QACnC,MAAM,KAAK,CAAC,0BAA0B,CAAC,CAAC;KACxC;IAED,IAAI,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;QAC1B,MAAM,KAAK,CAAC,iCAAiC,CAAC,CAAC;KAC/C;IAED,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;QACjB,MAAM,KAAK,CAAC,iCAAiC,CAAC,CAAC;KAC/C;IAED,IAAI,OAAO,IAAI,CAAC,MAAM,KAAK,UAAU,EAAE;QACtC,MAAM,KAAK,CAAC,gCAAgC,CAAC,CAAC;KAC9C;AACF,CAAC,CAAC;AAEF;;;;;;;;;;GAUG;AACH;IAAA;IAiLA,CAAC;IA7KA;;;;;;;OAOG;IACH,uCAAU,GAAV;QACC,eAAe,CAAC;QAChB,OAAO;IACR,CAAC;IAED;;;;;;;;;;;;OAYG;IACH,0CAAa,GAAb,UAAc,UAAkB;QAC/B,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;;;;;;;;;;OAoBG;IACH,wCAAW,GAAX,UAAY,WAAyC;QACpD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;;;;;;;;;;;;;;;;;;OA4BG;IACH,+CAAkB,GAAlB,UAAmB,UAAsB;QACxC,eAAe,CAAC;QAChB,OAAO;IACR,CAAC;IAED;;;;;;;;;;;;;;;;;;;;;;;;;OAyBG;IACH,yCAAY,GAAZ,UAAa,iBAAuB;QACnC,YAAY,CAAC,iBAAiB,CAAC,CAAC;QAChC,iBAAiB,GAAG,wBAAwB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,iBAAiB,CAAC,CAAC;QAC3E,IAAI,CAAC,aAAa,CAAC,iBAAiB,CAAC,CAAC;IACvC,CAAC;IAED;;;;;;;;;;;;;;;;;;;;;OAqBG;IACH,gDAAmB,GAAnB,UAAoB,iBAAuB;QAC1C,iBAAiB,GAAG,wBAAwB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,iBAAiB,CAAC,CAAC;QAC3E,IAAI,CAAC,oBAAoB,CAAC,iBAAiB,CAAC,CAAC;IAC9C,CAAC;IAED;;;;;;;OAOG;IACH,kDAAqB,GAArB;QACC,eAAe,CAAC;QAChB,OAAO;IACR,CAAC;IAES,0CAAa,GAAvB,UAAwB,iBAAuB;QAC9C,eAAe,CAAC;QAChB,OAAO;IACR,CAAC;IAES,iDAAoB,GAA9B,UAA+B,iBAAuB;QACrD,eAAe,CAAC;QAChB,OAAO;IACR,CAAC;IAEF,yBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;AChPsD;AAEvD;;;;;;;;;GASG;AAEH;IAEC,yBAAoB,QAAkB;QAAlB,aAAQ,GAAR,QAAQ,CAAU;IACtC,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,uCAAa,GAAb,UAAc,WAAyB;QACtC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,uDAA6B,GAA7B,UAA8B,UAAkB;QAC/C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;;;;OAaG;IACN,yDAA+B,GAA/B,UAAgC,aAAqB,EAAE,WAAyB;QAAhF,iBAIC;QAHA,OAAO,IAAI,CAAC,aAAa,CAAC,WAAW,CAAC,CAAC,IAAI,CAAC,UAAC,OAAyB;YACrE,OAAO,KAAI,CAAC,QAAQ,CAAC,kBAAkB,CAAC,aAAa,EAAE,aAAa,EAAE,OAAO,CAAC,eAAe,CAAC,CAAC;QAChG,CAAC,CAAC,CAAC;IACJ,CAAC;IA3DoB,eAAe;QADpC,4EAAY,EAAE;OACO,eAAe,CA6DpC;IAAD,sBAAC;CAAA;AA7DoC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC1BrC;AAAA;AAAA;;;;;;;;;GASG;AAKH;;;;;;GAMG;AACH;IAAA;IAyGA,CAAC;IAvGG;;;;;;;;;;;;OAYG;IACN,4CAAkB,GAAlB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;OAUG;IACN,mDAAyB,GAAzB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,wCAAc,GAAd;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;;OAWG;IACN,wCAAc,GAAd;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;OAUG;IACN,8CAAoB,GAApB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;;;;OAaG;IACN,4CAAkB,GAAlB,UAAmB,QAAgB;QAClC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACF,sBAAC;AAAD,CAAC;;;;;;;;;;;;;;AClHD;AAAA;AAAA;;;;;;;;;GASG;AACH;IAAA;IAgDA,CAAC;IA9CG;;;;;;;;;OASG;IACN,gCAAG,GAAH,UAAI,GAAW;QACd,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;OAUG;IACN,gCAAG,GAAH,UAAI,GAAW,EAAE,KAAgB;QAChC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;OAUG;IACN,mCAAM,GAAN,UAAO,GAAW,EAAE,iBAAyC;QAC5D,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACF,yBAAC;AAAD,CAAC;;;;;;;;;;;;;;ACtED;AAAA;AAAA;;;;;;;;;GASG;AAgBH;;;;;GAKG;AACH;IAAA;IAgLA,CAAC;IA9KA;;;;;;;;;;OAUG;IACH,uCAAa,GAAb;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,kDAAwB,GAAxB,UAAyB,YAAoB;QAC5C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;OASG;IACH,mDAAyB,GAAzB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,gDAAsB,GAAtB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;OAWG;IACH,wCAAc,GAAd,UAAe,OAAe,EAAE,IAAgB;QAC/C,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,sCAAY,GAAZ,UAAa,OAAe;QAC3B,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;OASG;IACH,yCAAe,GAAf,UAAgB,OAAe;QAC9B,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;OAOG;IACH,6CAAmB,GAAnB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;OAOG;IACH,4CAAkB,GAAlB,UAAmB,UAAkB,EAAE,SAAkB;QACxD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED,0CAAgB,GAAhB,UAAiB,UAAkB,EAAE,KAAU,EAAE,MAAe;QAC/D,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;OAUG;IACH,iCAAO,GAAP,UAAQ,GAAW,EAAE,KAAU;QAC9B,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;;;OAWG;IACH,iCAAO,GAAP,UAAQ,GAAW;QAClB,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACF,sBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzLD;AAAA;AAAA;IAEC,qBACS,oBAA4B,EAC5B,oBAA4B,EAC5B,4BAAoC,EACpC,eAAuB,EACvB,eAAuB,EACvB,uBAA+B;QAL/B,yBAAoB,GAApB,oBAAoB,CAAQ;QAC5B,yBAAoB,GAApB,oBAAoB,CAAQ;QAC5B,iCAA4B,GAA5B,4BAA4B,CAAQ;QACpC,oBAAe,GAAf,eAAe,CAAQ;QACvB,oBAAe,GAAf,eAAe,CAAQ;QACvB,4BAAuB,GAAvB,uBAAuB,CAAQ;IACxC,CAAC;IAED;;;;;;;;;OASG;IACH,oCAAc,GAAd,UAAe,GAAW;QACzB,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACD;;;;;;;;;OASG;IACH,0BAAI,GAAJ,UAAK,IAAY;QAChB,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACD;;;;;;;;;;;;;OAaG;IACH,qCAAe,GAAf,UAAgB,MAAc,EAAE,SAAiB,EAAE,cAAsB;QACxE,IAAM,UAAU,GAAgB,EAAE,CAAC;QACnC,UAAU,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,MAAM,CAAC;QAC1C,UAAU,CAAC,IAAI,CAAC,eAAe,CAAC,GAAG,SAAS,CAAC;QAC7C,UAAU,CAAC,IAAI,CAAC,uBAAuB,CAAC,GAAG,cAAc,CAAC;QAC1D,OAAO,UAAU,CAAC;IACnB,CAAC;IACD;;;;;;;;;;;;;OAaG;IACH,yCAAmB,GAAnB,UAAoB,MAAc,EAAE,SAAiB,EAAE,cAAsB;QAC5E,IAAM,UAAU,GAAgB,EAAE,CAAC;QACnC,UAAU,CAAC,IAAI,CAAC,oBAAoB,CAAC,GAAG,MAAM,CAAC;QAC/C,UAAU,CAAC,IAAI,CAAC,oBAAoB,CAAC,GAAG,SAAS,CAAC;QAClD,UAAU,CAAC,IAAI,CAAC,4BAA4B,CAAC,GAAG,cAAc,CAAC;QAC/D,OAAO,UAAU,CAAC;IACnB,CAAC;IACF,kBAAC;AAAD,CAAC;;;;;;;;;;;;;;ACvGD;AAAA;AAAA;;;;;;;;;GASG;AACH;;;;;;;GAOG;AAEH;IAAA;IA4BA,CAAC;IA3BG;;;;;;;;;OASG;IACN,0CAAa,GAAb,UAAc,gCAAyC;QACtD,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;OAOG;IACN,0CAAa,GAAb;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACF,yBAAC;AAAD,CAAC;;;;;;;;;;;;;;AC/CD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAC6E;AAE9C;AAMsB;AAEY;AACsC;AAClB;AACpC;AACF;AAKA;AACM;AAEM;AAGpB;AACc;AACnB;;;;;;;;;;;;;ACrCrC;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;;;;;;;AAEoD;AASA;AACgE;AAsBvH;;;GAGG;AAIF;IAKA,gBAAgB;IAChB,yBACS,IAAyB,EACzB,UAA+C,EAC/C,EAAqB,EACrB,sBAA2B,EAC3B,sBAA8C,EAC9C,cAA+B,EAC/B,cAA+B,EAC/B,qBAA6B,EAC7B,iBAAyB,EACjC,qBAA6B,EAC7B,2BAAmC,EACnC,kBAAuC;QAX/B,SAAI,GAAJ,IAAI,CAAqB;QACzB,eAAU,GAAV,UAAU,CAAqC;QAC/C,OAAE,GAAF,EAAE,CAAmB;QACrB,2BAAsB,GAAtB,sBAAsB,CAAK;QAC3B,2BAAsB,GAAtB,sBAAsB,CAAwB;QAC9C,mBAAc,GAAd,cAAc,CAAiB;QAC/B,mBAAc,GAAd,cAAc,CAAiB;QAC/B,0BAAqB,GAArB,qBAAqB,CAAQ;QAC7B,sBAAiB,GAAjB,iBAAiB,CAAQ;QAZ1B,iBAAY,GAA4B,IAAI,CAAC,EAAE,CAAC,KAAK,EAAE,CAAC;QAiB/D,IAAI,CAAC,mBAAmB,GAAG,kBAAkB,CAAC,GAAG,CAAC,qBAAqB,CAAC,CAAC;QACzE,IAAI,CAAC,uBAAuB,GAAG,kBAAkB,CAAC,GAAG,CAAC,2BAA2B,CAAC,CAAC;IACpF,CAAC;IAEE;;;;;;;;;;;OAWG;IACN,mDAAyB,GAAzB;QACC,OAAO,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;IAChD,CAAC;IAED,wCAAc,GAAd,UAAe,WAAoB;QAClC,WAAW,CAAC,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC;IACxE,CAAC;IAED,uCAAa,GAAb;QACC,OAAO,IAAI,CAAC,YAAY,CAAC,OAAO,CAAC;IAClC,CAAC;IAEE;;;;;;;;;;;OAWG;IACN,0CAAgB,GAAhB;QACC,OAAO,IAAI,CAAC,cAAc,CAAC,gBAAgB,EAAE,CAAC;IAC/C,CAAC;IAEE;;;;;;;;;;;;;OAaG;IACN,0CAAgB,GAAhB;QACC,OAAO,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,IAAI,CAAC,mBAAmB,EAAE,CAAC,CAAC;IACjD,CAAC;IAEE;;;;;;;;;;OAUG;IACN,iDAAuB,GAAvB;QAAA,iBAIC;QAHA,OAAO,IAAI,CAAC,gBAAgB,EAAE,CAAC,IAAI,CAAC,UAAC,aAAqB;YACzD,OAAO,KAAI,CAAC,wBAAwB,CAAC,aAAa,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;QACnE,CAAC,CAAC,CAAC;IACJ,CAAC;IAEE;;;;;;;;;;;;OAYG;IAEN,6CAAmB,GAAnB,UAAoB,OAAe;QADnC,iBAUC;QARA,OAAO,IAAI,CAAC,mBAAmB,CAAC,GAAG,CAAC;YACnC,OAAO;SACP,CAAC,CAAC,IAAI,CAAC,UAAC,aAAa;YACrB,OAAO,aAAa,CAAC,SAAS,CAAC;QAChC,CAAC,EAAE,UAAC,KAAU;YACb,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,iEAAiE,CAAC,CAAC;YACnF,OAAO,KAAI,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAC9B,CAAC,CAAC,CAAC;IACJ,CAAC;IAEE;;;;;;;;;OASG;IAEN,6CAAmB,GAAnB;QADA,iBAQC;QANA,OAAO,IAAI,CAAC,uBAAuB,CAAC,GAAG,CAAC,EAAE,CAAC,CAAC,IAAI,CAAC,UAAC,QAAQ;YACzD,OAAO,KAAI,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;QACzC,CAAC,EAAE,UAAC,KAAK;YACR,KAAI,CAAC,IAAI,CAAC,KAAK,CAAC,yEAAyE,CAAC,CAAC;YAC3F,OAAO,KAAI,CAAC,EAAE,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;QAC9B,CAAC,CAAC,CAAC;IACJ,CAAC;IAEE;;;;;;;;;OASG;IACN,oDAA0B,GAA1B,UAA2B,QAA0B;QACpD,IAAI,CAAC,cAAc,CAAC,gBAAgB,CAAC,IAAI,CAAC,iBAAiB,EAAE,QAAQ,EAAE,KAAK,CAAC,CAAC;QAC9E,IAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,CAAC;QACtC,IAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC,IAAI,CAAC,qBAAqB,EAAE;YAC/D,OAAO,EAAE,QAAQ,CAAC,OAAO;SACzB,CAAC,CAAC;QACH,IAAI,CAAC,sBAAsB,CAAC,OAAO,CAAC,IAAI,CAAC,qBAAqB,CAAC,CAAC;IACjE,CAAC;IAEE;;;;;;;OAOG;IACN,gDAAsB,GAAtB;QAAA,iBAEC;QADA,IAAI,CAAC,sBAAsB,CAAC,SAAS,CAAC,IAAI,CAAC,qBAAqB,EAAE,UAAC,OAAe,EAAE,QAA0B,IAAK,YAAI,CAAC,UAAU,CAAC,GAAG,CAAC,QAAQ,CAAC,OAAO,CAAC,EAArC,CAAqC,CAAC,CAAC;IAC3J,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,kDAAwB,GAAxB,UAAyB,WAAmB;QAC3C,OAAO,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC;IACrE,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,kDAAwB,GAAxB,UAAyB,WAAmB;QAC3C,OAAO,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC,CAAC,CAAC,CAAC,WAAW,CAAC;IACrE,CAAC;IAEO,6CAAmB,GAA3B;QAAA,iBAOC;QANA,OAAO,IAAI,CAAC,cAAc,CAAC,kBAAkB,CAAC,IAAI,CAAC,iBAAiB,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,UAAC,IAAqC;YACvH,OAAO,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,CAAC,KAAI,CAAC,cAAc,CAAC,gBAAgB,EAAE,CAAC;QACrE,CAAC,EAAE;YACF,OAAO,KAAI,CAAC,cAAc,CAAC,gBAAgB,EAAE,CAAC;QAC/C,CAAC,CACA,CAAC;IACH,CAAC;IAvGD;QADC,qDAAM,CAAC,EAAC,OAAO,EAAE,CAAC,4DAAqB,CAAC,EAAC,CAAC;8DAU1C;IAaD;QADC,qDAAM,CAAC,EAAC,OAAO,EAAE,CAAC,4DAAqB,CAAC,EAAC,CAAC;8DAQ1C;IA9IY,eAAe;QAH5B,4IAA0B,CAAC,uBAAuB,EAAE,SAAS,CAAC;QAC9D,4EAAY,EAAE;QACf,eAAe;OACD,eAAe,CAyN5B;IAAD,sBAAC;CAAA;AAzN4B;;;;;;;;;;;;;AClD7B;AAAA;AAAA;AAAA;;;;;;;;;GASG;;;;;;;AAGoD;AACvD,gBAAgB;AAGf;IACA,gCAAY,cAA8B;QACzC,OAAO,cAAc,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;IACvD,CAAC;IAHY,sBAAsB;QAFnC,4EAAY,EAAE;QACf,eAAe;OACD,sBAAsB,CAInC;IAAD,6BAAC;CAAA;AAJmC;;;;;;;;;;;;;AChBpC;AAAA;AAAA;;;;;;;;;GASG;AAIH;;;;;;GAMG;AACH;IAAA;IA0IA,CAAC;IAxIG;;;;;;;;;;;;;;OAcG;IACN,sCAAQ,GAAR,UAAS,aAA2B;QACnC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;;;;;;;OAgBG;IACN,sCAAQ,GAAR,UAAS,GAAW;QACnB,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;OASG;IACN,kDAAoB,GAApB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;;;OAYG;IACN,2CAAa,GAAb;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;OASG;IACN,sDAAwB,GAAxB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAEE;;;;;;;;;;;OAWG;IACN,gDAAkB,GAAlB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;OASG;IACH,qDAAuB,GAAvB;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;;;;OASG;IACH,iEAAmC,GAAnC;QACC,eAAe,CAAC;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACF,0BAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;AClJuE;AAGxE;;;;;;;;;;;;;;;;;;;;;;GAsBG;AACH;IAIC,mCAAY,kBAAuC,EAAE,GAAW,EAAE,UAAmB;QAEpF,IAAI,CAAC,gBAAgB,GAAG,kBAAkB,CAAC,GAAG,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC;QAChE,IAAI,CAAC,gBAAgB,CAAC,gBAAgB,EAAE,CAAC;IAE1C,CAAC;IAID,2CAAO,GAAP,UAAQ,UAAkB;QACzB,OAAO,IAAI,CAAC,gBAAgB,CAAC,OAAO,CAAC,UAAU,CAAC,CAAC;IAClD,CAAC;IAID,uCAAG,GAAH,UAAI,YAA4B;QAC/B,OAAO,IAAI,CAAC,gBAAgB,CAAC,GAAG,CAAC,YAAY,CAAC,CAAC;IAChD,CAAC;IAID,yCAAK,GAAL,UAAM,YAAqB;QAC1B,OAAO,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC;IAClD,CAAC;IAID,wCAAI,GAAJ,UAAK,YAAsB;QAC1B,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;IACjD,CAAC;IAID,0CAAM,GAAN,UAAO,OAAgB;QACtB,OAAO,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;IAC9C,CAAC;IAGD,0CAAM,GAAN,UAAO,OAAgB;QACtB,OAAO,IAAI,CAAC,gBAAgB,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;IAC9C,CAAC;IAGD,wCAAI,GAAJ,UAAK,OAAgB;QACpB,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;IAC5C,CAAC;IApCD;QAFC,oBAAoB;QACpB,8EAAM,EAAE;4DAGR;IAID;QAFC,oBAAoB;QACpB,8EAAM,EAAE;wDAGR;IAID;QAFC,oBAAoB;QACpB,8EAAM,EAAE;0DAGR;IAID;QAFC,oBAAoB;QACpB,8EAAM,EAAE;yDAGR;IAID;QAFC,oBAAoB;QACpB,uFAAe,EAAE;2DAGjB;IAGD;QADC,uFAAe,EAAE;2DAGjB;IAGD;QADC,oBAAoB;yDAGpB;IAEF,gCAAC;CAAA;AAnD8C;AAqD/C,SAAS,oBAAoB,CAAC,MAAW,EAAE,YAAoB,EAAE,UAAyD;IAEzH,IAAM,cAAc,GAAG,UAAU,CAAC,KAAK,CAAC;IAExC,UAAU,CAAC,KAAK,GAAG;QAClB,OAAO,cAAc,CAAC,KAAK,CAAC,IAAI,EAAE,SAAS,CAAC,CAAC,IAAI,CAAC,UAAC,QAAa;YAC/D,OAAO,QAAQ,CAAC,OAAO,CAAC;YACxB,OAAO,QAAQ,CAAC;QACjB,CAAC,CAAC,CAAC;IACJ,CAAC,CAAC;AACH,CAAC;;;;;;;;;;;;;;;;;;;;;;;ACrGD;;;;;;;;;GASG;AACuE;AACmB;AAO7F;IAAA;IAAuC,CAAC;IAA3B,wBAAwB;QALpC,iGAAQ,CAAC;YACT,SAAS,EAAE;gBACV,4GAAsB;aACtB;SACD,CAAC;OACW,wBAAwB,CAAG;IAAD,+BAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACPyC;AAM7E;IAMA,gCAAY,kBAAuC;QAJlC,QAAG,GAAG,gEAAgE,CAAC;QAKvF,IAAI,CAAC,QAAQ,GAAG,kBAAkB,CAAC,GAAG,CAAgC,IAAI,CAAC,GAAG,CAAC,CAAC;IACjF,CAAC;IAED,oCAAG,GAAH,UAAI,SAA2C;QAC9C,OAAO,IAAI,CAAC,QAAQ,CAAC,GAAG,CAAC,SAAgB,CAAC,CAAC,IAAI,CAAC,UAAC,IAAmC;YACnF,OAAO;gBACN,WAAW,EAAE,IAAI,CAAC,WAAW;aAC7B,CAAC;QACH,CAAC,CAAC,CAAC;IACJ,CAAC;IAhBY,sBAAsB;QAFnC,qGAAY,EAAE;QACf,eAAe;OACD,sBAAsB,CAkBnC;IAAD,6BAAC;CAAA;AAlBmC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACNkH;AAEnD;AACrB;AACgE;AAE9I,IAAM,4CAA4C,GAAG,4DAA4D,CAAC;AAMjH;IAA+C,6CAAwC;IAEvF,mCAAY,kBAAuC;eAClD,kBAAM,kBAAkB,EAAE,4CAA4C,CAAC;IACxE,CAAC;IAJY,yBAAyB;QAJtC,mFAAW,CAAC,EAAC,OAAO,EAAE,CAAC,qFAAqB,CAAC,EAAE,IAAI,EAAE,CAAC,+EAAe,EAAE,+EAAe,EAAE,+FAA+B,CAAC,EAAC,CAAC;QAC1H,qKAA0B,CAAC,4CAA4C,EAAE,CAAC,KAAK,EAAE,aAAa,CAAC,CAAC;QAChG,qGAAY,EAAE;QACf,eAAe;OACD,yBAAyB,CAKtC;IAAD,gCAAC;CAAA,CAL+C,kHAAyB,GAKxE;AALsC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACZ6D;AAED;AACrB;AAK7E;IAA+C,6CAAwC;IAEvF,mCAAY,kBAAuC;eAClD,kBAAM,kBAAkB,EAAE,4DAA4D,CAAC;IACxF,CAAC;IAJY,yBAAyB;QAHtC,mFAAW,CAAC,EAAC,OAAO,EAAE,CAAC,qFAAqB,CAAC,EAAE,IAAI,EAAE,CAAC,+EAAe,CAAC,EAAC,CAAC;QACxE,qGAAY,EAAE;QACf,eAAe;OACD,yBAAyB,CAKtC;IAAD,gCAAC;CAAA,CAL+C,kHAAyB,GAKxE;AALsC;;;;;;;;;;;;;ACnBvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACyC;AAIK;AACA;AAER;;;;;;;;;;;;;ACjBzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAEH,UAAU;AACyC;AACH;AACI;;;;;;;;;;;;;ACApD;AAAA;AAAA;AAAsE;AAKtE,gBAAgB;AAChB;IAEC,kCAA6B,cAA+B,EAAU,SAAiB;QAA1D,mBAAc,GAAd,cAAc,CAAiB;QAAU,cAAS,GAAT,SAAS,CAAQ;IACvF,CAAC;IAED,6CAAU,GAAV,UAAW,oBAAqC;QAC/C,oBAAoB,CAAC,SAAS,GAAG,IAAI,CAAC,qBAAqB,CAAC,oBAAoB,CAAC,SAAS,CAAC,CAAC;QAC5F,OAAO,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,oBAAoB,CAAC,CAAC;IAC7D,CAAC;IAED,gDAAa,GAAb,UAAc,SAAiB,EAAE,KAAsB;QAAtB,qCAAsB;QACtD,OAAO,IAAI,CAAC,cAAc,CAAC,aAAa,CAAC,IAAI,CAAC,qBAAqB,CAAC,SAAS,CAAC,EAAE,KAAK,CAAC,CAAC;IACxF,CAAC;IAED,wDAAqB,GAArB,UAAsB,KAAsB;QAAtB,qCAAsB;QAC3C,OAAO,IAAI,CAAC,cAAc,CAAC,qBAAqB,CAAC,KAAK,CAAC,CAAC;IACzD,CAAC;IAED,6CAAU,GAAV,UAAW,SAAiB;QAC3B,OAAO,IAAI,CAAC,cAAc,CAAC,UAAU,CAAC,IAAI,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC,CAAC;IAC9E,CAAC;IAED,4DAAyB,GAAzB,UAA0B,UAA8B;QACvD,OAAO,IAAI,CAAC,cAAc,CAAC,yBAAyB,CAAC,UAAU,CAAC,CAAC;IAClE,CAAC;IAED,wDAAqB,GAArB,UAAsB,SAAiB;QACtC,OAAO,oFAAyB,CAAC,sBAAsB,CAAC,IAAI,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;IACpF,CAAC;IAED,oDAAiB,GAAjB;QACC,OAAO,IAAI,CAAC,cAAc,CAAC;IAC5B,CAAC;IAEF,+BAAC;AAAD,CAAC;;;;;;;;;;;;;;AC1CD;AAAA;AAAA;AAAoE;AAEpE,gBAAgB;AAChB;IAMC,+BAAoB,2BAA4C;QAA5C,gCAA2B,GAA3B,2BAA2B,CAAiB;IAChE,CAAC;IALM,2CAAqB,GAA5B,UAA6B,SAAiB;QAC7C,OAAO,IAAI,KAAK,CAAC,qDAAmD,SAAS,4CAAyC,CAAC,CAAC;IACzH,CAAC;IAKD,iDAAiB,GAAjB,UAAkB,SAAiB;QAClC,IAAI,CAAC,iBAAiB,CAAC,SAAS,CAAC,CAAC;QAClC,OAAO,IAAI,kFAAwB,CAAC,IAAI,CAAC,2BAA2B,EAAE,SAAS,CAAC,CAAC;IAClF,CAAC;IAEO,iDAAiB,GAAzB,UAA0B,SAAiB;QAC1C,IAAI,OAAO,SAAS,KAAK,QAAQ,IAAI,SAAS,CAAC,MAAM,IAAI,CAAC,EAAE;YAC3D,MAAM,qBAAqB,CAAC,qBAAqB,CAAC,SAAS,CAAC,CAAC;SAC7D;IACF,CAAC;IACF,4BAAC;AAAD,CAAC;;;;;;;;;;;;;;AClCD;AAAA;AAAA;;;;;;;;;GASG;AAEH,gBAAgB;AAChB;IAAA;IA6CA,CAAC;IA3CG;;;;;;;;;;;;;OAaG;IAEC,mDAAyB,GAAhC,UAAiC,EAAU;QAC1C,OAAO,IAAI,KAAK,CAAC,wDAAsD,EAAE,MAAG,CAAC,CAAC;IAC/E,CAAC;IAEM,gDAAsB,GAA7B,UAA8B,SAAiB,EAAE,SAAiB;QACjE,OAAO,KAAG,SAAS,GAAG,IAAI,CAAC,SAAS,GAAG,SAAW,CAAC;IACpD,CAAC;IAEM,sDAA4B,GAAnC,UAAoC,YAAoB;QACvD,IAAM,OAAO,GAAqB,YAAY,CAAC,KAAK,CAAC,IAAI,MAAM,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC,CAAC;QAChG,IAAI,OAAO,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;YACrC,OAAO,OAAO,CAAC,CAAC,CAAC,CAAC;SAClB;QACD,MAAM,yBAAyB,CAAC,yBAAyB,CAAC,YAAY,CAAC,CAAC;IACzE,CAAC;IAEM,sDAA4B,GAAnC,UAAoC,YAAoB;QACvD,IAAM,OAAO,GAAqB,YAAY,CAAC,KAAK,CAAC,IAAI,MAAM,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC,CAAC;QAChG,IAAI,OAAO,IAAI,OAAO,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,EAAE;YACrC,OAAO,OAAO,CAAC,CAAC,CAAC,CAAC;SAClB;QACD,MAAM,yBAAyB,CAAC,yBAAyB,CAAC,YAAY,CAAC,CAAC;IACzE,CAAC;IAEuB,mCAAS,GAAG,SAAS,CAAC;IAEtB,kDAAwB,GAAG,MAAM,GAAG,yBAAyB,CAAC,SAAS,GAAG,MAAM,CAAC;IAE1G,gCAAC;CAAA;AA7C8C;;;;;;;;;;;;;;;;;;;;;;ACDO;AAEtD;;;;;;GAMG;AACH,gBAAgB;AAGf;IAKA,yBAAoB,SAAwC;QAAxC,cAAS,GAAT,SAAS,CAA+B;QAH5D,YAAY;QACK,aAAQ,GAAW,SAAS,CAAC;IAG9C,CAAC;IAED;;;;;;;;;OASG;IACI,mCAAS,GAAhB;QACC,OAAO,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,IAAI,IAAI,CAAC,SAAS,CAAC,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;IAC/E,CAAC;IApBY,eAAe;QAF5B,4EAAY,EAAE;QACf,eAAe;OACD,eAAe,CAsB5B;IAAD,sBAAC;CAAA;AAtB4B;;;;;;;;;;;;;;;;;;;;;;;ACZqC;AACY;AAE9E;;;;;;;GAOG;AAGF;IAEA,6BAAoB,MAAuB;QAAvB,WAAM,GAAN,MAAM,CAAiB;IAAG,CAAC;IAE5C;;;;;;;;;;OAUG;IACC,mDAAqB,GAA5B,UAA6B,KAAa,EAAE,IAAY,EAAE,QAAqB;QAArB,wCAAqB;QAC9E,IAAI,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,KAAK,GAAG,IAAI,CAAC,MAAM,EAAE;YACnD,OAAO,IAAI,iFAAa,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;SAC5C;QACD,IAAM,MAAM,GAAW,OAAO,CAAC;QAC/B,IAAM,eAAe,GAAqB,IAAI,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;QAE7D,IAAI,aAAa,GAAG,CAAC,CAAC;QACtB,IAAI,CAAC,eAAe,EAAE;YACrB,aAAa,GAAG,KAAK,CAAC;SACtB;aAAM;YACN,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,eAAe,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBAChD,IAAM,YAAY,GAAW,IAAI,CAAC,uBAAuB,CAAC,IAAI,EAAE,eAAe,CAAC,CAAC,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC,CAAC;gBAC3F,IAAI,YAAY,GAAG,KAAK,EAAE;oBACzB,MAAM;iBACN;gBACD,aAAa,GAAG,YAAY,CAAC;aAC7B;SACD;QACD,IAAM,SAAS,GAAW,IAAI,CAAC,MAAM,CAAC,CAAC,EAAE,aAAa,CAAC,CAAC;QACxD,OAAO,IAAI,iFAAa,CAAC,IAAI,EAAE,SAAS,EAAE,IAAI,EAAE,QAAQ,CAAC,CAAC;IAC3D,CAAC;IAEO,qDAAuB,GAA/B,UAAgC,YAAoB,EAAE,UAAkB,EAAE,KAAa;QACtF,OAAO,YAAY,CAAC,KAAK,CAAC,UAAU,EAAE,KAAK,CAAC,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC,MAAM,CAAC;IACtE,CAAC;IAxCY,mBAAmB;QAFhC,qGAAY,EAAE;QACf,eAAe;OACD,mBAAmB,CAyChC;IAAD,0BAAC;CAAA;AAzCgC;;;;;;;;;;;;;;;;;;;;;;ACxBjC;;;;;;;;;GASG;AAC8D;AAQjE,eAAe;AAGd;IAEA,qCACS,aAA4B;QAA5B,kBAAa,GAAb,aAAa,CAAe;IAClC,CAAC;IAEJ,mDAAa,GAAb,UAAc,aAA4B,EAAE,IAAkB;QAC7D,IAAM,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAChI,IAAM,UAAU,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,IAAI,EAAE,EAAE,IAAI,CAAC,SAAS,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC;QAEhI,IAAM,QAAQ,GAAG,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;YACjC,IAAI,EAAE,IAAI,CAAC,SAAS;SACpB,CAAC,CAAC,CAAC,IAAI,CAAC;QACT,IAAM,UAAU,GAAG,IAAI,CAAC,aAAa,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;QAErD,IAAI,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,IAAgB,EAAE,KAAa;YAClD,IAAI,CAAC,OAAO,GAAG,EAAE,CAAC;YAClB,IAAI,KAAK,GAAG,CAAC,EAAE;gBACd,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAC9B;YACD,IAAI,KAAK,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,CAAC,CAAC,EAAE;gBACtC,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAC9B;iBAAM;gBACN,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;aAC9B;QACF,CAAC,CAAC,CAAC;QAEH,IAAI,CAAC,YAAY,GAAG,IAAI,CAAC,cAAc,CAAC,aAAa,EAAE,IAAI,CAAC,aAAa,CAAC,MAAM,EAAE,EAAE,IAAI,CAAC,WAAW,EAAE,IAAI,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;QAC3H,IAAI,CAAC,gBAAgB,GAAG,gCAAgC,CAAC;IAC1D,CAAC;IAEO,oDAAc,GAAtB,UAAuB,aAA4B,EAAE,MAAoB,EAAE,KAAa,EAAE,gBAA6C,EAAE,eAA4C;QAEpL,IAAI,KAAK,EAAE;YACV,MAAM,CAAC,IAAI,GAAG,KAAK,CAAC;SACpB;QACD,IAAI,gBAAgB,EAAE;YACrB,MAAM,CAAC,kBAAkB,GAAG;gBAC3B,OAAO,gBAAgB,CAAC,aAAa,CAAC,gBAAgB,EAAE,CAAC,CAAC;YAC3D,CAAC,CAAC;SACF;QACD,IAAI,eAAe,EAAE;YACpB,MAAM,CAAC,iBAAiB,GAAG;gBAC1B,OAAO,eAAe,CAAC,aAAa,CAAC,gBAAgB,EAAE,CAAC,CAAC;YAC1D,CAAC,CAAC;SACF;QAED,OAAO,MAAM,CAAC;IACf,CAAC;IAhDY,2BAA2B;QAFxC,sFAAY,EAAE;QACf,eAAe;OACD,2BAA2B,CAkDxC;IAAD,kCAAC;CAAA;AAlDwC;;;;;;;;;;;;;;;;;;;;;;;ACVwB;AAGW;AAE5E;;;;;;GAMG;AAGF;IAEA,qBACS,YAA2B;QAA3B,iBAAY,GAAZ,YAAY,CAAe;IACjC,CAAC;IAEJ;;;;;;;;;;;;;;;;;;;;;OAqBG;IACH,0BAAI,GAAJ,UAAK,MAAoB;QACxB,IAAI,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;QAC5B,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;YAC7B,WAAW,EAAE,0BAA0B;YACvC,UAAU,EAAE,kGAA4B,CAAC,MAAM,CAAC;SAChD,CAAC,CAAC;IACJ,CAAC;IAEO,oCAAc,GAAtB,UAAuB,MAAoB;QAC1C,IAAI,CAAC,MAAM,CAAC,UAAU,EAAE;YACvB,MAAM,IAAI,KAAK,CAAC,kEAAkE,CAAC,CAAC;SACpF;IACF,CAAC;IAxCY,WAAW;QAFxB,sFAAY,EAAE;QACf,eAAe;OACD,WAAW,CAyCxB;IAAD,kBAAC;CAAA;AAzCwB;;;;;;;;;;;;;ACZzB;AAAA;AAAA;AAAwE;AAQxE,eAAe;AACR,IAAM,4BAA4B,GAAG,UAAC,MAAoB;IAEhE,eAAe;IACf;QAQC,+BACS,MAAuB,EACvB,MAAwB,EACxB,UAAqC,EACrC,YAAiB,EACzB,WAAuC,EAC/B,aAA4B,EAC5B,mBAAqC,EACrC,EAAqB,EAC7B,2BAAkD,EAClD,kBAAgC;YAVjC,iBA2EC;YA1EQ,WAAM,GAAN,MAAM,CAAiB;YACvB,WAAM,GAAN,MAAM,CAAkB;YACxB,eAAU,GAAV,UAAU,CAA2B;YACrC,iBAAY,GAAZ,YAAY,CAAK;YAEjB,kBAAa,GAAb,aAAa,CAAe;YAC5B,wBAAmB,GAAnB,mBAAmB,CAAkB;YACrC,OAAE,GAAF,EAAE,CAAmB;YAI7B,IAAI,CAAC,aAAa,GAAG,IAAI,4DAAa,CAAC,IAAI,CAAC,EAAE,EAAE,2BAA2B,EAAE,kBAAkB,CAAC,CAAC;YACjG,IAAI,CAAC,aAAa,CAAC,UAAU,GAAG,MAAM,CAAC,UAAU,CAAC;YAClD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,EAAE,WAAW,CAAC,MAAM,CAAC,UAAU,EAAE;gBACvD,MAAM;gBACN,aAAa,EAAE,IAAI,CAAC,aAAa;aACjC,CAAC,CAAC,CAAC;YAEJ,IAAI,MAAM,CAAC,YAAY,EAAE;gBACxB,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,GAAG,IAAI,CAAC;aACxC;YAED,IAAI,OAAO,IAAI,CAAC,eAAe,KAAK,UAAU,EAAE;gBAC/C,MAAM,IAAI,KAAK,CAAC,oEAAoE,CAAC,CAAC;aACtF;YAED,IAAM,WAAW,GAAG,IAAI,CAAC,eAAe,EAAE,CAAC;YAE3C,IAAI,CAAC,cAAc,GAAG;gBACrB,MAAM,EAAE,WAAW,CAAC,KAAK;aACzB,CAAC;YAEF,IAAI,CAAC,aAAa,GAAG,UAAC,MAAoB;gBACzC,KAAI,CAAC,aAAa,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YAC1C,CAAC,CAAC;YAEF,IAAI,eAA2B,CAAC;YAEhC,IAAI,CAAC,aAAa,CAAC,UAAU,GAAG,UAAC,SAAiB,EAAE,IAAgB;gBACnE,KAAI,CAAC,YAAY,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;gBACrC,KAAI,CAAC,cAAc,CAAC,WAAW,GAAG,IAAI,CAAC,WAAW,CAAC;gBACnD,KAAI,CAAC,YAAY,CAAC,gBAAgB,EAAE,CAAC;gBACrC,CAAC,IAAI,CAAC,OAAO,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,UAAC,MAAM;oBACnC,IAAI,OAAO,MAAM,CAAC,iBAAiB,KAAK,UAAU,EAAE;wBACnD,eAAe,GAAG,KAAI,CAAC,UAAU,CAAC,MAAM,CAAC,MAAM,CAAC,iBAAiB,EAAE,UAAC,MAAM;4BACzE,IAAI,MAAM,EAAE;gCACX,KAAI,CAAC,YAAY,CAAC,YAAY,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;6BAC1C;iCAAM;gCACN,KAAI,CAAC,YAAY,CAAC,aAAa,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;6BAC3C;wBACF,CAAC,CAAC,CAAC;qBACH;oBAED,KAAI,CAAC,YAAY,CAAC,SAAS,CAAC,KAAI,CAAC,yBAAyB,CAAC,MAAM,CAAC,CAAC,CAAC;gBACrE,CAAC,CAAC,CAAC;YACJ,CAAC,CAAC;YAEF,IAAI,CAAC,aAAa,CAAC,OAAO,GAAG,UAAC,MAAe;gBAC5C,KAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC;gBAChC,eAAe,EAAE,CAAC;YACnB,CAAC,CAAC;YAEF,IAAI,CAAC,aAAa,CAAC,QAAQ,GAAG;gBAC7B,KAAI,CAAC,YAAY,CAAC,OAAO,EAAE,CAAC;gBAC5B,eAAe,EAAE,CAAC;YACnB,CAAC,CAAC;YAEF,IAAI,CAAC,aAAa,CAAC,cAAc,GAAG,UAAC,KAAmB;gBACvD,KAAI,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;gBACxB,KAAI,CAAC,cAAc,CAAC,MAAM,GAAG,KAAK,CAAC;YACpC,CAAC,CAAC;YAEF,IAAI,CAAC,aAAa,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC;YAC3C,IAAI,CAAC,UAAU,CAAC,WAAW,CAAC,CAAC;QAC9B,CAAC;QAEO,2CAAW,GAAnB,UAAoB,KAAmB;YAAvC,iBAcC;YAbA,IAAI,CAAC,cAAc,CAAC,UAAU,GAAG,KAAK,CAAC,GAAG,CAAC,UAAC,IAAI,EAAE,KAAa;gBAC9D,IAAM,MAAM,GAAG,KAAI,CAAC,aAAa,CAAC,YAAY,CAAC;oBAC9C,EAAE,EAAE,MAAM,GAAG,IAAI,CAAC,EAAE;oBACpB,SAAS,EAAE,KAAK;oBAChB,aAAa,EAAE,KAAI,CAAC,aAAa;oBACjC,gBAAgB,EAAE,KAAK;oBACvB,IAAI,EAAE,IAAI,CAAC,IAAI;oBACf,aAAa,EAAE;wBACd,OAAO,MAAM,CAAC,SAAS,KAAK,KAAI,CAAC,aAAa,CAAC,mBAAmB,EAAE,CAAC;oBACtE,CAAC;iBACD,CAAC,CAAC;gBACH,OAAO,MAAM,CAAC;YACf,CAAC,CAAC,CAAC;QACJ,CAAC;QAEO,0CAAU,GAAlB,UAAmB,WAAyB;YAA5C,iBAUC;YATA,IAAI,CAAC,cAAc,CAAC,gBAAgB,GAAG,WAAW,CAAC,gBAAgB,CAAC;YACpE,IAAI,WAAW,CAAC,YAAY,EAAE;gBAC7B,IAAI,CAAC,YAAY,CAAC,kBAAkB,CAAC;oBACpC,KAAI,CAAC,aAAa,CAAC,aAAa,CAAC,WAAW,CAAC,YAAY,CAAC,CAAC;oBAC3D,OAAO,KAAI,CAAC,EAAE,CAAC,MAAM,EAAE,CAAC;gBACzB,CAAC,CAAC,CAAC;aACH;YAED,IAAI,CAAC,WAAW,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;QACrC,CAAC;QAEO,yDAAyB,GAAjC,UAAkC,MAAoB;YAAtD,iBASC;YARA,OAAO;gBACN,EAAE,EAAE,MAAM,CAAC,EAAE;gBACb,KAAK,EAAE,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,OAAO,CAAC,CAAC,CAAC,IAAI,CAAC,mBAAmB,CAAC,SAAS;gBAClG,KAAK,EAAE,MAAM,CAAC,IAAI;gBAClB,QAAQ,EAAE;oBACT,KAAI,CAAC,aAAa,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;gBAC1C,CAAC;aACD,CAAC;QACH,CAAC;QACF,4BAAC;IAAD,CAAC;IAED,OAAO,qBAAqB,CAAC;AAC9B,CAAC,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACvJF;;;;;;;;;GASG;AAC8D;AAqBjE,IAAM,qBAAqB,GAAiB;IAC3C,EAAE,EAAE,kBAAkB;IACtB,IAAI,EAAE,qBAAqB;IAC3B,YAAY,EAAE,IAAI;IAClB,iBAAiB;QAChB,OAAO,IAAI,CAAC;IACb,CAAC;IACD,kBAAkB;QACjB,OAAO,IAAI,CAAC;IACb,CAAC;IACD,OAAO,YAAC,aAA4B;QACnC,OAAO;IACR,CAAC;CACD,CAAC;AAEF,eAAe;AAGd;IADD,eAAe;IACd;IAiFD,CAAC;IA/EA,oCAAY,GAAZ,UAAa,aAA2B;QACvC,OAAO,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,CAAC;IAC5C,CAAC;IAED,4BAAI,GAAJ,UAAK,aAA4B;QAChC,IAAM,MAAM,GAAG;YACd,EAAE,EAAE,aAAa;YACjB,IAAI,EAAE,gBAAgB;YACtB,OAAO,EAAE,UAAC,aAA4B;gBACrC,aAAa,CAAC,KAAK,EAAE,CAAC;YACvB,CAAC;SACD,CAAC;QAEF,OAAO,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;IACpD,CAAC;IAED,4BAAI,GAAJ,UAAK,aAA4B;QAChC,IAAM,MAAM,GAAG;YACd,EAAE,EAAE,aAAa;YACjB,IAAI,EAAE,gBAAgB;YACtB,OAAO,YAAC,aAA4B;gBACnC,aAAa,CAAC,iBAAiB,CAAC,aAAa,CAAC,mBAAmB,EAAE,GAAG,CAAC,CAAC,CAAC;YAC1E,CAAC;SACD,CAAC;QAEF,OAAO,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;IACpD,CAAC;IAED,oCAAY,GAAZ,UAAa,aAA2B;QACvC,IAAI,CAAC,aAAa,CAAC,aAAa,IAAI,aAAa,CAAC,gBAAgB,KAAK,IAAI,EAAE;YAC5E,MAAM,IAAI,KAAK,CAAC,+FAA+F,CAAC,CAAC;SACjH;QAED,IAAM,MAAM,GAAG;YACd,EAAE,EAAE,aAAa;YACjB,IAAI,EAAE,aAAa;YACnB,iBAAiB,EAAE;gBAClB,OAAO,aAAa,CAAC,aAAa,CAAC,mBAAmB,EAAE,IAAI,aAAa,CAAC,gBAAgB,CAAC;YAC5F,CAAC;YACD,OAAO,EAAE,UAAC,aAA4B;gBACrC,aAAa,CAAC,iBAAiB,CAAC,aAAa,CAAC,gBAAgB,CAAC,CAAC;YACjE,CAAC;SACD,CAAC;QAEF,OAAO,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;IACpD,CAAC;IAED,4BAAI,GAAJ,UAAK,aAA2B;QAC/B,IAAM,MAAM,GAAG;YACd,EAAE,EAAE,aAAa;YACjB,IAAI,EAAE,gBAAgB;YACtB,YAAY,EAAE,KAAK;YACnB,OAAO,YAAC,aAA4B;gBACnC,IAAM,YAAY,GAAG,aAAa,CAAC,mBAAmB,EAAE,CAAC;gBACzD,IAAI,YAAY,IAAI,CAAC,EAAE;oBACtB,MAAM,IAAI,KAAK,CAAC,2DAA2D,CAAC,CAAC;iBAC7E;gBACD,aAAa,CAAC,iBAAiB,CAAC,YAAY,GAAG,CAAC,CAAC,CAAC;YACnD,CAAC;SACD,CAAC;QAEF,OAAO,IAAI,CAAC,eAAe,CAAC,aAAa,EAAE,MAAM,CAAC,CAAC;IACpD,CAAC;IAED,8BAAM,GAAN;QACC,OAAO,IAAI,CAAC,eAAe,CAAC;YAC3B,EAAE,EAAE,eAAe;YACnB,IAAI,EAAE,kBAAkB;YACxB,YAAY,EAAE,KAAK;YACnB,OAAO,YAAC,aAA4B;gBACnC,aAAa,CAAC,MAAM,EAAE,CAAC;YACxB,CAAC;SACD,CAAC,CAAC;IACJ,CAAC;IAEO,uCAAe,GAAvB,UAAwB,aAAkC,EAAE,mBAAwC;QAA5E,oDAAkC;QAAE,gEAAwC;QACnG,oBAAW,qBAAqB,EAAK,mBAAmB,EAAK,aAAa,EAAE;IAC7E,CAAC;IA/EY,aAAa;QAF1B,sFAAY,EAAE;QACf,eAAe;OACD,aAAa,CAiF1B;IAAD,oBAAC;CAAA;AAjF0B;;;;;;;;;;;;;;;;;;;;;;;;;;ACwG3B;;;;;;;GAOG;AACH;IAcC,uBACS,EAAqB,EACrB,2BAAkD,EAClD,kBAAgC;QAFhC,OAAE,GAAF,EAAE,CAAmB;QACrB,gCAA2B,GAA3B,2BAA2B,CAAuB;QAClD,uBAAkB,GAAlB,kBAAkB,CAAc;QAExC,4BAA4B;QAC5B,IAAI,CAAC,UAAU,GAAG,UAAS,KAAa,EAAE,QAAoB;YAC7D,OAAO;QACR,CAAC,CAAC;QACF,IAAI,CAAC,OAAO,GAAG,UAAS,MAAe;YACtC,OAAO;QACR,CAAC,CAAC;QACF,IAAI,CAAC,QAAQ,GAAG;YACf,OAAO;QACR,CAAC,CAAC;QACF,IAAI,CAAC,cAAc,GAAG,UAAS,KAAmB;YACjD,OAAO;QACR,CAAC,CAAC;IACH,CAAC;IAED,eAAe;IACf,kCAAU,GAAV,UAAW,IAAkB;QAE5B,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,CAAC;QAE1B,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,2BAA2B,CAAC;QAC/E,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;QAE/C,IAAI,CAAC,aAAa,GAAG,CAAC,CAAC;QACvB,IAAI,CAAC,KAAK,gBAAO,IAAI,CAAC,CAAC;QACvB,IAAI,CAAC,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC;QAC/B,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,QAAQ,CAAC;QAChC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QAEnC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;IAC3B,CAAC;IAED,eAAe;IACf,qCAAa,GAAb,UAAc,MAAoB;QAAlC,iBAOC;QANA,IAAI,MAAM,CAAC,kBAAkB,EAAE;YAC9B,OAAO,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,kBAAkB,EAAE,CAAC,CAAC,IAAI,CAAC;gBACxD,OAAO,MAAM,CAAC,OAAO,CAAC,KAAI,CAAC,CAAC;YAC7B,CAAC,CAAC,CAAC;SACH;QACD,OAAO,IAAI,CAAC,EAAE,CAAC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;IAC9C,CAAC;IAED;;;;;;OAMG;IACH,yCAAiB,GAAjB,UAAkB,KAAa;QAC9B,IAAM,QAAQ,GAAG,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;QAC9C,IAAI,QAAQ,EAAE;YACb,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;YACjC,IAAI,CAAC,aAAa,GAAG,KAAK,CAAC;SAC3B;IACF,CAAC;IAED;;;;;;;OAOG;IACH,sCAAc,GAAd,UAAe,EAAU;QACxB,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC,CAAC;IACrD,CAAC;IAED;;;;;;;OAOG;IACH,+BAAO,GAAP,UAAQ,OAAmB,EAAE,KAAa;QACzC,IAAI,QAAQ,CAAC,OAAO,CAAC,EAAE,EAAE,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE,EAAE;YAClD,OAAO,CAAC,EAAE,GAAG,IAAI,CAAC,kBAAkB,EAAE,CAAC;SACvC;QACD,IAAI,CAAC,KAAK,EAAE;YACX,KAAK,GAAG,CAAC,CAAC;SACV;QACD,IAAI,IAAI,CAAC,aAAa,IAAI,KAAK,EAAE;YAChC,IAAI,CAAC,aAAa,EAAE,CAAC;SACrB;QACD,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,EAAE,OAAO,CAAC,CAAC;QACtC,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;QACnC,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;QACrD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;IAClC,CAAC;IAED;;;;;;;OAOG;IACH,sCAAc,GAAd,UAAe,EAAU;QACxB,IAAI,CAAC,iBAAiB,CAAC,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC,CAAC;IACrD,CAAC;IAED;;;;;;;OAOG;IACH,yCAAiB,GAAjB,UAAkB,KAAa;QAC9B,IAAI,KAAK,IAAI,CAAC,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,EAAE,EAAE;YAC/C,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC,CAAC,CAAC;YAC7B,IAAI,KAAK,KAAK,IAAI,CAAC,aAAa,EAAE;gBACjC,IAAI,CAAC,iBAAiB,CAAC,CAAC,CAAC,CAAC;aAC1B;YACD,IAAI,CAAC,eAAe,CAAC,aAAa,CAAC,IAAI,EAAE,IAAI,CAAC,KAAK,CAAC,CAAC;YACrD,IAAI,CAAC,cAAc,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;SACjC;IACF,CAAC;IAED;;;;;;;OAOG;IACH,6BAAK,GAAL;QACC,IAAI,MAAe,CAAC;QACpB,IAAI,OAAO,IAAI,CAAC,UAAU,KAAK,UAAU,EAAE;YAC1C,MAAM,GAAG,IAAI,CAAC,UAAU,EAAE,CAAC;SAC3B;QACD,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;IACtB,CAAC;IAED;;;;;OAKG;IACH,8BAAM,GAAN;QACC,IAAI,CAAC,QAAQ,EAAE,CAAC;IACjB,CAAC;IAED;;;;;OAKG;IACH,gCAAQ,GAAR;QACC,OAAO,IAAI,CAAC,MAAM,CAAC;IACpB,CAAC;IAED;;;;;;OAMG;IACH,0CAAkB,GAAlB,UAAmB,EAAU;QAC5B,IAAM,KAAK,GAAG,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,UAAC,IAAI;YACxC,OAAO,IAAI,CAAC,EAAE,KAAK,EAAE,CAAC;QACvB,CAAC,CAAC,CAAC;QACH,OAAO,KAAK,CAAC;IACd,CAAC;IAED;;;;;;OAMG;IACH,oCAAY,GAAZ,UAAa,MAAc;QAC1B,OAAO,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;IAC7C,CAAC;IAED;;;;;OAKG;IACH,wCAAgB,GAAhB;QACC,OAAO,IAAI,CAAC,cAAc,EAAE,CAAC,EAAE,CAAC;IACjC,CAAC;IAED;;;;;OAKG;IACH,2CAAmB,GAAnB;QACC,OAAO,IAAI,CAAC,aAAa,CAAC;IAC3B,CAAC;IAED;;;;;OAKG;IACH,sCAAc,GAAd;QACC,OAAO,IAAI,CAAC,gBAAgB,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;IAClD,CAAC;IAED;;;;;;OAMG;IACH,qCAAa,GAAb;QACC,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAC;IAC3B,CAAC;IAED;;;;;;OAMG;IACH,qCAAa,GAAb,UAAc,EAAU;QACvB,IAAM,KAAK,GAAG,IAAI,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC;QAC1C,IAAI,KAAK,IAAI,CAAC,EAAE;YACf,OAAO,IAAI,CAAC,gBAAgB,CAAC,KAAK,CAAC,CAAC;SACpC;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAED;;;;;;OAMG;IACH,wCAAgB,GAAhB,UAAiB,KAAa;QAC7B,IAAI,KAAK,IAAI,CAAC,IAAI,KAAK,GAAG,IAAI,CAAC,aAAa,EAAE,EAAE;YAC/C,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,CAAC;SAC1B;QACD,MAAM,IAAI,KAAK,CAAC,CAAC,uDAAuD,GAAG,KAAK,CAAC,CAAC,CAAC;IACpF,CAAC;IAEO,sCAAc,GAAtB,UAAuB,MAAoB;QAC1C,IAAI,CAAC,MAAM,CAAC,KAAK,IAAI,MAAM,CAAC,KAAK,CAAC,MAAM,IAAI,CAAC,EAAE;YAC9C,MAAM,IAAI,KAAK,CAAC,yDAAyD,CAAC,CAAC;SAC3E;QAED,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;YACzB,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;gBACtB,MAAM,IAAI,KAAK,CAAC,+DAA6D,IAAM,CAAC,CAAC;aACrF;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IAEO,wCAAgB,GAAxB,UAAyB,KAAmB;QAA5C,iBAWC;QAVA,IAAM,OAAO,GAAqB,EAAE,CAAC;QACrC,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;YAClB,IAAI,CAAC,IAAI,CAAC,EAAE,EAAE;gBACb,IAAI,CAAC,EAAE,GAAG,KAAI,CAAC,kBAAkB,EAAE,CAAC;aACpC;iBAAM,IAAI,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE;gBAC5B,MAAM,IAAI,KAAK,CAAC,kCAAgC,IAAI,CAAC,EAAI,CAAC,CAAC;aAC3D;iBAAM;gBACN,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,EAAE,CAAC;aAC3B;QACF,CAAC,CAAC,CAAC;IACJ,CAAC;IACF,oBAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;AC3cD;;;;;;;;;GASG;AACsD;AACiB;AAChC;AACI;AAE9C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;GAwCG;AAeH;IAAA;IAAkC,CAAC;IAAtB,mBAAmB;QAd/B,8EAAQ,CAAC;YACT,OAAO,EAAE;gBACR,cAAc;gBACd,0BAA0B;gBAC1B,iBAAiB;gBACjB,eAAe;gBACf,oBAAoB;aACpB;YACD,SAAS,EAAE;gBACV,wFAA2B;gBAC3B,wDAAW;gBACX,4DAAa;aACb;SACD,CAAC;OACW,mBAAmB,CAAG;IAAD,0BAAC;CAAA;AAAH;;;;;;;;;;;;;;;;;;;;;;;;ACtEhC;;;;;;;;;GASG;AACmC;AACwC;AAE9E;;;;;;GAMG;AAGF;IADD,eAAe;IACd;IAiBD,CAAC;IAfG;;;;;;;;;;OAUG;IACN,qCAAQ,GAAR,UAAS,IAAY;QACpB,OAAO,8CAAa,CAAC,IAAI,CAAC,CAAC,QAAQ,EAAE,CAAC;IACvC,CAAC;IAfY,kBAAkB;QAF/B,qGAAY,EAAE;QACf,eAAe;OACD,kBAAkB,CAiB/B;IAAD,yBAAC;CAAA;AAjB+B;;;;;;;;;;;;;;;;;;;;;;ACXgC;AAShE;;;;;GAKG;AAGF;IAIA,iCAAoB,IAAyB;QAAzB,SAAI,GAAJ,IAAI,CAAqB;QAFrC,SAAI,GAAG,EAAuC,CAAC;IAGvD,CAAC;IAED;;;;;;;;;;;;OAYG;IACH,uCAAK,GAAL,UAAS,GAAW,EAAE,OAAyC,EAAE,eAAgC,EAAE,eAAqC;QAEvI,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;YACpB,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,GAAG;gBAChB,OAAO;gBACP,eAAe;gBACf,eAAe;aACf,CAAC;SACF;aAAM;YACN,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,+BAA6B,GAAK,CAAC,CAAC;YACpD,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,iBAAiB,CAAC,eAAe,CAAC;YACxD,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,iBAAiB,CAAC,eAAe,CAAC;YACxD,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,GAAG,OAAO,CAAC;SACjC;QAED,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,iBAAiB,GAAG;YAClC,eAAe,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,eAAe;YAC/C,eAAe,EAAE,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,eAAe;SAC/C,CAAC;QAEF,IAAM,IAAI,GAAG,IAAI,CAAC;QAClB,IAAM,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,OAAO,CAAC;QAChC,CAAgB,CAAC,IAAI,CACrB,UAAS,QAAW;YAEnB,IAAI,IAAI,CAAC,eAAe,EAAE;gBACzB,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACtB,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;aACjD;iBAAM;gBACN,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,uDAAqD,GAAK,CAAC,CAAC;aAC5E;QACF,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,iBAAiB,CAAC,EACxC,UAAS,KAAY;YACpB,IAAI,IAAI,CAAC,eAAe,EAAE;gBACzB,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;gBACtB,IAAI,CAAC,eAAe,CAAC,KAAK,CAAC,SAAS,EAAE,SAAS,CAAC,CAAC;aACjD;iBAAM;gBACN,IAAI,CAAC,IAAI,CAAC,KAAK,CAAC,uDAAqD,GAAK,CAAC,CAAC;aAC5E;QACF,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,iBAAiB,CAAC,CACxC,CAAC;IACH,CAAC;IA7DY,uBAAuB;QAFpC,qFAAY,EAAE;QACf,eAAe;OACD,uBAAuB,CA+DpC;IAAD,8BAAC;CAAA;AA/DoC;;;;;;;;;;;;;;;;;;;;;;;ACjByC;AAE9E;;;;;;GAMG;AAGF;IAFD;QAIC;;WAEG;QACK,wBAAmB,GAAW,uCAAuC,CAAC;IAsI/E,CAAC;IApIG;;;;;;;;;;OAUG;IACN,gCAAO,GAAP,UAAQ,IAA6B;QACpC,OAAO,IAAI,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,gBAAgB,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,kBAAkB,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC;IAChI,CAAC;IAEE;;;;;;;;;;OAUG;IACN,qCAAY,GAAZ,UAAa,IAA6B;QACzC,IAAI;YACH,OAAO,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;SACvF;QAAC,OAAO,CAAC,EAAE;YACX,MAAM,IAAI,KAAK,CAAC,0CAAwC,IAAM,CAAC,CAAC;SAChE;IACF,CAAC;IAEE;;;;;;;;;;OAUG;IACN,qCAAY,GAAZ,UAAa,IAA6B;QACzC,IAAI;YACH,OAAO,CAAC,IAAI,CAAC,SAAS,EAAE,CAAC,OAAO,CAAC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;SACpF;QAAC,OAAO,CAAC,EAAE;YACX,MAAM,IAAI,KAAK,CAAC,0CAAwC,IAAM,CAAC,CAAC;SAChE;IACF,CAAC;IAEE;;;;;;;;;;OAUG;IACN,2CAAkB,GAAlB,UAAmB,IAAiC;QACnD,IAAI;YACH,uCAAuC;YACvC,OAAO,IAAI,CAAC,IAAI,IAAI,wBAAwB,CAAC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC;SACtE;QAAC,WAAM;YACP,MAAM,IAAI,KAAK,CAAC,8DAA8D,CAAC,CAAC;SAChF;IACF,CAAC;IAEE;;;;;;;;;;OAUG;IACN,mDAA0B,GAA1B,UAA2B,QAAgB;QAC1C,OAAO,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC,WAAW,CAAC,CAAC;IAC7E,CAAC;IAEE;;;;;;;;;;OAUG;IACN,2CAAkB,GAAlB,UAAsB,mBAA0C,EAAE,kBAAyC;QAC1G,gCAAgC;QAChC,IAAM,cAAc,GAAQ;YAAS,cAAc;iBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;gBAAd,yBAAc;;YAClD,IAAM,MAAM,GAAG,kBAAkB,CAAC,KAAK,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YACpD,IAAI,MAAM,EAAE;gBACX,OAAO,MAAM,CAAC;aACd;QACF,CAAC,CAAC;QACF,mDAAmD;QACnD,cAAc,CAAC,SAAS,GAAG,mBAAmB,CAAC,SAAS,CAAC;QAEzD,OAAO,cAAc,CAAC;IACvB,CAAC;IAEE;;;;;;;;;OASG;IACC,kCAAS,GAAhB;QACC,OAAQ,MAAc,CAAC,eAAe,CAAC;IACxC,CAAC;IAED,gBAAgB;IAChB,uCAAc,GAAd;QACC,OAAO,OAAQ,MAAc,CAAC,SAAS,KAAK,WAAW,CAAC;IACzD,CAAC;IAzIY,cAAc;QAF3B,qGAAY,EAAE;QACf,eAAe;OACD,cAAc,CA2I3B;IAAD,qBAAC;CAAA;AA3I2B;AA6IrB,IAAM,cAAc,GAAG,IAAI,cAAc,EAAE,CAAC;;;;;;;;;;;;;;;;;;;;;;;ACnKnD;;;;;;;;;GASG;AAC2E;AAE9E;;;;;;GAMG;AAGF;IADD,eAAe;IACd;IAoCD,CAAC;IAlCG;;;;;;;;;;;;;;;OAeG;IAEN,mCAAa,GAAb,UAAc,OAAe;QAE5B,IAAM,sBAAsB,GAAG,IAAI,MAAM,CAAC,gBAAgB,CAAC,CAAC;QAC5D,IAAM,QAAQ,GAAG,IAAI,MAAM,CAAC,kBAAkB,CAAC,CAAC;QAEhD,IAAI,SAAS,CAAC;QACd,IAAI,sBAAsB,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;YACzC,SAAS,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC;SACrC;aAAM,IAAI,QAAQ,CAAC,IAAI,CAAC,OAAO,CAAC,EAAE;YAClC,SAAS,GAAG,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC,CAAC;SAC1D;aAAM;YACN,SAAS,GAAG,OAAO,CAAC;SACpB;QAED,OAAO,IAAI,MAAM,CAAC,SAAS,EAAE,GAAG,CAAC,CAAC;IACnC,CAAC;IAlCY,WAAW;QAFxB,qGAAY,EAAE;QACf,eAAe;OACD,WAAW,CAoCxB;IAAD,kBAAC;CAAA;AApCwB;AAsClB,IAAM,WAAW,GAAG,IAAI,WAAW,EAAE,CAAC;;;;;;;;;;;;;AC3D7C;AAAA;AAAA;;;;;;;;;GASG;AAEH;;;;;;GAMG;AACH;IAAA;IAiCA,CAAC;IA/BG;;;;;;;;;;;;;;OAcG;IACN,qCAAkB,GAAlB,UAAmB,GAAW,EAAE,GAAW,EAAE,KAAa;QACzD,IAAM,CAAC,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC;QAC3B,IAAM,IAAI,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;QAC3C,GAAG,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC;QACxC,IAAM,KAAK,GAAG,IAAI,MAAM,CAAC,QAAQ,GAAG,GAAG,GAAG,WAAW,EAAE,GAAG,CAAC,CAAC;QAC5D,IAAM,SAAS,GAAG,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,CAAC;QAEtD,IAAI,GAAG,CAAC,KAAK,CAAC,KAAK,CAAC,EAAE;YACrB,GAAG,GAAG,GAAG,CAAC,OAAO,CAAC,KAAK,EAAE,IAAI,GAAG,GAAG,GAAG,GAAG,GAAG,KAAK,GAAG,IAAI,CAAC,CAAC;SAC1D;aAAM;YACN,GAAG,GAAG,GAAG,GAAG,SAAS,GAAG,GAAG,GAAG,GAAG,GAAG,KAAK,CAAC;SAC1C;QACD,OAAO,GAAG,GAAG,IAAI,CAAC;IACnB,CAAC;IAGF,eAAC;AAAD,CAAC;;;;;;;;;;;;;;;;;;;;;;;ACnDD;;;;;;;;;GASG;AAC2E;AAG9E;;;;;;GAMG;AAGF;IAEA,qBACS,QAAa,EACb,mBAA2B,EAC3B,OAA+B;QAF/B,aAAQ,GAAR,QAAQ,CAAK;QACb,wBAAmB,GAAnB,mBAAmB,CAAQ;QAC3B,YAAO,GAAP,OAAO,CAAwB;IACrC,CAAC;IAED;;;;;;;;;OASG;IACN,qCAAe,GAAf;QACC,IAAI,IAAI,CAAC,QAAQ,EAAE,EAAE;YACpB,OAAO,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC;SAC3B;aAAM,IAAI,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,mBAAmB,CAAC,EAAE;YAC1E,OAAQ,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,cAAc,CAAC,IAAI,CAAC,mBAAmB,CAAuB,CAAC,aAAa,CAAC;SAC3G;QACD,OAAO,IAAI,CAAC;IACb,CAAC;IAzBY,WAAW;QAFxB,qGAAY,EAAE;QACf,eAAe;OACD,WAAW,CA2BxB;IAAD,kBAAC;CAAA;AA3BwB;;;;;;;;;;;;;ACtBzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;;;;;;;AAGgC;AACc;AACO;AACpB;AACY;AACkB;AACxB;AACA;AAC6B;AAMvE;;;;;;GAMG;AA64CH;IAAA;IAA8B,CAAC;IAAlB,eAAe;QA54C3B,iFAAQ,CAAC;YACT,OAAO,EAAE;gBACR,eAAe;gBACf,eAAe;gBACf,YAAY;aACZ;YACD,SAAS,EAAE;gBACV,8DAAc;gBACd,kDAAQ;gBACR,sEAAkB;gBAClB,8DAAc;gBACd,wDAAW;gBACX,wDAAW;gBACX,gFAAuB;gBACvB;oBACC,OAAO,EAAE,YAAY;oBACrB,UAAU,EAAE;wBACX,OAAO,UAAS,KAAU;4BACzB,IAAI,CAAC,KAAK,GAAG,KAAK,CAAC;wBACpB,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;mBASG;gBACH;oBACC,OAAO,EAAE,gBAAgB;oBACzB,UAAU,EAAE;wBACX,OAAO,UAAC,MAAc,EAAE,GAAW;4BAClC,YAAY;4BACZ,qEAAqE;4BACrE,IAAM,EAAE,GAAG,IAAI,MAAM,CACpB,mBAAmB,GAAG,SAAS;gCAC/B,iCAAiC,GAAG,gBAAgB;gCACpD,kBAAkB,GAAG,WAAW;gCAChC,sCAAsC,GAAG,QAAQ;gCACjD,YAAY,GAAG,OAAO;gCACtB,QAAQ,CAAC,kBAAkB;6BAC3B,CAAC;4BAEF,IAAI,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE;gCACjB,OAAO,GAAG,CAAC;6BACX;iCAAM;gCACN,OAAO,MAAM,GAAG,GAAG,CAAC;6BACpB;wBACF,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;mBASG;gBACH;oBACC,OAAO,EAAE,WAAW;oBACpB,UAAU,EAAE;wBACX,OAAO,UAAC,GAAW;4BAClB,IAAI,GAAG,EAAE;gCACR,IAAI,IAAI,GAAG,QAAQ,CAAC,aAAa,CAAC,GAAG,CAAC,CAAC;gCACvC,IAAI,CAAC,YAAY,CAAC,MAAM,EAAE,GAAG,CAAC,CAAC;gCAC/B,IAAM,MAAM,GAAG,IAAI,CAAC,QAAQ,GAAG,IAAI,GAAG,IAAI,CAAC,QAAQ,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;gCACzF,IAAI,GAAG,IAAI,CAAC,CAAC,KAAK;gCAClB,OAAO,MAAM,CAAC;6BACd;iCAAM;gCACN,OAAO,MAAM,CAAC,QAAQ,CAAC,QAAQ,GAAG,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,QAAQ,GAAG,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC;6BAC7H;wBAEF,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;;;mBAYG;gBACH;oBACC,OAAO,EAAE,SAAS;oBAClB,UAAU,EAAE;wBACX,OAAO,UAAC,KAAa;4BACpB,OAAO,CAAC,OAAO,KAAK,KAAK,WAAW,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,MAAM,IAAI,KAAK,CAAC,QAAQ,EAAE,CAAC,IAAI,EAAE,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC;wBACrH,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;;mBAWG;gBACH;oBACC,OAAO,EAAE,QAAQ;oBACjB,UAAU,EAAE;wBACX,OAAO,UAAC,WAAsB,EAAE,UAAsB;4BACrD,IAAI,CAAC,UAAU,EAAE;gCAChB,oCAAoC;gCACpC,UAAU,GAAG,cAAY,CAAC,CAAC;6BAC3B;4BACD,UAAU,CAAC,SAAS,GAAG,MAAM,CAAC,MAAM,CAAC,WAAW,CAAC,SAAS,CAAC,CAAC;4BAC5D,OAAO,UAAU,CAAC;wBACnB,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;;;;mBAaG;gBACH;oBACC,OAAO,EAAE,OAAO;oBAChB,UAAU,EAAE;wBACX,OAAO,UAAS,KAAU,EAAE,MAAW;4BAEtC,IAAM,aAAa,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC,4BAA4B;4BACzF,kEAAkE;4BAElE,IAAM,iBAAiB,GAAG,aAAa,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;4BAEjD,OAAO,SAAS,YAAY;gCAE3B,kEAAkE;gCAElE,IAAM,kBAAkB,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;gCAEjE,OAAO,MAAM,CAAC,KAAK,CAAC,KAAK,EAAE,iBAAiB,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC,CAAC;4BAE1E,CAAC,CAAC;wBAEH,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,eAAe;oBACxB,UAAU,EAAE,UAAC,UAAqC;wBACjD,OAAO,UAAC,IAAe,EAAE,QAAgB;4BACxC,UAAU,CAAC;gCACV,IAAI,EAAE,CAAC;gCACP,UAAU,CAAC,OAAO,EAAE,CAAC;4BACtB,CAAC,EAAE,QAAQ,CAAC,CAAC;wBACd,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,YAAY,CAAC;iBACpB;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,MAAM;oBACf,UAAU,EAAE;wBACX,OAAO,UAAC,SAAe;4BACtB,OAAO,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC,CAAC;wBAC9C,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;;mBAWG;gBACH;oBACC,OAAO,EAAE,OAAO;oBAChB,UAAU,EAAE,UAAC,OAAY;wBACxB,OAAO,UAAC,MAAW,EAAE,MAAW;4BAE/B,OAAO,CAAC,MAAM,CAAC,MAAM,EAAE,MAAM,CAAC,CAAC;4BAE/B,OAAO,MAAM,CAAC;wBACf,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,SAAS,CAAC;iBACjB;gBACD;;;;;;;;;;;;;;;;;;;;;;;;;mBAyBG;gBACH;oBACC,OAAO,EAAE,gBAAgB;oBACzB,UAAU,EAAE;wBACX,OAAO,UAAC,MAAwB;4BAE/B,IAAI,WAAW,GAAG,EAAE,CAAC;4BACrB,IAAI,MAAM,EAAE;gCACX,KAAK,IAAM,KAAK,IAAI,MAAM,EAAE;oCAC3B,IAAI,MAAM,CAAC,cAAc,CAAC,KAAK,CAAC,EAAE;wCACjC,WAAW,IAAI,GAAG,GAAG,KAAK,GAAG,GAAG,GAAG,MAAM,CAAC,KAAK,CAAC,CAAC;qCACjD;iCACD;6BACD;4BACD,OAAO,GAAG,GAAG,WAAW,CAAC;wBAC1B,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;mBAOG;gBACH;oBACC,OAAO,EAAE,QAAQ;oBACjB,UAAU,EAAE;wBACX,OAAO,UAAS,GAAW;4BAC1B,OAAO,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;wBAC/D,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;;;;;;;;;;;;mBAqBG;gBACH;oBACC,OAAO,EAAE,YAAY;oBACrB,UAAU,EAAE;wBACX,OAAO,UAAC,GAAQ;4BAEf,IAAM,MAAM,GAAG,EAAS,CAAC;4BAEzB,GAAG,CAAC,OAAO,CAAC,IAAI,MAAM,CAAC,sBAAsB,EAAE,GAAG,CAAC,EAAE,UAAS,EAAO,EAAE,EAAO,EAAE,EAAO,EAAE,EAAO;gCAC/F,MAAM,CAAC,EAAE,CAAC,GAAG,EAAE,CAAC;4BAEjB,CAAC,CAAC,CAAC;4BACH,OAAO,MAAM,CAAC;wBACf,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,MAAM;oBACf,UAAU,EAAE;wBAEX,OAAO,UAAS,OAAe;4BAC9B,IAAM,eAAe,GAAG,MAAM,CAAC;4BAC/B,IAAM,SAAS,GAAG,MAAM,CAAC;4BACzB,OAAO,OAAO,CAAC,OAAO,CAAC,eAAe,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC,CAAC;wBACpE,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;;;mBAYG;gBACH;oBACC,OAAO,EAAE,gBAAgB;oBACzB,UAAU,EAAE;wBAEX,OAAO,UAAC,MAAW;4BAClB,IAAM,aAAa,GAAG,EAAE,CAAC;4BACzB,KAAK,IAAM,GAAG,IAAI,MAAM,EAAE;gCACzB,IAAI,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,IAAI,GAAG,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;oCAC1D,aAAa,CAAC,IAAI,CAAC;wCAClB,GAAG;wCACH,KAAK,EAAE,MAAM,CAAC,GAAG,CAAC;qCAClB,CAAC,CAAC;iCACH;6BACD;4BACD,OAAO,aAAa,CAAC;wBACtB,CAAC,CAAC;oBAEH,CAAC;iBACD;gBACD;;;;;;;mBAOG;gBACH;oBACC,OAAO,EAAE,UAAU;oBACnB,UAAU,EAAE;wBAEX,SAAS,WAAW;4BACnB,OAAO,OAAO,CAAC;wBAChB,CAAC;wBAED,OAAO;4BACN,WAAW;4BACX,OAAO,YAAC,IAA2D;gCAAnE,iBAyBC;gCAxBA,IAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC;gCACvB,IAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;gCACvB,IAAM,QAAQ,GAAG,IAAI,CAAC,QAAQ,CAAC;gCAC/B,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;oCACjB,QAAQ,EAAE,CAAC;oCACX,OAAO;iCACP;gCACD,IAAI,KAAK,KAAK,SAAS,EAAE;oCACxB,KAAK,GAAG,CAAC,CAAC;iCACV;gCACD,IAAI,IAAI,CAAC,KAAK,CAAC,KAAK,SAAS,EAAE;oCAC9B,IAAI,CAAC,WAAW,EAAE,CAAC,IAAI,CAAC,KAAK,CAAC,EAAE;wCAC/B,IAAI,KAAK,GAAG,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE;4CAC5B,KAAI,CAAC,OAAO,CAAC;gDACZ,IAAI;gDACJ,KAAK,EAAE,KAAK,GAAG,CAAC;gDAChB,QAAQ;6CACR,CAAC,CAAC;yCACH;6CAAM,IAAI,OAAO,QAAQ,KAAK,UAAU,EAAE;4CAC1C,QAAQ,EAAE,CAAC;yCACX;oCACF,CAAC,CAAC,CAAC;iCAEH;4BACF,CAAC;yBACD,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;mBASG;gBACH;oBACC,OAAO,EAAE,aAAa;oBACtB,UAAU,EAAE;wBAEX,OAAO,UAAC,MAAa,EAAE,MAAa;4BAEnC,MAAM,CAAC,OAAO,CAAC,UAAS,QAAa;gCACpC,IAAI,MAAM,CAAC,OAAO,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,EAAE;oCACpC,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;iCACtB;4BACF,CAAC,CAAC,CAAC;4BAEH,OAAO,MAAM,CAAC;wBACf,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;;;;;;mBAeG;gBACH;oBACC,OAAO,EAAE,eAAe;oBACxB,UAAU,EAAE,UAAC,WAAwB;wBACpC,OAAO,WAAW,CAAC,aAAa,CAAC;oBAClC,CAAC;oBACD,IAAI,EAAE,CAAC,aAAa,CAAC;iBACrB;gBACD;;;;;;;;;mBASG;gBACH;oBACC,OAAO,EAAE,oBAAoB;oBAC7B,UAAU,EAAE;wBACX,OAAO;4BACN,IAAI,CAAC,GAAG,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE,CAAC;4BAC7B,IAAI,MAAM,CAAC,WAAW,IAAI,OAAO,MAAM,CAAC,WAAW,CAAC,GAAG,KAAK,UAAU,EAAE;gCACvE,CAAC,IAAI,MAAM,CAAC,WAAW,CAAC,GAAG,EAAE,CAAC,CAAC,wCAAwC;6BACvE;4BACD,IAAM,IAAI,GAAG,sCAAsC,CAAC,OAAO,CAAC,OAAO,EAAE,UAAS,CAAC;gCAC9E,IAAM,CAAC,GAAG,CAAC,CAAC,GAAG,IAAI,CAAC,MAAM,EAAE,GAAG,EAAE,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;gCAC5C,CAAC,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,CAAC,CAAC;gCACvB,OAAO,CAAC,CAAC,KAAK,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAG,GAAG,CAAC,CAAC,CAAC,QAAQ,CAAC,EAAE,CAAC,CAAC;4BACvD,CAAC,CAAC,CAAC;4BACH,OAAO,IAAI,CAAC;wBACb,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;;mBAWG;gBACH;oBACC,OAAO,EAAE,YAAY;oBACrB,UAAU,EAAE;wBACX,OAAO,UAAC,GAAW;4BAClB,IAAI,OAAO,GAAG,KAAK,QAAQ,EAAE;gCAC5B,OAAO,GAAG,CAAC,OAAO,CAAC,IAAI,EAAE,OAAO,CAAC;qCAC/B,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;qCACrB,OAAO,CAAC,IAAI,EAAE,MAAM,CAAC;qCACrB,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC;qCACvB,OAAO,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;6BAC1B;iCAAM;gCACN,OAAO,GAAG,CAAC;6BACX;wBACF,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;;mBAWG;gBACH;oBACC,OAAO,EAAE,UAAU;oBACnB,UAAU,EAAE,UAAC,OAAY;wBACxB,OAAO,UAAS,GAAW;4BAC1B;kJACsH;4BACtH,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,OAAO,CAAC,qBAAqB,EAAE,MAAM,CAAC,CAAC,KAAK,CAAC,EAAE,CAAC,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC;wBACnI,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,SAAS,CAAC;iBACjB;gBACD;;;;;;;;;;;mBAWG;gBACH;oBACC,OAAO,EAAE,cAAc;oBACvB,UAAU,EAAE,UAAC,OAAY;wBACxB,OAAO,UAAS,GAAQ;4BACvB,IAAI,MAAM,GAAG,4CAAY,CAAC,GAAG,CAAC,CAAC;4BAC/B,IAAI,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;gCACrB,MAAM,GAAG,MAAM,CAAC,OAAO,CAAC,gBAAgB,EAAE,EAAE,CAAC,CAAC,OAAO,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC,OAAO,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC;6BAC9F;4BACD,OAAO,MAAM,CAAC;wBACf,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,SAAS,CAAC;iBACjB;gBACD;;;;;;;mBAOG;gBACH;oBACC,OAAO,EAAE,WAAW;oBACpB,UAAU,EAAE,UAAC,EAAqB,EAAE,IAAyB;wBAC5D,OAAO,UAAC,MAAW,EAAE,OAAY;4BAChC,OAAO;gCACN,IAAI;oCACH,OAAO,EAAE,CAAC,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC,CAAC;iCACjD;gCAAC,OAAO,CAAC,EAAE;oCACX,IAAI,CAAC,KAAK,CAAC,6DAA6D,CAAC,CAAC;oCAC1E,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;oCACd,OAAO,EAAE,CAAC,MAAM,CAAC,CAAC,CAAC,CAAC;iCACpB;4BACF,CAAC,CAAC;wBACH,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,IAAI,EAAE,MAAM,CAAC;iBACpB;gBACD;;;;;;;mBAOG;gBACH;oBACC,OAAO,EAAE,YAAY;oBACrB,UAAU,EAAE;wBACX,OAAO,UAAC,KAAU;4BACjB,OAAO,OAAO,KAAK,KAAK,UAAU,CAAC;wBACpC,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD,+DAA+D;gBAC/D;oBACC,OAAO,EAAE,UAAU;oBACnB,UAAU,EAAE;wBACX,kEAAkE;wBAClE,IAAM,WAAW,GAAG;4BACnB,OAAO,EAAE,KAAK;4BACd,QAAQ,EAAE,IAAI;4BACd,MAAM,EAAE,IAAI;4BACZ,MAAM,EAAE,KAAK;4BACb,MAAM,EAAE,KAAK;4BACb,SAAS,EAAE,KAAK;yBACT,CAAC;wBACT,OAAO,UAAC,KAAU;4BACjB,OAAO,CAAC,CAAC,CAAC,KAAK,IAAI,WAAW,CAAC,OAAO,KAAK,CAAC,CAAC,CAAC;wBAC/C,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;oBACC,OAAO,EAAE,UAAU;oBACnB,UAAU,EAAE,UAAC,UAAe,EAAE,QAAa;wBAC1C,2BAA2B;wBAC3B;4BAAA;4BAEA,CAAC;4BAAD,gBAAC;wBAAD,CAAC;wBAED,OAAO,UAAS,IAAS,EAAE,IAAS,EAAE,OAAY;4BACjD,IAAI,IAAS,CAAC;4BACd,IAAI,YAAiB,CAAC;4BACtB,IAAI,MAAW,CAAC;4BAChB,IAAI,KAAU,CAAC;4BACf,IAAI,OAAY,CAAC;4BACjB,IAAI,SAAc,CAAC;4BACnB,IAAI,YAAiB,CAAC;4BACtB,IAAI,OAAY,CAAC;4BACjB,IAAI,UAAU,GAAG,CAAC,CAAC;4BACnB,IAAI,OAAO,GAAQ,KAAK,CAAC;4BACzB,IAAI,QAAQ,GAAG,IAAI,CAAC;4BACpB,IAAI,QAAa,CAAC;4BAElB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;gCACtB,MAAM,IAAI,SAAS,EAAE,CAAC;6BACtB;4BACD,IAAI,GAAG,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;4BAC9B,IAAI,OAAO,KAAK,IAAI,EAAE;gCACrB,OAAO,GAAG,IAAI,CAAC;gCACf,QAAQ,GAAG,KAAK,CAAC;6BACjB;iCAAM,IAAI,QAAQ,CAAC,OAAO,CAAC,EAAE;gCAC7B,OAAO,GAAG,OAAO,CAAC,OAAO,CAAC;gCAC1B,OAAO,GAAG,SAAS,IAAI,OAAO,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,EAAE,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,CAAC;gCACzE,QAAQ,GAAG,UAAU,IAAI,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC;6BAC/D;4BACD,IAAM,OAAO,GAAG;gCACf,IAAM,SAAS,GAAG,IAAI,GAAG,CAAC,IAAI,CAAC,GAAG,EAAE,GAAG,KAAK,CAAC,CAAC;gCAC9C,IAAI,SAAS,IAAI,CAAC,EAAE;oCACnB,IAAI,YAAY,EAAE;wCACjB,YAAY,CAAC,YAAY,CAAC,CAAC;qCAC3B;oCACD,QAAQ,GAAG,YAAY,CAAC;oCACxB,YAAY,GAAG,SAAS,GAAG,YAAY,GAAG,SAAS,CAAC;oCACpD,IAAI,QAAQ,EAAE;wCACb,UAAU,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;wCACxB,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;wCACnC,IAAI,CAAC,SAAS,IAAI,CAAC,YAAY,EAAE;4CAChC,IAAI,GAAG,OAAO,GAAG,IAAI,CAAC;yCACtB;qCACD;iCACD;qCAAM;oCACN,SAAS,GAAG,UAAU,CAAC,OAAO,EAAE,SAAS,CAAC,CAAC;iCAC3C;4BACF,CAAC,CAAC;4BAEF,IAAM,UAAU,GAAG;gCAClB,IAAI,SAAS,EAAE;oCACd,YAAY,CAAC,SAAS,CAAC,CAAC;iCACxB;gCACD,YAAY,GAAG,SAAS,GAAG,YAAY,GAAG,SAAS,CAAC;gCACpD,IAAI,QAAQ,IAAI,CAAC,OAAO,KAAK,IAAI,CAAC,EAAE;oCACnC,UAAU,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;oCACxB,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;oCACnC,IAAI,CAAC,SAAS,IAAI,CAAC,YAAY,EAAE;wCAChC,IAAI,GAAG,OAAO,GAAG,IAAI,CAAC;qCACtB;iCACD;4BACF,CAAC,CAAC;4BAEF,OAAO;gCACN,IAAI,GAAG,SAAS,CAAC;gCACjB,KAAK,GAAG,IAAI,CAAC,GAAG,EAAE,CAAC;gCACnB,OAAO,GAAG,IAAI,CAAC;gCACf,YAAY,GAAG,QAAQ,IAAI,CAAC,SAAS,IAAI,CAAC,OAAO,CAAC,CAAC;gCACnD,IAAI,WAAW,CAAC;gCAEhB,IAAI,OAAO,KAAK,KAAK,EAAE;oCACtB,WAAW,GAAG,OAAO,IAAI,CAAC,SAAS,CAAC;iCACpC;qCAAM;oCACN,IAAI,CAAC,YAAY,IAAI,CAAC,OAAO,EAAE;wCAC9B,UAAU,GAAG,KAAK,CAAC;qCACnB;oCACD,IAAM,SAAS,GAAG,OAAO,GAAG,CAAC,KAAK,GAAG,UAAU,CAAC,CAAC;oCACjD,QAAQ,GAAG,SAAS,IAAI,CAAC,CAAC;oCAE1B,IAAI,QAAQ,EAAE;wCACb,IAAI,YAAY,EAAE;4CACjB,YAAY,GAAG,YAAY,CAAC,YAAY,CAAC,CAAC;yCAC1C;wCACD,UAAU,GAAG,KAAK,CAAC;wCACnB,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;qCACnC;yCAAM,IAAI,CAAC,YAAY,EAAE;wCACzB,YAAY,GAAG,UAAU,CAAC,UAAU,EAAE,SAAS,CAAC,CAAC;qCACjD;iCACD;gCACD,IAAI,QAAQ,IAAI,SAAS,EAAE;oCAC1B,SAAS,GAAG,YAAY,CAAC,SAAS,CAAC,CAAC;iCACpC;qCAAM,IAAI,CAAC,SAAS,IAAI,IAAI,KAAK,OAAO,EAAE;oCAC1C,SAAS,GAAG,UAAU,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;iCACtC;gCACD,IAAI,WAAW,EAAE;oCAChB,QAAQ,GAAG,IAAI,CAAC;oCAChB,MAAM,GAAG,IAAI,CAAC,KAAK,CAAC,OAAO,EAAE,IAAI,CAAC,CAAC;iCACnC;gCACD,IAAI,QAAQ,IAAI,CAAC,SAAS,IAAI,CAAC,YAAY,EAAE;oCAC5C,IAAI,GAAG,OAAO,GAAG,IAAI,CAAC;iCACtB;gCACD,OAAO,MAAM,CAAC;4BACf,CAAC,CAAC;wBACH,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,YAAY,EAAE,UAAU,CAAC;iBAChC;gBACD;oBACC,OAAO,EAAE,UAAU;oBACnB,UAAU,EAAE,UAAC,QAAa,EAAE,UAAe,EAAE,QAAa;wBACzD,OAAO,UAAS,IAAS,EAAE,IAAS,EAAE,OAAY;4BACjD,IAAI,OAAO,GAAG,IAAI,CAAC;4BACnB,IAAI,QAAQ,GAAG,IAAI,CAAC;4BAEpB,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,EAAE;gCACtB,MAAM,IAAI,SAAS,EAAE,CAAC;6BACtB;4BACD,IAAI,OAAO,KAAK,KAAK,EAAE;gCACtB,OAAO,GAAG,KAAK,CAAC;6BAChB;iCAAM,IAAI,QAAQ,CAAC,OAAO,CAAC,EAAE;gCAC7B,OAAO,GAAG,SAAS,IAAI,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC;gCAC3D,QAAQ,GAAG,UAAU,IAAI,OAAO,CAAC,CAAC,CAAC,OAAO,CAAC,QAAQ,CAAC,CAAC,CAAC,QAAQ,CAAC;6BAC/D;4BACD,OAAO,GAAG,EAAE,CAAC;4BACb,OAAO,CAAC,OAAO,GAAG,OAAO,CAAC;4BAC1B,OAAO,CAAC,OAAO,GAAG,IAAI,CAAC;4BACvB,OAAO,CAAC,QAAQ,GAAG,QAAQ,CAAC;4BAE5B,OAAO,QAAQ,CAAC,IAAI,EAAE,IAAI,EAAE,OAAO,CAAC,CAAC;wBACtC,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,UAAU,EAAE,YAAY,EAAE,UAAU,CAAC;iBAC5C;gBACD;;;;;;;;mBAQG;gBACH;oBACC,OAAO,EAAE,WAAW;oBACpB,UAAU,EAAE,UAAC,OAAY;wBACxB,OAAO,UAAS,UAAe;4BAC9B,OAAO,OAAO,CAAC,SAAS,CAAC,UAAU,CAAC,CAAC;wBACtC,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,SAAS,CAAC;iBACjB;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,iBAAiB;oBAC1B,UAAU,EAAE,UAAC,OAAY;wBACxB,OAAO,UAAS,UAAe;4BAC9B,OAAO,OAAO,CAAC,SAAS,CAAC,UAAU,EAAE,IAAI,EAAE,IAAI,CAAC,CAAC;wBAClD,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,SAAS,CAAC;iBACjB;gBACD;;;;;;;;;mBASG;gBACH;oBACC,OAAO,EAAE,oBAAoB;oBAC7B,UAAU,EAAE,UAAC,OAAY;wBACxB,OAAO,UAAS,MAAW,EAAE,kBAAuB;4BACnD,MAAM,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC;4BACzB,OAAO,MAAM,CAAC,MAAM,CAAC,kBAAkB,CAAC,CAAC,GAAG,CAAC,MAAM,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC;wBAC/E,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,SAAS,CAAC;iBACjB;gBACD;;;;;;;;mBAQG;gBACH;oBACC,OAAO,EAAE,8BAA8B;oBACvC,UAAU,EAAE,UAAC,cAAmB;wBAC/B,OAAO;4BACN,IAAI,cAAc,CAAC,MAAM,EAAE,EAAE;gCAC5B,cAAc,CAAC,UAAU,EAAE,CAAC;6BAC5B;wBACF,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,gBAAgB,CAAC;iBACxB;gBACD;;;;;;;;mBAQG;gBACH;oBACC,OAAO,EAAE,YAAY;oBACrB,UAAU,YAAC,MAAuB;wBACjC,OAAO,SAAS,UAAU,CAAC,GAAW;4BAErC,IAAI,CAAC,GAAG,GAAG,GAAG,CAAC;4BAEf,IAAI,CAAC,KAAK,GAAG;gCACZ,OAAO,IAAI,CAAC,GAAG,CAAC;4BACjB,CAAC,CAAC;4BAEF;;;;;;;;;+BASG;4BACH,IAAI,CAAC,aAAa,GAAG,UAAS,MAAwB;gCACrD,IAAM,KAAK,GAAG,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,CAAC;gCACrC,IAAI,MAAM,EAAE;oCACX,sCAAsC;oCACtC,IAAM,IAAI,GAAG,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,IAAI,CAAC,UAAS,CAAC,EAAE,CAAC;wCAClD,OAAO,CAAC,CAAC,MAAM,GAAG,CAAC,CAAC,MAAM,CAAC;oCAC5B,CAAC,CAAC,CAAC;oCACH,IAAI,CAAC,OAAO,CAAC,UAAS,GAAG;wCACxB,IAAM,EAAE,GAAG,IAAI,MAAM,CAAC,KAAK,GAAG,GAAG,GAAG,KAAK,CAAC,CAAC;wCAC3C,KAAK,CAAC,GAAG,GAAG,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,GAAG,GAAG,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,OAAO,CAAC,EAAE,EAAE,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC;oCAChF,CAAC,CAAC,CAAC;iCACH;gCACD,OAAO,KAAK,CAAC;4BACd,CAAC,CAAC;wBACH,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,QAAQ,CAAC;iBAChB;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,qBAAqB;oBAC9B,UAAU,EAAE;wBACX,OAAO,UAAS,QAAa;4BAC5B,IAAM,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,UAAS,GAAG;gCACxD,OAAO,QAAQ,CAAC,GAAG,CAAC,YAAY,KAAK,CAAC;4BACvC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;4BAEN,OAAO,QAAQ,CAAC,OAAO,CAAC,CAAC;wBAC1B,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,+BAA+B;oBACxC,UAAU,EAAE;wBACX,OAAO,UAAS,QAAa;4BAC5B,IAAM,OAAO,GAAG,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,MAAM,CAAC,UAAS,GAAG;gCACxD,OAAO,QAAQ,CAAC,GAAG,CAAC,YAAY,KAAK,CAAC;4BACvC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;4BAEN,OAAO,OAAO,CAAC;wBAChB,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,aAAa;oBACtB,UAAU,EAAE,UAAC,IAAS;wBACrB,OAAO,UAAS,YAAiB,EAAE,WAAgB;4BAClD,IAAI,CAAC,YAAY,EAAE;gCAClB,YAAY,GAAG,IAAI,CAAC,WAAW,CAAC,CAAC;6BACjC;iCAAM;gCACN,KAAK,IAAM,CAAC,IAAI,YAAY,EAAE;oCAC7B,IAAI,YAAY,CAAC,cAAc,CAAC,CAAC,CAAC,EAAE;wCACnC,OAAO,YAAY,CAAC,CAAC,CAAC,CAAC;qCACvB;iCACD;gCACD,8CAAc,CAAC,YAAY,EAAE,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC;6BAChD;4BAED,OAAO,YAAY,CAAC;wBACrB,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,MAAM,CAAC;iBACd;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,iBAAiB;oBAC1B,UAAU,EAAE,UAAC,cAAmB;wBAC/B,OAAO,UAAS,EAAO;4BACtB,OAAO,cAAc,CAAC,OAAO,CAAC,EAAE,CAAC,CAAC;wBACnC,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,gBAAgB,CAAC;iBACxB;gBACD;;;;;;;;;mBASG;gBACH;oBACC,OAAO,EAAE,mBAAmB;oBAC5B,UAAU,EAAE,UAAC,MAAuB;wBACnC,OAAO,UAAS,KAAU;4BACzB,IAAI,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,EAAE;gCAC3B,KAAK,IAAM,GAAG,IAAI,KAAK,EAAE;oCACxB,IAAI,KAAK,CAAC,cAAc,CAAC,GAAG,CAAC,EAAE;wCAC9B,IAAI,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,EAAE;4CAChC,OAAO,KAAK,CAAC;yCACb;qCACD;iCACD;gCACD,OAAO,IAAI,CAAC;6BACZ;4BACD,OAAO,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,MAAM,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;wBAC7E,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,QAAQ,CAAC;iBAChB;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,aAAa;oBACtB,UAAU,EAAE;wBACX,OAAO;4BACN,IAAM,GAAG,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;4BAClD,OAAO;gCACN,IAAM,IAAI,GAAG,SAAS,CAAC;gCACvB,OAAO,GAAG,CAAC,KAAK,CAAC,UAAS,CAAM;oCAC/B,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;gCACzB,CAAC,CAAC,CAAC;4BACJ,CAAC,CAAC;wBACH,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,aAAa;oBACtB,UAAU,EAAE;wBACX,OAAO;4BACN,IAAM,GAAG,GAAG,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC;4BAClD,OAAO;gCACN,IAAM,IAAI,GAAG,SAAS,CAAC;gCACvB,OAAO,GAAG,CAAC,IAAI,CAAC,UAAS,CAAM;oCAC9B,OAAO,CAAC,CAAC,KAAK,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;gCACzB,CAAC,CAAC,CAAC;4BACJ,CAAC,CAAC;wBACH,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,iBAAiB;oBAC1B,UAAU,EAAE,UAAC,cAAmB;wBAC/B,OAAO,UAAS,QAAa;4BAC5B,OAAO,MAAM,CAAC,QAAQ,CAAC,CAAC,GAAG,EAAE,CAAC,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,CAAC;wBACjE,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,gBAAgB,CAAC;iBACxB;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,kBAAkB;oBAC3B,UAAU,EAAE;wBACX,OAAO,UAAS,YAAiB;4BAChC,IAAI,OAAO,YAAY,KAAK,QAAQ,EAAE;gCACrC,OAAO,IAAI,CAAC,YAAY,CAAC,CAAC;6BAC1B;iCAAM;gCACN,MAAM,IAAI,KAAK,CAAC,8CAA8C,GAAG,OAAO,YAAY,GAAG,mCAAmC,CAAC,CAAC;6BAC5H;wBAEF,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;mBAOG;gBACH;oBACC,OAAO,EAAE,QAAQ;oBACjB,UAAU,EAAE;wBACX,OAAO,UAAS,MAAW;4BAC1B;;;;+BAIG;4BACH,OAAO,IAAI,CAAC,kBAAkB,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,OAAO,CAAC,iBAAiB,EAC/E,SAAS,YAAY,CAAC,KAAU,EAAE,EAAU;gCAC3C,yCAAyC;gCACzC,OAAO,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,EAAE,EAAE,EAAE,CAAC,CAAC,CAAC;4BAC9C,CAAC,CAAC,CAAC,CAAC;wBACN,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,6BAA6B;oBACtC,UAAU,EAAE;wBACX,OAAO,UAAS,GAAQ;4BACvB,OAAO,UAAS,CAAM,EAAE,CAAM;gCAE7B,IAAI,GAAG,EAAE;oCACR,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;oCACX,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC;iCACX;gCAED,IAAI,CAAC,KAAK,CAAC,EAAE;oCACZ,OAAO,CAAC,CAAC;iCACT;gCACD,IAAI,CAAC,CAAC,CAAC,uBAAuB,EAAE;oCAC/B,4BAA4B;oCAC5B,OAAO,CAAC,CAAC,WAAW,GAAG,CAAC,CAAC,WAAW,CAAC;iCACrC;gCACD,IAAI,CAAC,CAAC,uBAAuB,CAAC,CAAC,CAAC,GAAG,CAAC,EAAE;oCACrC,uGAAuG;oCACvG,gFAAgF;oCAChF,OAAO,CAAC,CAAC;iCACT;gCAED,OAAO,CAAC,CAAC,CAAC;4BACX,CAAC,CAAC;wBACH,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;mBAQG;gBACH;oBACC,OAAO,EAAE,UAAU;oBACnB,UAAU,EAAE,UAAC,OAAY;wBACxB,OAAO;4BACN,OAAO,OAAO,CAAC,GAAG,KAAK,OAAO,CAAC;wBAChC,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,SAAS,CAAC;iBACjB;gBACD;;;;;;;;;;;;;mBAaG;gBACH;oBACC,OAAO,EAAE,oBAAoB;oBAC7B,UAAU,EAAE;wBACX,OAAO,UAAS,KAAU,EAAE,WAAgB;4BAC3C,IAAM,OAAO,GAAG,WAAW,CAAC,qBAAqB,EAAE,CAAC;4BACpD,OAAO,CAAC,KAAK,CAAC,CAAC,IAAI,OAAO,CAAC,IAAI,IAAI,KAAK,CAAC,CAAC,IAAI,OAAO,CAAC,KAAK,IAAI,KAAK,CAAC,CAAC,IAAI,OAAO,CAAC,GAAG,IAAI,KAAK,CAAC,CAAC,IAAI,OAAO,CAAC,MAAM,CAAC,CAAC;wBACrH,CAAC,CAAC;oBACH,CAAC;iBACD;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,iBAAiB;oBAC1B,UAAU,EAAE;wBACX,OAAO,UAAS,mBAAwB,EAAE,mBAAwB;4BACjE,OAAO,CAAC,CAAC,mBAAmB,CAAC,IAAI,GAAG,CAAC,mBAAmB,CAAC,IAAI,GAAG,mBAAmB,CAAC,KAAK,CAAC;gCACzF,CAAC,mBAAmB,CAAC,IAAI,GAAG,mBAAmB,CAAC,KAAK,CAAC,GAAG,mBAAmB,CAAC,IAAI;gCACjF,mBAAmB,CAAC,GAAG,GAAG,CAAC,mBAAmB,CAAC,GAAG,GAAG,mBAAmB,CAAC,MAAM,CAAC;gCAChF,CAAC,mBAAmB,CAAC,GAAG,GAAG,mBAAmB,CAAC,MAAM,CAAC,GAAG,mBAAmB,CAAC,GAAG,CAAC,CAAC;wBACpF,CAAC,CAAC;oBACH,CAAC;iBAED;gBAED;oBACC,OAAO,EAAE,2BAA2B;oBACpC,QAAQ,EAAE,IAAI;iBACd;gBACD;;;;;;;;;mBASG;gBACH;oBACC,OAAO,EAAE,sBAAsB;oBAC/B,UAAU,EAAE,UAAC,SAAc,EAAE,OAAY,EAAE,eAAoB,EAAE,yBAA8B;wBAC9F,OAAO,UAAS,OAAY;4BAC3B,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,OAAO,CAAC,EAAE;gCAC7C,OAAO,KAAK,CAAC;6BACb;4BACD,IAAM,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,MAAM,EAAE,CAAC;4BACzC,MAAM,CAAC,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,UAAU,EAAE,CAAC;4BAC7C,MAAM,CAAC,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC,WAAW,EAAE,CAAC;4BAE/C,IAAM,GAAG,GAAG,QAAQ,CAAC,gBAAgB,IAAI,QAAQ,CAAC,eAAe,CAAC;4BAElE,OAAO,eAAe,CAAC;gCACtB,IAAI,EAAE,CAAC,yBAAyB,GAAG,GAAG,CAAC,UAAU;gCACjD,KAAK,EAAE,MAAM,CAAC,UAAU,GAAG,CAAC,GAAG,yBAAyB;gCACxD,GAAG,EAAE,CAAC,yBAAyB,GAAG,GAAG,CAAC,SAAS;gCAC/C,MAAM,EAAE,MAAM,CAAC,WAAW,GAAG,CAAC,GAAG,yBAAyB;6BAC1D,EAAE,MAAM,CAAC,CAAC;wBACZ,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,WAAW,EAAE,SAAS,EAAE,iBAAiB,EAAE,2BAA2B,CAAC;iBAC9E;gBACD;;;;;;;;;mBASG;gBACH;oBACC,OAAO,EAAE,2BAA2B;oBACpC,UAAU,EAAE,UAAC,MAAuB;wBACnC,OAAO,SAAS,yBAAyB,CAAC,GAAQ,EAAE,QAAa;4BAChE,OAAO,MAAM,CAAC,MAAM,CAAC,GAAG,EAAE,UAAC,MAAW,EAAE,KAAU,EAAE,GAAQ;gCAC3D,IAAI,MAAM,CAAC,aAAa,CAAC,KAAK,CAAC,EAAE;oCAChC,MAAM,CAAC,GAAG,CAAC,GAAG,yBAAyB,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;iCACzD;qCAAM;oCACN,MAAM,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,KAAK,CAAC,CAAC;iCAC9B;gCACD,OAAO,MAAM,CAAC;4BACf,CAAC,EAAE,EAAE,CAAC,CAAC;wBACR,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,QAAQ,CAAC;iBAChB;gBACD;;;;;;;;;;mBAUG;gBACH;oBACC,OAAO,EAAE,wBAAwB;oBACjC,UAAU,EAAE,UAAC,MAAuB,EAAE,yBAA8B;wBACnE,OAAO,UAAS,WAAgB,EAAE,YAAiB;4BAClD,oCAAoC;4BACpC,SAAS,gBAAgB,KAAI,CAAC;4BAE9B,oCAAoC;4BACpC,SAAS,oBAAoB,KAAI,CAAC;4BAElC,IAAM,SAAS,GAAG,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,SAAS,CAAC,WAAW,CAAC,EAAE,YAAY,EAAE,UAAS,OAAY,EAAE,OAAY;gCAClH,IAAI,CAAC,MAAM,CAAC,aAAa,CAAC,OAAO,CAAC,EAAE;oCACnC,OAAO,CAAC,MAAM,CAAC,OAAO,CAAC,OAAO,EAAE,OAAO,CAAC,CAAC,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,oBAAoB,CAAC;iCACnF;gCAED,qGAAqG;gCACrG,6BAA6B;gCAC7B,OAAO,SAAS,CAAC;4BAClB,CAAC,CAAC,CAAC;4BAEH,0FAA0F;4BAC1F,IAAM,YAAY,GAAG,yBAAyB,CAAC,SAAS,EAAE,UAAS,KAAU;gCAC5E,IAAI,KAAK,KAAK,gBAAgB,IAAI,KAAK,KAAK,oBAAoB,EAAE;oCACjE,OAAO,gBAAgB,CAAC;iCACxB;qCAAM;oCACN,OAAO,KAAK,CAAC;iCACb;4BACF,CAAC,CAAC,CAAC;4BAEH,wDAAwD;4BACxD,OAAO,yBAAyB,CAAC,YAAY,EAAE,UAAS,KAAU;gCACjE,OAAO,KAAK,KAAK,gBAAgB,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;4BAClD,CAAC,CAAC,CAAC;wBACJ,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,QAAQ,EAAE,2BAA2B,CAAC;iBAC7C;gBAED;oBACC,OAAO,EAAE,SAAS;oBAClB,UAAU,EAAE,UAAC,SAAc,EAAE,OAAY;wBACxC,OAAO,UAAS,SAAc;4BAC7B,OAAO,OAAO,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC;wBAClD,CAAC,CAAC;oBACH,CAAC;oBACD,IAAI,EAAE,CAAC,WAAW,EAAE,SAAS,CAAC;iBAC9B;gBACD;oBACC,OAAO,EAAE,4BAA4B;oBACrC,QAAQ,EAAE;wBACT,IAAM,mBAAmB,GAAG,UAAS,IAAS;4BAC7C,IAAM,aAAa,GAAG,MAAa,CAAC;4BAEpC,IAAI,IAAI,KAAK,SAAS,IAAI,IAAI,KAAK,IAAI,IAAI,IAAI,CAAC,IAAI,EAAE;gCACrD,OAAO,IAAI,CAAC;6BACZ;4BAED,IAAI,OAAO,IAAI,KAAK,UAAU,EAAE;gCAC/B,OAAO,UAAU,CAAC;6BAClB;iCAAM,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;gCACpC,OAAO,QAAQ,CAAC;6BAChB;iCAAM,IAAI,OAAO,IAAI,KAAK,QAAQ,EAAE;gCACpC,OAAO,QAAQ,CAAC;6BAChB;iCAAM,IAAI,OAAO,IAAI,KAAK,SAAS,EAAE;gCACrC,OAAO,SAAS,CAAC;6BACjB;iCAAM,IAAI,aAAa,CAAC,eAAe,CAAC,SAAS,CAAC,IAAI,CAAC,EAAE;gCACzD,OAAO,SAAS,CAAC;6BACjB;iCAAM,IAAI,IAAI,CAAC,cAAc,IAAI,IAAI,CAAC,cAAc,CAAC,QAAQ,CAAC,EAAE,EAAE,kBAAkB;gCACpF,IAAI,IAAI,CAAC,OAAO,EAAE;oCACjB,IAAM,KAAG,GAAQ,EAAE,CAAC;oCACpB,IAAI,CAAC,OAAO,CAAC,UAAS,YAAiB;wCACtC,KAAG,CAAC,IAAI,CAAC,mBAAmB,CAAC,YAAY,CAAC,CAAC,CAAC;oCAC7C,CAAC,CAAC,CAAC;oCACH,OAAO,KAAG,CAAC;iCACX;qCAAM;oCACN,OAAO,QAAQ,CAAC;iCAChB;6BACD;iCAAM,EAAE,OAAO;gCACf,IAAM,OAAK,GAAG,EAAS,CAAC;gCACxB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC,UAAS,SAAS;oCAC3C,IAAI,SAAS,CAAC,OAAO,CAAC,GAAG,CAAC,KAAK,CAAC,EAAE;wCACjC,OAAK,CAAC,SAAS,CAAC,GAAG,mBAAmB,CAAC,IAAI,CAAC,SAAS,CAAC,CAAC,CAAC;qCACxD;gCACF,CAAC,CAAC,CAAC;gCACH,OAAO,OAAK,CAAC;6BACb;wBACF,CAAC,CAAC;wBACF,OAAO,mBAAmB,CAAC;oBAC5B,CAAC;iBACD;aAED;SACD,CAAC;OACW,eAAe,CAAG;IAAD,sBAAC;CAAA;AAAH;;;;;;;;;;;;;AC76C5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACwB;AAE3B,SAAS;AAC+C;AACR;AACN;AACA;AACQ;;;;;;;;;;;;;ACjBlD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACc;AAYS;AAE1B;IAAA;IAKA,CAAC;IAAD,iCAAC;AAAD,CAAC;;AAED,oIAAoI;AACpI,SAAS,UAAU,CAAC,OAAyD;IAC5E,OAAQ,MAAc,CAAC,eAAe,CAAC,OAAO,CAAC,OAAO,CAAC,CAAC,CAAC,CAAE,OAAe,CAAC,OAAO,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC;AAC1G,CAAC;AAED,gDAAgD;AAChD;IAAA;IAoDA,CAAC;IAlDA,0CAAU,GAAV;QAEC,uDAAuD;QAEvD,IAAM,IAAI,GAAG,OAAO,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;QAErD,UAAU,CAAC,6EAA4B,CAAC,CAAC,IAAI,CAAC,CAAC;QAE/C,uDAAuD;QAEvD,IAAM,YAAY,GAAiC,OAAO,CAAC,YAAY,CAAe,cAAc,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC,CAAC;QAC3H,YAAY,CAAC,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAC,MAAW,EAAE,SAAiB,EAAE,MAA+B,EAAE,mBAA+B;YACjI,OAAO,MAAM,CAAC,KAAK,CAAC,SAAS,EAAE,mBAAmB,CAAC,CAAC;QACrD,CAAC,CAAC,CAAC;QACH,UAAU,CAAC,wEAAuB,CAAC,CAAC,YAAY,CAAC,CAAC;QAElD,UAAU,CAAC,iFAAgC,CAAC,CAAC,YAAY,CAAC,CAAC;QAE3D,OAAO,YAAY,CAAC;IAErB,CAAC;IAGD,kDAAkB,GAAlB;QAEC,IAAM,YAAY,GAAiB,OAAO,CAAC,YAAY,CAAM,cAAc,EAAE,CAAC,gBAAgB,CAAC,CAAC,CAAC;QACjG,IAAM,IAAI,GAAG,OAAO,CAAC,YAAY,CAAC,MAAM,EAAE,CAAC,OAAO,CAAC,CAAC,CAAC;QAErD,UAAU,CAAC,gFAA+B,CAAC,CAAC,YAAY,EAAE,IAAI,CAAC,CAAC;QAChE,OAAO,YAAY,CAAC;IACrB,CAAC;IAED,2DAA2B,GAA3B;QACC,IAAM,SAAS,GAAG,OAAO,CAAC,YAAY,CAAM,WAAW,EAAE,CAAC,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC;QACzE,IAAM,uBAAuB,GAA4C,OAAO,CAAC,YAAY,CAA0B,yBAAyB,EAAE,CAAC,UAAU,CAAC,CAAC,CAAC;QAChK,IAAM,iBAAiB,GAAG,OAAO,CAAC,SAAS,EAAE,CAAC;QAE9C,UAAU,CAAC,kFAAiC,CAAC,CAAC,SAAS,EAAE,uBAAuB,EAAE,iBAAiB,CAAC,CAAC;QACrG,OAAO,uBAAuB,CAAC;IAChC,CAAC;IAED,oCAAI,GAAJ;QAEC,OAAO;YACN,YAAY,EAAE,IAAI,CAAC,UAAU,EAAE;YAC/B,YAAY,EAAE,IAAI,CAAC,kBAAkB,EAAE;YACvC,uBAAuB,EAAE,IAAI,CAAC,2BAA2B,EAAE;SAC3D,CAAC;IAEH,CAAC;IACF,4BAAC;AAAD,CAAC;AAEM,IAAM,qBAAqB,GAAG,IAAI,qBAAqB,EAAE,CAAC;;;;;;;;;;;;;ACpEjE;AAAA;AAAA;IAAA;IAmDA,CAAC;IAjDA,2BAAO,GAAP,UAAQ,IAAa,EAAE,4BAAsC;QAC5D,IAAI,GAAG,IAAI,IAAI,UAAU,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAC1C,IAAM,SAAS,GAAG,OAAO,CAAC,YAAY,CAAmB,IAAI,EAAE,CAAC,eAAe,EAAE,uBAAuB,CAAC,CAAC,CAAC;QAE3G;;;;WAIG;QAEH;YAAA;YACA,CAAC;YAAD,YAAC;QAAD,CAAC;QACD,KAAK,CAAC,SAAS,GAAG,SAAS,CAAC;QAE5B,IAAM,IAAI,GAAQ,IAAI,KAAK,EAAE,CAAC;QAE7B,IAAY,CAAC,QAAQ,GAAG,CAAC,CAAC;QAC1B,IAAyB,CAAC,4BAA4B,GAAG,4BAA4B,CAAC;QACvF,OAAO,IAAI,CAAC;IACb,CAAC;IAED,+BAAW,GAAX,UAAY,IAAa;QACxB,IAAI,GAAG,IAAI,IAAI,cAAc,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAC9C,OAAO,OAAO,CAAC,YAAY,CAAc,IAAI,EAAE,CAAC,iBAAiB,CAAC,CAAC,CAAC;QAAA,CAAC;IACtE,CAAC;IAED,yBAAK,GAAL,UAAM,IAAa;QAClB,IAAI,GAAG,IAAI,IAAI,aAAa,GAAG,IAAI,CAAC,MAAM,EAAE,CAAC;QAC7C,OAAO,OAAO,CAAC,YAAY,CAAe,IAAI,EAAE,CAAC,gBAAgB,EAAE,iBAAiB,CAAC,CAAC,CAAC;IACxF,CAAC;IAGD,6BAAS,GAAT;QACC,IAAM,SAAS,GAAG;YACjB,WAAW,EAAX;gBACC,OAAO,IAAI,CAAC,CAAC,CAAC,CAAC;YAChB,CAAC;SAC2C,CAAC;QAE9C,IAAM,GAAG,GAAG,OAAO,CAAC,YAAY,CAAmB,UAAU,EAAE,CAAC,aAAa,CAAC,CAAC,CAAC;QAC/E,GAAW,CAAC,oBAAoB,GAAG,UAAS,gBAAyB;YACrE,IAAI,CAAC,gBAAgB,GAAG,gBAAgB,CAAC;QAC1C,CAAC,CAAC;QAED,SAAiB,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC;QAE5B,OAAO,SAAS,CAAC;IAClB,CAAC;IAEF,gBAAC;AAAD,CAAC;AAEM,IAAM,SAAS,GAAG,IAAI,SAAS,EAAE,CAAC;;;;;;;;;;;;;AC5EzC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACyB;AACG;AACC;AACJ;AACkC;AAClC;;;;;;;;;;;;;ACJ5B;AAAA;AAAA;AAAwD;AAGxD,IAAM,MAAM,GAAqB,MAAc,CAAC,eAAe,CAAC;AAEhE;IAAA;QAES,uBAAkB,GAAG,CAAC,MAAM,EAAE,MAAM,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;QACnD,oCAA+B,GAAG,CAAC,KAAK,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,QAAQ,EAAE,QAAQ,CAAC,CAAC;IAuD/F,CAAC;IArDA,6BAAM,GAAN,UAAO,iBAAgE;QAAvE,iBAiBC;QAhBA,IAAM,EAAE,GAAI,MAAc,CAAC,CAAC,IAAK,MAAc,CAAC,eAAe,CAAC;QAChE,IAAM,KAAK,GAAG,OAAO,CAAC,SAAS,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC;QAElD,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAC,OAAkC;YACrD,IAAI,OAAO,OAAO,KAAK,QAAQ,EAAE;gBAChC,IAAI,iBAAiB,EAAE;oBACtB,OAAO,iBAAiB,CAAC,OAAO,CAAC,CAAC;iBAClC;qBAAM;oBACN,OAAO,KAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,qDAAS,CAAC,OAAO,CAAC,+BAA6B,OAAS,CAAC,CAAC,CAAC;iBAC/F;aACD;iBAAM;gBACN,OAAO,KAAI,CAAC,IAAI,CAAC,iBAAiB,EAAE,OAAO,CAAC,CAAC;aAC7C;QACF,CAAC,CAAC,CAAC;QAEH,OAAQ,KAA6B,CAAC;IACvC,CAAC;IAED,2BAAI,GAAJ,UAAK,IAAY;QAAE,uBAAoC;aAApC,UAAoC,EAApC,qBAAoC,EAApC,IAAoC;YAApC,sCAAoC;;QAEtD,IAAM,qBAAqB,GAAG,aAAa,CAAC,MAAM,CAAC,UAAC,OAAO,IAAK,QAAC,CAAC,OAAO,EAAT,CAAS,CAAC,CAAC;QAE3E,IAAM,gBAAgB,GAAG,qBAAqB,CAAC,IAAI,CAAC,UAAC,OAAO,IAAK,QAAC,CAAC,OAAO,CAAC,4BAA4B,EAAtC,CAAsC,CAAC,CAAC;QAEzG,IAAM,iCAAiC,GAAG,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,SAAS,CAAC,IAAI,CAAC,+BAA+B,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB,CAAC,4BAA4B,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC,+BAA+B,CAAC;QAE7O,IAAM,eAAe,GAAG,OAAO,CAAC,YAAY,CAAS,IAAI,EAAE,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,iCAAiC,CAAC,CAAC,CAAC;QAE9H,qBAAqB,CAAC,OAAO,CAAC,UAAC,OAAO,EAAE,KAAK;YAC5C,IAAM,OAAO,GAAG,eAAsB,CAAC;YACvC,OAAO,CAAC,KAAK,CAAC,GAAG,OAAO,CAAC;QAC1B,CAAC,CAAC,CAAC;QAEF,eAAuB,CAAC,MAAM,GAAG,qBAAqB,CAAC,MAAM,CAAC;QAE/D,IAAI,CAAC,+BAA+B,CAAC,OAAO,CAAC,UAAC,UAAyC;YACtF,eAAe,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC;QACjD,CAAC,CAAC,CAAC;QAEH,IAAI,gBAAgB,EAAE;YACrB,MAAM,CAAC,OAAO,CAAC,gBAAgB,CAAC,4BAA4B,EAAE,UAAC,KAAgB,EAAE,UAAyC;gBACzH,eAAe,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,KAAK,CAAC,CAAC;YACpD,CAAC,CAAC,CAAC;SACH;QAED,IAAI,CAAC,kBAAkB,CAAC,OAAO,CAAC,UAAC,UAAyC;YACzE,eAAe,CAAC,UAAU,CAAC,CAAC,GAAG,CAAC,WAAW,CAAC,eAAe,CAAC,CAAC;QAC9D,CAAC,CAAC,CAAC;QAEH,OAAO,eAAe,CAAC;IACxB,CAAC;IAEF,mBAAC;AAAD,CAAC;AAEM,IAAM,YAAY,GAAG,IAAI,YAAY,EAAE,CAAC;;;;;;;;;;;;;AChE/C;AAAA;AAAA;IA2CC;QAzCA,UAAK,GAAqB;YAAA,iBAMzB;YALA,IAAM,CAAC,GAAQ;gBAAC,cAAc;qBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;oBAAd,yBAAc;;gBAC7B,OAAO,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,KAAI,EAAE,IAAI,CAAC,CAAC;YACvC,CAAC,CAAC;YACF,CAAC,CAAC,IAAI,GAAG,EAAE,CAAC;YACZ,OAAO,CAAC,CAAC;QACV,CAAC,EAAE,CAAC;QAGJ,SAAI,GAAqB;YAAA,iBAMxB;YALA,IAAM,CAAC,GAAQ;gBAAC,cAAc;qBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;oBAAd,yBAAc;;gBAC7B,OAAO,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAI,EAAE,IAAI,CAAC,CAAC;YACtC,CAAC,CAAC;YACF,CAAC,CAAC,IAAI,GAAG,EAAE,CAAC;YACZ,OAAO,CAAC,CAAC;QACV,CAAC,EAAE,CAAC;QAEJ,QAAG,GAAqB;YAAA,iBAMvB;YALA,IAAM,CAAC,GAAQ;gBAAC,cAAc;qBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;oBAAd,yBAAc;;gBAC7B,OAAO,OAAO,CAAC,GAAG,CAAC,IAAI,CAAC,KAAI,EAAE,IAAI,CAAC,CAAC;YACrC,CAAC,CAAC;YACF,CAAC,CAAC,IAAI,GAAG,EAAE,CAAC;YACZ,OAAO,CAAC,CAAC;QACV,CAAC,EAAE,CAAC;QAEJ,UAAK,GAAqB;YAAA,iBAMzB;YALA,IAAM,CAAC,GAAQ;gBAAC,cAAc;qBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;oBAAd,yBAAc;;gBAC7B,OAAO,OAAO,CAAC,KAAK,CAAC,IAAI,CAAC,KAAI,EAAE,IAAI,CAAC,CAAC;YACvC,CAAC,CAAC;YACF,CAAC,CAAC,IAAI,GAAG,EAAE,CAAC;YACZ,OAAO,CAAC,CAAC;QACV,CAAC,EAAE,CAAC;QAEJ,SAAI,GAAqB;YAAA,iBAMxB;YALA,IAAM,CAAC,GAAQ;gBAAC,cAAc;qBAAd,UAAc,EAAd,qBAAc,EAAd,IAAc;oBAAd,yBAAc;;gBAC7B,OAAO,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,KAAI,EAAE,IAAI,CAAC,CAAC;YACtC,CAAC,CAAC;YACF,CAAC,CAAC,IAAI,GAAG,EAAE,CAAC;YACZ,OAAO,CAAC,CAAC;QACV,CAAC,EAAE,CAAC;QAGH,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QACrB,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;QACpB,KAAK,CAAC,IAAI,EAAE,KAAK,CAAC,CAAC;QACnB,KAAK,CAAC,IAAI,EAAE,OAAO,CAAC,CAAC;QACrB,KAAK,CAAC,IAAI,EAAE,MAAM,CAAC,CAAC;IACrB,CAAC;IAED,qBAAqB;IACrB,+BAAW,GAAX;QACC,MAAM,IAAI,KAAK,CAAC,6CAA6C,CAAC,CAAC;IAChE,CAAC;IAED,qBAAqB;IACrB,yBAAK,GAAL;QACC,MAAM,IAAI,KAAK,CAAC,uCAAuC,CAAC,CAAC;IAC1D,CAAC;IAEF,gBAAC;AAAD,CAAC;;;;;;;;;;;;;;ACzED;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACc;AACkB;AAKnC,IAAY,WAEX;AAFD,WAAY,WAAW;IACtB,qDAAQ;IAAE,mDAAO;AAClB,CAAC,EAFW,WAAW,KAAX,WAAW,QAEtB;AAYD;;;;;GAKG;AACH;IAAA;IA8IA,CAAC;IA5IA;;;;;;;;;OASG;IACH,oCAAY,GAAZ,UAAgB,IAAY,EAAE,WAA+C,EAAE,KAAS;QAAxF,iBAiDC;QAjD6B,4CAA2B,WAAW,CAAC,QAAQ;QAE5E,IAAM,OAAO,GAAG,OAAO,CAAC,YAAY,CAAc,IAAI,EAAE,CAAC,MAAM,EAAE,SAAS,EAAE,OAAO,CAAC,CAA0B,CAAC;QAE/G,OAAO,CAAC,WAAW,GAAG,WAAW,CAAC;QAClC,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;QACtB,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC;QACpB,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAC,eAAuC,EAAE,cAAsC;YACzG,IAAI,QAAQ,GAAQ,IAAI,CAAC;YACzB,IAAI,OAAO,CAAC,WAAW,KAAK,WAAW,CAAC,QAAQ,EAAE;gBACjD,IAAI,eAAe,EAAE;oBACpB,QAAQ,GAAG,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;iBAC1C;qBAAM;oBACN,QAAQ,GAAG,OAAO,CAAC,KAAK,CAAC;iBACzB;gBACD,IAAI,QAAQ,IAAI,QAAQ,CAAC,IAAI,EAAE;oBAC9B,OAAO,QAAQ,CAAC;iBAChB;qBAAM;oBACN,OAAO,KAAI,CAAC,YAAY,CAAC,IAAI,GAAG,UAAU,EAAE,WAAW,CAAC,QAAQ,EAAE,QAAQ,CAAC,CAAC;iBAC5E;aACD;iBAAM;gBACN,IAAI,cAAc,EAAE;oBACnB,QAAQ,GAAG,cAAc,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;iBACzC;qBAAM;oBACN,QAAQ,GAAG,OAAO,CAAC,KAAK,CAAC;iBACzB;gBACD,IAAI,QAAQ,IAAI,QAAQ,CAAC,IAAI,EAAE;oBAC9B,OAAO,QAAQ,CAAC;iBAChB;qBAAM;oBACN,OAAO,KAAI,CAAC,YAAY,CAAC,IAAI,GAAG,UAAU,EAAE,WAAW,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;iBAC3E;aACD;QACF,CAAC,CAAC,CAAC;QAEH,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAC,eAAuC;YACpE,IAAI,QAAQ,GAAQ,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;YACnD,OAAO,KAAI,CAAC,YAAY,CAAC,IAAI,GAAG,UAAU,EAAE,OAAO,CAAC,WAAW,EAAE,QAAQ,CAAC,CAAC;QAC5E,CAAC,CAAC,CAAC;QAEH,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAC,cAAsC;YACjE,IAAI,OAAO,CAAC,WAAW,KAAK,WAAW,CAAC,OAAO,EAAE;gBAChD,IAAI,QAAQ,GAAQ,cAAc,CAAC,OAAO,CAAC,KAAK,CAAC,CAAC;gBAClD,OAAO,KAAI,CAAC,YAAY,CAAC,IAAI,GAAG,UAAU,EAAE,WAAW,CAAC,OAAO,EAAE,QAAQ,CAAC,CAAC;aAC3E;YAED,OAAO,OAAO,CAAC;QAChB,CAAC,CAAC,CAAC;QAEH,OAAO,OAAO,CAAC;IAChB,CAAC;IAED;;;;;;OAMG;IACH,0BAAE,GAAF;QAAA,iBAuEC;QArEA,IAAM,EAAE,GAA8B,OAAO,CAAC,YAAY,CAAoB,IAAI,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,QAAQ,CAAC,CAAC,CAAC;QAEnI,EAAE,CAAC,GAAG,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAC,QAAmC;YAEvD,IAAM,SAAS,GAAU,EAAE,CAAC;YAE5B,QAAQ;iBACN,MAAM,CAAC,UAAC,OAAO,IAAK,cAAO,CAAC,WAAW,KAAK,WAAW,CAAC,QAAQ,EAA5C,CAA4C,CAAC;iBACjE,OAAO,CAAC,UAAC,OAAO;gBAChB,OAAO,CAAC,IAAI,CAAC,UAAC,QAAQ;oBACrB,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC;gBAC1B,CAAC,CAAC,CAAC;YACJ,CAAC,CAAC,CAAC;YAEJ,IAAM,WAAW,GAAG,QAAQ,CAAC,IAAI,CAAC,UAAC,OAAO,IAAK,cAAO,CAAC,WAAW,KAAK,WAAW,CAAC,OAAO,EAA3C,CAA2C,CAAC,CAAC;YAE5F,IAAI,CAAC,WAAW,EAAE;gBACjB,OAAO,KAAI,CAAC,YAAY,CAAC,cAAc,EAAE,WAAW,CAAC,QAAQ,EAAE,SAAS,CAAC,CAAC;aAC1E;iBAAM;gBACN,OAAO,KAAI,CAAC,YAAY,CAAC,cAAc,EAAE,WAAW,CAAC,OAAO,EAAE,WAAW,CAAC,KAAK,CAAC,CAAC;aACjF;QACF,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAC,KAAU;YAC/B,IAAI,KAAK,IAAI,KAAK,CAAC,IAAI,EAAE;gBACxB,OAAO,KAAK,CAAC;aACb;iBAAM;gBACN,OAAO,KAAI,CAAC,YAAY,CAAC,aAAa,EAAE,WAAW,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;aACrE;QACF,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,QAAQ,CAAC;YAErB,IAAM,QAAQ,GAA2B;gBAExC,OAAO,EAAE,KAAI,CAAC,YAAY,CAAM,iBAAiB,EAAE,WAAW,CAAC,OAAO,CAAC;gBAEvE,OAAO,YAAC,KAAU;oBACjB,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,WAAW,CAAC,QAAQ,CAAC;oBAChD,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;gBAC5B,CAAC;gBAED,MAAM,YAAC,KAAU;oBAChB,IAAI,CAAC,OAAO,CAAC,WAAW,GAAG,WAAW,CAAC,OAAO,CAAC;oBAC/C,IAAI,CAAC,OAAO,CAAC,KAAK,GAAG,KAAK,CAAC;gBAC5B,CAAC;gBAED,MAAM,YAAC,KAAW,IAAG,4CAAY,EAAE,CAAC,EAAC;aACrC,CAAC;YACF,OAAO,QAAQ,CAAC;QACjB,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAC,KAAU;YAClC,IAAI,KAAK,IAAI,KAAK,CAAC,IAAI,EAAE;gBACxB,OAAO,KAAK,CAAC;aACb;iBAAM;gBACN,OAAO,KAAI,CAAC,YAAY,CAAC,gBAAgB,EAAE,WAAW,CAAC,QAAQ,EAAE,KAAK,CAAC,CAAC;aACxE;QACF,CAAC,CAAC,CAAC;QAEH,EAAE,CAAC,MAAM,CAAC,GAAG,CAAC,QAAQ,CAAC,UAAC,KAAU;YACjC,IAAI,KAAK,IAAI,KAAK,CAAC,IAAI,EAAE;gBACxB,OAAO,KAAK,CAAC;aACb;iBAAM;gBACN,OAAO,KAAI,CAAC,YAAY,CAAC,eAAe,EAAE,WAAW,CAAC,OAAO,EAAE,KAAK,CAAC,CAAC;aACtE;QACF,CAAC,CAAC,CAAC;QAEH,OAAO,EAAE,CAAC;IACX,CAAC;IACF,oBAAC;AAAD,CAAC;AAEM,IAAM,aAAa,GAAG,IAAI,aAAa,EAAE,CAAC;;;;;;;;;;;;;ACpLjD;AAAA;AAAA;AAAA;;;;;;;;;GASG;AACH,yHAAyH;AACzH,oHAAoH;AACjF;AAEnC,UAAU,CAAE,4CAAoB,CAAC,MAAM,CAAC,UAAS,QAAa;IAC7D,QAAQ,CAAC,KAAK,CAAC,MAAM,EAAE,OAAO,CAAC,CAAC;AACjC,CAAC,CAAC,CAAC,CAAC;;;;;;;;;;;;;AChBJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;GASG;AAMuD;AAIE;AAEyF;AAIhG;AAMK;AAI1B;AAEoC;AAElB;AAElD,iEAAqB,CAAC,IAAI,EAAE,CAAC;;;;;;;;;;;;ACzC7B,yB;;;;;;;;;;;ACAA,0B;;;;;;;;;;;ACAA,yB","file":"sharedSmarteditForTests.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./smartedit-build/test/unit/sharedSmarteditForTests.ts\");\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport './yMessage/yEventMessage/IYEventMessageData';\r\n\r\nexport * from './tree/types';\r\nexport {YMoreTextComponent} from './yMoreText/YMoreTextComponent';\r\nexport * from './infiniteScrolling/YInfiniteScrollingComponent';\r\nexport {IYDropdownMenuItem} from './yDropdown/yDropDownMenu/IYDropdownMenuItem';\r\nexport * from './yMessage/yEventMessage/IYEventMessageData';\r\nexport * from './yMessage/yEventMessage/yEventMessage';\r\nexport * from './languageSelector/selector/LanguageSelectorComponent';\r\nexport * from './languageSelector/dropdown/LanguageDropdownSelectorComponent';","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as lo from 'lodash';\r\nimport {\r\n\tISeComponent,\r\n\tSeComponent\r\n} from \"smarteditcommons/services/dependencyInjection/di\";\r\nimport {Page} from \"smarteditcommons/dtos\";\r\nimport {DiscardablePromiseUtils} from 'smarteditcommons/utils/DiscardablePromiseUtils';\r\nimport {TestModeService} from 'smarteditcommons/services/testModeService';\r\n\r\n/** @internal */\r\nexport interface ITechnicalUniqueIdAware {\r\n\ttechnicalUniqueId: string;\r\n}\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name yInfiniteScrollingModule.directive:yInfiniteScrolling\r\n * @scope\r\n * @restrict E\r\n *\r\n * @description\r\n * A component that you can use to implement infinite scrolling for an expanding content (typically with a ng-repeat) nested in it.\r\n * It is meant to handle paginated requests from a backend when data is expected to be large.\r\n * Since the expanding content is a <b>transcluded</b> element, we must specify the context to which the items will be attached:\r\n * If context is myContext, each pagination will push its new items to myContext.items.\r\n * @param {String} pageSize The maximum size of each page requested from the backend.\r\n * @param {String} mask A string value sent to the server upon fetching a page to further restrict the search, it is sent as query string \"mask\".\r\n * <br>The directive listens for change to mask and will reset the scroll and re-fetch data.\r\n * <br/>It it left to the implementers to decide what it filters on\r\n * @param {String} distance A number representing how close the bottom of the element must be to the bottom of the container before the expression specified by fetchPage function is triggered. Measured in multiples of the container height; for example, if the container is 1000 pixels tall and distance is set to 2, the infinite scroll expression will be evaluated when the bottom of the element is within 2000 pixels of the bottom of the container. Defaults to 0 (e.g. the expression will be evaluated when the bottom of the element crosses the bottom of the container).\r\n * @param {Object} context The container object to which the items of the fetched {@link Page.object:Page Page} will be added\r\n * @param {Function} fetchPage function to fetch the next page when the bottom of the element approaches the bottom of the container.\r\n *        fetchPage will be invoked with 3 arguments : <b>mask, pageSize, currentPage</b>. The currentPage is determined by the scrolling and starts with 0. The function must return a page of type {@link Page.object:Page Page}.\r\n * @param {String} dropDownContainerClass An optional CSS class to be added to the container of the dropdown. It would typically be used to override the default height. <b>The resolved CSS must set a height (or max-height) and overflow-y:scroll.</b>\r\n * @param {String} dropDownClass An optional CSS class to be added to the dropdown. <b>Neither height nor overflow should be set on the dropdown, it must be free to fill up the space and reach the container size. Failure to do so will cause the directive to call nextPage as many times as the number of available pages on the server.</b>\r\n */\r\n@SeComponent({\r\n\ttemplateUrl: 'yInfiniteScrollingTemplate.html',\r\n\tinputs: [\r\n\t\t'pageSize',\r\n\t\t'mask:?',\r\n\t\t'fetchPage',\r\n\t\t'distance:?',\r\n\t\t'context:?',\r\n\t\t'dropDownContainerClass: @?',\r\n\t\t'dropDownClass: @?'\r\n\t]\r\n})\r\n/* @ngInject */\n export class YInfiniteScrollingComponent<T extends ITechnicalUniqueIdAware> implements ISeComponent {\r\n\r\n\t/** @internal */\r\n\tpublic CONTAINER_CLASS = \"ySEInfiniteScrolling-container\";\r\n\r\n\t/** @internal */\r\n\tpublic items: T[];\r\n\t/** @internal */\r\n\tpublic initiated = false;\r\n\t/** @internal */\r\n\tpublic currentPage: number;\r\n\t/** @internal */\r\n\tpublic pagingDisabled: boolean;\r\n\t// inputs\r\n\tpublic dropDownContainerClass: string;\r\n\tpublic dropDownClass: string;\r\n\tpublic pageSize: number;\r\n\tpublic mask: string;\r\n\tpublic fetchPage: (mask: string, pageSize: number, currentPage: number) => angular.IPromise<Page<T>>;\r\n\tprivate distance: number;\r\n\tprivate context: {items: T[]};\r\n\t// end of inputs\r\n\r\n\tprivate container: Element;\r\n\tprivate containerId: string;\r\n\r\n\tprivate THROTTLE_MILLISECONDS = 250;\r\n\r\n\t/** @internal */\r\n\tconstructor(\r\n\t\tprivate $timeout: angular.ITimeoutService,\r\n\t\tprivate encode: (object: any) => string,\r\n\t\tprivate lodash: lo.LoDashStatic,\r\n\t\tprivate discardablePromiseUtils: DiscardablePromiseUtils,\r\n\t\tprivate $element: JQuery<Element>,\r\n\t\tgenerateIdentifier: () => string,\r\n\t\tthrottle: (func: (...args: any[]) => any, maxWait: number) => any,\r\n\t\ttestModeService: TestModeService\r\n\t) {\r\n\t\tthis.containerId = generateIdentifier();\r\n\r\n\t\t// needs to be bound for usage by underlying infinite-scroll\r\n\r\n\t\tthis.nextPage = this.nextPage.bind(this);\r\n\t\tif (!testModeService.isE2EMode()) {\r\n\t\t\tthis.$onChanges = throttle(this.$onChanges.bind(this), this.THROTTLE_MILLISECONDS);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t/** @internal */\r\n\t$onChanges() {\r\n\t\tthis.context = this.context || this;\r\n\t\tthis.$postLink();\r\n\t}\r\n\r\n\t/** @internal */\r\n\tnextPage() {\r\n\r\n\t\tif (this.pagingDisabled) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.pagingDisabled = true;\r\n\t\tthis.currentPage++;\r\n\t\tthis.mask = this.mask || \"\";\r\n\r\n\t\tthis.discardablePromiseUtils.apply(this.containerId, this.fetchPage(this.mask, this.pageSize, this.currentPage),\r\n\t\t\t(page: Page<T>) => {\r\n\r\n\t\t\t\tpage.results.forEach((element: T) => {\r\n\t\t\t\t\telement.technicalUniqueId = this.encode(element);\r\n\t\t\t\t});\r\n\r\n\t\t\t\tconst uniqueResults = this.lodash.differenceBy(page.results, this.context.items, \"technicalUniqueId\" as keyof ITechnicalUniqueIdAware);\r\n\t\t\t\tif (this.lodash.size(uniqueResults) > 0) {\r\n\t\t\t\t\tArray.prototype.push.apply(this.context.items, uniqueResults);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t * pagingDisabled controls the disablement of the native infinite-scroll directive therefore its\r\n\t\t\t\t * re-evaluation must happen on the next digest cycle, after the HTML real estate has been modified\r\n\t\t\t\t * by the new data set. Doing it on the same digest cycle would cause the non throttled infinite-scroll directive\r\n\t\t\t\t * to fetch more pages than required\r\n\t\t\t\t */\r\n\t\t\t\tthis.$timeout(() => {\r\n\t\t\t\t\tthis.pagingDisabled = page.results.length === 0 || (page.pagination && this.context.items.length === page.pagination.totalCount);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t}\r\n\r\n\t/** @internal */\r\n\t$postLink() {\r\n\t\tconst wasInitiated = this.initiated;\r\n\r\n\t\tthis.distance = this.distance || 0;\r\n\t\tthis.context.items = [];\r\n\t\tthis.currentPage = -1;\r\n\t\tthis.pagingDisabled = false;\r\n\t\tif (!this.container && this.$element) {\r\n\t\t\tthis.container = this.$element.find(\".\" + this.CONTAINER_CLASS).get(0);\r\n\t\t\tthis.initiated = true;\r\n\t\t} else {\r\n\t\t\tthis.container.scrollTop = 0;\r\n\t\t}\r\n\r\n\t\tif (wasInitiated) {\r\n\t\t\t// not needed the first time since data-infinite-scroll-immediate-check=\"true\"\r\n\t\t\tthis.nextPage();\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {CrossFrameEventService, ISeComponent, IToolingLanguage, LanguageService} from \"../../services\";\r\n\r\n/* @internal */\r\nexport class LanguageSelectorController implements ISeComponent {\r\n\r\n\tpublic selectedLanguage: IToolingLanguage = null;\r\n\tpublic languages: IToolingLanguage[] = [];\r\n\r\n\tprivate unRegisterEventService: () => void;\r\n\r\n\tconstructor(\r\n\t\tprivate SWITCH_LANGUAGE_EVENT: string,\r\n\t\tprivate languageService: LanguageService,\r\n\t\tprivate crossFrameEventService: CrossFrameEventService,\r\n\t\tprivate $q: angular.IQService\r\n\t) {}\r\n\r\n\t$onInit(): void {\r\n\t\tthis.$q.all([\r\n\t\t\tthis.languageService.getResolveLocale(),\r\n\t\t\tthis.languageService.getToolingLanguages()\r\n\t\t]).then(([isoCode, languages]: [string, IToolingLanguage[]]) => {\r\n\t\t\tthis.languages = [...languages];\r\n\t\t\tthis.setSelectedLanguage(isoCode);\r\n\t\t});\r\n\r\n\t\tthis.unRegisterEventService = this.crossFrameEventService.subscribe(this.SWITCH_LANGUAGE_EVENT, this.handleLanguageChange.bind(this));\r\n\t}\r\n\r\n\t$onDestroy(): void {\r\n\t\tthis.unRegisterEventService();\r\n\t}\r\n\r\n\t/**\r\n\t * Triggered when an user selects a language.\r\n\t * @param {IToolingLanguage} language\r\n\t */\r\n\tonSelectedLanguage(language: IToolingLanguage) {\r\n\t\tthis.languageService.setSelectedToolingLanguage(language);\r\n\t}\r\n\r\n\t/**\r\n\t * Returns an ordered language array by name and sets the selected language at the beginning.\r\n\t *\r\n\t * @param {IToolingLanguage} selectedLanguage\r\n\t * @param {IToolingLanguage[]} languages\r\n\t * @returns {IToolingLanguage[]}\r\n\t */\r\n\tprotected orderLanguagesWithSelectedLanguage(selectedLanguage: IToolingLanguage, languages: IToolingLanguage[]) {\r\n\t\tconst orderedLanguages = this.languages.filter((language) => language !== selectedLanguage).sort((a, b) => {\r\n\t\t\treturn a.isoCode.localeCompare(b.isoCode);\r\n\t\t});\r\n\t\torderedLanguages.unshift(selectedLanguage);\r\n\r\n\t\treturn orderedLanguages;\r\n\t}\r\n\r\n\t/**\r\n\t * Triggered onInit and when language service sets a new language.\r\n\t *\r\n\t * @param {IToolingLanguage[]} languages\r\n\t * @param {string} isoCode\r\n\t */\r\n\tprivate setSelectedLanguage(isoCode: string): void {\r\n\t\tthis.selectedLanguage = this.findLanguageWithIsoCode(isoCode);\r\n\r\n\t\tif (this.selectedLanguage) {\r\n\t\t\tthis.languages = this.orderLanguagesWithSelectedLanguage(this.selectedLanguage, this.languages);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t// In case the iso code is too specific, it will use the more generic iso code to set the language.\r\n\t\tthis.languageService.getResolveLocaleIsoCode().then((code: string) => {\r\n\t\t\tthis.selectedLanguage = this.findLanguageWithIsoCode(code);\r\n\t\t\tthis.languages = this.orderLanguagesWithSelectedLanguage(this.selectedLanguage, this.languages);\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * Finds the language with a specified isoCode.\r\n\t *\r\n\t * @param {string} isoCode\r\n\t * @returns {IToolingLanguage}\r\n\t */\r\n\tprivate findLanguageWithIsoCode(isoCode: string): IToolingLanguage {\r\n\t\treturn this.languages.find((language) => language.isoCode === isoCode);\r\n\t}\r\n\r\n\t/**\r\n\t * Callback for setting the selected language.\r\n\t */\r\n\tprivate handleLanguageChange(): void {\r\n\t\tthis.languageService.getResolveLocale().then((isoCode: string) => {\r\n\t\t\tthis.setSelectedLanguage(isoCode);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n/**\r\n * @ngdoc directive\r\n * @name SmarteditCommonsModule.component:LanguageDropdownSelectorComponent\r\n * @element language-dropdown-selector\r\n * @description\r\n * An icon language dropdown selector which allows the user to select a language.\r\n *\r\n * Use the {@link smarteditCommonsModule.service:LanguageService languageService}\r\n * to call backend API in order to get the list of supported languages\r\n */\r\nimport {CrossFrameEventService, IToolingLanguage, LanguageService, SeComponent} from \"../../../services\";\r\nimport {LanguageSelectorController} from \"../LanguageSelectorController\";\r\n\r\n@SeComponent({\r\n\ttemplateUrl: 'languageDropdownSelectorTemplate.html'\r\n})\r\n/* @ngInject */\n export class LanguageDropdownSelectorComponent extends LanguageSelectorController {\r\n\r\n\tconstructor(\r\n\t\tSWITCH_LANGUAGE_EVENT: string,\r\n\t\tlanguageService: LanguageService,\r\n\t\tcrossFrameEventService: CrossFrameEventService,\r\n\t\t$q: angular.IQService\r\n\t) {\r\n\t\tsuper(SWITCH_LANGUAGE_EVENT, languageService, crossFrameEventService, $q);\r\n\t}\r\n\r\n\tprotected orderLanguagesWithSelectedLanguage(selectedLanguage: IToolingLanguage, languages: IToolingLanguage[]) {\r\n\t\treturn this.languages;\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n/**\r\n * @ngdoc directive\r\n * @name SmarteditCommonsModule.component:LanguageSelectorComponent\r\n * @element language-selector\r\n * @description\r\n * A language selector which allows the user to select a language while showing the currently displayed language.\r\n *\r\n * Use the {@link smarteditCommonsModule.service:LanguageService languageService}\r\n * to call backend API in order to get the list of supported languages\r\n */\r\nimport {CrossFrameEventService, LanguageService, SeComponent} from \"../../../services/\";\r\nimport {LanguageSelectorController} from \"../LanguageSelectorController\";\r\n\r\n@SeComponent({\r\n\ttemplateUrl: 'languageSelectorTemplate.html'\r\n})\r\n/* @ngInject */\n export class LanguageSelectorComponent extends LanguageSelectorController {\r\n\r\n\tconstructor(\r\n\t\tSWITCH_LANGUAGE_EVENT: string,\r\n\t\tlanguageService: LanguageService,\r\n\t\tcrossFrameEventService: CrossFrameEventService,\r\n\t\t$q: angular.IQService\r\n\t) {\r\n\t\tsuper(SWITCH_LANGUAGE_EVENT, languageService, crossFrameEventService, $q);\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from \"angular\";\r\n\r\n/**\r\n * @ngdoc object\r\n * @name treeModule.object:YTreeDndEvent\r\n * @description\r\n * A plain JSON object, representing the event triggered when dragging and dropping nodes in the {@link treeModule.directive:ytree ytree} directive.\r\n *\r\n * @param {Object} sourceNode is the {@link treeModule.object:Node node} that is being dragged.\r\n * @param {Object} destinationNodes is the set of the destination's parent's children {@link treeModule.object:Node nodes}.\r\n * @param {Number} position is the index at which the {@link treeModule.object:Node node} was dropped.\r\n *\r\n */\r\nexport class YTreeDndEvent {\r\n\tconstructor(\r\n\t\t/**\r\n\t\t * @ngdoc property\r\n\t\t * @name sourceNode\r\n\t\t * @propertyOf treeModule.object:YTreeDndEvent\r\n\t\t * @description\r\n\t\t * the {@link treeModule.object:Node node} being dragged\r\n\t\t */\r\n\t\tpublic sourceNode: TreeNode,\r\n\t\t/**\r\n\t\t * @ngdoc property\r\n\t\t * @name destinationNodes\r\n\t\t * @propertyOf treeModule.object:YTreeDndEvent\r\n\t\t * @description\r\n\t\t * array of siblings {@link treeModule.object:Node nodes} to the location drop location\r\n\t\t */\r\n\t\tpublic destinationNodes: TreeNode,\r\n\t\t/**\r\n\t\t * @ngdoc property\r\n\t\t * @name position\r\n\t\t * @propertyOf treeModule.object:YTreeDndEvent\r\n\t\t * @description\r\n\t\t * the index at which {@link treeModule.object:Node node} was dropped amongst its siblings\r\n\t\t */\r\n\t\tpublic position: number,\r\n\t\t/**\r\n\t\t * @ngdoc property\r\n\t\t * @name sourceParentHandle\r\n\t\t * @propertyOf treeModule.object:YTreeDndEvent\r\n\t\t * @description\r\n\t\t * the  UI handle of the parent node of the source element\r\n\t\t */\r\n\t\tpublic sourceParentHandle?: any,\r\n\t\t/**\r\n\t\t * @ngdoc property\r\n\t\t * @name targetParentHandle\r\n\t\t * @propertyOf treeModule.object:YTreeDndEvent\r\n\t\t * @description\r\n\t\t * the UI handle of the targeted parent element\r\n\t\t */\r\n\t\tpublic targetParentHandle?: any\r\n\t) {}\r\n}\r\n\r\n/**\r\n * @ngdoc object\r\n * @name treeModule.object:dragOptions\r\n * @description\r\n * A JSON object holding callbacks related to nodes drag and drop functionality in the {@link treeModule.directive:ytree ytree} directive.\r\n * Each callback exposes the {@link treeModule.object:YTreeDndEvent YTreeDndEvent}\r\n */\r\nexport interface TreeDragOptions {\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name onDropCallback\r\n\t * @propertyOf treeModule.object:dragOptions\r\n\t * @description\r\n\t * Callback function executed after the node is dropped.\r\n\t */\r\n\tonDropCallback: (event: YTreeDndEvent) => void;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name beforeDropCallback\r\n\t * @propertyOf treeModule.object:dragOptions\r\n\t * @description\r\n\t * Callback function executed before drop. Return true allows drop, false rejects, and an object {confirmDropI18nKey: 'key'} opens a confirmation modal.\r\n\t */\r\n\tbeforeDropCallback: (event: YTreeDndEvent) => void;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name acceptDropCallback\r\n\t * @propertyOf treeModule.object:dragOptions\r\n\t * @description\r\n\t * Callback function executed when hovering over droppable slots, return true to allow, return false to block.\r\n\t */\r\n\tacceptDropCallback: (event: YTreeDndEvent) => void;\r\n\tallowDropCallback: (event: YTreeDndEvent) => void;\r\n}\r\n\r\nexport interface ITreeService {\r\n\tfetchChildren(parent: TreeNode): angular.IPromise<TreeNode[]>;\r\n\tsaveNode(parent: TreeNode): angular.IPromise<TreeNode>;\r\n\tremoveNode(node: TreeNode): angular.IPromise<void>;\r\n}\r\n\r\n/**\r\n * @ngdoc object\r\n * @name treeModule.object:Node\r\n * @description\r\n * A plain JSON object, representing the node of a tree managed by the {@link treeModule.directive:ytree ytree} directive.\r\n */\r\nexport interface TreeNode {\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name hasChildren\r\n\t * @propertyOf treeModule.object:Node\r\n\t * @description\r\n\t * boolean specifying whether the retrieved node has children. This is read only and ignored upon saving.\r\n\t */\r\n\thasChildren: boolean;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name name\r\n\t * @propertyOf treeModule.object:Node\r\n\t * @description\r\n\t * the non localized node name. Required upon posting.\r\n\t */\r\n\tname: string;\r\n\tparent: TreeNode;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name parentUid\r\n\t * @propertyOf treeModule.object:Node\r\n\t * @description\r\n\t * the unique identifier of the parent node for the given catalog. Required upon posting.\r\n\t */\r\n\tparentUid: string;\r\n\tposition: number;\r\n\titemtype: string;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name uid\r\n\t * @propertyOf treeModule.object:Node\r\n\t * @description\r\n\t * the unique identifier of a node for the given catalog. Optional upon posting.\r\n\t */\r\n\tuid: string;\r\n\tuuid: string;\r\n\tnodes?: TreeNode[];\r\n\tinitiated?: boolean;\r\n\tmouseHovered?: boolean;\r\n}\r\n\r\nexport interface TreeNgModel extends angular.INgModelController {\r\n\tcollapsed: boolean;\r\n\ttoggle: () => void;\r\n\t$parentNodeScope: any;\r\n}\r\n\r\n/* @internal */\r\nexport interface ITreeDndOptions {\r\n\tdragEnabled: boolean;\r\n\tdragDelay: number;\r\n}\r\n\r\n/* @internal */\r\nexport interface TreeDndOptionsCallbacks {\r\n\tdropped?: (event: any) => void;\r\n\tbeforeDrop?: (event: any) => void;\r\n\taccept?: (sourceNodeScope: any, destNodesScope: any, destIndex: any) => void;\r\n}\r\n\r\n/* @internal */\r\nexport interface TreeConfiguration {\r\n\ttreeClass: string;\r\n\thiddenClass: string;\r\n\tnodesClass: string;\r\n\tnodeClass: string;\r\n\thandleClass: string;\r\n\tplaceholderClass: string;\r\n\tdragClass: string;\r\n\tdragThreshold: number;\r\n\tlevelThreshold: number;\r\n\tdefaultCollapsed: boolean;\r\n\tdragDelay: number;\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {SystemEventService} from \"smarteditcommons/services/SystemEventService\";\r\nimport {SeComponent} from \"smarteditcommons/services/dependencyInjection/SeComponent\";\r\nimport {IYEventMessageData} from \"./IYEventMessageData\";\r\nimport {ISeComponent} from \"smarteditcommons/services\";\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name smarteditCommonsModule.directive:YEventMessage\r\n * @scope\r\n * @restrict E\r\n *\r\n * @description\r\n * The YEventMessage is a wrapper around YMessage, used to display or hide the message based on events sent through the systemEventService.\r\n * \r\n * @param {< string =} type The YMessage type\r\n * @param {< string =} title The YMessage title\r\n * @param {< string =} description The YMessage description\r\n * @param {< string =} showEvent The event id where the YMessage should be shown. You can update the message or title at this time, \r\n * by passing a {@link smarteditCommonsModule.interface:IYEventMessageData IYEventMessageData} as argument to the event service.\r\n * @param {< string =} hideEvent The event id where the YMessage should be hidden\r\n * @param {< string =} showToStart Controls whether the component is shown right away after compiling the dom\r\n */\r\n@SeComponent({\r\n\ttemplate: `\r\n\t\t<div data-recompile-dom=\"$ctrl.recompile\">\r\n\t\t\t<y-message data-type=\"$ctrl.type\"\r\n\t\t\t\tdata-ng-if=\"$ctrl.show\">\r\n\t\t\t\t<message-title data-ng-if=\"$ctrl.title.length\">\r\n\t\t\t\t\t{{ $ctrl.title | translate }}\r\n\t\t\t\t</message-title>\r\n\t\t\t\t<message-description data-ng-if=\"$ctrl.description.length\">\r\n\t\t\t\t\t{{ $ctrl.description | translate }}\r\n\t\t\t\t</message-description>\r\n\t\t\t</y-message>\r\n\t\t</div>\r\n    `,\r\n\tinputs: [\r\n\t\t'type: ?',\r\n\t\t'title: ?',\r\n\t\t'description: ?',\r\n\t\t'showEvent: ?',\r\n\t\t'hideEvent: ?',\r\n\t\t'showToStart: ?'\r\n\t]\r\n})\r\n/* @ngInject */\n export class YEventMessageComponent implements ISeComponent {\r\n\r\n\tpublic type: string = 'info';\r\n\tpublic title: string;\r\n\tpublic description: string;\r\n\tpublic show: boolean = false;\r\n\tpublic showToStart: string | boolean;\r\n\tpublic recompile: () => void;\r\n\r\n\tprivate unregisterShowEventHandler: () => void;\r\n\tprivate unregisterHideEventHandler: () => void;\r\n\r\n\t/** @internal */\r\n\tconstructor(private systemEventService: SystemEventService) {\r\n\t}\r\n\r\n\t$onChanges(changesObj: angular.IOnChangesObject): void {\r\n\t\tif (changesObj.showEvent) {\r\n\t\t\tthis.removeShowEventHandler();\r\n\t\t\tthis.unregisterShowEventHandler = this.systemEventService.subscribe(changesObj.showEvent.currentValue,\r\n\t\t\t\t(eventId: string, eventData: any) => this.showEventHandler(eventId, eventData));\r\n\t\t}\r\n\t\tif (changesObj.hideEvent) {\r\n\t\t\tthis.removeHideEventHandler();\r\n\t\t\tthis.unregisterHideEventHandler = this.systemEventService.subscribe(changesObj.hideEvent.currentValue,\r\n\t\t\t\t() => this.show = false);\r\n\t\t}\r\n\t\tif (this.recompile) {\r\n\t\t\tthis.recompile();\r\n\t\t}\r\n\t}\r\n\r\n\t$onInit(): void {\r\n\t\tthis.show = this.showToStart === 'true' || this.showToStart === true;\r\n\t}\r\n\r\n\t$onDestroy() {\r\n\t\tthis.removeShowEventHandler();\r\n\t\tthis.removeHideEventHandler();\r\n\t}\r\n\r\n\tshowDescription(): boolean {\r\n\t\treturn typeof this.description === 'string' && this.description.length > 0;\r\n\t}\r\n\r\n\tshowTitle(): boolean {\r\n\t\treturn typeof this.title === 'string' && this.title.length > 0;\r\n\t}\r\n\r\n\tshowEventHandler(eventId: string, eventData: IYEventMessageData): void {\r\n\t\tif (eventData.description && eventData.description.length) {\r\n\t\t\tthis.description = eventData.description;\r\n\t\t}\r\n\t\tif (eventData.title && eventData.title.length) {\r\n\t\t\tthis.title = eventData.title;\r\n\t\t}\r\n\t\tthis.show = true;\r\n\t\tif (this.recompile) {\r\n\t\t\tthis.recompile();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate removeHideEventHandler(): void {\r\n\t\tif (this.unregisterHideEventHandler) {\r\n\t\t\tthis.unregisterHideEventHandler();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate removeShowEventHandler(): void {\r\n\t\tif (this.unregisterShowEventHandler) {\r\n\t\t\tthis.unregisterShowEventHandler();\r\n\t\t}\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from \"angular\";\r\nimport {ISeComponent, SeComponent} from \"smarteditcommons/services/dependencyInjection/di\";\r\n\r\nimport {TruncatedText} from \"smarteditcommons/dtos/TruncatedText\";\r\nimport {TextTruncateService} from \"smarteditcommons/services/text/textTruncateService\";\r\n\r\n/**\r\n * @ngdoc directive\r\n * @name SmarteditCommonsModule.component:yMoreTextComponent\r\n * @element more-text\r\n * @description\r\n * The component for truncating strings and adding an ellipsis. \r\n * If the limit is less then the string length then the string is truncated and 'more'/'less' buttons\r\n * are displayed to expand or collapse the string.\r\n * \r\n * @param {< String} text the text to be displayed\r\n * @param {< String =} limit index in text to truncate to. Default value is 100.\r\n * @param {< String =} moreLabelI18nKey the label property value for a more button. Default value is 'more'.\r\n * @param {< String =} lessLabelI18nKey the label property value for a less button. Default value is 'less'.\r\n * @param {< String =} ellipsis the ellipsis for a truncated text. Default value is an empty string.\r\n */\r\n@SeComponent({\r\n\ttemplateUrl: 'moreTextTemplate.html',\r\n\tinputs: ['text', 'limit:?', 'moreLabelI18nKey:?', 'lessLabelI18nKey:?', 'ellipsis:?'],\r\n\tproviders: [TextTruncateService]\r\n})\r\n/* @ngInject */\n export class YMoreTextComponent implements ISeComponent {\r\n\tpublic text: string;\r\n\tpublic linkLabel: string;\r\n\tpublic isTruncated: boolean = false;\r\n\r\n\tprivate limit: number;\r\n\tprivate ellipsis: string;\r\n\tprivate showingMore: boolean = false;\r\n\tprivate moreLabelI18nKey: string;\r\n\tprivate lessLabelI18nKey: string;\r\n\tprivate moreLabel: string;\r\n\tprivate lessLabel: string;\r\n\tprivate truncatedText: TruncatedText;\r\n\r\n\tconstructor(\r\n\t\tprivate textTruncateService: TextTruncateService,\r\n\t\tprivate $translate: angular.translate.ITranslateService,\r\n\t\tprivate $q: angular.IQService) {}\r\n\r\n\t$onInit(): void {\r\n\t\tthis.limit = this.limit || 100;\r\n\t\tthis.moreLabelI18nKey = this.moreLabelI18nKey || 'se.moretext.more.link';\r\n\t\tthis.lessLabelI18nKey = this.lessLabelI18nKey || 'se.moretext.less.link';\r\n\t\tthis.truncatedText = this.textTruncateService.truncateToNearestWord(this.limit, this.text, this.ellipsis);\r\n\t\tthis.isTruncated = this.truncatedText.isTruncated();\r\n\t\tthis.translateLabels().then(() => {\r\n\t\t\tthis.showHideMoreText();\r\n\t\t});\r\n\t}\r\n\r\n\tshowHideMoreText(): void {\r\n\t\tif (this.isTruncated) {\r\n\t\t\tthis.text = this.showingMore ? this.truncatedText.getUntruncatedText() : this.truncatedText.getTruncatedText();\r\n\t\t\tthis.linkLabel = this.showingMore ? this.lessLabel : this.moreLabel;\r\n\t\t\tthis.showingMore = !this.showingMore;\r\n\t\t}\r\n\t}\r\n\r\n\ttranslateLabels(): angular.IPromise<any> {\r\n\t\tconst promisesToResolve: angular.IPromise<any>[] = [];\r\n\t\tconst moreLink = this.$translate(this.moreLabelI18nKey).then((label: string) => {\r\n\t\t\tthis.moreLabel = this.moreLabel || label;\r\n\t\t});\r\n\t\tconst lessLink = this.$translate(this.lessLabelI18nKey).then((label: string) => {\r\n\t\t\tthis.lessLabel = this.lessLabel || label;\r\n\t\t});\r\n\t\tpromisesToResolve.push(moreLink, lessLink);\r\n\t\treturn this.$q.all(promisesToResolve);\r\n\t}\r\n}\r\n","import {SeDirective} from \"smarteditcommons/services/dependencyInjection/SeDirective\";\r\n\r\n/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n/**\r\n * @ngdoc directive\r\n * @name smarteditCommonsModule.directive:compileHtml\r\n * @scope\r\n * @restrict A\r\n * @attribute compile-html\r\n *\r\n * @description\r\n * Directive responsible for evaluating and compiling HTML markup.\r\n *\r\n * @param {String} String HTML string to be evaluated and compiled in the parent scope.\r\n * @example\r\n * <pre>\r\n *      <div compile-html=\"<a data-ng-click=\\\"injectedContext.onLink( item.path )\\\">{{ item[key.property] }}</a>\"></div>\r\n * </pre>\r\n */\r\n\r\n@SeDirective({\r\n\tselector: '[compile-html]'\r\n})\r\n/* @ngInject */\n export class CompileHtmlDirective {\r\n\r\n\tconstructor(\r\n\t\tprivate $compile: angular.ICompileService,\r\n\t\tprivate $scope: angular.IScope,\r\n\t\tprivate $element: JQuery<HTMLElement>,\r\n\t\tprivate $attrs: angular.IAttributes\r\n\t) {\r\n\t}\r\n\r\n\t$postLink() {\r\n\t\tthis.$scope.$parent.$watch(\r\n\t\t\t(scope) => scope.$eval(this.$attrs.compileHtml),\r\n\t\t\t(value) => {\r\n\t\t\t\tthis.$element.html(value);\r\n\t\t\t\tthis.$compile(this.$element.contents() as any)(this.$scope.$parent);\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './CompileHtmlDirective';","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as lo from 'lodash';\r\nimport {Payload, Primitive} from 'smarteditcommons';\r\nimport {SeInjectable} from 'smarteditcommons/services/dependencyInjection/di';\r\nexport type Cloneable = Primitive | Primitive[] | Payload;\r\n/**\r\n * @ngdoc service\r\n * @name functionsModule.service:CloneableUtils\r\n *\r\n * @description\r\n * utility service around Cloneable objects\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class CloneableUtils {\r\n\r\n\tconstructor(private lodash: lo.LoDashStatic) {\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name functionsModule.service:CloneableUtils#makeCloneable\r\n\t * @methodOf functionsModule.service:CloneableUtils\r\n\t * @description\r\n\t * returns a \"cloneable\" version of an object.\r\n\t * Something is cloneable when it can be sent through W3C postMessage.\r\n\t * To this purpose, functions must be removed from the cloneable candidate.\r\n\t * @param {Object} json the object to be made cloneable\r\n\t * @returns {Cloneable} the cloneable copy of the object\r\n\t */\r\n\tmakeCloneable(_json: any): Cloneable {\r\n\r\n\t\tconst json = this.lodash.cloneDeepWith(_json, (value) => {\r\n\t\t\tif (value !== undefined && value !== null && !this.isPrimitive(json)) {\r\n\t\t\t\t// is a promise\r\n\t\t\t\tif (value.then) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t} else if (typeof value === 'function') {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t} else if (this.lodash.isElement(value)) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t\t// is yjQuery\r\n\t\t\t\t} else if (typeof value !== 'string' && value.hasOwnProperty('length') && !value.forEach) {\r\n\t\t\t\t\treturn null;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn value;\r\n\t\t\t}\r\n\t\t});\r\n\t\tif (json === undefined || json === null || this.isPrimitive(json)) {\r\n\t\t\treturn json;\r\n\t\t} else if (json.hasOwnProperty('length') || json.forEach) { // Array, already taken care of yjQuery\r\n\t\t\treturn json.map((arrayElement: any) => this.makeCloneable(arrayElement)) as Cloneable;\r\n\t\t} else { // JSON\r\n\t\t\treturn Object.keys(json).reduce((clone, directKey) => {\r\n\t\t\t\tif (directKey.indexOf(\"$\") !== 0) {\r\n\t\t\t\t\tclone[directKey] = this.makeCloneable(json[directKey]);\r\n\t\t\t\t}\r\n\t\t\t\treturn clone;\r\n\t\t\t}, {} as Payload);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate isPrimitive(value: any) {\r\n\t\treturn typeof value === 'number' || typeof value === 'string' || typeof value === 'boolean';\r\n\t}\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * Key value pairs where the key is the permission and the value is a boolean string\r\n * Used in IPermissionsRestServiceResult\r\n */\r\nexport interface IPermissionsRestServicePair {\r\n\tkey: string;\r\n\tvalue: string;\r\n}\r\n\r\n/**\r\n * Result of getting permissions form the PermissionsRestService.get\r\n */\r\nexport interface IPermissionsRestServiceResult {\r\n\tid?: string;\r\n\tpermissions: IPermissionsRestServicePair[];\r\n}\r\n\r\n/**\r\n * The input param type for PermissionsRestService.get\r\n */\r\nexport interface IPermissionsRestServiceQueryData {\r\n\tuser: string;\r\n\tpermissionNames: string;\r\n}\r\n\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n/**\r\n * @internal\r\n * \r\n * @name TruncatedText \r\n *\r\n * @description\r\n * Model containing truncated text properties.\r\n */\r\nexport class TruncatedText {\r\n\tconstructor(private text: string = \"\", private truncatedText: string = \"\", private truncated: boolean, private ellipsis: string = \"\") {\r\n\t\t// if text/truncatedText is null, then set its value to \"\"\r\n\t\tthis.text = this.text || \"\";\r\n\t\tthis.truncatedText = this.truncatedText || \"\";\r\n\t}\r\n\r\n\tpublic getUntruncatedText(): string {\r\n\t\treturn this.text;\r\n\t}\r\n\r\n\tpublic getTruncatedText(): string {\r\n\t\treturn this.truncatedText + this.ellipsis;\r\n\t}\r\n\r\n\tpublic isTruncated(): boolean {\r\n\t\treturn this.truncated;\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * @ngdoc object\r\n * @name ValidationError.object:ValidationError\r\n * @description\r\n * An object representing the backend response for any erroy of type \"ValidationError\"\r\n */\r\nexport interface ValidationError {\r\n\tlanguage?: string;\r\n\tmessage: string;\r\n\treason: string;\r\n\tsubject: string;\r\n\tsubjectType: string;\r\n\terrorCode: string;\r\n\ttype: \"ValidationError\";\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * We are doing forced imports in order to generate the types (d.ts) of below interfaces or classes correctly.\r\n * If we don't include the below imports, as a part of webpack tree shaking, the types will not be generated.\r\n * There is an open issue in typescript github regarding forced imports\r\n * https://github.com/Microsoft/TypeScript/issues/9191\r\n * https://github.com/Microsoft/TypeScript/wiki/FAQ#why-are-imports-being-elided-in-my-emit\r\n * \r\n * If an interface X extends an interface Y, make sure X has all types it needs from Y by checking index.d.ts, if not, do force import of X and Y.\r\n */\r\nimport './Cloneable';\r\nimport './ICatalog';\r\nimport './IHomepage';\r\nimport './IPermissionsDto';\r\nimport './Page';\r\nimport './Pageable';\r\nimport './Pagination';\r\nimport './Payload';\r\nimport './Primitive';\r\nimport './TypedMap';\r\nimport './ValidationError';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport \"./forcedImport\";\r\n\r\nexport {IExtensibleResourceClass} from './IExtensibleResourceClass';\r\nexport {Cloneable, CloneableUtils} from './Cloneable';\r\nexport {Page} from './Page';\r\nexport {Pageable} from './Pageable';\r\nexport {Pagination} from './Pagination';\r\nexport {Payload} from './Payload';\r\nexport {Primitive} from './Primitive';\r\nexport {TypedMap} from './TypedMap';\r\nexport {TruncatedText} from './TruncatedText';\r\nexport {User} from './User';\r\nexport {ValidationError} from './ValidationError';\r\nexport * from './ICatalog';\r\nexport * from './IHomepage';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n// barrel\r\nexport * from './dtos';\r\nexport * from './services';\r\nexport * from './components';\r\nexport * from './directives';\r\nexport * from './modules';\r\nexport * from './utils';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './translations/translationServiceModule';","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n/** @internal */\r\nexport class TranslationFile {\r\n\tconstructor(public prefix: string, public suffix: string, public key?: string) {\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport * as lo from 'lodash';\r\nimport {IRestServiceFactory} from 'smarteditcommons/services';\r\nimport {TypedMap} from 'smarteditcommons/dtos';\r\nimport {TranslationFile} from './TranslationFile';\r\nimport {TranslationOptions} from './TranslationOptions';\r\n\r\n/** @internal */\r\nexport function $translateStaticFilesLoader($q: angular.IQService, lodash: lo.LoDashStatic, restServiceFactory: IRestServiceFactory) {\r\n\t'ngInject';\r\n\treturn initializer.bind(undefined, $q, lodash, restServiceFactory);\r\n}\r\n\r\n/*\r\n * this custom implementations of $translateStaticFilesLoader needed by 'pascalprecht.translate' package leverages\r\n * our restServiceFactory as opposed to $http in order to proxy the i18n loading to the container.\r\n * This is required for our cross-origin compliancy\r\n */\r\nfunction initializer($q: angular.IQService, lodash: lo.LoDashStatic, restServiceFactory: IRestServiceFactory, options: TranslationOptions): angular.IPromise<TypedMap<string>> {\r\n\r\n\tif (!options || (!angular.isArray(options.files) && (!angular.isString(options.prefix) || !angular.isString(options.suffix)))) {\r\n\t\tthrow new Error(\"Couldn't load translation static files, no files and prefix or suffix specified!\");\r\n\t}\r\n\r\n\toptions.files = options.files || [new TranslationFile(options.prefix, options.suffix)];\r\n\r\n\tconst load = function(file: TranslationFile): angular.IPromise<TypedMap<string>> {\r\n\r\n\t\tif (!file || (!angular.isString(file.prefix) || !angular.isString(file.suffix))) {\r\n\t\t\tthrow new Error(\"Couldn't load translation static files, no files and prefix or suffix specified!\");\r\n\t\t}\r\n\r\n\t\tlet fileUrl = [\r\n\t\t\tfile.prefix,\r\n\t\t\toptions.key,\r\n\t\t\tfile.suffix\r\n\t\t].join('');\r\n\r\n\t\tif (angular.isObject(options.fileMap) && options.fileMap[fileUrl]) {\r\n\t\t\tfileUrl = options.fileMap[fileUrl];\r\n\t\t}\r\n\r\n\t\treturn restServiceFactory.get<TypedMap<string>>(fileUrl).get(options.$http);\r\n\t};\r\n\r\n\tconst promises: angular.IPromise<TypedMap<string>>[] = options.files.map((file: TranslationFile) => {\r\n\t\treturn load(new TranslationFile(file.prefix, file.suffix, options.key));\r\n\t});\r\n\r\n\treturn $q.all(promises).then((data: TypedMap<string>[]) => {\r\n\t\tconst mergedData = {} as TypedMap<string>;\r\n\r\n\t\tdata.forEach((datum: TypedMap<string>) => {\r\n\t\t\tdelete datum.$resolved;\r\n\t\t\tdelete datum.$promise;\r\n\t\t\tlodash.merge(mergedData, datum);\r\n\t\t});\r\n\t\treturn mergedData;\r\n\t});\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {SeModule} from 'smarteditcommons/services/dependencyInjection/di';\r\nimport {$translateStaticFilesLoader} from './translateStaticFilesLoader';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name translationServiceModule\r\n *\r\n * @description\r\n * \r\n * This module is used to configure the translate service, the filter, and the directives from the 'pascalprecht.translate' package. The configuration consists of:\r\n * \r\n * <br/>- Initializing the translation map from the {@link i18nInterceptorModule.object:I18NAPIROOT I18NAPIROOT} constant.\r\n * <br/>- Setting the preferredLanguage to the {@link i18nInterceptorModule.object:UNDEFINED_LOCALE UNDEFINED_LOCALE} so that the {@link i18nInterceptorModule.service:i18nInterceptor#methods_request i18nInterceptor request} can replace it with the appropriate URI combined with the runtime browser locale retrieved from browserService.getBrowserLocale, which is unaccessible at configuration time.\r\n */\r\n\r\n@SeModule({\r\n\timports: ['pascalprecht.translate', 'i18nInterceptorModule', 'smarteditCommonsModule'],\r\n\tproviders: [$translateStaticFilesLoader],\r\n\tconfig: ($translateProvider: any, I18NAPIROOT: string, UNDEFINED_LOCALE: string) => {\r\n\t\t'ngInject';\r\n        /*\r\n         * hard coded url that is always intercepted by i18nInterceptor so as to replace by value from configuration REST call\r\n         */\r\n\t\t$translateProvider.useStaticFilesLoader({\r\n\t\t\tprefix: '/' + I18NAPIROOT + '/',\r\n\t\t\tsuffix: ''\r\n\t\t});\r\n\r\n\t\t// Tell the module what language to use by default\r\n\t\t$translateProvider.preferredLanguage(UNDEFINED_LOCALE);\r\n\r\n\t\t// Using 'escapeParameters' strategy. 'sanitize' not supported in current version.\r\n\t\t// see https://angular-translate.github.io/docs/#/guide/19_security\r\n\t\t// Note that this is the only option that should be used for now.\r\n\t\t// The options 'sanitizeParameters' and 'escape' are causing issues (& replaced by &amp; and interpolation parameters values are not displayed correctly).\r\n\t\t$translateProvider.useSanitizeValueStrategy('escapeParameters');\r\n\t},\r\n\tinitialize: (operationContextService: any, I18N_RESOURCE_URI: string, OPERATION_CONTEXT: any) => {\r\n\t\t'ngInject';\r\n\t\toperationContextService.register(I18N_RESOURCE_URI, OPERATION_CONTEXT.TOOLING);\r\n\t}\r\n})\r\nexport class TranslationServiceModule {}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as lo from 'lodash';\r\nimport {SeModule} from \"smarteditcommons/services/dependencyInjection/di\";\r\n/** @internal */\r\nfunction $exceptionHandler($log: angular.ILogService) {\r\n\t'ngInject';\r\n\r\n\tconst ignorePatterns = [\r\n\t\t/^Possibly unhandled rejection/\r\n\t];\r\n\r\n\tconst patternsForE2EErrorLogs = [\r\n\t\t/Unexpected request/, // missing http mock patterns in e2e\r\n\t\t/No more request expected/ // missing http mock patterns in e2e\r\n\t];\r\n\treturn function exceptionHandler(exception: any, cause: any) {\r\n\r\n        /*\r\n         * original exception occuring in a promise based API won't show here\r\n         * the catch set in decoration is necessary to log them\r\n         */\r\n\t\tif (ignorePatterns.some((pattern) => pattern.test(exception))) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (patternsForE2EErrorLogs.some((pattern) => pattern.test(exception))) {\r\n\t\t\t$log.error(`E2E mock issue: ${exception}`);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\t$log.error(exception);\r\n\t};\r\n}\r\n\r\nfunction isAjaxError(error: any) {\r\n\treturn error.hasOwnProperty(\"headers\");\r\n}\r\n/*\r\n * Helper function used on all known promise based Angular 1.6 APIs\r\n * to handle promise rejection in an AOP fashion through Angular decorators\r\n */\r\nfunction handlePromiseRejections(\r\n\t$q: angular.IQService,\r\n\t$log: angular.ILogService,\r\n\tlodash: lo.LoDashStatic,\r\n\tpromise: angular.IPromise<any>): angular.IPromise<any> {\r\n\r\n\tconst defaultFailureCallback = (error: any) => {\r\n\t\tif (undefined !== error && \"canceled\" !== error) {\r\n\t\t\tif (lodash.isPlainObject(error)) {\r\n\t\t\t\tif (!isAjaxError(error)) {\r\n\t\t\t\t\t$log.error(`exception caught in promise: ${JSON.stringify(error)}`);\r\n\t\t\t\t}\r\n\t\t\t} else if (!lodash.isBoolean(error)) {\r\n\t\t\t\t$log.error(error);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn $q.reject(error);\r\n\t};\r\n\r\n\tconst oldThen = promise.then;\r\n\r\n\tpromise.then = function(successCallback, _failureCallback, notifyCallback) {\r\n\t\tconst failureCallback = _failureCallback ? _failureCallback : defaultFailureCallback;\r\n\t\treturn oldThen.call(this, successCallback, failureCallback, notifyCallback);\r\n\t};\r\n\treturn promise;\r\n}\r\n\r\n/** @internal */\r\n@SeModule({\r\n\tproviders: [\r\n\t\t$exceptionHandler\r\n\t],\r\n\t/*\r\n\t * Decoration all known promise based Angular 1.6 APIs\r\n\t * to handle promise rejection in an AOP fashion\r\n\t */\r\n\tconfig: ($qProvider: angular.IQProvider, $provide: angular.auto.IProvideService) => {\r\n\t\t'ngInject';\r\n\r\n\t\t$qProvider.errorOnUnhandledRejections(true);\r\n\r\n\t\t$provide.decorator('$q', (\r\n\t\t\t$delegate: angular.IQService,\r\n\t\t\t$log: angular.ILogService,\r\n\t\t\tlodash: lo.LoDashStatic\r\n\t\t) => {\r\n\t\t\t'ngInject';\r\n\r\n\t\t\tconst originalWhen = $delegate.when;\r\n\t\t\t$delegate.when = function() {\r\n\t\t\t\tif (arguments[0] && !arguments[0].then) {\r\n\t\t\t\t\treturn handlePromiseRejections($delegate, $log, lodash, originalWhen.apply(this, arguments));\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn originalWhen.apply(this, arguments);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\r\n\t\t\tconst originalAll = $delegate.all;\r\n\t\t\t$delegate.all = function() {\r\n\t\t\t\treturn handlePromiseRejections($delegate, $log, lodash, originalAll.apply($delegate, arguments));\r\n\t\t\t};\r\n\r\n\t\t\tconst originalDefer = $delegate.defer;\r\n\t\t\t$delegate.defer = function(): angular.IDeferred<any> {\r\n\t\t\t\tconst deferred = originalDefer.bind($delegate)();\r\n\r\n\t\t\t\thandlePromiseRejections($delegate, $log, lodash, deferred.promise);\r\n\r\n\t\t\t\treturn deferred;\r\n\t\t\t};\r\n\r\n\t\t\treturn $delegate;\r\n\t\t});\r\n\r\n\t\t$provide.decorator('$timeout', (\r\n\t\t\t$delegate: angular.ITimeoutService,\r\n\t\t\t$q: angular.IQService,\r\n\t\t\t$log: angular.ILogService,\r\n\t\t\tlodash: lo.LoDashStatic\r\n\t\t) => {\r\n\t\t\t'ngInject';\r\n\r\n\t\t\tconst originalTimeout = $delegate;\r\n\r\n\t\t\tfunction wrappedTimeout() {\r\n\t\t\t\treturn handlePromiseRejections($q, $log, lodash, originalTimeout.apply($delegate, arguments));\r\n\t\t\t}\r\n\r\n\t\t\tlodash.merge(wrappedTimeout, originalTimeout);\r\n\r\n\t\t\treturn wrappedTimeout;\r\n\t\t});\r\n\t}\r\n})\r\nexport class ConfigModule {}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {TestModeService} from 'smarteditcommons';\r\nimport {SeInjectable} from './dependencyInjection/di';\r\n\r\n/* @internal */\r\n@SeInjectable()\r\n/* @ngInject */\n export class PolyfillService {\r\n\r\n\tconstructor(\r\n\t\tprivate browserService: any,\r\n\t\tprivate testModeService: TestModeService\r\n\t) {}\r\n\r\n\tisEligibleForEconomyMode(): boolean {\r\n\t\treturn this.browserService.isIE() || this.testModeService.isE2EMode();\r\n\t}\r\n\r\n\tisEligibleForExtendedView(): boolean {\r\n\t\treturn (this.browserService.isIE() || this.browserService.isFF()) || this.testModeService.isE2EMode();\r\n\t}\r\n\r\n\tisEligibleForThrottledScrolling(): boolean {\r\n\t\treturn this.browserService.isIE();\r\n\t}\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {IPrioritized} from 'smarteditcommons';\r\nimport {SeInjectable} from './dependencyInjection/di';\r\n/**\r\n * @ngdoc service\r\n * @name smarteditServicesModule.service:PriorityService\r\n * @description\r\n * The PriorityService handles arrays of {@link smarteditServicesModule.interface:IPrioritized IPrioritized} elements\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class PriorityService {\r\n\r\n\tconstructor(private encode: any) {\r\n\r\n\t}\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:PriorityService#sort<T>\r\n\t * @methodOf smarteditServicesModule.service:PriorityService\r\n\t *\r\n\t * @description\r\n\t * Will sort the candidate array by ascendign or descending priority.\r\n\t * Even if the priority is not defined for a number of elements, the sorting will still be consistent over invocations\r\n\t * @param {T[]} candidate the array of @link smarteditServicesModule.interface:IPrioritized IPrioritized} elements to be sorted\r\n\t * @param {boolean=} [ascending=true] if true, candidate will be sorted by ascending priority.\r\n\t * @returns {T[]} A promise resolving to the username,\r\n\t * previously mentioned as \"principalUID\", associated to the\r\n\t * authenticated user.\r\n\t */\r\n\tsort<T extends IPrioritized>(candidate: T[], ascending: boolean = true): T[] {\r\n\r\n\t\treturn candidate.sort((item1: IPrioritized, item2: IPrioritized) => {\r\n\t\t\tlet output: number = item1.priority - item2.priority;\r\n\t\t\tif (output === 0) {\r\n\t\t\t\toutput = this.encode(item1).localCompare(this.encode(item2));\r\n\t\t\t}\r\n\t\t\treturn output;\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport {GatewayFactory} from 'smarteditcommons';\r\nimport {SeInjectable} from './dependencyInjection/di';\r\n\r\n@SeInjectable()\r\n/* @ngInject */\n export class SmarteditBootstrapGateway {\r\n\tconstructor(gatewayFactory: GatewayFactory) {\r\n\t\treturn gatewayFactory.createGateway('smartEditBootstrap');\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {deprecate} from \"./deprecate\";\r\ndeprecate();\r\n\r\nimport {\r\n\tLanguageDropdownSelectorComponent,\r\n\tLanguageSelectorComponent,\r\n\tYEventMessageComponent,\r\n\tYInfiniteScrollingComponent,\r\n\tYMoreTextComponent\r\n} from 'smarteditcommons/components';\r\nimport {\r\n\tCompileHtmlDirective\r\n} from 'smarteditcommons/directives';\r\n\r\nimport {CrossFrameEventService} from './crossFrame/CrossFrameEventService';\r\nimport {CrossFrameEventServiceGateway} from './crossFrame/CrossFrameEventServiceGateway';\r\nimport {SystemEventService} from './SystemEventService';\r\nimport {FunctionsModule} from '../utils/functionsModule';\r\nimport {LanguageService} from './language/LanguageService';\r\nimport {LanguageServiceGateway} from './language/LanguageServiceGateway';\r\nimport {SeModule} from './dependencyInjection/di';\r\nimport {SmarteditRootModule} from './SmarteditRootModule';\r\nimport {TranslationServiceModule} from '../modules/translations/translationServiceModule';\r\nimport {FlawInjectionInterceptorModule} from './flaws/flawInjectionInterceptorModule';\r\nimport {ConfigModule} from './ConfigModule';\r\nimport {AuthorizationService} from \"smarteditcommons/services/auth/AuthorizationService\";\r\nimport {CommonsRestServiceModule} from \"smarteditcommons/services/rest/CommonsRestServiceModule\";\r\n\r\n/**\r\n * @ngdoc overview\r\n * @name smarteditCommonsModule\r\n *\r\n * @description\r\n * Module containing all the services shared within the smartedit commons.\r\n */\r\n@SeModule({\r\n\timports: [\r\n\t\tSmarteditRootModule,\r\n\t\tCommonsRestServiceModule,\r\n\t\tFunctionsModule,\r\n\t\tFlawInjectionInterceptorModule,\r\n\t\t'infinite-scroll',\r\n\t\t'resourceLocationsModule',\r\n\t\t'seConstantsModule',\r\n\t\t'yjqueryModule',\r\n\t\t'yLoDashModule',\r\n\t\tTranslationServiceModule,\r\n\t\tConfigModule,\r\n\t\t'ui.select',\r\n\t\t'ngSanitize'\r\n\t],\r\n\tproviders: [\r\n\t\tAuthorizationService,\r\n\t\tSystemEventService,\r\n\t\tCrossFrameEventServiceGateway,\r\n\t\tCrossFrameEventService,\r\n\t\tLanguageServiceGateway,\r\n\t\tLanguageService\r\n\t],\r\n\tdeclarations: [\r\n\t\tCompileHtmlDirective,\r\n\t\tYInfiniteScrollingComponent,\r\n\t\tYEventMessageComponent,\r\n\t\tYMoreTextComponent,\r\n\t\tLanguageDropdownSelectorComponent,\r\n\t\tLanguageSelectorComponent\r\n\t]\r\n})\r\nexport class SmarteditCommonsModule {}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {GatewayProxiedAnnotationFactory} from './gatewayProxiedAnnotation';\r\nimport {SeModule} from './dependencyInjection/di';\r\nimport {GatewayFactory, GatewayProxy} from './gateway';\r\nimport {OperationContextService} from './httpErrorInterceptor/default/retryInterceptor/OperationContextService';\r\nimport {OperationContextAnnotationFactory} from './httpErrorInterceptor/default/retryInterceptor/operationContextAnnotation';\r\n\r\n/**\r\n * @name smarteditRootModule\r\n *\r\n * @description\r\n * Module acts as a root module of smartedit commons module.\r\n */\r\n@SeModule({\r\n\timports: [\r\n\t\t'resourceLocationsModule',\r\n\t\t'functionsModule',\r\n\t\t'seConstantsModule',\r\n\t\t'yjqueryModule',\r\n\t\t'yLoDashModule'\r\n\t],\r\n\tproviders: [\r\n\t\tGatewayFactory,\r\n\t\tGatewayProxy,\r\n\t\tGatewayProxiedAnnotationFactory,\r\n\t\tOperationContextService,\r\n\t\tOperationContextAnnotationFactory\r\n\t],\r\n\tinitialize: (gatewayProxiedAnnotationFactory: any, operationContextAnnotationFactory: any) => {\r\n\t\t'ngInject';\r\n\t}\r\n})\r\n/** @internal */\r\nexport class SmarteditRootModule {}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport * as angular from 'angular';\r\nimport {TypedMap} from './../dtos';\r\nimport {SeInjectable} from './dependencyInjection/di';\r\n\r\nexport type EventHandler = (eventId: string, eventData?: any) => angular.IPromise<any> | any;\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditCommonsModule.service:SystemEventService\r\n * @description\r\n *\r\n * The SystemEventService is used to transmit events synchronously or asynchronously. It is supported by the SmartEdit {@link smarteditCommonsModule.service:GatewayFactory gatewayFactory} to propagate events between SmartEditContainer and SmartEdit.\r\n * It also contains options to publish events, as well as subscribe the event handlers.\r\n *\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class SystemEventService {\r\n\tprivate _eventHandlers: TypedMap<EventHandler[]>;\r\n\t/** @internal */\r\n\tconstructor(\r\n\t\tprivate $timeout: angular.ITimeoutService,\r\n\t\tprivate $q: angular.IQService,\r\n\t\tprivate $log: angular.ILogService,\r\n\t\tprivate toPromise: any\r\n\t) {\r\n\t\tthis._eventHandlers = {};\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:SystemEventService#publish\r\n     * @methodOf smarteditCommonsModule.service:SystemEventService\r\n     *\r\n     * @description\r\n     * send the event with data synchronously.\r\n     *\r\n     * @param {String} eventId The identifier of the event.\r\n     * @param {any=} data The event payload. It is optional parameter.\r\n     *\r\n     * @return {angular.IPromise<any>} A promise with resolved data of last subscriber or with the rejected error reason\r\n     */\r\n\tpublish(eventId: string, data?: any): angular.IPromise<any> {\r\n\t\tif (!eventId) {\r\n\t\t\tthis.$log.error('Failed to send event. No event ID provided for data: ' + data);\r\n\t\t} else {\r\n\t\t\tif (this._eventHandlers[eventId] && this._eventHandlers[eventId].length > 0) {\r\n\t\t\t\treturn this._invokeEventHandlers(eventId, data);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this.$q.when();\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:SystemEventService#sendSynchEvent\r\n     * @methodOf smarteditCommonsModule.service:SystemEventService\r\n     * @deprecated since 1808\r\n     * @description\r\n     * send the event with data synchronously.\r\n     *\r\n     * @param {String} eventId The identifier of the event.\r\n     * @param {any=} data The event payload. It is optional parameter.\r\n     *\r\n     * @return {angular.IPromise<any>} A promise with resolved data of last subscriber or with the rejected error reason\r\n     */\r\n\tsendSynchEvent(eventId: string, data?: any): angular.IPromise<any> {\r\n\t\treturn this.publish(eventId, data);\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:SystemEventService#publishAsync\r\n     * @methodOf smarteditCommonsModule.service:SystemEventService\r\n     *\r\n     * @description\r\n     * send the event with data asynchronously.\r\n     *\r\n     * @param {String} eventId The identifier of the event.\r\n     * @param {any=} data The event payload. It is an optional parameter.\r\n     *\r\n     * @return {angular.IPromise<any>} A deferred promise\r\n     */\r\n\tpublishAsync(eventId: string, data?: any): angular.IPromise<any> {\r\n\t\tconst deferred: angular.IDeferred<{}> = this.$q.defer();\r\n\t\tthis.$timeout(function() {\r\n\t\t\tthis.publish(eventId, data).then(\r\n\t\t\t\tfunction(resolvedData: any) {\r\n\t\t\t\t\tdeferred.resolve(resolvedData);\r\n\t\t\t\t},\r\n\t\t\t\tfunction(reason: any) {\r\n\t\t\t\t\tdeferred.reject(reason);\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t}.bind(this), 0);\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:SystemEventService#sendAsynchEvent\r\n     * @methodOf smarteditCommonsModule.service:SystemEventService \r\n     * @deprecated since 1808\r\n     * @description\r\n     * send the event with data asynchronously.\r\n     *\r\n     * @param {String} eventId The identifier of the event.\r\n     * @param {any=} data The event payload. It is an optional parameter.\r\n     *\r\n     * @return {angular.IPromise<any>} A deferred promise\r\n     */\r\n\tsendAsynchEvent(eventId: string, data?: any): angular.IPromise<any> {\r\n\t\treturn this.publishAsync(eventId, data);\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditCommonsModule.service:SystemEventService#subscribe\r\n\t * @methodOf smarteditCommonsModule.service:SystemEventService\r\n\t *\r\n\t * @description\r\n\t * method to subscribe the event handler given the eventId and handler\r\n\t * \r\n\t * @param {String} eventId The identifier of the event.\r\n\t * @param {EventHandler} handler The event handler, a callback function which can either return a promise or directly a value. \r\n\t * \r\n\t * @return {() => void} unsubscribeFn Function to unsubscribe the event handler\r\n\t */\r\n\tsubscribe(eventId: string, handler: EventHandler): () => void {\r\n\t\tlet unsubscribeFn: () => void;\r\n\t\tif (!eventId || !handler) {\r\n\t\t\tthis.$log.error('Failed to subscribe event handler for event: ' + eventId);\r\n\t\t} else {\r\n\t\t\t// create handlers array for this event if not already created\r\n\t\t\tif (this._eventHandlers[eventId] === undefined) {\r\n\t\t\t\tthis._eventHandlers[eventId] = [];\r\n\t\t\t}\r\n\t\t\tthis._eventHandlers[eventId].push(handler);\r\n\r\n\t\t\tunsubscribeFn = () => {\r\n\t\t\t\tthis._unsubscribe(eventId, handler);\r\n\t\t\t};\r\n\t\t}\r\n\t\treturn unsubscribeFn;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditCommonsModule.service:SystemEventService#registerEventHandler\r\n\t * @methodOf smarteditCommonsModule.service:SystemEventService\r\n\t * @deprecated since 1808\r\n\t * @description\r\n\t * method to subscribe the event handler given the eventId and handler\r\n\t * \r\n\t * @param {String} eventId The identifier of the event.\r\n\t * @param {EventHandler} handler The event handler, a callback function which can either return a promise or directly a value. \r\n\t * \r\n\t * @return {() => void} unsubscribeFn Function to unsubscribe the event handler\r\n\t */\r\n\tregisterEventHandler(eventId: string, handler: EventHandler): () => void {\r\n\t\treturn this.subscribe(eventId, handler);\r\n\t}\r\n\r\n\tprivate _unsubscribe(eventId: string, handler: EventHandler) {\r\n\t\tconst handlersArray = this._eventHandlers[eventId];\r\n\t\tconst index = handlersArray ? this._eventHandlers[eventId].indexOf(handler) : -1;\r\n\t\tif (index >= 0) {\r\n\t\t\tthis._eventHandlers[eventId].splice(index, 1);\r\n\t\t} else {\r\n\t\t\tthis.$log.warn('Attempting to remove event handler for ' + eventId + ' but handler not found.');\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _invokeEventHandlers(eventId: string, data?: any) {\r\n\t\treturn this.$q.all(this._eventHandlers[eventId].map((eventHandler: EventHandler) => {\r\n\t\t\tconst promiseClosure = this.toPromise(eventHandler);\r\n\t\t\treturn promiseClosure(eventId, data);\r\n\t\t})).then((results: any) => {\r\n\t\t\treturn this.$q.when(results.pop());\r\n\t\t}, (reason: any) => {\r\n\t\t\treturn this.$q.reject(reason);\r\n\t\t});\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport {SeConstructor, TypedMap} from 'smarteditcommons';\r\nimport {FunctionsUtils} from 'smarteditcommons/utils/FunctionsUtils';\r\nimport {} from 'reflect-metadata';\r\nimport * as lo from 'lodash';\r\n\r\n/**\r\n * @ngdoc object\r\n * @name NoModule.object:MethodAnnotation\r\n *\r\n * @description\r\n * Shorthand signature of a {@link https://www.typescriptlang.org/docs/handbook/decorators.html Typescript Decorator} function for methods\r\n * used by {@link NoModule.service:AnnotationService AnnotationService}.\r\n * @param {any} target the instance the method of which is annotated\r\n * @param {any} propertyName the name of the method that is annotated\r\n * @param {any} originalMethod the original method being annotated, it is prebound to the instance\r\n * @returns {any} the final return value of the proxied method.\r\n * It is left to implementers to discard, modify, reuse the original method.\r\n */\r\nexport type MethodAnnotation = (target: any, propertyName: string, originalMethod: (...x: any[]) => any, ...invocationArguments: any[]) => any;\r\n/**\r\n * @ngdoc object\r\n * @name NoModule.object:MethodAnnotationFactory\r\n *\r\n * @description\r\n * A {@link NoModule.object:MethodAnnotation MethodAnnotation} factory\r\n * used by {@link NoModule.service:AnnotationService AnnotationService}.\r\n * @param {...any[]} factoryArguments the factory arguments\r\n * @returns {MethodAnnotation} {@link NoModule.object:MethodAnnotation MethodAnnotation}\r\n */\r\nexport type MethodAnnotationFactory = (...factoryArguments: any[]) => MethodAnnotation;\r\n/**\r\n * @ngdoc object\r\n * @name NoModule.object:ClassAnnotation\r\n *\r\n * @description\r\n * Shorthand signature of a {@link https://www.typescriptlang.org/docs/handbook/decorators.html Typescript Decorator} function for classes\r\n * used by {@link NoModule.service:AnnotationService AnnotationService}.\r\n * @param {any} instance an instance of the class which is annotated\r\n * @param {(...x: any[]) => any} originalConstructor the prebound original constructor of the instance\r\n * @param {...any[]} invocationArguments the arguments with which the constructor is invoked\r\n * @returns {any} void or a new instance.\r\n * It is left to implementers to discard, modify, or reuse the original constructor then not to return or return a new instance.\r\n */\r\nexport type ClassAnnotation = (instance: any, originalConstructor: (...x: any[]) => any, ...invocationArguments: any[]) => any;\r\n/**\r\n * @ngdoc object\r\n * @name NoModule.object:ClassAnnotationFactory\r\n *\r\n * @description\r\n * A {@link NoModule.object:ClassAnnotation ClassAnnotation} factory\r\n * used by {@link NoModule.service:AnnotationService AnnotationService}.\r\n * @param {...any[]} factoryArguments the factory arguments\r\n * @returns {ClassAnnotation} {@link NoModule.object:ClassAnnotation ClassAnnotation}\r\n */\r\nexport type ClassAnnotationFactory = (...x: any[]) => ClassAnnotation;\r\n\r\n/** @internal */\r\nenum annotationType {\r\n\tClass = 'classAnnotation',\r\n\tMethod = 'MethodAnnotation'\r\n}\r\n\r\nconst lodash: lo.LoDashStatic = (window as any).smarteditLodash;\r\n\r\n/**\r\n * @ngdoc service\r\n * @name NoModule.service:AnnotationService\r\n *\r\n * @description\r\n * Utility service to declare and consume method level and class level {@link https://www.typescriptlang.org/docs/handbook/decorators.html Typescript decorator factories}.\r\n * <br/>Since Decorator is a reserved word in Smartedit, Typescript Decorators are called as Annotations.\r\n */\r\nexport class AnnotationService {\r\n\r\n\tpublic readonly INJECTABLE_NAME_KEY = \"getInjectableName\";\r\n\tpublic readonly ORIGINAL_CONSTRUCTOR_KEY = \"originalConstructor\";\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#getClassAnnotations\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Retrieves an object with all the string-indexed annotations defined on the given class target\r\n\t * @param {any} target The typescript class on which class annotations are defined\r\n\t * @returns {[index: string]: any} an object contains string-indexed annotation name and payload\r\n\t */\r\n\tgetClassAnnotations = lodash.memoize(this.getClassAnnotationsLogic);\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#getMethodAnnotations\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Retrieves an object with all the string indexed annotations defined on the given class method\r\n\t * @param {any} target The typescript class to the inspected\r\n\t * @param {string} propertyName The name of the method on which annotations are defined\r\n\t * @returns {[index: string]: any} an object contains string-indexed annotation name and payload\r\n\t */\r\n\tgetMethodAnnotations = lodash.memoize(this.getMethodAnnotationsLogic, function(target: any, propertyName: string) {\r\n\t\treturn JSON.stringify(target.prototype) + propertyName;\r\n\t});\r\n\r\n\tprivate functionsUtils: FunctionsUtils = new FunctionsUtils();\r\n\r\n\tprivate annotationFactoryMap = {} as TypedMap<MethodAnnotationFactory | ClassAnnotationFactory>;\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#getClassAnnotation\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Retrieves arguments of class annotation under a given annotation name\r\n\t * @param {any} target The typescript class on which class annotation is defined\r\n\t * @param {(args?: any) => ClassDecorator} annotation The type of the class annotation\r\n\t * @returns {any} the payload passed to the annotation\r\n\t */\r\n\tgetClassAnnotation(target: any, annotation: (args?: any) => ClassDecorator): any {\r\n\t\tconst annotationMap: TypedMap<any> = this.getClassAnnotations(target);\r\n\t\tconst annotationName: string = (annotation as any).annotationName;\r\n\t\tif (annotationMap) {\r\n\t\t\tif (annotationName in annotationMap) {\r\n\t\t\t\treturn annotationMap[annotationName];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#getMethodAnnotation\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Retrieves arguments of method annotation for a given typescript class\r\n\t * @param {any} target The typescript class\r\n\t * @param {string} propertyName The name of the method on which annotation is defined\r\n\t * @param {(args?: any) => MethodDecorator)} annotation The type of the method annotation\r\n\t * @returns {any} the payload passed to the annotation\r\n\t */\r\n\tgetMethodAnnotation(target: any, propertyName: string, annotation: (args?: any) => MethodDecorator): any {\r\n\t\tconst annotationMap: TypedMap<any> = this.getMethodAnnotations(target, propertyName);\r\n\t\tconst annotationName: string = (annotation as any).annotationName;\r\n\t\tif (annotationMap) {\r\n\t\t\tif (annotationName in annotationMap) {\r\n\t\t\t\treturn annotationMap[annotationName];\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#hasClassAnnotation\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Determines whether a given class target has given annotation name defined or not\r\n\t * @param {any} target The typescript class on which class annotation is defined\r\n\t * @param {(args?: any) => ClassDecorator} annotation The type of the class annotation\r\n\t * @returns {boolean} true if a given target has given annotation name. Otherwise false.\r\n\t */\r\n\thasClassAnnotation(target: any, annotation: (args?: any) => ClassDecorator): boolean {\r\n\t\tconst annotationMap: TypedMap<any> = this.getClassAnnotations(target);\r\n\t\treturn ((annotation as any).annotationName in annotationMap) ? true : false;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#hasMethodAnnotation\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Determines whether a given method name has given annotation name defined or not under a given typescript class\r\n\t * @param {any} target The typescript class object\r\n\t * @param {string} propertyName The name of the method on which annotation is defined\r\n\t * @param {(args?: any) => MethodDecorator} annotation The type of the method annotation\r\n\t * @returns {boolean} true if a given method name has given annotation name. Otherwise false.\r\n\t */\r\n\thasMethodAnnotation(target: any, propertyName: string, annotation: (args?: any) => MethodDecorator): boolean {\r\n\t\tconst annotationMap: TypedMap<any> = this.getMethodAnnotations(target, propertyName);\r\n\t\treturn ((annotation as any).annotationName in annotationMap) ? true : false;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#setClassAnnotationFactory\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Registers a {@link NoModule.object:ClassAnnotationFactory ClassAnnotationFactory} under a given name.\r\n\t * <br/>Typically, in order for the ClassAnnotationFactory to benefit from Angular dependency injection, this method will be called within an Angular factory.\r\n\t * @param {string} name the name of the factory.\r\n\t * @returns {ClassAnnotationFactory} a {@link NoModule.object:ClassAnnotationFactory ClassAnnotationFactory}\r\n\t */\r\n\tsetClassAnnotationFactory(name: string, annotationFactory: ClassAnnotationFactory): ClassAnnotationFactory {\r\n\t\tthis.annotationFactoryMap[name] = annotationFactory;\r\n\t\treturn annotationFactory;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#getClassAnnotationFactory\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Retrieves a {@link NoModule.object:ClassAnnotationFactory ClassAnnotationFactory}\r\n\t * previously registered under the given name:\r\n\t * \r\n\t * <pre>\r\n\t *   export const GatewayProxied = annotationService.getClassAnnotationFactory('GatewayProxied');\r\n\t * </pre>\r\n\t * \r\n\t * @param {string} name The name of the factory\r\n\t * @returns {ClassAnnotationFactory} a {@link NoModule.object:ClassAnnotationFactory ClassAnnotationFactory}\r\n\t */\r\n\r\n\r\n\tgetClassAnnotationFactory(name: string): (...args: any[]) => ClassDecorator {\r\n\t\tconst instance = this;\r\n\r\n\t\tconst classAnnotationFactory = function(...factoryArgument: any[]) {\r\n\r\n\t\t\treturn function(originalConstructor: any) {\r\n\r\n\t\t\t\tconst newConstructor = instance.functionsUtils.extendsConstructor(originalConstructor, function(...args: any[]) {\r\n\r\n\t\t\t\t\tconst annotationFactory = instance.annotationFactoryMap[name] as ClassAnnotationFactory;\r\n\t\t\t\t\tif (annotationFactory) {\r\n\t\t\t\t\t\t// Note: Before we used to bind originalConstructor.bind(this). However, it had to be left up to the caller \r\n\t\t\t\t\t\t// since that causes problems in IE; when a function is bound in IE, the browser wraps it in a function with \r\n\t\t\t\t\t\t// native code, making it impossible to retrieve its name. \r\n\t\t\t\t\t\tconst result = annotationFactory(factoryArgument)(this, originalConstructor, args);\r\n\t\t\t\t\t\tif (result) {\r\n\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(`annotation '${name}' is used on '${originalConstructor.name}' but its ClassAnnotationFactory may not have been added to the dependency injection`);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (instance.functionsUtils.hasArguments(originalConstructor) && !originalConstructor.$inject && !instance.functionsUtils.isUnitTestMode()) {\r\n\t\t\t\t\tthrow new Error(`${originalConstructor.name} class was decorated with annotation ${name} but has probably not been annotated with @SeInjectable() or @SeComponent`);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t/*\r\n\t\t\t\t * enable angular to inject this new constructor even though it has an empty signature\r\n\t\t\t\t * by copying $inject property\r\n\t\t\t\t * For idempotency purposes we copy all properties anyways\r\n\t\t\t\t */\r\n\t\t\t\tlodash.merge(newConstructor, originalConstructor);\r\n\r\n\t\t\t\tconst rootOriginalConstructor = instance.getOriginalConstructor(originalConstructor);\r\n\r\n\t\t\t\tReflect.defineMetadata(instance.ORIGINAL_CONSTRUCTOR_KEY, rootOriginalConstructor, newConstructor);\r\n\r\n\t\t\t\tReflect.defineMetadata(annotationType.Class + ':' + name, factoryArgument, rootOriginalConstructor);\r\n\r\n\t\t\t\t// override original constructor\r\n\t\t\t\treturn newConstructor;\r\n\t\t\t};\r\n\t\t};\r\n\t\t(classAnnotationFactory as any).annotationName = name;\r\n\t\treturn classAnnotationFactory;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#setMethodAnnotationFactory\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Registers a {@link NoModule.object:MethodAnnotationFactory MethodAnnotationFactory} under a given name.\r\n\t * <br/>Typically, in order for the MethodAnnotationFactory to benefit from Angular dependency injection, this method will be called within an Angular factory.\r\n\t * @param {string} name The name of the factory.\r\n\t * @returns {MethodAnnotationFactory} a {@link NoModule.object:MethodAnnotationFactory MethodAnnotationFactory}\r\n\t */\r\n\tsetMethodAnnotationFactory(name: string, annotationFactory: MethodAnnotationFactory): MethodAnnotationFactory {\r\n\t\tthis.annotationFactoryMap[name] = annotationFactory;\r\n\t\treturn annotationFactory;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#getMethodAnnotationFactory\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Retrieves a method level {@link NoModule.object:MethodAnnotationFactory MethodAnnotationFactory}\r\n\t * previously registered under the given name:\r\n\t * \r\n\t * <pre>\r\n\t *   export const Cached = annotationService.getMethodAnnotationFactory('Cached');\r\n\t * </pre>\r\n\t * \r\n\t * @param {string} name the name of the factory.\r\n\t * @returns {MethodAnnotationFactory} a {@link NoModule.object:MethodAnnotationFactory MethodAnnotationFactory}.\r\n\t */\r\n\tgetMethodAnnotationFactory(name: string) {\r\n\t\tconst instance = this;\r\n\r\n\t\tconst methodAnnotationFactory = function(...factoryArgument: any[]) {\r\n\r\n\t\t\t/*\r\n\t\t\t * when decorating an abstract class, strangely enough target is an instance of the abstract class\r\n\t\t\t * we need pass \"this\" instead to the annotationFactory invocation\r\n\t\t\t */\r\n\t\t\treturn (target: any, propertyName: string, descriptor: TypedPropertyDescriptor<(...x: any[]) => any>) => {\r\n\r\n\t\t\t\tconst originalMethod = descriptor.value;\r\n\r\n\t\t\t\tdescriptor.value = function() {\r\n\t\t\t\t\tconst annotationFactory: MethodAnnotationFactory = instance.annotationFactoryMap[name] as MethodAnnotationFactory;\r\n\r\n\t\t\t\t\tif (annotationFactory) {\r\n\t\t\t\t\t\treturn annotationFactory(factoryArgument)(this, propertyName, originalMethod.bind(this), arguments);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error(`annotation '${name}' is used but its MethodAnnotationFactory may not have been added to the dependency injection`);\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\r\n\t\t\t\tReflect.defineMetadata(annotationType.Method + ':' + name, factoryArgument, target, propertyName);\r\n\t\t\t};\r\n\t\t};\r\n\t\t(methodAnnotationFactory as any).annotationName = name;\r\n\t\treturn methodAnnotationFactory;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name NoModule.service:AnnotationService#getOriginalConstructor\r\n\t * @methodOf NoModule.service:AnnotationService\r\n\t * \r\n\t * @description\r\n\t * Given a class constructor, returns the original constructor of it prior to any class level\r\n\t * proxying by annotations declared through {@link NoModule.service:AnnotationService AnnotationService}\r\n\t * \r\n\t * @param {SeConstructor} target the constructor\r\n\t */\r\n\tpublic getOriginalConstructor(target: any): SeConstructor {\r\n\t\treturn Reflect.getMetadata(this.ORIGINAL_CONSTRUCTOR_KEY, target) || target;\r\n\t}\r\n\r\n\tprivate getClassAnnotationsLogic(target: any): TypedMap<any> {\r\n\t\tconst originalConstructor = this.getOriginalConstructor(target);\r\n\t\tconst annotationMap: TypedMap<any> = {};\r\n\r\n\t\tReflect.getMetadataKeys(originalConstructor)\r\n\t\t\t.filter((key: string) => key.toString().startsWith(annotationType.Class))\r\n\t\t\t.map((key: string) => {\r\n\t\t\t\tannotationMap[key.split(':')[1]] = Reflect.getMetadata(key, originalConstructor);\r\n\t\t\t});\r\n\t\treturn annotationMap;\r\n\t}\r\n\r\n\tprivate getMethodAnnotationsLogic(target: any, propertyName: string): TypedMap<any> {\r\n\t\tconst annotationMap: TypedMap<any> = {};\r\n\r\n\t\tReflect.getMetadataKeys(target.prototype, propertyName)\r\n\t\t\t.filter((key: string) => key.toString().startsWith(annotationType.Method))\r\n\t\t\t.map((key: string) => {\r\n\t\t\t\tannotationMap[key.split(':')[1]] = Reflect.getMetadata(key, target.prototype, propertyName);\r\n\t\t\t});\r\n\r\n\t\treturn annotationMap;\r\n\t}\r\n\r\n}\r\n\r\n'se:smarteditcommons';\r\nexport const annotationService: AnnotationService = new AnnotationService();\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.annotationService = annotationService;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {SeInjectable} from 'smarteditcommons/services/dependencyInjection/di';\r\nimport {PermissionsRestService} from 'smarteditcommons/services/rest/PermissionsRestService';\r\nimport {ISessionService} from 'smarteditcommons/services/interfaces/ISessionService';\r\nimport {\r\n\tIPermissionsRestServicePair,\r\n\tIPermissionsRestServiceResult\r\n} from 'smarteditcommons/dtos/IPermissionsDto';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditCommonsModule.service.AuthorizationService\r\n *\r\n * @description\r\n * This service makes calls to the Global Permissions REST API to check if the current user was\r\n * granted certain permissions.\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class AuthorizationService {\r\n\r\n\tpublic static ERR_INVALID_PERMISSION_NAMES = new Error('permissionNames must be a non-empty array');\r\n\r\n\tconstructor(\r\n\t\tprivate $log: angular.ILogService,\r\n\t\tprivate sessionService: ISessionService,\r\n\t\tprivate permissionsRestService: PermissionsRestService) {\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service.AuthorizationService#hasGlobalPermissions\r\n     * @methodOf smarteditCommonsModule.service.AuthorizationService\r\n     *\r\n     * @description\r\n     * This method checks if the current user is granted the given global permissions.\r\n     *\r\n     * @param {String[]} permissionNames The list of global permissions to check.\r\n     * \r\n     * @return {Boolean} true if the user is granted all of the given permissions, false otherwise\r\n     * \r\n     * @throws Will throw an error if the permissionNames array is empty\r\n     */\r\n\tpublic hasGlobalPermissions(permissionNames: string[]): angular.IPromise<boolean> {\r\n\r\n\t\tif (!permissionNames.length || permissionNames.length < 1) {\r\n\t\t\tthrow AuthorizationService.ERR_INVALID_PERMISSION_NAMES;\r\n\t\t}\r\n\r\n\t\tconst onSuccess = (permissions: IPermissionsRestServiceResult) => {\r\n\t\t\treturn this.mergePermissionResults(permissions, permissionNames);\r\n\t\t};\r\n\r\n\t\tconst onError = () => {\r\n\t\t\tthis.$log.error('AuthorizationService - Failed to determine authorization for the following permissions: ' + permissionNames.toString());\r\n\t\t\treturn false;\r\n\t\t};\r\n\r\n\t\treturn this.getPermissions(permissionNames).then(onSuccess, onError);\r\n\t}\r\n\r\n    /*\r\n     * This method will look for the result for the given permission name. If found, it is\r\n     * verified that it has been granted. Otherwise, the method will return false.\r\n     */\r\n\tprivate getPermissionResult(permissionResults: IPermissionsRestServiceResult, permissionName: string) {\r\n\t\tconst permission: IPermissionsRestServicePair = permissionResults.permissions.find((result: IPermissionsRestServicePair) => result.key.toLowerCase() === permissionName.toLowerCase());\r\n\r\n\t\treturn !!permission && permission.value === 'true';\r\n\t}\r\n\r\n    /*\r\n     * This method merges permission results. It iterates through the list of permission names that\r\n     * were checked and evaluates if the permission is granted. It immediately returns false when\r\n     * it encounters a permission that is denied.\r\n     */\r\n\tprivate mergePermissionResults(permissionResults: IPermissionsRestServiceResult, permissionNames: string[]) {\r\n\t\tlet hasPermission = !!permissionNames && permissionNames.length > 0;\r\n\t\tlet index = 0;\r\n\r\n\t\twhile (hasPermission && index < permissionNames.length) {\r\n\t\t\thasPermission = hasPermission && this.getPermissionResult(permissionResults, permissionNames[index++]);\r\n\t\t}\r\n\r\n\t\treturn hasPermission;\r\n\t}\r\n\r\n    /*\r\n     * This method makes a call to the Global Permissions API with the given permission names\r\n     * and returns the list of results.\r\n     */\r\n\tprivate getPermissions(permissionNames: string[]): angular.IPromise<IPermissionsRestServiceResult> {\r\n\t\treturn this.sessionService.getCurrentUsername().then((user: string) => {\r\n\t\t\tif (!user) {\r\n\t\t\t\treturn {permissions: []};\r\n\t\t\t}\r\n\t\t\treturn this.permissionsRestService.get({\r\n\t\t\t\tuser,\r\n\t\t\t\tpermissionNames: permissionNames.join(',')\r\n\t\t\t}).then((response: IPermissionsRestServiceResult) => {\r\n\t\t\t\treturn response;\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:CacheAction\r\n * @description\r\n * A {@link smarteditServicesModule.object:@Cached @Cached} annotation is associated to a CacheAction.\r\n */\r\nexport class CacheAction {\r\n\r\n\tpublic name: string;\r\n\r\n\tconstructor(name: string) {\r\n\t\tthis.name = name;\r\n\t}\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport * as lo from 'lodash';\r\nimport {CacheAction} from './CacheAction';\r\nimport {EvictionTag} from './EvictionTag';\r\nimport {IMetadata} from './engine/interfaces';\r\nimport {\r\n\tCacheEngine,\r\n\tCrossFrameEventService,\r\n\tDefaultCacheTiming,\r\n\tICacheItem,\r\n\tICacheTiming,\r\n\tRarelyChangingContentName,\r\n\tSeInjectable\r\n} from 'smarteditcommons/services';\r\nimport {Cloneable} from 'smarteditcommons/dtos';\r\nimport {FunctionsUtils} from \"smarteditcommons\";\r\n\r\nexport type ICachePredicate = (cacheActions: CacheAction[]) => boolean;\r\n\r\n/** @internal */\r\ninterface IPredicateRegistry {\r\n\ttest: ICachePredicate;\r\n\tcacheTiming: ICacheTiming;\r\n}\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditServicesModule.service:CacheService\r\n * @description\r\n * Service to which the {@link smarteditServicesModule.object:@Cached @Cached} and {@link smarteditServicesModule.object:@InvalidateCache @InvalidateCache} annotations delegate to perform service method level caching.\r\n * It is not handled explicitly except for its evict method.\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class CacheService {\r\n\r\n\tprivate predicatesRegistry: IPredicateRegistry[] = [];\r\n\tprivate eventListeners: string[] = [];\r\n\r\n\t/** @internal */\r\n\tconstructor(\r\n\t\tprivate $q: angular.IQService,\r\n\t\tprivate $log: angular.ILogService,\r\n\t\tprivate lodash: lo.LoDashStatic,\r\n\t\tprivate encode: (obj: any) => string,\r\n\t\tprivate functionsUtils: FunctionsUtils,\r\n\t\tprivate crossFrameEventService: CrossFrameEventService,\r\n\t\tprivate cacheEngine: CacheEngine) {\r\n\t\tthis.registerDefaultCacheTimings();\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:CacheService#register\r\n\t * @methodOf smarteditServicesModule.service:CacheService\r\n\t * \r\n\t * @description\r\n\t * Register a new predicate with it's associated cacheTiming.\r\n\t * Each time the @Cache annotation is handled, the CacheService try to find a matching cacheTiming for the given cacheActions.\r\n\t * \r\n\t * @param {ICachePredicate} test This function takes the cacheActions {@link smarteditServicesModule.object:CacheAction CacheAction} argument, and must return a Boolean that is true if the given cacheActions match the predicate.\r\n\t * @param {ICacheTiming} cacheTiming This function is used to call setAge(item: ICacheItem<any>) on the cached item.\r\n\t * \r\n\t * @return {CacheService} CacheService The CacheService instance.\r\n\t * \r\n\t * @example\r\n\t * ```ts\r\n\t * export class CustomCacheTiming implements ICacheTiming {\r\n\t * \tprivate expirationAge: number;\r\n\t * \tprivate refreshAge: number;\r\n\t *  constructor(expirationAge: number, refreshAge: number) {\r\n\t * \t\t// The cached response is discarded if it is older than the expiration age.\r\n\t * \t\tthis.expirationAge = expirationAge;\r\n\t * \t\t// maximum age for the cached response to be considered \"fresh.\"\r\n\t * \t\tthis.refreshAge = refreshAge;\r\n\t * \t}\r\n\t * \tsetAge(item: ICacheItem<any>): void {\r\n\t * \t\titem.expirationAge = this.expirationAge;\r\n\t * \t\titem.refreshAge = this.refreshAge;\r\n\t * \t}\r\n\t * \t};\r\n\t * \tconst customCacheTiming = new CustomCacheTiming(30 * 60000, 15 * 60000);\r\n\t * \tconst customContentPredicate: ICachePredicate = (cacheActions: CacheAction[]) => {\r\n\t * \t\treturn cacheActions.find((cacheAction) => cacheAction.name === 'CUSTOM_TAG') !== null;\r\n\t * \t};\r\n\t * this.register(customContentPredicate, customCacheTiming);\r\n\t * ```\r\n\t */\r\n\tpublic register(test: ICachePredicate, cacheTiming: ICacheTiming): CacheService {\r\n\t\tthis.predicatesRegistry.unshift({\r\n\t\t\ttest,\r\n\t\t\tcacheTiming\r\n\t\t});\r\n\t\treturn this;\r\n\t}\r\n\r\n\t/**\r\n\t * public method but only meant to be used by @Cache annotation\r\n\t */\r\n\tpublic handle<T extends IMetadata>(service: any, methodName: string, preboundMethod: (...args: any[]) => T, invocationArguments: any[], cacheActions: CacheAction[], tags: EvictionTag[]): angular.IPromise<T> {\r\n\r\n\t\tconst constructorName = this.functionsUtils.getInstanceConstructorName(service);\r\n\t\tconst cachedItemId: string = window.btoa(constructorName + methodName) + this.encode(invocationArguments);\r\n\r\n\t\tconst _item: ICacheItem<any> = this.cacheEngine.getItemById(cachedItemId);\r\n\t\tconst item: ICacheItem<any> = _item || {\r\n\t\t\tid: cachedItemId,\r\n\t\t\ttimestamp: new Date().getTime(),\r\n\t\t\tevictionTags: this.collectEventNamesFromTags(tags),\r\n\t\t\tcache: null,\r\n\t\t\texpirationAge: null,\r\n\t\t\trefreshAge: null\r\n\t\t};\r\n\r\n\t\tif (!_item) {\r\n\t\t\tconst cacheTiming: ICacheTiming = this.findCacheTimingByCacheActions(cacheActions);\r\n\t\t\tif (!cacheTiming) {\r\n\t\t\t\tthrow new Error('CacheService::handle - No predicate match.');\r\n\t\t\t}\r\n\t\t\tcacheTiming.setAge(item);\r\n\r\n\t\t\tthis.cacheEngine.addItem(item, cacheTiming, preboundMethod.bind(undefined, ...invocationArguments));\r\n\r\n\t\t\tthis.listenForEvictionByTags(tags);\r\n\t\t}\r\n\r\n\t\treturn this.cacheEngine.handle(item);\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:CacheService#evict\r\n\t * @methodOf  smarteditServicesModule.service:CacheService\r\n\t * @description\r\n\t * Will evict the entire cache of all methods of all services referencing either directly or indirectly the given {@link smarteditServicesModule.object:EvictionTag EvictionTags}\r\n\t * @param {...EvictionTag[]} evictionTags the {@link smarteditServicesModule.object:EvictionTag EvictionTags}\r\n\t */\r\n\tpublic evict(...evictionTags: EvictionTag[]): void {\r\n\t\tconst tags: string[] = this.collectEventNamesFromTags(evictionTags);\r\n\t\tthis.cacheEngine.evict(...tags);\r\n\t}\r\n\r\n\tprotected listenForEvictionByTags(tags: EvictionTag[]): void {\r\n\t\tthis.collectEventNamesFromTags(tags).filter((eventId) => {\r\n\t\t\treturn this.eventListeners.indexOf(eventId) === -1;\r\n\t\t}).forEach((eventId) => {\r\n\t\t\tthis.$log.debug(`registering event listener ${eventId}`);\r\n\t\t\tthis.eventListeners.push(eventId);\r\n\t\t\tthis.crossFrameEventService.subscribe(eventId, (evt: string, data: Cloneable) => {\r\n\t\t\t\tthis.$log.debug(`cleaning cache on event ${eventId}`);\r\n\t\t\t\tthis.cacheEngine.evict(eventId);\r\n\t\t\t\treturn this.$q.when<Cloneable>({});\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\tprotected collectEventNamesFromTags(tags: EvictionTag[]): string[] {\r\n\t\tif (tags && tags.length) {\r\n\t\t\treturn this.lodash.union(...tags.map((t) => this.collectEventNamesFromTag(t)));\r\n\t\t} else {\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\tprotected collectEventNamesFromTag(tag: EvictionTag): string[] {\r\n\t\treturn this.lodash.union([tag.event], ...(tag.relatedTags ? tag.relatedTags.map((t) => this.collectEventNamesFromTag(t)) : []));\r\n\t}\r\n\r\n\tprotected findCacheTimingByCacheActions(cacheActions: CacheAction[]): ICacheTiming {\r\n\t\tconst predicate: IPredicateRegistry = this.predicatesRegistry.find((cacheTimingPredicate) => cacheTimingPredicate.test(cacheActions));\r\n\t\treturn predicate ? predicate.cacheTiming : null;\r\n\t}\r\n\r\n\tprotected registerDefaultCacheTimings(): void {\r\n\t\tconst defaultCacheTiming = new DefaultCacheTiming(24 * 60 * 60 * 1000, 12 * 60 * 60 * 1000);\r\n\t\tconst rarelyChangingContentPredicate: ICachePredicate = (cacheActions: CacheAction[]) => {\r\n\t\t\treturn cacheActions.find((cacheAction) => cacheAction.name === RarelyChangingContentName) !== null;\r\n\t\t};\r\n\t\tthis.register(rarelyChangingContentPredicate, defaultCacheTiming);\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:EvictionTag\r\n * @description\r\n * A {@link smarteditServicesModule.object:@Cached @Cached} annotation is tagged with 0 to n EvictionTag, each EvictionTag possibly referencing other evictionTags.\r\n * <br/>An EvictionTag enables a method cache to be evicted 2 different ways:\r\n * <ul>\r\n * <li> An event with the same name as the tag is raised.</li>\r\n * <li> {@link smarteditServicesModule.service:CacheService#methods_evict evict} method of {@link smarteditServicesModule.service:CacheService cacheService} is invoked with the tag.</li>\r\n * </ul>\r\n */\r\nexport class EvictionTag {\r\n\r\n    /**\r\n     * @ngdoc property\r\n     * @name name\r\n     * @propertyOf smarteditServicesModule.object:EvictionTag\r\n     * @description\r\n     * event upon which the cache should be cleared.\r\n     */\r\n\tpublic event: string;\r\n\r\n    /**\r\n     * @ngdoc property\r\n     * @name relatedTags\r\n     * @propertyOf smarteditServicesModule.object:EvictionTag\r\n     * @description\r\n     * other EvictionTag instances grouped under this evictionTag.\r\n     */\r\n\tpublic relatedTags?: EvictionTag[];\r\n\r\n\tconstructor(args: {event: string, relatedTags?: EvictionTag[]}) {\r\n\t\tthis.event = args.event;\r\n\t\tthis.relatedTags = args.relatedTags;\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {CacheAction} from '../CacheAction';\r\n\r\n'se:smarteditcommons';\r\nexport const FrequentlyChangingContentName: string = 'FrequentlyChangingContent';\r\n\r\n'se:smarteditcommons';\r\nexport const frequentlyChangingContent = new CacheAction(FrequentlyChangingContentName);\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.FrequentlyChangingContentName = FrequentlyChangingContentName;\n(window as any).smarteditcommons.frequentlyChangingContent = frequentlyChangingContent;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './frequentlyChangingContent';\r\nexport * from './rarelyChangingContent';","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {CacheAction} from '../CacheAction';\r\n\r\n'se:smarteditcommons';\r\n/** @internal */\r\nexport const RarelyChangingContentName: string = 'RarelyChangingContent';\r\n\r\n'se:smarteditcommons';\r\nexport const rarelyChangingContent = new CacheAction(RarelyChangingContentName);\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.RarelyChangingContentName = RarelyChangingContentName;\n(window as any).smarteditcommons.rarelyChangingContent = rarelyChangingContent;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {annotationService} from '../annotationService';\r\nimport {CacheAction} from './CacheAction';\r\nimport {EvictionTag} from './EvictionTag';\r\nimport {CacheService} from './CacheService';\r\nimport * as lo from 'lodash';\r\nimport {functionsUtils} from \"../../utils/FunctionsUtils\";\r\n\r\nconst lodash: lo.LoDashStatic = (window as any).smarteditLodash;\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n///////////////////////////////// CACHE CONFIG ////////////////////////////////\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\nconst cacheConfigAnnotationName = \"CacheConfig\";\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:@CacheConfig\r\n * @description\r\n * Class level typescript {@link http://www.typescriptlang.org/docs/handbook/decorators.html decorator factory} responsible for setting\r\n *  class level cache configuration to be merged into method specific {@link smarteditServicesModule.object:@Cached @Cached} and \r\n *  {@link smarteditServicesModule.object:@InvalidateCache @InvalidateCache} configurations.\r\n * @param {object} cacheConfig the configuration fo this cache\r\n * @param {cacheAction} cacheConfig.actions the list of {@link smarteditServicesModule.object:CacheAction CacheAction} characterizing this cache.\r\n * @param {EvictionTag[]} cacheConfig.tags a list of {@link smarteditServicesModule.object:EvictionTag EvictionTag} to control the eviction behaviour of this cache.\r\n */\r\n'se:smarteditcommons';\r\nexport const CacheConfig = annotationService.getClassAnnotationFactory(cacheConfigAnnotationName) as (args: {actions?: CacheAction[], tags?: EvictionTag[]}) => ClassDecorator;\r\n\r\n'se:smarteditcommons';\r\nexport function CacheConfigAnnotationFactory($log: angular.ILogService) {\r\n\t'ngInject';\r\n\treturn annotationService.setClassAnnotationFactory(cacheConfigAnnotationName, (factoryArguments: [{actions: CacheAction[], tags?: EvictionTag[]}]) => {\r\n\t\treturn function(instance: any, originalConstructor: (...x: any[]) => any, invocationArguments: any[]) {\r\n\t\t\toriginalConstructor.call(instance, ...invocationArguments);\r\n\r\n\t\t\tinstance.cacheConfig = factoryArguments[0];\r\n\r\n\t\t\t$log.debug(`adding cache config ${JSON.stringify(instance.cacheConfig)} to class ${functionsUtils.getInstanceConstructorName(instance)}`, instance);\r\n\t\t};\r\n\t});\r\n}\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n//////////////////////////////////// CACHE ////////////////////////////////////\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\nconst CachedAnnotationName = 'Cached';\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:@Cached\r\n * @description\r\n * Method level typescript {@link http://www.typescriptlang.org/docs/handbook/decorators.html decorator factory} responsible for performing\r\n * invocation arguments sensitive method caching.\r\n * <br/> This annotation must only be used on methods returning promises.\r\n * @param {object} cacheConfig the configuration fo this cache\r\n * <br/> This configuration will be merged with a class level {@link smarteditServicesModule.object:@CacheConfig @acheConfig} if any.\r\n * @throws if no {@link smarteditServicesModule.object:CacheAction CacheAction} is found in the resulting merge\r\n * @param {cacheAction} cacheConfig.actions the list of {@link smarteditServicesModule.object:CacheAction CacheAction} characterizing this cache.\r\n * @param {EvictionTag[]} cacheConfig.tags a list of {@link smarteditServicesModule.object:EvictionTag EvictionTag} to control the eviction behaviour of this cache.\r\n */\r\n'se:smarteditcommons';\r\nexport const Cached = annotationService.getMethodAnnotationFactory(CachedAnnotationName) as (args?: {actions: CacheAction[], tags?: EvictionTag[]}) => MethodDecorator;\r\n\r\n'se:smarteditcommons';\r\nexport function CachedAnnotationFactory(cacheService: CacheService) {\r\n\t'ngInject';\r\n\treturn annotationService.setMethodAnnotationFactory(CachedAnnotationName, (factoryArguments: [{actions: CacheAction[], tags?: EvictionTag[]}]) => {\r\n\r\n\t\treturn function(target: any, propertyName: string, originalMethod: (...x: any[]) => any, invocationArguments: IArguments) {\r\n\r\n\t\t\tlet actions: CacheAction[] = [];\r\n\t\t\tlet tags: EvictionTag[] = [];\r\n\r\n\t\t\tif (factoryArguments[0]) {\r\n\t\t\t\tactions = factoryArguments[0].actions;\r\n\t\t\t\ttags = factoryArguments[0].tags;\r\n\t\t\t}\r\n\r\n\t\t\tif (target.cacheConfig) {\r\n\t\t\t\tif (target.cacheConfig.actions) {\r\n\t\t\t\t\tactions = lodash.uniq(actions.concat(target.cacheConfig.actions));\r\n\t\t\t\t}\r\n\t\t\t\tif (target.cacheConfig.tags) {\r\n\t\t\t\t\ttags = lodash.uniq(tags.concat(target.cacheConfig.tags));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (!actions.length) {\r\n\t\t\t\tconst constructorName = functionsUtils.getInstanceConstructorName(target);\r\n\t\t\t\tthrow new Error(`method ${propertyName} of ${constructorName} is @Cached annotated but no CacheAction is specified either through @Cached or through class level @CacheConfig annotation`);\r\n\t\t\t}\r\n\t\t\treturn cacheService.handle(target, propertyName, originalMethod, Array.prototype.slice.apply(invocationArguments), actions, tags);\r\n\t\t};\r\n\t});\r\n}\r\n///////////////////////////////////////////////////////////////////////////////\r\n////////////////////////////// INVALIDATE CACHE ///////////////////////////////\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\nconst InvalidateCacheName = 'InvalidateCache';\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:@InvalidateCache\r\n * @description\r\n * Method level typescript {@link http://www.typescriptlang.org/docs/handbook/decorators.html decorator factory} responsible for\r\n * invalidating all caches either directly or indirectly declaring the {@link smarteditServicesModule.object:EvictionTag eviction tag} passed as argument.\r\n * if no eviction tag is passed as argument, defaults to the optional eviction tags passed to the class through {@link smarteditServicesModule.object:@CacheConfig @CacheConfig}.\r\n * \r\n * @param {EvictionTag} evictionTag the {@link smarteditServicesModule.object:EvictionTag eviction tag}.\r\n */\r\n'se:smarteditcommons';\r\nexport const InvalidateCache = function(tag?: EvictionTag) {\r\n\treturn annotationService.getMethodAnnotationFactory(InvalidateCacheName)(tag);\r\n};\r\n\r\n'se:smarteditcommons';\r\nexport function InvalidateCacheAnnotationFactory(cacheService: CacheService) {\r\n\t'ngInject';\r\n\treturn annotationService.setMethodAnnotationFactory(InvalidateCacheName, (factoryArguments: [EvictionTag]) => {\r\n\r\n\t\treturn function(target: any, propertyName: string, originalMethod: (...x: any[]) => any, invocationArguments: IArguments) {\r\n\r\n\t\t\tlet tags: EvictionTag[] = [];\r\n\r\n\t\t\tconst tag: EvictionTag = factoryArguments[0];\r\n\t\t\tif (!tag) {\r\n\t\t\t\tif (target.cacheConfig && target.cacheConfig.tags) {\r\n\t\t\t\t\ttags = target.cacheConfig.tags;\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\ttags = [tag];\r\n\t\t\t}\r\n\r\n\t\t\tif (!tags.length) {\r\n\t\t\t\tthrow new Error(`method ${propertyName} of ${target.constructor.name} is @InvalidateCache annotated but no EvictionTag is specified either through @InvalidateCache or through class level @CacheConfig annotation`);\r\n\t\t\t}\r\n\r\n\t\t\tconst returnedObject = originalMethod.apply(undefined, invocationArguments);\r\n\t\t\tif (returnedObject && returnedObject.then) {\r\n\t\t\t\treturn returnedObject.then((value: any) => {\r\n\t\t\t\t\tcacheService.evict(...tags);\r\n\t\t\t\t\treturn value;\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tcacheService.evict(...tags);\r\n\t\t\t\treturn returnedObject;\r\n\t\t\t}\r\n\r\n\t\t};\r\n\t});\r\n}\r\n\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.CacheConfig = CacheConfig;\n(window as any).smarteditcommons.CacheConfigAnnotationFactory = CacheConfigAnnotationFactory;\n(window as any).smarteditcommons.Cached = Cached;\n(window as any).smarteditcommons.CachedAnnotationFactory = CachedAnnotationFactory;\n(window as any).smarteditcommons.InvalidateCache = InvalidateCache;\n(window as any).smarteditcommons.InvalidateCacheAnnotationFactory = InvalidateCacheAnnotationFactory;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {ICacheItem, ICacheTiming, IMetadata} from \"./interfaces\";\r\n\r\n/** @internal */\r\nexport interface ICacheItemRegistry {\r\n\titem: ICacheItem<any>;\r\n\tcacheTiming: ICacheTiming;\r\n\tcompleted: boolean;\r\n\tprocessing: boolean;\r\n\tdefer: any;\r\n\trefresh<T>(): angular.IPromise<T>;\r\n}\r\n\r\n/** @internal */\r\n/** @ngInject */\r\nexport class CacheEngine {\r\n\tprivate static readonly BACKGROUND_REFRESH_INTERVAL: number = 10000;\r\n\tprivate cachedItemsRegistry: ICacheItemRegistry[] = [];\r\n\r\n\tconstructor(\r\n\t\tprivate $q: angular.IQService,\r\n\t\tprivate $log: angular.ILogService) {\r\n\t\tthis.startBackgroundMonitoringJob();\r\n\t}\r\n\r\n\tpublic addItem(item: ICacheItem<any>, cacheTiming: ICacheTiming, refresh: <T>() => angular.IPromise<T>): void {\r\n\t\tif (this.getItemIndex(item) === -1) {\r\n\t\t\tthis.cachedItemsRegistry.push({\r\n\t\t\t\titem,\r\n\t\t\t\tcacheTiming,\r\n\t\t\t\trefresh,\r\n\t\t\t\tcompleted: false,\r\n\t\t\t\tprocessing: false,\r\n\t\t\t\tdefer: this.$q.defer()\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tthis.$log.warn(`CacheEngine - item already exist for id: ${item.id}`);\r\n\t\t}\r\n\t}\r\n\r\n\tpublic getItemById(id: string): ICacheItem<any> {\r\n\t\tconst match = this.cachedItemsRegistry.find((obj) => obj.item.id === id);\r\n\t\treturn match ? match.item : null;\r\n\t}\r\n\r\n\tpublic handle<T>(item: ICacheItem<any>): angular.IPromise<T> {\r\n\t\tconst obj = this.cachedItemsRegistry[this.getItemIndex(item)];\r\n\t\tif (obj.completed && !this.hasExpired(item)) {\r\n\t\t\tobj.defer.resolve(item.cache);\r\n\t\t} else if (!obj.processing) {\r\n\t\t\tobj.processing = true;\r\n\t\t\tthis.refreshCache(obj);\r\n\t\t}\r\n\t\treturn obj.defer.promise;\r\n\t}\r\n\r\n\tpublic evict(...tags: string[]): void {\r\n\t\ttags.forEach((tag) => {\r\n\t\t\tthis.cachedItemsRegistry\r\n\t\t\t\t.filter((obj) => obj.item.evictionTags.indexOf(tag) > -1)\r\n\t\t\t\t.forEach((obj) => this.cachedItemsRegistry.splice(this.getItemIndex(obj.item), 1));\r\n\t\t});\r\n\t}\r\n\r\n\t// regularly go though cache data and call prebound methods to refresh data when needed.\r\n\tprotected startBackgroundMonitoringJob(): void {\r\n\t\tsetInterval(() => {\r\n\t\t\tthis.cachedItemsRegistry\r\n\t\t\t\t.filter((obj) => this.needRefresh(obj.item))\r\n\t\t\t\t.forEach((obj) => this.refreshCache(obj));\r\n\t\t}, CacheEngine.BACKGROUND_REFRESH_INTERVAL);\r\n\t}\r\n\r\n\tprotected refreshCache<T>(obj: ICacheItemRegistry): void {\r\n\t\tobj.refresh().then((value: IMetadata) => {\r\n\t\t\t// TODO: read value.metadata to refresh expiry/refresh ages.\r\n\t\t\tobj.cacheTiming.setAge(obj.item);\r\n\t\t\tobj.item.cache = value;\r\n\t\t\tobj.item.timestamp = new Date().getTime();\r\n\t\t\tobj.completed = true;\r\n\t\t\tobj.processing = false;\r\n\t\t\tobj.defer.resolve(value);\r\n\t\t}, (e: any) => {\r\n\t\t\tthis.$log.error(`CacheEngine - unable to refresh cache for id: ${obj.item.id}`, e);\r\n\t\t\tdelete obj.item.cache;\r\n\t\t\tobj.defer.reject(e);\r\n\t\t});\r\n\t}\r\n\r\n\tprivate hasExpired(item: ICacheItem<any>): boolean {\r\n\t\treturn (item.timestamp + item.expirationAge) <= new Date().getTime();\r\n\t}\r\n\r\n\tprivate needRefresh(item: ICacheItem<any>): boolean {\r\n\t\treturn (item.timestamp + item.refreshAge) <= new Date().getTime();\r\n\t}\r\n\r\n\tprivate getItemIndex(item: ICacheItem<any>): number {\r\n\t\treturn this.cachedItemsRegistry.findIndex((o) => o.item.id === item.id);\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {ICacheItem, ICacheTiming} from \"./interfaces\";\r\n\r\nexport class DefaultCacheTiming implements ICacheTiming {\r\n\tprivate expirationAge: number;\r\n\tprivate refreshAge: number;\r\n\r\n\tconstructor(expirationAge: number, refreshAge: number) {\r\n\t\t// The cached response is discarded if it is older than the expiration age.\r\n\t\tthis.expirationAge = expirationAge;\r\n\r\n\t\t// maximum age for the cached response to be considered \"fresh.\"\r\n\t\tthis.refreshAge = refreshAge;\r\n\t}\r\n\r\n\tsetAge(item: ICacheItem<any>): void {\r\n\t\titem.expirationAge = this.expirationAge;\r\n\t\titem.refreshAge = this.refreshAge;\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './CacheEngine';\r\nexport * from './DefaultCacheTiming';\r\nexport * from './interfaces';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './cachedAnnotation';\r\nexport * from './CacheAction';\r\nexport * from './CacheService';\r\nexport * from './EvictionTag';\r\nexport * from './actions';\r\nexport * from './engine';\r\nexport * from './tags';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {EvictionTag} from '../EvictionTag';\r\n\r\n// TODO : merge the EVENT strings and the tag ones\r\n'se:smarteditcommons';\r\nexport const authorizationEvictionTag = new EvictionTag({event: \"AUTHORIZATION_SUCCESS\"});\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.authorizationEvictionTag = authorizationEvictionTag;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {EvictionTag} from '../EvictionTag';\r\nimport {userEvictionTag} from './userEvictionTag';\r\n\r\n'se:smarteditcommons';\r\nexport const catalogSyncedEvictionTag = new EvictionTag({event: \"CATALOG_SYNCHRONIZED_EVENT\"});\r\n'se:smarteditcommons';\r\nexport const catalogEvictionTag = new EvictionTag({event: \"CATALOG_EVENT\", relatedTags: [catalogSyncedEvictionTag, userEvictionTag]});\r\n\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.catalogSyncedEvictionTag = catalogSyncedEvictionTag;\n(window as any).smarteditcommons.catalogEvictionTag = catalogEvictionTag;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {EvictionTag} from '../EvictionTag';\r\n\r\n'se:smarteditcommons';\r\nexport const contentCatalogUpdateEvictionTag = new EvictionTag({event: \"EVENT_CONTENT_CATALOG_UPDATE\"});\r\n\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.contentCatalogUpdateEvictionTag = contentCatalogUpdateEvictionTag;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './authorizationEvictionTag';\r\nexport * from './catalogEvictionTag';\r\nexport * from './pageEvictionTag';\r\nexport * from './userEvictionTag';\r\nexport * from './contentCatalogUpdateEvictionTag';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {EvictionTag} from '../EvictionTag';\r\n\r\n'se:smarteditcommons';\r\nexport const pageCreationEvictionTag = new EvictionTag({event: \"PAGE_CREATED_EVENT\"});\r\n'se:smarteditcommons';\r\nexport const pageDeletionEvictionTag = new EvictionTag({event: \"PAGE_DELETED_EVENT\"});\r\n'se:smarteditcommons';\r\nexport const pageUpdateEvictionTag = new EvictionTag({event: \"PAGE_UPDATED_EVENT\"});\r\n'se:smarteditcommons';\r\nexport const pageRestoredEvictionTag = new EvictionTag({event: \"PAGE_RESTORED_EVENT\"});\r\n'se:smarteditcommons';\r\nexport const pageChangeEvictionTag = new EvictionTag({event: \"PAGE_CHANGE\"});\r\n'se:smarteditcommons';\r\nexport const pageEvictionTag = new EvictionTag({event: \"pageEvictionTag\", relatedTags: [pageCreationEvictionTag, pageDeletionEvictionTag, pageUpdateEvictionTag]});\r\n\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.pageCreationEvictionTag = pageCreationEvictionTag;\n(window as any).smarteditcommons.pageDeletionEvictionTag = pageDeletionEvictionTag;\n(window as any).smarteditcommons.pageUpdateEvictionTag = pageUpdateEvictionTag;\n(window as any).smarteditcommons.pageRestoredEvictionTag = pageRestoredEvictionTag;\n(window as any).smarteditcommons.pageChangeEvictionTag = pageChangeEvictionTag;\n(window as any).smarteditcommons.pageEvictionTag = pageEvictionTag;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {EvictionTag} from '../EvictionTag';\r\n// TODO : merge the EVENT strings and the tag ones\r\nexport const userEvictionTag = new EvictionTag({event: \"USER_HAS_CHANGED\"});","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {MessageGateway, SystemEventService, WindowUtils} from 'smarteditcommons';\r\nimport {SeInjectable} from '../dependencyInjection/di';\r\nimport {Cloneable} from '../../dtos';\r\nimport {CloneableEventHandler} from '../gateway';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditCommonsModule.service:CrossFrameEventService\r\n *\r\n * @description\r\n * The Cross Frame Event Service is responsible for publishing and subscribing events within and between frames.\r\n * It uses {@link smarteditCommonsModule.service:GatewayFactory gatewayFactory} and {@link smarteditCommonsModule.service:SystemEventService EventService} to transmit events.\r\n * \r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class CrossFrameEventService {\r\n\r\n\t/** @internal */\r\n\tconstructor(\r\n\t\tprivate $q: angular.IQService,\r\n\t\tprivate systemEventService: SystemEventService,\r\n\t\tprivate crossFrameEventServiceGateway: MessageGateway,\r\n\t\tprivate windowUtils: WindowUtils,\r\n\t) {}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:CrossFrameEventService#publish\r\n     * @methodOf smarteditCommonsModule.service:CrossFrameEventService\r\n     *\r\n     * @description\r\n     * Publishes an event within and across the gateway.\r\n     *\r\n     * The publish method is used to send events using {@link smarteditCommonsModule.SystemEventService#publishAsync publishAsync} of\r\n     * {@link smarteditCommonsModule.SystemEventService SystemEventService} and as well send the message across the gateway by using \r\n     * {@link smarteditCommonsModule.service:MessageGateway#publish publish} of the {@link smarteditCommonsModule.service:GatewayFactory gatewayFactory}.\r\n     *\r\n     * @param {String} eventId Event identifier\r\n     * @param {any=} data The event payload. It is an optional paramter.\r\n     * @returns {angular.IPromise<[any, any]>} Promise to resolve\r\n     */\r\n\tpublish(eventId: string, data?: any): angular.IPromise<any[]> {\r\n\t\tconst promises = [this.systemEventService.publishAsync(eventId, data)];\r\n\r\n\t\tif (this.windowUtils.getTargetIFrame()) {\r\n\t\t\tpromises.push(this.crossFrameEventServiceGateway.publish(eventId, data));\r\n\t\t}\r\n\r\n\t\treturn this.$q.all(promises);\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:CrossFrameEventService#subscribe\r\n     * @methodOf smarteditCommonsModule.service:CrossFrameEventService\r\n     *\r\n     * @description\r\n     * Subscribe to an event across both frames.\r\n     *\r\n     * The subscribe method is used to register for listening to events using subscribe method of\r\n     * {@link smarteditCommonsModule.SystemEventService SystemEventService} and as well send the registration message across the gateway by using \r\n     * {@link smarteditCommonsModule.service:MessageGateway#subscribe subscribe} of the {@link smarteditCommonsModule.service:GatewayFactory gatewayFactory}.\r\n     *\r\n     * @param {String} eventId Event identifier\r\n     * @param {CloneableEventHandler} handler Callback function to be invoked\r\n     * @returns {() => void} The function to call in order to unsubscribe the event listening; this will unsubscribe both from the systemEventService and the crossFrameEventServiceGatway\r\n     */\r\n\tsubscribe<T extends Cloneable>(eventId: string, handler: CloneableEventHandler<T>): () => void {\r\n\t\tconst systemEventServiceUnsubscribeFn = this.systemEventService.subscribe(eventId, handler);\r\n\t\tconst crossFrameEventServiceGatewayUnsubscribeFn = this.crossFrameEventServiceGateway.subscribe(eventId, handler);\r\n\r\n\t\tconst unsubscribeFn = function() {\r\n\t\t\tsystemEventServiceUnsubscribeFn();\r\n\t\t\tcrossFrameEventServiceGatewayUnsubscribeFn();\r\n\t\t};\r\n\r\n\t\treturn unsubscribeFn;\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport {GatewayFactory} from 'smarteditcommons';\r\nimport {SeInjectable} from '../dependencyInjection/di';\r\n\r\n/** @internal */\r\n@SeInjectable()\r\n/* @ngInject */\n export class CrossFrameEventServiceGateway {\r\n\tconstructor(\r\n\t\tCROSS_FRAME_EVENT: string,\r\n\t\tgatewayFactory: GatewayFactory\r\n\t) {\r\n\t\treturn gatewayFactory.createGateway(CROSS_FRAME_EVENT);\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {functionsUtils} from 'smarteditcommons/utils/FunctionsUtils';\r\n\r\nimport {SeConstructor, SeFactory, SeValueProvider} from './types';\r\nimport {annotationService} from '../annotationService';\r\n\r\n/** @internal */\r\nexport class DINameUtils {\r\n\r\n\tbuildComponentName(componentConstructor: SeConstructor): string {\r\n\t\treturn this.buildName(componentConstructor).replace(/Component$/, '').replace(/Directive$/, '');\r\n\t}\r\n\r\n\tbuildServiceName(serviceConstructor: SeConstructor | SeFactory): string {\r\n\t\treturn this.buildName(serviceConstructor);\r\n\t}\r\n\r\n\t// builds the DI recipe name for a given construtor\r\n\tbuildName(constructor: SeConstructor | SeFactory): string {\r\n\t\tconst originalConstructor = annotationService.getOriginalConstructor(constructor);\r\n\t\tconst originalName = functionsUtils.getConstructorName(originalConstructor);\r\n\t\treturn this.convertNameCasing(originalName);\r\n\t}\r\n\r\n\t// converts the first character to lower case\r\n\tconvertNameCasing(originalName: string): string {\r\n\t\tconst builtName = originalName.substring(0, 1).toLowerCase() + originalName.substring(1);\r\n\t\treturn builtName;\r\n\t}\r\n\r\n\t/*\r\n\t * This method will generate a SeValueProvider from a shortHand map built off a variable:\r\n\t * if a variable x (or DEFAULT_x) equals 5, then the method will return \r\n\t * { provide : 'x', useValue: 5} when it is passed {x}\r\n\t */\r\n\t/* forbiddenNameSpaces useValue:false */\r\n\tmakeValueProvider(variableShortHand: {[index: string]: any}): SeValueProvider {\r\n\t\tconst fullKey = Object.keys(variableShortHand)[0];\r\n\t\tconst key = fullKey.replace(/^DEFAULT_/, \"\");\r\n\t\treturn {\r\n\t\t\tprovide: key,\r\n\t\t\tuseValue: variableShortHand[fullKey]\r\n\t\t};\r\n\t}\r\n\r\n}\r\n\r\n'se:smarteditcommons';\r\nexport const diNameUtils = new DINameUtils();\r\n\r\n\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.diNameUtils = diNameUtils;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nexport interface IChangesObject<T> {\r\n\tcurrentValue: T;\r\n\tpreviousValue: T;\r\n\tisFirstChange(): boolean;\r\n}\r\n\r\nexport interface IOnChangesObject {\r\n\t[property: string]: IChangesObject<any>;\r\n}\r\n\r\nexport interface ISeComponent {\r\n\r\n    /**\r\n     * Called on each controller after all the controllers on an element have been constructed and had their bindings\r\n     * initialized (and before the pre & post linking functions for the directives on this element). This is a good\r\n     * place to put initialization code for your controller.\r\n     */\r\n\t$onInit?(): void;\r\n    /**\r\n     * Called on each turn of the digest cycle. Provides an opportunity to detect and act on changes.\r\n     * Any actions that you wish to take in response to the changes that you detect must be invoked from this hook;\r\n     * implementing this has no effect on when `$onChanges` is called. For example, this hook could be useful if you wish\r\n     * to perform a deep equality check, or to check a `Date object, changes to which would not be detected by Angular's\r\n     * change detector and thus not trigger `$onChanges`. This hook is invoked with no arguments; if detecting changes,\r\n     * you must store the previous value(s) for comparison to the current values.\r\n     */\r\n\t$doCheck?(): void;\r\n    /**\r\n     * Called whenever one-way bindings are updated. The onChangesObj is a hash whose keys are the names of the bound\r\n     * properties that have changed, and the values are an {@link IChangesObject} object  of the form\r\n     * { currentValue, previousValue, isFirstChange() }. Use this hook to trigger updates within a component such as\r\n     * cloning the bound value to prevent accidental mutation of the outer value.\r\n     */\r\n\t$onChanges?(onChangesObj: IOnChangesObject): void;\r\n    /**\r\n     * Called on a controller when its containing scope is destroyed. Use this hook for releasing external resources,\r\n     * watches and event handlers.\r\n     */\r\n\t$onDestroy?(): void;\r\n    /**\r\n     * Called after this controller's element and its children have been linked. Similar to the post-link function this\r\n     * hook can be used to set up DOM event handlers and do direct DOM manipulation. Note that child elements that contain\r\n     * templateUrl directives will not have been compiled and linked since they are waiting for their template to load\r\n     * asynchronously and their own compilation and linking has been suspended until that occurs.\r\n     */\r\n\t$postLink?(): void;\r\n\r\n\t// IController implementations frequently do not implement any of its methods.\r\n\t// A string indexer indicates to TypeScript not to issue a weak type error in this case.\r\n\t[index: string]: any;\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {SeComponentConstructor, SeComponentDefinition} from './types';\r\nimport {parseDirectiveBindings, parseDirectiveName} from './SeDirective';\r\nimport {functionsUtils} from 'smarteditcommons/utils/FunctionsUtils';\r\nimport {TypedMap} from \"smarteditcommons\";\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:@SeComponent\r\n *\r\n * @description\r\n * Class level typescript {@link http://www.typescriptlang.org/docs/handbook/decorators.html decorator factory}\r\n * used to declare a Smartedit web component from a Depencency injection standpoint.\r\n * The controller alias will be $ctrl.\r\n * inherits properties from {@link smarteditServicesModule.object:@SeDirective}\r\n * @param {object} definition the component definition\r\n * @param {string?} definition.templateUrl the HTML file location for this component\r\n * @param {string?} definition.template the inline HTML template for this component\r\n * @param {object?} definition.entryComponents the array of {@link smarteditServicesModule.object:@SeComponent @SeComponent} that this new one requires.\r\n * @param {object} definition.providers the list of {@link smarteditServicesModule.interface:SeClassProvider service classes},\r\n * {@link smarteditServicesModule.interface:SeFactoryProvider service factories}, {@link smarteditServicesModule.interface:SeValueProvider value},\r\n * or multi providers to be injected into the component.\r\n */\r\n'se:smarteditcommons';\r\nexport const SeComponent = function(definition: SeComponentDefinition) {\r\n\treturn function <T extends SeComponentConstructor>(componentConstructor: T) {\r\n\r\n\t\tconst component: angular.IComponentOptions = {\r\n\t\t\tcontroller: componentConstructor,\r\n\t\t\tcontrollerAs: '$ctrl',\r\n\t\t\ttransclude: true,\r\n\t\t\tbindings: parseDirectiveBindings(definition.inputs),\r\n\t\t\trequire: definition.require as TypedMap<string>\r\n\t\t};\r\n\r\n\t\tif (definition.templateUrl) {\r\n\t\t\tcomponent.templateUrl = definition.templateUrl;\r\n\t\t} else if (definition.template) {\r\n\t\t\tcomponent.template = definition.template;\r\n\t\t}\r\n\t\tconst nameSet = parseDirectiveName(definition.selector, componentConstructor);\r\n\r\n\t\tif (nameSet.restrict !== \"E\") {\r\n\t\t\tconst componentName = functionsUtils.getConstructorName(componentConstructor);\r\n\t\t\tthrow new Error(`component ${componentName} declared a selector on class or attribute. version 1808 of Smartedit DI limits SeComponents to element selectors`);\r\n\t\t}\r\n\r\n\t\tcomponentConstructor.componentName = nameSet.name;\r\n\t\tcomponentConstructor.definition = component;\r\n\r\n\t\t// will be browsed by owning @SeModule\r\n\t\tcomponentConstructor.entryComponents = definition.entryComponents;\r\n\t\tcomponentConstructor.providers = definition.providers;\r\n\r\n\t\treturn componentConstructor;\r\n\t};\r\n};\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.SeComponent = SeComponent;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {TypedMap} from 'smarteditcommons';\r\nimport {functionsUtils} from 'smarteditcommons/utils/FunctionsUtils';\r\nimport {SeConstructor, SeDirectiveConstructor, SeDirectiveDefinition} from './types';\r\nimport {diNameUtils} from './DINameUtils';\r\n\r\n/** @internal */\r\nexport const parseDirectiveBindings = function(inputs: string[]) {\r\n\tlet bindings: TypedMap<string>;\r\n\r\n\tif (inputs && (inputs as any).length) {\r\n\t\tbindings = inputs.reduce((seed: any, element) => {\r\n\t\t\tconst values = element.replace(/\\s/g, \"\").split(\":\");\r\n\t\t\tlet bindingProperty = values[values.length - 1];\r\n\t\t\tif (!bindingProperty.startsWith(\"@\")\r\n\t\t\t\t&& !bindingProperty.startsWith(\"&\")\r\n\t\t\t\t&& !bindingProperty.startsWith(\"=\")) {\r\n\t\t\t\tbindingProperty = '<' + bindingProperty;\r\n\t\t\t}\r\n\t\t\tseed[values[0]] = bindingProperty;\r\n\t\t\treturn seed;\r\n\t\t}, {});\r\n\t}\r\n\treturn bindings;\r\n};\r\n\r\n/** @internal */\r\nexport const parseDirectiveName = function(selector: string, seContructor: SeConstructor): {name: string, restrict: string} {\r\n\r\n\tconst attributeDirectiveNamePattern = /^\\[([-\\w]+)\\]$/;\r\n\tconst elementDirectiveNamePattern = /^([-\\w]+)$/;\r\n\tconst lodash = (window as any).smarteditLodash;\r\n\r\n\tif (!selector) {\r\n\t\treturn {name: diNameUtils.buildComponentName(seContructor), restrict: \"E\"};\r\n\t} else if (selector.startsWith(\".\")) {\r\n\t\treturn {name: lodash.camelCase(selector.substring(1)), restrict: \"C\"};\r\n\t} else if (attributeDirectiveNamePattern.test(selector)) {\r\n\t\treturn {name: lodash.camelCase(attributeDirectiveNamePattern.exec(selector)[1]), restrict: \"A\"};\r\n\t} else if (elementDirectiveNamePattern.test(selector)) {\r\n\t\treturn {name: lodash.camelCase(elementDirectiveNamePattern.exec(selector)[1]), restrict: \"E\"};\r\n\t} else {\r\n\t\tconst directiveClassName = functionsUtils.getConstructorName(seContructor);\r\n\t\tthrow new Error(`SeDirective ${directiveClassName} declared an unexpected selector (${selector}). \r\n\t\tMake sure to use an element name or class (.class) or attribute ([attribute])`);\r\n\t}\r\n};\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:@SeDirective\r\n *\r\n * @description\r\n * Class level typescript {@link http://www.typescriptlang.org/docs/handbook/decorators.html decorator factory}\r\n * used to declare a Smartedit web directive from a Depencency injection standpoint.\r\n * This directive will have an isolated scope and will bind its properties to its controller\r\n * @param {object} definition the component definition\r\n * @param {string?} definition.selector The CSS selector that triggers the instantiation of a directive.\r\n * selector may be declared as one of the following:\r\n * <ul>\r\n * <li>element-name: select by element name.</li>\r\n * <li>.class: select by class name.</li>\r\n * <li>[attribute]: select by attribute name.</li>\r\n * </ul>\r\n * If no selector is set, will default to an element named as the lower camel case of the component class.\r\n * @param {string[]?} definition.inputs the array of input data binding\r\n * The inputs property defines a set of directiveProperty to bindingProperty configuration:\r\n * <ul>\r\n * <li>directiveProperty specifies the component property where the value is written.</li>\r\n * <li>bindingProperty specifies the binding type and/or the DOM property where the value is read from.</li>\r\n * binding type is legacy support for \"@\", \"&\" and \"=\" of Angular 1.x\r\n * </ul>\r\n * example: inputs: ['bankName', 'id: account-id']\r\n * @param {object} definition.providers the list of {@link smarteditServicesModule.interface:SeClassProvider service classes},\r\n * {@link smarteditServicesModule.interface:SeFactoryProvider service factories}, {@link smarteditServicesModule.interface:SeValueProvider value},\r\n * or multi providers to be injected into the component.\r\n */\r\n'se:smarteditcommons';\r\nexport const SeDirective = function(definition: SeDirectiveDefinition) {\r\n\treturn function(directiveConstructor: SeDirectiveConstructor) {\r\n\r\n\t\tconst directive: angular.IDirective = {\r\n\t\t\tcontroller: directiveConstructor,\r\n\t\t\tscope: {},\r\n\t\t\tbindToController: parseDirectiveBindings(definition.inputs) || true,\r\n\t\t\trequire: definition.require\r\n\t\t};\r\n\r\n\t\tconst nameSet = parseDirectiveName(definition.selector, directiveConstructor);\r\n\r\n\t\tdirective.restrict = nameSet.restrict;\r\n\r\n\t\tdirectiveConstructor.directiveName = nameSet.name;\r\n\t\tdirectiveConstructor.definition = directive;\r\n\r\n\t\t// will be browsed by owning @SeModule\r\n\t\tdirectiveConstructor.providers = definition.providers;\r\n\r\n\t\treturn directiveConstructor;\r\n\t};\r\n};\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.parseDirectiveBindings = parseDirectiveBindings;\n(window as any).smarteditcommons.parseDirectiveName = parseDirectiveName;\n(window as any).smarteditcommons.SeDirective = SeDirective;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:@SeInjectable()\r\n *\r\n * @description\r\n * Class level typescript {@link http://www.typescriptlang.org/docs/handbook/decorators.html decorator factory}\r\n * used to declare a Smartedit injectable service from a Dependency injection standpoint.\r\n * When multiple class annotations are used, {@link smarteditServicesModule.object:@SeInjectable() @SeInjectable()} must be closest to the class declaration.\r\n */\r\n'se:smarteditcommons';\r\nexport const SeInjectable = function() {\r\n\treturn function(providerConstructor: any) {\r\n\t\treturn providerConstructor;\r\n\t};\r\n};\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.SeInjectable = SeInjectable;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n/* forbiddenNameSpaces angular.module:false */\r\nimport * as angular from 'angular';\r\nimport {functionsUtils} from 'smarteditcommons/utils/FunctionsUtils';\r\nimport {diNameUtils} from './DINameUtils';\r\nimport {\r\n\tSeBaseProvider,\r\n\tSeClassProvider,\r\n\tSeComponentConstructor,\r\n\tSeConstructor,\r\n\tSeDirectiveConstructor,\r\n\tSeFactory,\r\n\tSeFactoryProvider,\r\n\tSeModuleConstructor,\r\n\tSeModuleWithProviders,\r\n\tSeProvider,\r\n\tSeValueProvider\r\n} from \"./types\";\r\n\r\nconst MultiProviderMap: {\r\n\t[key: string]: string[]\r\n} = {};\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:@SeModule\r\n *\r\n * @description\r\n * Class level typescript {@link http://www.typescriptlang.org/docs/handbook/decorators.html decorator factory}\r\n * used to declare a Smartedit module from a Dependency injection standpoint.\r\n *\r\n * To create a configurable module, create a static method returning an SeModuleWithProvider object. The module\r\n * can then be imported by a parent module returning the SeModuleWithProvider object from the static method.\r\n * \r\n * @param {object} definition the module definition\r\n * @param {object} definition.declarations the array of {@link smarteditServicesModule.object:@SeDirective @SeDirective} and {@link smarteditServicesModule.object:@SeComponent @SeComponent} on which this new {@link smarteditServicesModule.object:@SeModule @SeModule} depends.\r\n * @param {object} definition.imports the array of modules on which this new module depends.\r\n * <br/> This is a mixed array of string (legacy approach) and {@link smarteditServicesModule.object:@SeModule @SeModule} annotated classes (recommended approach).\r\n * @param {object} definition.providers the list of {@link smarteditServicesModule.interface:SeClassProvider service classes},\r\n * {@link smarteditServicesModule.interface:SeFactoryProvider service factories}, {@link smarteditServicesModule.interface:SeValueProvider value},\r\n * or multi providers to be injected into this new module.\r\n * @param {Array} definition.config the injectable callback to be executed at configuration time\r\n * @param {Array} definition.initialize the injectable callback to be executed at startup time\r\n */\r\n\r\n'se:smarteditcommons';\r\nexport const SeModule = function(definition: {\r\n\tdeclarations?: (SeDirectiveConstructor | SeComponentConstructor)[],\r\n\timports?: (string | SeModuleConstructor | SeModuleWithProviders)[],\r\n\tproviders?: SeProvider[],\r\n\tconfig?: (...args: any[]) => void,\r\n\tinitialize?: (...args: any[]) => void\r\n}) {\r\n\treturn function <T extends SeModuleConstructor>(moduleConstructor: T) {\r\n\r\n\t\tconst seModuleName = diNameUtils.buildName(moduleConstructor);\r\n\t\tconst angularInstance = getAngular();\r\n\t\tconst allImports: string[] = [];\r\n\r\n\t\tif (definition.imports) {\r\n\t\t\tdefinition.imports.forEach((importStatement, index) => {\r\n\r\n\t\t\t\tconst throwUnAnnotatedModuleError = (seModule: SeModuleConstructor) => {\r\n\t\t\t\t\tconst importedModule = diNameUtils.buildName(seModule);\r\n\t\t\t\t\tthrow new Error(`${importedModule} module was imported into ${seModuleName} module but doesn't seem to have been @SeModule annotated`);\r\n\t\t\t\t};\r\n\r\n\t\t\t\tlet moduleName;\r\n\t\t\t\tif (typeof importStatement === 'string') {\r\n\t\t\t\t\tmoduleName = importStatement;\r\n\t\t\t\t} else if (typeof importStatement === 'function') {\r\n\t\t\t\t\tmoduleName = (importStatement as SeModuleConstructor).moduleName;\r\n\t\t\t\t\tif (!moduleName) {\r\n\t\t\t\t\t\tthrowUnAnnotatedModuleError(importStatement);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (importStatement && importStatement.seModule) {\r\n\t\t\t\t\tif (!importStatement.seModule.moduleName) {\r\n\t\t\t\t\t\tthrowUnAnnotatedModuleError(importStatement.seModule);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst moduleWithProvidersName = diNameUtils.buildName(importStatement.seModule);\r\n\t\t\t\t\tconst moduleWithProviders = angularInstance.module(moduleWithProvidersName);\r\n\r\n\t\t\t\t\tmoduleName = moduleWithProviders.name;\r\n\r\n\t\t\t\t\tif (importStatement.providers) {\r\n\t\t\t\t\t\taddArrayOfProvidersToModule(moduleWithProviders, importStatement.providers);\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthrow new Error(`the import statement ${importStatement} at index ${index} added to ${seModuleName} is neither a legacy string nor an SeModuleConstructor`);\r\n\t\t\t\t}\r\n\t\t\t\tif (allImports.indexOf(moduleName) > -1) {\r\n\t\t\t\t\tthrow new Error(`module ${moduleName} is imported more than once into ${seModuleName}`);\r\n\t\t\t\t}\r\n\t\t\t\tallImports.push(moduleName);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tconst module = angularInstance.module(seModuleName, allImports);\r\n\r\n\t\tif (definition.providers) {\r\n\t\t\taddArrayOfProvidersToModule(module, definition.providers);\r\n\t\t}\r\n\r\n\t\tif (definition.declarations) {\r\n\t\t\tdefinition.declarations.forEach((comp) => {\r\n\t\t\t\taddFullComponentGraphToModule(module, comp);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tif (definition.config) {\r\n\t\t\tmodule.config(definition.config);\r\n\t\t}\r\n\r\n\t\tif (definition.initialize) {\r\n\t\t\tmodule.run(definition.initialize);\r\n\t\t}\r\n\r\n\t\tmoduleConstructor.moduleName = module.name;\r\n\t\treturn moduleConstructor;\r\n\t};\r\n\r\n};\r\n\r\nfunction addArrayOfProvidersToModule(module: angular.IModule, providers: SeProvider[]) {\r\n\tproviders.forEach((provider: SeProvider, index: number) => {\r\n\t\tconst moduleName = module.name;\r\n\r\n\t\tif (!provider) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t`At the time a provider at index ${index} was added to module ${moduleName},\r\n\t\t\t\tit was undefined, this is probably due to the path in your typescript import statement\r\n\t\t\t\treferencing a barrel file of an alias defined in a higher layer, consider using a relative path instead.`\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif ((provider as SeBaseProvider).provide && !(provider as SeValueProvider).useValue &&\r\n\t\t\t!(provider as SeClassProvider).useClass && !(provider as SeFactoryProvider).useFactory) {\r\n\t\t\tthrow new Error(\r\n\t\t\t\t`At the time a provider named ${(provider as SeBaseProvider).provide} was added to module ${moduleName}\r\n\t\t        did not provide an instance of SeValueProvider, SeClassProvider, or FactoryProvider.`\r\n\t\t\t);\r\n\t\t}\r\n\r\n\t\tif ((provider as (SeValueProvider | SeFactoryProvider | SeClassProvider)).multi) {\r\n\t\t\tprovider = (provider as SeValueProvider | SeFactoryProvider | SeClassProvider);\r\n\t\t\taddMultiProviderToModule(module, provider);\r\n\t\t} else {\r\n\t\t\taddProviderToModule(module, provider);\r\n\t\t}\r\n\t});\r\n}\r\n\r\nfunction addProviderToModule(module: angular.IModule, provider: SeProvider) {\r\n\tif ((provider as SeValueProvider).useValue) {\r\n\r\n\t\tprovider = provider as SeValueProvider;\r\n\t\tmodule.constant(provider.provide, provider.useValue);\r\n\r\n\t} else if ((provider as SeClassProvider).useClass) {\r\n\r\n\t\tprovider = provider as SeClassProvider;\r\n\t\tmodule.service(provider.provide, provider.useClass);\r\n\r\n\t} else if ((provider as SeFactoryProvider).useFactory) {\r\n\t\tprovider = provider as SeFactoryProvider;\r\n\r\n\t\tconst isNgAnnotated = Array.isArray(provider.useFactory) || provider.useFactory.$inject;\r\n\r\n\t\tif (isNgAnnotated && provider.deps) {\r\n\t\t\tthrow Error(`At the time a provider ${provider.provide} uses ngInject annotations and \r\n\t\t\tSeFactoryProvider.deps at the same time. Please use one or the other.`);\r\n\t\t}\r\n\r\n\t\tconst dependencies = provider.deps ? provider.deps.map((dependency: SeConstructor | SeFactory | string) => {\r\n\t\t\treturn typeof dependency === 'string' ? dependency : diNameUtils.buildServiceName(dependency);\r\n\t\t}) : [];\r\n\r\n\t\t// In current framework, this is only needed for case of multi and for uglify ready di\r\n\t\tmodule.factory(provider.provide, isNgAnnotated ? provider.useFactory : [...dependencies, provider.useFactory]);\r\n\t} else {\r\n\t\tprovider = provider as SeFactory | SeConstructor;\r\n\r\n\t\tconst serviceName = diNameUtils.buildServiceName(provider);\r\n\r\n\t\tmodule.service(serviceName, provider);\r\n\t}\r\n}\r\n\r\nfunction addMultiProviderToModule(module: angular.IModule, provider: SeValueProvider | SeClassProvider | SeFactoryProvider) {\r\n\tconst multiProviderMapName = module.name + provider.provide;\r\n\tlet dependencies = MultiProviderMap[multiProviderMapName];\r\n\r\n\tif (!dependencies) {\r\n\t\tdependencies = [];\r\n\t}\r\n\r\n\tconst multiProviderInstance = multiProviderMapName + functionsUtils.getLodash().uniqueId();\r\n\r\n\tdependencies.push(multiProviderInstance);\r\n\tMultiProviderMap[multiProviderMapName] = dependencies;\r\n\r\n\tconst useFactory = function() {\r\n\t\treturn [].slice.call(arguments);\r\n\t};\r\n\r\n\taddProviderToModule(module, {...provider, provide: multiProviderInstance});\r\n\taddProviderToModule(module, {\r\n\t\tprovide: provider.provide,\r\n\t\tuseFactory,\r\n\t\tdeps: dependencies\r\n\t});\r\n}\r\n\r\nfunction addFullComponentGraphToModule(module: angular.IModule, component: SeDirectiveConstructor | SeComponentConstructor) {\r\n\r\n\tconst definition = component.definition;\r\n\tif (!definition) {\r\n\t\tconst componentConstructorName = functionsUtils.getConstructorName(component);\r\n\t\tthrow new Error(`${componentConstructorName} component was imported into ${module.name} module but doesn't seem to have been @SeComponent or @SeDirective annotated`);\r\n\t}\r\n\r\n\tif (component.providers) {\r\n\t\taddArrayOfProvidersToModule(module, component.providers);\r\n\t}\r\n\r\n\tconst componentName = (component as SeComponentConstructor).componentName;\r\n\tconst directivename = (component as SeDirectiveConstructor).directiveName;\r\n\r\n\tif (componentName) {\r\n\t\tmodule.component(componentName, definition as angular.IComponentOptions);\r\n\r\n\t\tdelete component.definition;\r\n\r\n\t\tconst entryComponents = (component as SeComponentConstructor).entryComponents;\r\n\t\tif (entryComponents) {\r\n\t\t\tentryComponents.forEach((entryComponent: any) => {\r\n\t\t\t\taddFullComponentGraphToModule(module, entryComponent);\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t\tdelete (component as SeComponentConstructor).entryComponents;\r\n\t} else if (directivename) {\r\n\t\tmodule.directive(directivename, () => definition as angular.IDirective);\r\n\t}\r\n}\r\n\r\n// For testing purposes.\r\n(SeModule as any).getAngular = function() {\r\n\treturn angular;\r\n};\r\n\r\nfunction getAngular() {\r\n\treturn (SeModule as any).getAngular();\r\n}\r\n\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.SeModule = SeModule;\n(window as any).smarteditcommons.addArrayOfProvidersToModule = addArrayOfProvidersToModule;\n(window as any).smarteditcommons.addProviderToModule = addProviderToModule;\n(window as any).smarteditcommons.addMultiProviderToModule = addMultiProviderToModule;\n(window as any).smarteditcommons.addFullComponentGraphToModule = addFullComponentGraphToModule;\n(window as any).smarteditcommons.getAngular = getAngular;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './SeInjectable';\r\nexport * from './SeComponent';\r\nexport * from './SeDirective';\r\nexport * from './ISeComponent';\r\nexport * from './SeModule';\r\nexport * from './types';\r\nexport * from './DINameUtils';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/* forbiddenNameSpaces useValue:false */\r\n/* forbiddenNameSpaces useFactory:false */\r\n/* forbiddenNameSpaces useClass:false */\r\nimport * as angular from 'angular';\r\nimport {TypedMap} from \"smarteditcommons\";\r\n\r\nexport interface SeDirectiveDefinition {\r\n\tselector?: string;\r\n\tinputs?: string[];\r\n\t// outputs?: string[]\r\n\t// host?: {...}\r\n\tproviders?: SeProvider[];\r\n\t// exportAs?: string\r\n\t// queries?: {...},\r\n\trequire?: string | string[] | TypedMap<string>;\r\n}\r\n\r\nexport interface SeComponentDefinition extends SeDirectiveDefinition {\r\n\t// changeDetection?: ChangeDetectionStrategy\r\n\t// viewProviders?: Provider[]\r\n\t// moduleId?: string\r\n\ttemplateUrl?: string;\r\n\ttemplate?: string;\r\n\t// styleUrls?: string[]\r\n\t// styles?: string[]\r\n\t// animations?: any[]\r\n\t// encapsulation?: ViewEncapsulation\r\n\t// interpolation?: [string, string]\r\n\tentryComponents?: SeComponentConstructor[];\r\n\t// preserveWhitespaces?: boolean\r\n\t// inherited from core/Directive\r\n}\r\n\r\nexport type SeFactory = (...arg: any[]) => any;\r\n\r\nexport interface SeConstructor {\r\n\tnew(...arg: any[]): any;\r\n}\r\n\r\nexport interface SeModuleConstructor extends SeConstructor {\r\n\t// used by Smartedit DI\r\n\tmoduleName?: string;\r\n}\r\n\r\nexport interface SeDirectiveConstructor extends SeConstructor {\r\n\tdirectiveName?: string;\r\n\tdefinition?: angular.IDirective;\r\n\t// will be browsed by owning @SeModule\r\n\tproviders?: SeProvider[];\r\n}\r\n\r\nexport interface SeComponentConstructor extends SeConstructor {\r\n\tcomponentName?: string;\r\n\tdefinition?: angular.IComponentOptions;\r\n\t// will be browsed by owning @SeModule\r\n\tentryComponents?: SeComponentConstructor[];\r\n\tproviders?: SeProvider[];\r\n}\r\n\r\nexport interface SeBaseProvider {\r\n\tprovide: string;\r\n\tmulti?: boolean;\r\n}\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:SeValueProvider\r\n * @description\r\n * Configures an injectable value provider in a {@link smarteditServicesModule.object:@SeModule module}, component or directive.\r\n */\r\nexport interface SeValueProvider extends SeBaseProvider {\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name provide\r\n\t * @propertyOf smarteditServicesModule.interface:SeValueProvider\r\n\t * @description\r\n\t * The provider name.\r\n\t */\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name useValue\r\n\t * @propertyOf smarteditServicesModule.interface:SeValueProvider\r\n\t * @description\r\n\t * An instance value of the provider.\r\n\t */\r\n\tuseValue: any;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name multi (optional)\r\n\t * @propertyOf smarteditServicesModule.interface:SeValueProvider\r\n\t * @description\r\n\t * If set to true, an array of instances will be provided for the same provider name. Useful for\r\n\t * configuring a module by many modules.\r\n\t */\r\n}\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:SeClassProvider\r\n * @description\r\n * Configures an injectable class provider in a {@link smarteditServicesModule.object:@SeModule module}, component or directive.\r\n */\r\nexport interface SeClassProvider extends SeBaseProvider {\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name provide\r\n\t * @propertyOf smarteditServicesModule.interface:SeClassProvider\r\n\t * @description\r\n\t * The provider name.\r\n\t */\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name useClass\r\n\t * @propertyOf smarteditServicesModule.interface:SeClassProvider\r\n\t * @description\r\n\t * A class to invoke of the provider.\r\n\t */\r\n\tuseClass: SeConstructor;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name multi (optional)\r\n\t * @propertyOf smarteditServicesModule.interface:SeClassProvider\r\n\t * @description\r\n\t * If set to true, an array of instances will be provided for the same provider name. Useful for\r\n\t * configuring a module by many modules.\r\n\t */\r\n}\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.interface:SeFactoryProvider\r\n * @description\r\n * Configures an injectable factory provider in a {@link smarteditServicesModule.object:@SeModule module}, component or directive.\r\n */\r\nexport interface SeFactoryProvider extends SeBaseProvider {\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name provide\r\n\t * @propertyOf smarteditServicesModule.interface:SeFactoryProvider\r\n\t * @description\r\n\t * The provider name.\r\n\t */\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name useFactory\r\n\t * @propertyOf smarteditServicesModule.interface:SeFactoryProvider\r\n\t * @description\r\n\t * A function to invoke the construction of the provider.\r\n\t */\r\n\tuseFactory: SeFactory;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name deps (optional)\r\n\t * @propertyOf smarteditServicesModule.interface:SeFactoryProvider\r\n\t * @description\r\n\t * A list of strings or referenced dependencies to be injected into the factory. The 'ngInject;' hint may be used\r\n\t * in replacement of this property.\r\n\t */\r\n\tdeps?: (SeConstructor | SeFactory | string)[];\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name multi (optional)\r\n\t * @propertyOf smarteditServicesModule.interface:SeFactoryProvider\r\n\t * @description\r\n\t * If set to true, an array of instances will be provided for the same provider name. Useful for\r\n\t * configuring a module by many modules.\r\n\t */\r\n}\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:SeModuleWithProviders\r\n * @description\r\n * The returning type of a configurable module.\r\n */\r\nexport interface SeModuleWithProviders {\r\n\tseModule: SeModuleConstructor;\r\n\tproviders: SeProvider[];\r\n}\r\n\r\nexport type SeProvider = SeValueProvider | SeClassProvider | SeFactoryProvider | SeConstructor | SeFactory;\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n/* forbiddenNameSpaces angular.module:false */\r\nimport * as angular from 'angular';\r\n\r\n/**\r\n * Backwards compatibility for partners and downstream teams\r\n * The deprecated modules below were moved to smarteditCommonsModule\r\n * \r\n * IMPORTANT: THE DEPRECATED MODULES WILL NOT BE AVAILABLE IN FUTURE RELEASES\r\n * @deprecated since 1808\r\n */\r\n/* @internal */\r\nconst deprecatedSince1808 = () => {\r\n\tangular.module('eventServiceModule', ['smarteditCommonsModule']);\r\n\tangular.module('crossFrameEventServiceModule', ['smarteditCommonsModule']);\r\n\tangular.module('languageServiceModule', ['smarteditCommonsModule']);\r\n\tangular.module('catalogServiceModule', ['smarteditCommonsModule']);\r\n\tangular.module('gatewayFactoryModule', ['smarteditRootModule']);\r\n\tangular.module('gatewayProxyModule', ['smarteditRootModule']);\r\n\tangular.module('operationContextServiceModule', ['smarteditRootModule']);\r\n\tangular.module('compileHtmlModule', ['smarteditCommonsModule']);\r\n\tangular.module('yMoreTextModule', ['smarteditCommonsModule']);\r\n};\r\n\r\n/*\r\n * Backwards compatibility for partners and downstream teams\r\n * The deprecated modules below were moved to smarteditCommonsModule\r\n *\r\n * IMPORTANT: THE DEPRECATED MODULES WILL NOT BE AVAILABLE IN FUTURE RELEASES\r\n * @deprecated since 1811\r\n */\r\n/* @internal */\r\nexport function deprecatedSince1811() {\r\n\tangular.module('permissionServiceInterfaceModule', ['smarteditCommonsModule']);\r\n\tangular.module('FetchDataHandlerInterfaceModule', ['genericEditorServicesModule']);\r\n\tangular.module('fetchEnumDataHandlerModule', ['genericEditorServicesModule']);\r\n\tangular.module('dateFormatterModule', ['dateTimePickerModule']);\r\n\tangular.module('DropdownPopulatorInterface', ['dropdownPopulatorModule']);\r\n\tangular.module('optionsDropdownPopulatorModule', ['dropdownPopulatorModule']);\r\n\tangular.module('uriDropdownPopulatorModule', ['dropdownPopulatorModule']);\r\n\tangular.module('editorFieldMappingServiceModule', ['genericEditorServicesModule']);\r\n\tangular.module('genericEditorStackServiceModule', ['genericEditorServicesModule']);\r\n\tangular.module('genericEditorTabServiceModule', ['genericEditorServicesModule']);\r\n\tangular.module('seValidationErrorParserModule', ['genericEditorServicesModule']);\r\n\tangular.module('seValidationMessageParserModule', ['genericEditorServicesModule']);\r\n\tangular.module('seGenericEditorFieldMessagesModule', ['genericEditorModule']);\r\n\tangular.module('genericEditorTabModule', ['genericEditorModule']);\r\n\tangular.module('genericEditorFieldModule', ['genericEditorModule']);\r\n\tangular.module('authorizationModule', ['smarteditCommonsModule']);\r\n}\r\n\r\nexport const deprecate = () => {\r\n\tdeprecatedSince1808();\r\n\tdeprecatedSince1811();\r\n};\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {Payload} from 'smarteditcommons/dtos';\r\n\r\nexport interface IDragAndDropEvents {\r\n\tTRACK_MOUSE_POSITION: string;\r\n\tDROP_ELEMENT: string;\r\n\tDRAG_DROP_START: string;\r\n\tDRAG_DROP_END: string;\r\n\tDRAG_DROP_CROSS_ORIGIN_START: string;\r\n}\r\n/**\r\n * @ngdoc object\r\n * @name smarteditServicesModule.object:IMousePosition\r\n * @description\r\n * Pointer coordinates\r\n */\r\nexport interface IMousePosition extends Payload {\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name x\r\n\t * @propertyOf smarteditServicesModule.object:IMousePosition\r\n\t * @description\r\n\t * abscissa of the pointer position\r\n\t */\r\n\tx: number;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name y\r\n\t * @propertyOf smarteditServicesModule.object:IMousePosition\r\n\t * @description\r\n\t * ordinate of the pointer position\r\n\t */\r\n\ty: number;\r\n}\r\n\r\nexport type IDragEventType = 'drop' | 'dragenter' | 'dragover' | 'dragleave';\r\nexport const IDragEventType = {\r\n\tDROP: 'drop' as IDragEventType,\r\n\tDRAG_ENTER: 'dragenter' as IDragEventType,\r\n\tDRAG_OVER: 'dragover' as IDragEventType,\r\n\tDRAG_LEAVE: 'dragleave' as IDragEventType\r\n};\r\n\r\nexport interface IDragAndDropScrollingService {\r\n\ttoggleThrottling(isEnabled: boolean): void;\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as lo from 'lodash';\r\nimport * as angular from 'angular';\r\nimport {IMousePosition} from 'smarteditcommons';\r\nimport {SeInjectable} from 'smarteditcommons/services';\r\n\r\nconst IN_VIEW_ELEMENTS_INTERSECTION_OBSERVER_OPTIONS = {\r\n\t// The root to use for intersection.\r\n\t// If not provided, use the top-level documents viewport.\r\n\troot: null as HTMLElement,\r\n\r\n\t// Threshold(s) at which to trigger callback, specified as a ratio, or list of\r\n\t// ratios, of (visible area / total area) of the observed element (hence all\r\n\t// entries must be in the range [0, 1]). Callback will be invoked when the visible\r\n\t// ratio of the observed element crosses a threshold in the list.\r\n\tthreshold: 0\r\n} as IntersectionObserverInit;\r\n\r\n/*\r\n * Of all the DOM node types we only care for 1 and 2 (Element and Attributes)\r\n */\r\nconst NODE_TYPES = {\r\n\tELEMENT: 1,\r\n\tATTRIBUTE: 2,\r\n\tTEXT: 3\r\n};\r\n\r\n/*\r\n* This is the configuration passed to the MutationObserver instance\r\n*/\r\nconst IN_VIEW_ELEMENTS_MUTATION_OBSERVER_OPTIONS = {\r\n    /*\r\n        * diables observation of attribute mutations\r\n        */\r\n\tattributes: false,\r\n    /*\r\n        * instruct the observer not to keep in store the former values of the mutated attributes\r\n        */\r\n\tattributeOldValue: false,\r\n    /*\r\n        * enables observation of addition and removal of nodes\r\n        */\r\n\tchildList: true,\r\n\tcharacterData: false,\r\n    /*\r\n        * enables recursive lookup without which only addition and removal of DIRECT children of the observed DOM root would be collected\r\n        */\r\n\tsubtree: true\r\n};\r\n\r\nexport interface QueueElement {\r\n\tcomponent: HTMLElement;\r\n\tisIntersecting: boolean;\r\n}\r\n/**\r\n * @ngdoc service\r\n * @name smarteditServicesModule.service:InViewElementObserver\r\n * @description\r\n * InViewElementObserver maintains a collection of eligible DOM elements considered \"in view\".\r\n * <br/>An element is considered eligible if matches at least one of the selectors passed to the service.\r\n * <br/>An eligible element is in view when and only when it intersects with the view port of the window frame.\r\n * <br/>This services provides as well convenience methods around \"in view\" components:\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class InViewElementObserver {\r\n\r\n\t/*\r\n\t * unique instance of a MutationObserver on the body (enough since subtree:true)\r\n\t */\r\n\tprivate mutationObserver: any;\r\n\r\n\t/*\r\n\t * unique instance of a IntersectionObserver\r\n\t */\r\n\tprivate intersectionObserver: any;\r\n\r\n\t/*\r\n\t * Queue used to process components when intersecting the viewport\r\n\t * {Array.<{isIntersecting: Boolean, parent: DOMElement, processed: COMPONENT_STATE}>}\r\n\t */\r\n\tprivate componentsQueue: QueueElement[] = [];\r\n\r\n\r\n\tprivate selectors: string[] = [];\r\n\r\n\t/** @internal */\r\n\tconstructor(\r\n\t\tprivate $log: angular.ILogService,\r\n\t\tprivate $document: angular.IDocumentService,\r\n\t\tprivate compareHTMLElementsPosition: () => (node1: HTMLElement, node2: HTMLElement) => number,\r\n\t\tprivate lodash: lo.LoDashStatic,\r\n\t\tprivate yjQuery: JQueryStatic,\r\n\t\tprivate isBlank: any,\r\n\t\tprivate isPointOverElement: (mousePosition: IMousePosition, component: HTMLElement) => boolean\r\n\t) {\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:InViewElementObserver#elementFromPoint\r\n\t * @methodOf smarteditServicesModule.service:InViewElementObserver\r\n\t * @description\r\n\t * Retrieves the element targeted by the given mousePosition.\r\n\t * <br/>On some browsers, the native Javascript API will not work when targeting\r\n\t * an element inside an iframe from the container if a container overlay blocks it.\r\n\t * <br/>In such case we resort to returning the targeted element amongst the list of \"in view\" elements\r\n\t * @param {IMousePosition} mousePosition the fixed {@link smarteditServicesModule.object:IMousePosition coordinates} of the pointer\r\n\t */\r\n\telementFromPoint(mousePosition: IMousePosition): Element {\r\n\t\tconst elementFromPointThroughNativeAPI = document.elementFromPoint(mousePosition.x, mousePosition.y);\r\n\t\t// we might potentially have an issue here if a browser has an intersection observer and document.elementFromPoint returns null.\r\n\t\t// Chrome version 66 when running in isE2EMode has the issue. But this is not likely to happen in reality because Chrome has an intersectionObserver\r\n\t\t// and hence it should just use the result from document.elementFromPoint.\r\n\t\treturn elementFromPointThroughNativeAPI || this.getInViewElements()\r\n\t\t\t.find((component) => {\r\n\t\t\t\treturn this.isPointOverElement(mousePosition, component as HTMLElement);\r\n\t\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:InViewElementObserver#addSelector\r\n\t * @methodOf smarteditServicesModule.service:InViewElementObserver\r\n\t * @description\r\n\t * Declares a new yjQuery selector in order to observe more elements.\r\n\t * @param {string[]} selector a {@link https://jquery.com jquery} selector\r\n\t */\r\n\taddSelector(selector: string) {\r\n\t\tif (!this.isBlank(selector) && this.selectors.indexOf(selector) === -1) {\r\n\t\t\tthis.selectors.push(selector);\r\n\t\t\tthis.restart();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:InViewElementObserver#getAllElements\r\n\t * @methodOf smarteditServicesModule.service:InViewElementObserver\r\n\t * @description\r\n\t * Retrieves the full list of eligible DOM elements even if they are not \"in view\".\r\n\t * @return {Element[]} An array of DOM elements\r\n\t */\r\n\tgetAllElements(): Element[] {\r\n\t\treturn this.componentsQueue\r\n\t\t\t.map((element) => element.component);\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:InViewElementObserver#getInViewElements\r\n\t * @methodOf smarteditServicesModule.service:InViewElementObserver\r\n\t * @description\r\n\t * Retrieves the list of currently \"in view\" DOM elements.\r\n\t * @return {Element[]} An array of DOM elements\r\n\t */\r\n\tgetInViewElements(): Element[] {\r\n\t\treturn this.componentsQueue\r\n\t\t\t.filter((element) => element.isIntersecting)\r\n\t\t\t.map((element) => element.component);\r\n\t}\r\n\r\n\r\n\tprivate restart() {\r\n\t\tthis.stopListener();\r\n\t\tthis.initListener();\r\n\t}\r\n\r\n\t/*\r\n\t * stops and clean up all listeners\r\n\t */\r\n\tprivate stopListener() {\r\n\t\t// Stop listening for DOM mutations\r\n\t\tif (this.mutationObserver) {\r\n\t\t\tthis.mutationObserver.disconnect();\r\n\t\t\tdelete this.mutationObserver;\r\n\t\t}\r\n\r\n\t\tif (this.intersectionObserver) {\r\n\t\t\tthis.intersectionObserver.disconnect();\r\n\t\t\tdelete this.intersectionObserver;\r\n\t\t}\r\n\r\n\t\tthis.componentsQueue = [];\r\n\t}\r\n\r\n\t/*\r\n\t * initializes and starts all Intersection/DOM listeners:\r\n\t * - Intersection of eligible components with the viewport\r\n\t * - DOM mutations on eligible components (by Means of native MutationObserver)\r\n\t */\r\n\tprivate initListener() {\r\n\r\n\t\tif (!this.mutationObserver) {\r\n\t\t\tthis.mutationObserver = this._newMutationObserver(this._mutationObserverCallback.bind(this));\r\n\r\n\t\t\tif (!this.intersectionObserver) {\r\n\t\t\t\t// Intersection Observer is used to observe intersection of components with the viewport.\r\n\t\t\t\t// each time the 'isIntersecting' property of an entry changes, the Intersection Callback is called.\r\n\t\t\t\t// we are using the componentsQueue to hold the components references and their isIntersecting value.\r\n\t\t\t\tthis.intersectionObserver = this._newIntersectionObserver((entries) => {\r\n\t\t\t\t\tentries\r\n\t\t\t\t\t\t.filter((entry) => this._isEligibleComponent(entry.target))\r\n\t\t\t\t\t\t.forEach((entry) => {\r\n\t\t\t\t\t\t\tthis._updateQueue(entry);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\t// Observing all eligible components that are already in the page.\r\n\t\t\t// Note that when an element visible in the viewport is removed, the Intersection Callback is called so we don't need to use the Mutation Observe to oberser removal of Nodes.\r\n\t\t\tthis._getEligibleElements().forEach((component: HTMLElement) => {\r\n\t\t\t\tthis.intersectionObserver.observe(component);\r\n\t\t\t});\r\n\r\n\t\t}\r\n\t}\r\n\r\n\t/*\r\n\t * Method used in mutationObserverCallback that extracts from mutations the list of added and removed nodes\r\n\t */\r\n\tprivate _aggregateAddedOrRemovedNodes(mutations: MutationRecord[], addedOnes: boolean) {\r\n\t\tconst entries = this.lodash.flatten(mutations.filter((mutation) => {\r\n\t\t\t// only keep mutations of type childList and addedNodes\r\n\t\t\treturn mutation.type === \"childList\"\r\n\t\t\t\t&& ((!!addedOnes && mutation.addedNodes && mutation.addedNodes.length)\r\n\t\t\t\t\t|| (!addedOnes && mutation.removedNodes && mutation.removedNodes.length));\r\n\t\t}).map((mutation: MutationRecord) => {\r\n\r\n\r\n\t\t\tconst children = this.lodash.flatten(Array.prototype.slice.call(addedOnes ? mutation.addedNodes : mutation.removedNodes)\r\n\t\t\t\t.filter((node: HTMLElement) => {\r\n\t\t\t\t\treturn node.nodeType === NODE_TYPES.ELEMENT;\r\n\t\t\t\t})\r\n\t\t\t\t.filter((node: HTMLElement) => this._isEligibleComponent(node))\r\n\t\t\t\t.map((child: HTMLElement) => {\r\n\t\t\t\t\treturn [child].concat(this._getAllEligibleChildren(child));\r\n\t\t\t\t}))\r\n\t\t\t\t.sort(this.compareHTMLElementsPosition())\r\n\t\t\t\t// so that in case of nested eligible components the deeper element is picked\r\n\t\t\t\t.reverse();\r\n\t\t\treturn children;\r\n\t\t}));\r\n\r\n\t\t/*\r\n\t\t * Despite MutationObserver specifications it so happens that sometimes,\r\n\t\t * depending on the very way a parent node is added with its children,\r\n\t\t * parent AND children will appear in a same mutation. We then must only keep the parent\r\n\t\t * Since the parent will appear first, the filtering lodash.uniqWith will always return the parent as opposed to the child which is what we need\r\n\t\t */\r\n\r\n\t\treturn this.lodash.uniqWith(entries, (entry1: HTMLElement, entry2: HTMLElement) => {\r\n\t\t\treturn entry1.contains(entry2) || entry2.contains(entry1);\r\n\t\t});\r\n\t}\r\n\r\n\t/*\r\n\t * callback executed by the mutation observer every time mutations occur.\r\n\t * repositioning and resizing are not part of this except that every time a eligible component is added,\r\n\t * it is registered within the positionRegistry and the resizeListener \r\n\t */\r\n\tprivate _mutationObserverCallback(mutations: MutationRecord[]) {\r\n\t\tthis.$log.debug(mutations);\r\n\r\n\t\tthis._aggregateAddedOrRemovedNodes(mutations, true).forEach((node: HTMLElement) => {\r\n\t\t\tthis.intersectionObserver.observe(node);\r\n\t\t});\r\n\r\n\t\tthis._aggregateAddedOrRemovedNodes(mutations, false).forEach((node: HTMLElement) => {\r\n\t\t\tconst componentIndex = this._getComponentIndexInQueue(node);\r\n\t\t\tif (componentIndex !== -1) {\r\n\t\t\t\tthis.componentsQueue.splice(componentIndex, 1);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n\r\n\t/*\r\n\t * Add the given entry to the componentsQueue\r\n\t * The components in the queue are sorted according to their position in the DOM\r\n\t * so that the adding of components is done to have parents before children\r\n\t */\r\n\tprivate _updateQueue(entry: IntersectionObserverEntry) {\r\n\r\n\t\tconst componentIndex = this._getComponentIndexInQueue(entry.target);\r\n\r\n\t\tif (componentIndex !== -1) {\r\n\t\t\tif (!entry.intersectionRatio && !this._isInDOM(entry.target)) {\r\n\t\t\t\tthis.componentsQueue.splice(componentIndex, 1);\r\n\r\n\t\t\t} else {\r\n\t\t\t\tthis.componentsQueue[componentIndex].isIntersecting = !!entry.intersectionRatio;\r\n\t\t\t}\r\n\t\t} else if (this._isInDOM(entry.target)) {// may have been removed by competing MutationObserver hence showign here but not intersecting\r\n\t\t\tthis.componentsQueue.push({\r\n\t\t\t\tcomponent: entry.target,\r\n\t\t\t\tisIntersecting: !!entry.intersectionRatio\r\n\t\t\t} as QueueElement);\r\n\t\t}\r\n\t}\r\n\r\n\t//////////////////////////////////////////////////////////////////////////////////////\r\n\t//////////////////////////////// HELPER METHODS //////////////////////////////////////\r\n\t//////////////////////////////////////////////////////////////////////////////////////\r\n\r\n\t/*\r\n\t * wrapping for test purposes\r\n\t */\r\n\tprivate _newMutationObserver(callback: MutationCallback) {\r\n\t\tconst mutationObserver = new MutationObserver(callback);\r\n\t\tmutationObserver.observe(document.body, IN_VIEW_ELEMENTS_MUTATION_OBSERVER_OPTIONS);\r\n\t\treturn mutationObserver;\r\n\t}\r\n\r\n\t/*\r\n\t * wrapping for test purposes\r\n\t */\r\n\tprivate _newIntersectionObserver(callback: IntersectionObserverCallback) {\r\n\t\treturn new IntersectionObserver(callback, IN_VIEW_ELEMENTS_INTERSECTION_OBSERVER_OPTIONS);\r\n\t}\r\n\r\n\r\n\tprivate _getJQuerySelector(): string {\r\n\t\treturn this.selectors.join(\",\");\r\n\t}\r\n\r\n\tprivate _isEligibleComponent(component: Element) {\r\n\t\treturn this.yjQuery(component).is(this._getJQuerySelector());\r\n\t}\r\n\r\n\tprivate _getEligibleElements() {\r\n\t\treturn Array.prototype.slice.call(this.yjQuery(this._getJQuerySelector()));\r\n\t}\r\n\r\n\tprivate _getAllEligibleChildren(component: HTMLElement) {\r\n\t\treturn Array.prototype.slice.call(this.yjQuery(component).find(this._getJQuerySelector()));\r\n\t}\r\n\r\n\tprivate _getComponentIndexInQueue(component: Element) {\r\n\t\treturn this.componentsQueue.findIndex(function(obj) {\r\n\t\t\treturn component === obj.component;\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _isInDOM(component: Element) {\r\n\t\treturn this.yjQuery.contains(this.$document[0], component);\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './IDragAndDropScrollingService';\r\nexport * from './InViewElementObserver';\r\n","import {SeInjectable} from \"smarteditcommons/services/dependencyInjection/di\";\r\n\r\n/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\ntype Predicate = (config: angular.IRequestConfig) => boolean;\r\ntype RequestHandler = (config: angular.IRequestConfig) => angular.IRequestConfig;\r\ntype ResponseHandler = <T>(response: angular.IHttpResponse<T>) => angular.IHttpResponse<T>;\r\n\r\n/*\r\n * interceptor that will inject flaw into outbound and inbound http calls.\r\n * It is mainly used to validate reliability and consitency of test frameworks\r\n */\r\n/** @internal */\r\n@SeInjectable()\r\n/* @ngInject */\n export class FlawInjectionInterceptor implements angular.IHttpInterceptor {\r\n\r\n\t/*\r\n\t * probability of flaw occurrence ranging from 0 to 1\r\n\t */\r\n\tprivate static PROBABILITY = 0;\r\n\r\n\tprivate flawWindow: any;\r\n\r\n\tprivate requestMutations: {test: Predicate, mutate: RequestHandler}[] = [];\r\n\tprivate responseMutations: {test: Predicate, mutate: ResponseHandler}[] = [];\r\n\r\n\tconstructor(\r\n\t\tprivate $log: angular.ILogService,\r\n\t\tprivate interceptorHelper: any) {\r\n\r\n\t\tthis.flawWindow = window;\r\n\t\tthis.flawWindow.allRequests = 0;\r\n\t\tthis.flawWindow.flawedRequests = 0;\r\n\t\tthis.flawWindow.allResponses = 0;\r\n\t\tthis.flawWindow.flawedResponses = 0;\r\n\r\n\t\tthis.request = this.request.bind(this);\r\n\t\tthis.response = this.response.bind(this);\r\n\r\n\t}\r\n\r\n\tregisterRequestFlaw(mutation: {test: Predicate, mutate: RequestHandler}) {\r\n\t\tthis.requestMutations.push(mutation);\r\n\t}\r\n\r\n\tregisterResponseFlaw(mutation: {test: Predicate, mutate: ResponseHandler}) {\r\n\t\tthis.responseMutations.push(mutation);\r\n\t}\r\n\r\n\trequest(config: angular.IRequestConfig) {\r\n\r\n\t\tif (FlawInjectionInterceptor.PROBABILITY !== 0 && this._isCRUDRequest(config) && !this._isGET(config)) {\r\n\t\t\treturn this.interceptorHelper.handleRequest(config, () => {\r\n\r\n\t\t\t\tthis.flawWindow.allRequests++;\r\n\t\t\t\tif (this._activateWithProbability(FlawInjectionInterceptor.PROBABILITY)) {\r\n\t\t\t\t\tthis.flawWindow.flawedRequests++;\r\n\r\n\t\t\t\t\tconst requestMutation = this.requestMutations.find((mutation) => mutation.test(config));\r\n\t\t\t\t\tif (requestMutation) {\r\n\t\t\t\t\t\tconfig = requestMutation.mutate(config);\r\n\t\t\t\t\t\tthis.$log.error(`FLAWED REQUEST-\"${config.url}`);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn config;\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\treturn config;\r\n\t\t}\r\n\t}\r\n\r\n\tresponse(response: angular.IHttpResponse<any>) {\r\n\t\tif (FlawInjectionInterceptor.PROBABILITY !== 0 && this._isCRUDResponse(response) && !this._isGET(response.config)) {\r\n\r\n\t\t\tthis.flawWindow.allResponses++;\r\n\t\t\tif (this._activateWithProbability(FlawInjectionInterceptor.PROBABILITY)) {\r\n\t\t\t\tthis.flawWindow.flawedResponses++;\r\n\r\n\t\t\t\tconst responseMutation = this.responseMutations.find((mutation) => mutation.test(response.config));\r\n\t\t\t\tif (responseMutation) {\r\n\t\t\t\t\tresponse = responseMutation.mutate(response);\r\n\t\t\t\t\tthis.$log.error(`FLAWED RESPONSE-\"${response.config.url}`);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\treturn response;\r\n\t\t} else {\r\n\t\t\treturn response;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _isCRUDRequest(config: angular.IRequestConfig) {\r\n\t\treturn config.url\r\n\t\t\t&& (config.url.indexOf(\".html\") === -1\r\n\t\t\t\t&& config.url.indexOf(\".js\") === -1\r\n\t\t\t);\r\n\t}\r\n\r\n\tprivate _isCRUDResponse(response: angular.IHttpResponse<any>) {\r\n\t\treturn response.config && response.config.url\r\n\t\t\t&& response.config.url.indexOf(\".html\") === -1\r\n\t\t\t&& response.headers('Content-Type')\r\n\t\t\t&& response.headers('Content-Type').indexOf(\"json\") > -1;\r\n\t}\r\n\r\n\tprivate _isGET(config: angular.IRequestConfig) {\r\n\t\treturn config.method === \"GET\";\r\n\t}\r\n\r\n\tprivate _activateWithProbability(probabilityTrue: number) {\r\n\t\treturn Math.random() >= 1.0 - probabilityTrue;\r\n\t}\r\n\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {diNameUtils, SeModule} from 'smarteditcommons/services/dependencyInjection/di';\r\nimport {FlawInjectionInterceptor} from './FlawInjectionInterceptor';\r\n\r\n/** @internal */\r\n@SeModule({\r\n\timports: [\r\n\t\t'interceptorHelperModule'\r\n\t],\r\n\tproviders: [FlawInjectionInterceptor],\r\n\tconfig: ($httpProvider: angular.IHttpProvider) => {\r\n\t\t'ngInject';\r\n\t\t$httpProvider.interceptors.push(diNameUtils.buildServiceName(FlawInjectionInterceptor));\r\n\t},\r\n\tinitialize: (flawInjectionInterceptor: FlawInjectionInterceptor) => {\r\n\t\t'ngInject';\r\n\t\t// mutates sites id\r\n\t\tflawInjectionInterceptor.registerRequestFlaw({\r\n\t\t\ttest: (config: angular.IRequestConfig) => /sites\\/[\\w-]+\\//.test(config.url),\r\n\t\t\tmutate: (config: angular.IRequestConfig) => {\r\n\t\t\t\tconfig.url = config.url.replace(/sites\\/([\\w-]+)\\//, \"sites/\" + Math.random() + \"/\");\r\n\t\t\t\treturn config;\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t}\r\n})\r\nexport class FlawInjectionInterceptorModule {}\r\n\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * We are doing forced imports in order to generate the types (d.ts) of below interfaces or classes correctly.\r\n * If we don't include the below imports, as a part of webpack tree shaking, the types will not be generated.\r\n * There is an open issue in typescript github regarding forced imports\r\n * https://github.com/Microsoft/TypeScript/issues/9191\r\n * https://github.com/Microsoft/TypeScript/wiki/FAQ#why-are-imports-being-elided-in-my-emit\r\n * \r\n * If an interface X extends an interface Y, make sure X has all types it needs from Y by checking index.d.ts, if not, do force import of X and Y.\r\n */\r\nimport 'smarteditcommons/services/dependencyInjection/types';\r\nimport 'smarteditcommons/services/dependencyInjection/ISeComponent';\r\nimport 'smarteditcommons/services/crossFrame/CrossFrameEventService';\r\nimport 'smarteditcommons/services/interfaces/IAlertService';\r\nimport 'smarteditcommons/services/interfaces/IBrowserService';\r\nimport 'smarteditcommons/services/interfaces/ICatalogService';\r\nimport 'smarteditcommons/services/interfaces/IContextualMenuButton';\r\nimport 'smarteditcommons/services/interfaces/IContextualMenuConfiguration';\r\nimport 'smarteditcommons/services/interfaces/IDecorator';\r\nimport 'smarteditcommons/services/interfaces/IExperience';\r\nimport 'smarteditcommons/services/interfaces/IFeature';\r\nimport 'smarteditcommons/services/interfaces/IFeatureService';\r\nimport 'smarteditcommons/services/interfaces/IModalService';\r\nimport 'smarteditcommons/services/interfaces/IPrioritized';\r\nimport 'smarteditcommons/services/interfaces/IReflectable';\r\nimport 'smarteditcommons/services/rest/IRestService';\r\nimport 'smarteditcommons/services/rest/IRestServiceFactory';\r\nimport 'smarteditcommons/services/interfaces/IToolbarItem';\r\nimport 'smarteditcommons/services/interfaces/IUriContext';\r\nimport 'smarteditcommons/services/interfaces/IURIBuilder';\r\nimport 'smarteditcommons/services/SystemEventService';\r\nimport 'smarteditcommons/services/wizard/WizardServiceModule';\r\nimport 'smarteditcommons/modules/translations/translationServiceModule';\r\nimport 'smarteditcommons/components/yDropdown/yDropDownMenu/IYDropdownMenuItem';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {IGatewayPostMessageData, MessageGateway} from './MessageGateway';\r\nimport {SystemEventService} from './../SystemEventService';\r\nimport {CloneableUtils, TypedMap, WindowUtils} from 'smarteditcommons';\r\nimport {SeInjectable} from './../dependencyInjection/di';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditCommonsModule.service:GatewayFactory\r\n *\r\n * @description\r\n * The Gateway Factory controls the creation of and access to {@link smarteditCommonsModule.service:MessageGateway MessageGateway}\r\n * instances.\r\n *\r\n * To construct and access a gateway, you must use the GatewayFactory's createGateway method and provide the channel\r\n * ID as an argument. If you try to create the same gateway twice, the second call will return a null.\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class GatewayFactory {\r\n\r\n\tprivate messageGatewayMap: TypedMap<MessageGateway> = {};\r\n\r\n\t/** @internal */\r\n\tconstructor(\r\n\t\tprivate $q: angular.IQService,\r\n\t\tprivate $log: angular.ILogService,\r\n\t\tprivate $window: angular.IWindowService,\r\n\t\tprivate $injector: angular.auto.IInjectorService,\r\n\t\tprivate $timeout: angular.ITimeoutService,\r\n\t\tprivate systemEventService: SystemEventService,\r\n\t\tprivate cloneableUtils: CloneableUtils,\r\n\t\tprivate getOrigin: any,\r\n\t\tprivate regExpFactory: any,\r\n\t\tprivate isIframe: any,\r\n\t\tprivate windowUtils: WindowUtils,\r\n\t\tprivate WHITE_LISTED_STOREFRONTS_CONFIGURATION_KEY: string,\r\n\t\tprivate TIMEOUT_TO_RETRY_PUBLISHING: number\r\n\t) {}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:GatewayFactory#initListener\r\n     * @methodOf smarteditCommonsModule.service:GatewayFactory\r\n     *\r\n     * @description\r\n     * Initializes a postMessage event handler that dispatches the handling of an event to the specified gateway.\r\n     * If the corresponding gateway does not exist, an error is logged.\r\n     */\r\n\r\n\tinitListener() {\r\n\r\n\t\tconst processedPrimaryKeys: string[] = [];\r\n\r\n\t\t// Listen to message from child window\r\n\t\tthis.$window.addEventListener('message', (e: MessageEvent) => {\r\n\r\n\t\t\tif (this._isAllowed(e.origin)) {\r\n\t\t\t\t// add control on e.origin\r\n\t\t\t\tconst event: IGatewayPostMessageData = e.data;\r\n\r\n\t\t\t\tif (processedPrimaryKeys.indexOf(event.pk) > -1) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\tprocessedPrimaryKeys.push(event.pk);\r\n\t\t\t\tthis.$log.debug('message event handler called', event.eventId);\r\n\r\n\t\t\t\tconst gatewayId: string = event.gatewayId;\r\n\t\t\t\tconst gateway: MessageGateway = this.messageGatewayMap[gatewayId];\r\n\t\t\t\tif (!gateway) {\r\n\t\t\t\t\tthis.$log.debug('Incoming message on gateway ' + gatewayId + ', but no destination exists.');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tgateway.processEvent(event);\r\n\t\t\t} else {\r\n\t\t\t\tthis.$log.error(\"disallowed storefront is trying to communicate with smarteditcontainer\");\r\n\t\t\t}\r\n\r\n\t\t}, false);\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:GatewayFactory#createGateway\r\n     * @methodOf smarteditCommonsModule.service:GatewayFactory\r\n     *\r\n     * @description\r\n     * Creates a gateway for the specified gateway identifier and caches it in order to handle postMessage events\r\n     * later in the application lifecycle. This method will fail on subsequent calls in order to prevent two\r\n     * clients from using the same gateway.\r\n     *\r\n     * @param {String} gatewayId The identifier of the gateway.\r\n     * @returns {MessageGateway} Returns the newly created Message Gateway or null.\r\n     */\r\n\tcreateGateway(gatewayId: string): MessageGateway {\r\n\t\tif (this.messageGatewayMap[gatewayId]) {\r\n\t\t\tthis.$log.error('Message Gateway for ' + gatewayId + ' already reserved');\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tthis.messageGatewayMap[gatewayId] = new MessageGateway(this.$q, this.$log, this.$timeout,\r\n\t\t\tthis.systemEventService, this.cloneableUtils, this.windowUtils,\r\n\t\t\tthis.TIMEOUT_TO_RETRY_PUBLISHING, gatewayId);\r\n\r\n\t\treturn this.messageGatewayMap[gatewayId];\r\n\t}\r\n\r\n    /**\r\n     * allowed if receiving end is frame or [container + (white listed storefront or same origin)]\r\n     */\r\n\tprivate _isAllowed(origin: string): boolean {\r\n\t\tconst whiteListedStorefronts: string[] = this.$injector.has(this.WHITE_LISTED_STOREFRONTS_CONFIGURATION_KEY) ?\r\n\t\t\tthis.$injector.get(this.WHITE_LISTED_STOREFRONTS_CONFIGURATION_KEY) : [];\r\n\t\treturn this.isIframe() || this.getOrigin() === origin || (whiteListedStorefronts.some((allowedURI: string) => {\r\n\t\t\treturn this.regExpFactory(allowedURI).test(origin);\r\n\t\t}));\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport * as angular from 'angular';\r\nimport {GatewayFactory, IProxiedService, MessageGateway} from 'smarteditcommons/services';\r\nimport {FunctionsUtils} from 'smarteditcommons/utils/FunctionsUtils';\r\nimport {SeInjectable} from './../dependencyInjection/di';\r\nimport {Cloneable} from 'smarteditcommons/dtos';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditCommonsModule.service:GatewayProxy\r\n *\r\n * @description\r\n * To seamlessly integrate the gateway factory between two services on different frames, you can use a gateway\r\n * proxy. The gateway proxy service simplifies using the gateway module by providing an API that registers an\r\n * instance of a service that requires a gateway for communication.\r\n *\r\n * This registration process automatically attaches listeners to each of the service's functions (turned into promises), allowing stub\r\n * instances to forward calls to these functions using an instance of a gateway from {@link\r\n * smarteditCommonsModule.service:GatewayFactory gatewayFactory}. Any function that has an empty body declared on the service is used\r\n * as a proxy function. It delegates a publish call to the gateway under the same function name, and wraps the result\r\n * of the call in a Promise.\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class GatewayProxy {\r\n\r\n\tprivate nonProxiableMethods = ['getMethodForVoid', 'getMethodForSingleInstance', 'getMethodForArray'];\r\n\r\n\tconstructor(\r\n\t\tprivate $log: angular.ILogService,\r\n\t\tprivate $q: angular.IQService,\r\n\t\tprivate toPromise: any,\r\n\t\tprivate isBlank: any,\r\n\t\tprivate functionsUtils: FunctionsUtils,\r\n\t\tprivate gatewayFactory: GatewayFactory\r\n\t) {}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:GatewayProxy#initForService\r\n     * @methodOf smarteditCommonsModule.service:GatewayProxy\r\n     *\r\n     * @description Mutates the given service into a proxied service.\r\n     * You must provide a unique string gatewayId, in one of 2 ways.<br />\r\n     * 1) Having a gatewayId property on the service provided<br />\r\n     * OR<br />\r\n     * 2) providing a gatewayId as 3rd param of this function<br />\r\n     *\r\n     * @param {any} service Service to mutate into a proxied service.\r\n     * @param {String[]=} methodsSubset An explicit set of methods on which the gatewayProxy will trigger. Otherwise, by default all functions will be proxied. This is particularly useful to avoid inner methods being unnecessarily turned into promises.\r\n     * @param {String=} gatewayId The gateway ID to use internaly for the proxy. If not provided, the service <strong>must<strong> have a gatewayId property.\r\n     */\r\n\r\n\tinitForService<T extends IProxiedService>(service: T, methodsSubset?: string[], gatewayId?: string): void {\r\n\r\n\t\tconst gwId = gatewayId || service.gatewayId;\r\n\r\n\t\tif (!gwId) {\r\n\t\t\tthis.$log.error(`initForService() - service expected to have an associated gatewayId - methodsSubset: ${methodsSubset && methodsSubset.length ? methodsSubset.join(',') : []}`);\r\n\t\t\treturn null;\r\n\t\t}\r\n\r\n\t\tconst gateway: MessageGateway = this.gatewayFactory.createGateway(gwId);\r\n\r\n\t\tlet loopedOver = methodsSubset;\r\n\t\tif (!loopedOver) {\r\n\t\t\tloopedOver = [];\r\n\t\t\tfor (const key in service) {\r\n\t\t\t\tif (typeof service[key] === 'function' && !this._isNonProxiableMethod(key)) {\r\n\t\t\t\t\tloopedOver.push(key);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tloopedOver.forEach((fnName: Extract<keyof T, string>) => {\r\n\t\t\tif (typeof service[fnName] === 'function') {\r\n\t\t\t\tif (this.functionsUtils.isEmpty(service[fnName] as any)) {\r\n\t\t\t\t\tthis._turnToProxy(fnName, service, gateway);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tservice[fnName] = this.toPromise(service[fnName], service);\r\n\t\t\t\t\tgateway.subscribe(fnName, this._onGatewayEvent.bind(null, fnName, service));\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _isNonProxiableMethod(key: string) {\r\n\t\treturn this.nonProxiableMethods.indexOf(key) > -1 || key.startsWith('$') || key === 'lodash' || key === 'jQuery';\r\n\t}\r\n\r\n\tprivate _onGatewayEvent<T>(fnName: Extract<keyof T, string>, service: T, eventId: string, data: {arguments: Cloneable}) {\r\n\t\treturn (service[fnName] as any).apply(service, data.arguments);\r\n\t}\r\n\r\n\tprivate _turnToProxy<T>(fnName: Extract<keyof T, string>, service: T, gateway: MessageGateway) {\r\n\t\tdelete service[fnName];\r\n\r\n\t\tservice[fnName] = ((...args: Cloneable[]) => {\r\n\t\t\treturn gateway.publish(fnName, {\r\n\t\t\t\targuments: args\r\n\t\t\t} as Cloneable).then((resolvedData: Cloneable) => {\r\n\t\t\t\tif (!this.isBlank(resolvedData)) {\r\n\t\t\t\t\tdelete (resolvedData as any).$resolved;\r\n\t\t\t\t\tdelete (resolvedData as any).$promise;\r\n\t\t\t\t}\r\n\t\t\t\treturn resolvedData;\r\n\t\t\t}, (error: any) => {\r\n\t\t\t\tif (error) {\r\n\t\t\t\t\tthis.$log.error(`gatewayProxy - publish failed for gateway ${gateway.gatewayId} method ${fnName} and arguments ${args}`);\r\n\t\t\t\t}\r\n\t\t\t\treturn this.$q.reject(error);\r\n\t\t\t});\r\n\t\t}) as any;\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {Cloneable, CloneableUtils, Payload, TypedMap, WindowUtils} from 'smarteditcommons';\r\nimport {SystemEventService} from './../SystemEventService';\r\nimport {SeInjectable} from './../dependencyInjection/di';\r\n\r\nexport type CloneableEventHandler<T extends Cloneable> = (eventId: string, eventData?: T) => angular.IPromise<any> | any;\r\n\r\n/** @internal */\r\nexport interface IGatewayPostMessageData extends Payload {\r\n\tpk: string;\r\n\tgatewayId: string;\r\n\teventId: string;\r\n\tdata: Cloneable;\r\n}\r\n\r\n/** @internal */\r\ninterface AcknowledgableDeferred<T> extends angular.IDeferred<T> {\r\n\tacknowledged: boolean;\r\n}\r\n/**\r\n * @ngdoc service\r\n * @name smarteditCommonsModule.service:MessageGateway\r\n *\r\n * @description\r\n * The Message Gateway is a private channel that is used to publish and subscribe to events across iFrame\r\n * boundaries. The gateway uses the W3C-compliant postMessage as its underlying technology. The benefits of\r\n * the postMessage are that:\r\n * <ul>\r\n *     <li>It works in cross-origin scenarios.</li>\r\n *     <li>The receiving end can reject messages based on their origins.</li>\r\n * </ul>\r\n *\r\n * The creation of instances is controlled by the {@link smarteditCommonsModule.service:GatewayFactory gatewayFactory}. Only one\r\n * instance can exist for each gateway ID.\r\n *\r\n * @param {String} gatewayId The channel identifier\r\n * @constructor\r\n */\r\n\r\n@SeInjectable()\r\n/* @ngInject */\n export class MessageGateway {\r\n\r\n\tprivate PROMISE_ACKNOWLEDGEMENT_EVENT_ID: string = 'promiseAcknowledgement';\r\n\tprivate PROMISE_RETURN_EVENT_ID: string = 'promiseReturn';\r\n\tprivate SUCCESS: string = 'success';\r\n\tprivate FAILURE: string = 'failure';\r\n\tprivate MAX_RETRIES: number = 5;\r\n\r\n\tprivate promisesToResolve: TypedMap<AcknowledgableDeferred<Cloneable>> = {};\r\n\r\n\t/** @internal */\r\n\tconstructor(\r\n\t\tprivate $q: angular.IQService,\r\n\t\tprivate $log: angular.ILogService,\r\n\t\tprivate $timeout: angular.ITimeoutService,\r\n\t\tprivate systemEventService: SystemEventService,\r\n\t\tprivate cloneableUtils: CloneableUtils,\r\n\t\tprivate windowUtils: WindowUtils,\r\n\t\tprivate TIMEOUT_TO_RETRY_PUBLISHING: number,\r\n\t\tpublic readonly gatewayId: string\r\n\t) {}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:MessageGateway#publish\r\n     * @methodOf smarteditCommonsModule.service:MessageGateway\r\n     *\r\n     * @description\r\n     * Publishes a message across the gateway using the postMessage.\r\n     *\r\n     * The gateway's publish method implements promises, which are an AngularJS implementation. To resolve a\r\n     * publish promise, all listener promises on the side of the channel must resolve. If a failure occurs in the\r\n     * chain, the chain is interrupted and the publish promise is rejected.\r\n     *\r\n     * @param {String} eventId Event identifier\r\n     * @param {Object} data Message payload\r\n     * @param {Number} retries The current number of attempts to publish a message. By default it is 0.\r\n     * @param {String=} pk An optional parameter. It is a primary key for the event, which is generated after\r\n     * the first attempt to send a message.\r\n     * @returns {Promise} Promise to resolve\r\n     */\r\n\tpublish<Tin extends Cloneable, Tout extends Cloneable>(eventId: string, _data: Tin, retries: number = 0, pk?: string): angular.IPromise<Tout> {\r\n\r\n\t\tif (!eventId) {\r\n\t\t\tthis.$log.error(`MessageGateway: Failed to send event. No event ID provided for _data: ${_data}`);\r\n\t\t\treturn this.$q.when({} as Tout);\r\n\t\t}\r\n\r\n\t\tconst data: Cloneable = this.cloneableUtils.makeCloneable(_data);\r\n\r\n\t\tif (!angular.equals(data, _data)) {\r\n\t\t\tthis.$log.warn(`gatewayFactory.publish - Non cloneable payload has been sanitized for gateway ${this.gatewayId}, event ${eventId}:`, data);\r\n\t\t}\r\n\r\n\t\tconst deferred: AcknowledgableDeferred<Tout> = this.promisesToResolve[pk] as AcknowledgableDeferred<Tout> || (this.$q.defer<Tout>() as AcknowledgableDeferred<Tout>);\r\n\t\tlet target: Window;\r\n\r\n\t\ttry {\r\n\r\n\t\t\ttarget = this.windowUtils.getTargetIFrame();\r\n\t\t\tif (!target) {\r\n\t\t\t\tthrow new Error('It is standalone. There is no iframe');\r\n\t\t\t}\r\n\r\n\t\t\tpk = pk || this._generateIdentifier();\r\n\t\t\ttry {\r\n\t\t\t\ttarget.postMessage({\r\n\t\t\t\t\tpk, // necessary to identify a incoming postMessage that would carry the response to resolve the promise\r\n\t\t\t\t\tgatewayId: this.gatewayId,\r\n\t\t\t\t\teventId,\r\n\t\t\t\t\tdata\r\n\t\t\t\t} as IGatewayPostMessageData, '*');\r\n\t\t\t} catch (e) {\r\n\t\t\t\tthis.$log.error(e);\r\n\t\t\t\tthis.$log.error(`gatewayFactory.publish - postMessage has failed for gateway ${this.gatewayId} event ${eventId} and data `, data);\r\n\t\t\t}\r\n\r\n\t\t\tthis.promisesToResolve[pk] = deferred;\r\n\r\n\t\t\t// in case promise does not return because, say, a non ready frame\r\n\t\t\tthis.$timeout(() => {\r\n\t\t\t\tif (!deferred.acknowledged && eventId !== this.PROMISE_RETURN_EVENT_ID && eventId !== this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID) { // still pending\r\n\t\t\t\t\tif (retries < this.MAX_RETRIES) {\r\n\r\n\t\t\t\t\t\tthis.$log.debug(document.location.href, \"is retrying to publish event\", eventId);\r\n\r\n\t\t\t\t\t\tthis.publish(eventId, data, ++retries, pk);\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tdeferred.reject();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}, this.TIMEOUT_TO_RETRY_PUBLISHING);\r\n\t\t} catch (e) {\r\n\t\t\tdeferred.reject();\r\n\t\t}\r\n\r\n\t\treturn deferred.promise;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:MessageGateway#subscribe\r\n     * @methodOf smarteditCommonsModule.service:MessageGateway\r\n     *\r\n     * @description\r\n     * Registers a given callback function to the given event ID.\r\n     *\r\n     * @param {String} eventId Event identifier\r\n     * @param {CloneableEventHandler} callback Callback function to be invoked\r\n     * @returns {() => void)} The function to call in order to unsubscribe the event listening\r\n     */\r\n\tsubscribe<T extends Cloneable>(eventId: string, callback: CloneableEventHandler<T>): () => void {\r\n\t\tlet unsubscribeFn: () => void;\r\n\t\tif (!eventId) {\r\n\t\t\tthis.$log.error('MessageGateway: Failed to subscribe event handler for event: ' + eventId);\r\n\t\t} else {\r\n\t\t\tconst systemEventId = this._getSystemEventId(eventId);\r\n\t\t\tunsubscribeFn = this.systemEventService.subscribe(systemEventId, callback);\r\n\t\t}\r\n\t\treturn unsubscribeFn;\r\n\t}\r\n\r\n\tprocessEvent(event: IGatewayPostMessageData) {\r\n\t\tconst eventData = event.data as {pk: string, type: string, resolvedDataOfLastSubscriber?: Cloneable};\r\n\t\tif (event.eventId !== this.PROMISE_RETURN_EVENT_ID && event.eventId !== this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID) {\r\n\t\t\tthis.$log.debug(document.location.href, \"sending acknowledgement for\", event);\r\n\r\n\t\t\tthis.publish(this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID, {\r\n\t\t\t\tpk: event.pk\r\n\t\t\t});\r\n\r\n\t\t\tconst systemEventId = this._getSystemEventId(event.eventId);\r\n\t\t\tthis.systemEventService.publishAsync(systemEventId, event.data).then(\r\n\t\t\t\t(resolvedDataOfLastSubscriber: Cloneable) => {\r\n\t\t\t\t\tthis.$log.debug(document.location.href, \"sending promise resolve\", event);\r\n\t\t\t\t\tthis.publish(this.PROMISE_RETURN_EVENT_ID, {\r\n\t\t\t\t\t\tpk: event.pk,\r\n\t\t\t\t\t\ttype: this.SUCCESS,\r\n\t\t\t\t\t\tresolvedDataOfLastSubscriber\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\t() => {\r\n\t\t\t\t\tthis.$log.debug(document.location.href, \"sending promise reject\", event);\r\n\t\t\t\t\tthis.publish(this.PROMISE_RETURN_EVENT_ID, {\r\n\t\t\t\t\t\tpk: event.pk,\r\n\t\t\t\t\t\ttype: this.FAILURE\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t);\r\n\t\t} else if (event.eventId === this.PROMISE_RETURN_EVENT_ID) {\r\n\r\n\t\t\tif (this.promisesToResolve[eventData.pk]) {\r\n\t\t\t\tif (eventData.type === this.SUCCESS) {\r\n\t\t\t\t\tthis.$log.debug(document.location.href, \"received promise resolve\", event);\r\n\t\t\t\t\tthis.promisesToResolve[eventData.pk].resolve(eventData.resolvedDataOfLastSubscriber);\r\n\t\t\t\t} else if (eventData.type === this.FAILURE) {\r\n\t\t\t\t\tthis.$log.debug(document.location.href, \"received promise reject\", event);\r\n\t\t\t\t\tthis.promisesToResolve[eventData.pk].reject();\r\n\t\t\t\t}\r\n\t\t\t\tdelete this.promisesToResolve[eventData.pk];\r\n\t\t\t}\r\n\r\n\t\t} else if (event.eventId === this.PROMISE_ACKNOWLEDGEMENT_EVENT_ID) {\r\n\t\t\tif (this.promisesToResolve[eventData.pk]) {\r\n\t\t\t\tthis.$log.debug(document.location.href, \"received acknowledgement\", event);\r\n\t\t\t\tthis.promisesToResolve[eventData.pk].acknowledged = true;\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _generateIdentifier(): string {\r\n\t\treturn new Date().getTime() + Math.random().toString();\r\n\t}\r\n\r\n\tprivate _getSystemEventId(eventId: string): string {\r\n\t\treturn this.gatewayId + ':' + eventId;\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nexport * from './GatewayFactory';\r\nexport * from './GatewayProxy';\r\nexport * from './IProxiedService';\r\nexport * from './MessageGateway';","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {annotationService} from 'smarteditcommons/services/annotationService';\r\nimport {GatewayProxy} from 'smarteditcommons/services/gateway';\r\nimport {diNameUtils} from 'smarteditcommons/services/dependencyInjection/di';\r\n\r\nconst GatewayProxiedName = 'GatewayProxied';\r\n\r\n'se:smarteditcommons';\r\nexport const GatewayProxied = annotationService.getClassAnnotationFactory(GatewayProxiedName) as (...args: string[]) => ClassDecorator;\r\n\r\n'se:smarteditcommons';\r\nexport function GatewayProxiedAnnotationFactory(gatewayProxy: GatewayProxy, $log: angular.ILogService) {\r\n\t'ngInject';\r\n\treturn annotationService.setClassAnnotationFactory(GatewayProxiedName, function(factoryArguments?: string[]) {\r\n\r\n\t\treturn function(instance: any, originalConstructor: (...x: any[]) => any, invocationArguments: any[]) {\r\n\r\n\t\t\toriginalConstructor.call(instance, ...invocationArguments);\r\n\t\t\tinstance.gatewayId = diNameUtils.buildServiceName(originalConstructor);\r\n\r\n\t\t\tgatewayProxy.initForService(instance, factoryArguments.length > 0 ? factoryArguments : null);\r\n\t\t\t// $log.debug(`${instance.gatewayId} is mutated into a proxied service with the arguments (${factoryArguments})`);\r\n\t\t};\r\n\t});\r\n}\r\n\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.GatewayProxied = GatewayProxied;\n(window as any).smarteditcommons.GatewayProxiedAnnotationFactory = GatewayProxiedAnnotationFactory;","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport * as lo from 'lodash';\r\nimport {SeInjectable} from 'smarteditcommons/services/dependencyInjection/di';\r\n\r\n/** @internal */\r\ninterface Store {\r\n\turlRegex: RegExp;\r\n\toperationContext: string;\r\n}\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditCommonsModule.service:OperationContextService\r\n * @description\r\n * This service provides the functionality to register a url with its associated operation contexts and also finds operation context given an url.\r\n */\r\n\r\n\r\n@SeInjectable()\r\n/* @ngInject */\n export class OperationContextService {\r\n\tprivate store: Store[];\r\n\t/** @internal */\r\n\tconstructor(private lodash: lo.LoDashStatic) {\r\n\t\tthis.store = [];\r\n\t}\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:OperationContextService#register\r\n     * @methodOf smarteditCommonsModule.service:OperationContextService\r\n     * \r\n     * @description\r\n     * Register a new url with it's associated operationContext.\r\n     * \r\n     * @param {String} url The url that is associated to the operation context.\r\n     * @param {String} operationContext The operation context name that is associated to the given url.\r\n     * \r\n     * @return {Object} operationContextService The operationContextService service\r\n     */\r\n\tregister(url: string, operationContext: string): this {\r\n\t\tif (typeof url !== 'string' || this.lodash.isEmpty(url)) {\r\n\t\t\tthrow new Error('operationContextService.register error: url is invalid');\r\n\t\t}\r\n\t\tif (typeof operationContext !== 'string' || this.lodash.isEmpty(operationContext)) {\r\n\t\t\tthrow new Error('operationContextService.register error: operationContext is invalid');\r\n\t\t}\r\n\t\tconst regexIndex = this.store.findIndex((store) => store.urlRegex.test(url) === true && store.operationContext === operationContext);\r\n\r\n\t\tif (regexIndex !== -1) {\r\n\t\t\treturn null;\r\n\t\t}\r\n\t\tconst urlRegex = new RegExp(url.replace(/\\/:[^\\/]*/g, '/.*'));\r\n\t\tthis.store.push({\r\n\t\t\turlRegex,\r\n\t\t\toperationContext\r\n\t\t});\r\n\t\treturn this;\r\n\t}\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:OperationContextService#findOperationContext\r\n     * @methodOf smarteditCommonsModule.service:OperationContextService\r\n     * \r\n     * @description\r\n     * Find the first matching operation context for the given url.\r\n     * \r\n     * @param {String} url The request url.\r\n     * \r\n     * @return {String} operationContext\r\n     */\r\n\tfindOperationContext(url: string): string {\r\n\t\tconst regexIndex = this.store.findIndex((store) => store.urlRegex.test(url) === true);\r\n\t\treturn ~regexIndex ? this.store[regexIndex].operationContext : null;\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport {annotationService} from 'smarteditcommons/services/annotationService';\r\nimport {OperationContextService} from './OperationContextService';\r\n\r\nconst operationContextName = 'OperationContextRegistered';\r\n\r\n/**\r\n * @ngdoc object\r\n * @name smarteditCommonsModule.object:@OperationContextRegistered\r\n * @description\r\n * Class level typescript {@link http://www.typescriptlang.org/docs/handbook/decorators.html decorator factory} is delegated to  \r\n * {@link smarteditCommonsModule.service:OperationContextService OperationContextService.register} and it provides the functionality \r\n * to register an url with {@link seConstantsModule.object:OPERATION_CONTEXT operation context(s)}.\r\n * \r\n * For example: \r\n * 1. @OperationContextRegistered('apiUrl', ['CMS', 'INTERACTIVE'])\r\n * 2. @OperationContextRegistered('apiUrl', 'TOOLING')\r\n * \r\n * @param {string} url\r\n * @param {string | string[]} operationContext\r\n */\r\n'se:smarteditcommons';\r\nexport const OperationContextRegistered = annotationService.getClassAnnotationFactory(operationContextName) as (url: string, operationContext: string | string[]) => ClassDecorator;\r\n\r\n'se:smarteditcommons';\r\nexport function OperationContextAnnotationFactory($injector: angular.auto.IInjectorService, operationContextService: OperationContextService, OPERATION_CONTEXT: any) {\r\n\t'ngInject';\r\n\treturn annotationService.setClassAnnotationFactory(operationContextName, function(factoryArguments: any[]) {\r\n\t\treturn function(instance: any, originalConstructor: (...x: any[]) => any, invocationArguments: any[]) {\r\n\r\n\t\t\toriginalConstructor.call(instance, ...invocationArguments);\r\n\r\n\t\t\tconst url: string = $injector.has(factoryArguments[0]) ? $injector.get(factoryArguments[0]) : factoryArguments[0];\r\n\r\n\t\t\tif (typeof factoryArguments[1] === 'string') {\r\n\t\t\t\tconst operationContext: string = OPERATION_CONTEXT[factoryArguments[1]];\r\n\t\t\t\toperationContextService.register(url, operationContext);\r\n\t\t\t} else if (Array.isArray(factoryArguments[1]) && factoryArguments[1].length > 0) {\r\n\t\t\t\tfactoryArguments[1].forEach((element: string) => {\r\n\t\t\t\t\toperationContextService.register(url, OPERATION_CONTEXT[element]);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\t});\r\n}\n(window as any).smarteditcommons = (window as any).smarteditcommons ? (window as any).smarteditcommons : {};\n(window as any).smarteditcommons.OperationContextRegistered = OperationContextRegistered;\n(window as any).smarteditcommons.OperationContextAnnotationFactory = OperationContextAnnotationFactory;","\r\n/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n// forced import to make sure d.ts are generated for the interfaces below\r\nimport './forcedImport';\r\n\r\nexport * from './dependencyInjection/di';\r\nexport * from './annotationService';\r\nexport * from './cache';\r\nexport * from './gateway';\r\nexport * from './interfaces';\r\n\r\nexport {AuthorizationService} from './auth/AuthorizationService';\r\nexport {CrossFrameEventService} from './crossFrame/CrossFrameEventService';\r\nexport {CrossFrameEventServiceGateway} from './crossFrame/CrossFrameEventServiceGateway';\r\nexport {GatewayProxied, GatewayProxiedAnnotationFactory} from './gatewayProxiedAnnotation';\r\nexport {instrument} from './instrumentation';\r\nexport {ILanguage, IToolingLanguage, LanguageService} from './language/LanguageService';\r\nexport {LanguageServiceGateway} from './language/LanguageServiceGateway';\r\nexport {IPerspective} from './perspectives/IPerspective';\r\nexport {IPerspectiveService} from './perspectives/IPerspectiveService';\r\nexport * from './rest/rest';\r\nexport {OperationContextService} from './httpErrorInterceptor/default/retryInterceptor/OperationContextService';\r\nexport {OperationContextAnnotationFactory, OperationContextRegistered} from './httpErrorInterceptor/default/retryInterceptor/operationContextAnnotation';\r\nexport {PolyfillService} from './PolyfillService';\r\nexport {PriorityService} from './PriorityService';\r\nexport {SmarteditBootstrapGateway} from './SmarteditBootstrapGateway';\r\nexport {EventHandler, SystemEventService} from './SystemEventService';\r\nexport {TestModeService} from './testModeService';\r\nexport * from './dragAndDrop';\r\nexport * from './storage';\r\n\r\nexport {SmarteditCommonsModule} from './SmarteditCommonsModule';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {Cloneable} from 'smarteditcommons';\r\nimport {FunctionsUtils} from 'smarteditcommons/utils/FunctionsUtils';\r\nimport {SeInjectable} from 'smarteditcommons/services/dependencyInjection/di';\r\ninterface ServiceConfig {\r\n\tname: string;\r\n\texclude: string[];\r\n\tinclude: string[];\r\n}\r\n\r\ninterface DelegateFunction<T> {\r\n\tname: keyof T;\r\n\tfn: (...args: any[]) => any;\r\n}\r\n\r\ninterface FunctionExecutionData {\r\n\tserviceName: string;\r\n\tfunctionName: string;\r\n\targuments: Cloneable;\r\n\tresult: any;\r\n}\r\n\r\n/** @internal */\r\ninterface InstrumentationConfig {\r\n\tglobalExcludedRecipes?: string[];\r\n\tglobalIncludedRecipes?: string[];\r\n\tglobalExcludedFunctions?: string[];\r\n\tglobalIncludedFunctions?: string[];\r\n\tdefaultExcludeModules?: string[];\r\n\tmodules: string[];\r\n\t$provide: angular.auto.IProvideService;\r\n}\r\n\r\n/** @internal */\r\n@SeInjectable()\r\nclass Instrumentation {\r\n\r\n\tprivate _FUNCTION_EXECUTION_DATA: {[key: string]: FunctionExecutionData} = {};\r\n\tprivate _DECORATED_MODULES: any[] = [];\r\n\tprivate _DEFAULT_LEVEL = 10;\r\n\tprivate alreadyBrowsed: string[] = [];\r\n\tprivate functionsUtils: FunctionsUtils = new FunctionsUtils();\r\n\r\n\tconstructor(private readObjectStructure: (arg: Cloneable) => Cloneable) {}\r\n\r\n\texecute(config: InstrumentationConfig, _LEVEL: number, isRoot: boolean): void {\r\n\t\tconst LEVEL = _LEVEL || this._DEFAULT_LEVEL;\r\n\r\n\t\tif (config.modules === undefined) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis._logFunctionArgumentsAndReturnValue = this._logFunctionArgumentsAndReturnValue.bind(this);\r\n\t\tthis._getServiceConfig = this._getServiceConfig.bind(this);\r\n\t\tthis._getIterableDelegate = this._getIterableDelegate.bind(this);\r\n\t\tthis._getDelegateFunctions = this._getDelegateFunctions.bind(this);\r\n\t\tthis._extractComponentBindings = this._extractComponentBindings.bind(this);\r\n\t\tthis._extractDirectiveBindings = this._extractDirectiveBindings.bind(this);\r\n\t\tconst $provide = config.$provide;\r\n\r\n\t\tconfig.modules.forEach((moduleName: string) => {\r\n\r\n\t\t\tthis.alreadyBrowsed.push(moduleName);\r\n\r\n\t\t\tif (!isRoot) {\r\n\t\t\t\tif (this._DECORATED_MODULES.indexOf(moduleName) > -1 || !moduleName.endsWith('Module')) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._DECORATED_MODULES.push(moduleName);\r\n\r\n\t\t\tconst moduleConfig = this._getServiceConfig(moduleName);\r\n\t\t\t// FIXME: necessary to concat?\r\n\t\t\tconst serviceExcludeFunctions = moduleConfig.exclude.concat(config.globalExcludedFunctions || []);\r\n\t\t\tconst serviceIncludeFunctions = moduleConfig.include.concat(config.globalIncludedFunctions || []);\r\n\r\n\t\t\t/* forbiddenNameSpaces angular.module:false */\r\n\t\t\tconst module = angular.module(moduleName);\r\n\r\n\t\t\t(module as any)._invokeQueue.forEach((invoke: [string, string, [string]]) => {\r\n\t\t\t\tconst fn = invoke[1];\r\n\t\t\t\tif (['factory', 'component', 'service', 'directive'].indexOf(fn) > -1) {\r\n\t\t\t\t\tconst args = invoke[2];\r\n\t\t\t\t\tconst recipeName = args[0];\r\n\t\t\t\t\tif (fn === 'component') {\r\n\t\t\t\t\t\tthis._extractComponentBindings(args);\r\n\t\t\t\t\t} else if (fn === 'directive') {\r\n\t\t\t\t\t\tthis._extractDirectiveBindings(args);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\tif (this._isEligible(recipeName, config.globalExcludedRecipes, config.globalIncludedRecipes)) {\r\n\r\n\t\t\t\t\t\t\t\t$provide.decorator(recipeName, ($delegate: (...param: any[]) => any) => {\r\n\r\n\t\t\t\t\t\t\t\t\tconst iterableDelegate = this._getIterableDelegate($delegate);\r\n\t\t\t\t\t\t\t\t\tconst originals: DelegateFunction<(...param: any[]) => any>[] = this._getDelegateFunctions(iterableDelegate, serviceExcludeFunctions, serviceIncludeFunctions);\r\n\r\n\t\t\t\t\t\t\t\t\toriginals.forEach((original) => {\r\n\t\t\t\t\t\t\t\t\t\tif (!iterableDelegate[original.name].__DECORATED__) {\r\n\t\t\t\t\t\t\t\t\t\t\tconst self = this;\r\n\t\t\t\t\t\t\t\t\t\t\tconst isEmpty = self.functionsUtils.isEmpty(original.fn);\r\n\t\t\t\t\t\t\t\t\t\t\tif (isEmpty) {\r\n\t\t\t\t\t\t\t\t\t\t\t\titerableDelegate[original.name] = function() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t'proxyFunction';\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst result = original.fn.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tself._logFunctionArgumentsAndReturnValue(recipeName, original.name, arguments, result);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\titerableDelegate[original.name] = function() {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst result = original.fn.apply(this, arguments);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tself._logFunctionArgumentsAndReturnValue(recipeName, original.name, arguments, result);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\titerableDelegate[original.name].__DECORATED__ = true;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\treturn $delegate;\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.warn(\"not eligible recipe : \" + recipeName);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\tthis.error(e);\r\n\t\t\t\t\t\t\tthis.warn(\"Warning-No-Service-Exists: \" + recipeName + \" of type \" + fn + \", moduleName: \" + moduleName);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tif (LEVEL > 0) {\r\n\t\t\t\tconst NEW_LEVEL = LEVEL - 1;\r\n\t\t\t\tmodule.requires.forEach((_moduleName: string) => {\r\n\t\t\t\t\tif (this.alreadyBrowsed.indexOf(_moduleName) === -1\r\n\t\t\t\t\t\t&& config.defaultExcludeModules.indexOf(_moduleName) === -1\r\n\t\t\t\t\t\t&& _moduleName.indexOf(\"Mock\") === -1) {\r\n\t\t\t\t\t\tthis.execute({\r\n\t\t\t\t\t\t\tglobalExcludedRecipes: config.globalExcludedRecipes,\r\n\t\t\t\t\t\t\tglobalIncludedRecipes: config.globalIncludedRecipes,\r\n\t\t\t\t\t\t\tglobalExcludedFunctions: config.globalExcludedFunctions,\r\n\t\t\t\t\t\t\tglobalIncludedFunctions: config.globalIncludedFunctions,\r\n\t\t\t\t\t\t\tmodules: [_moduleName],\r\n\t\t\t\t\t\t\t$provide: config.$provide,\r\n\t\t\t\t\t\t\tdefaultExcludeModules: config.defaultExcludeModules\r\n\t\t\t\t\t\t}, NEW_LEVEL, false);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t});\r\n\t}\r\n\r\n\tprivate _getServiceConfig(service: string): ServiceConfig {\r\n\t\treturn typeof service === \"string\" ? {\r\n\t\t\tname: service,\r\n\t\t\texclude: [],\r\n\t\t\tinclude: []\r\n\t\t} : service;\r\n\t}\r\n\r\n\tprivate _getIterableDelegate<T extends (...args: any[]) => any>($delegate: T) {\r\n\t\treturn $delegate.prototype ? $delegate.prototype : $delegate;\r\n\t}\r\n\r\n\tprivate _matches(name: string, nameRegex: string): boolean {\r\n\t\treturn (new RegExp(nameRegex, 'gi')).test(name);\r\n\t}\r\n\r\n\tprivate _getDelegateFunctions<T extends (...args: any[]) => any>($delegate: T, serviceExcludeFunctions: string[], serviceIncludeFunctions: string[]): DelegateFunction<T>[] {\r\n\t\tconst result = [];\r\n\r\n\t\tfor (const fnName in $delegate) {\r\n\r\n\t\t\tif (typeof $delegate[fnName] === \"function\") {\r\n\t\t\t\tif (this._isEligible(fnName, serviceExcludeFunctions, serviceIncludeFunctions)) {\r\n\t\t\t\t\tresult.push({\r\n\t\t\t\t\t\tname: fnName,\r\n\t\t\t\t\t\tfn: $delegate[fnName] as any as (...args: any[]) => any\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn result;\r\n\t}\r\n\r\n\tprivate _isEligible(recipeName: string, excludes: string[], includes: string[]): boolean {\r\n\t\treturn (!includes.length || !!includes.find(this._matches.bind(this, recipeName))) && (!excludes.length || !excludes.find(this._matches.bind(this, recipeName)));\r\n\t}\r\n\r\n\tprivate _resultIsPromise(result: angular.IPromise<any>) {\r\n\t\treturn !!result && (result as any).$$state !== undefined;\r\n\t}\r\n\r\n\tprivate _keyExists(key: string) {\r\n\t\tif (this._FUNCTION_EXECUTION_DATA[key] !== undefined) {\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tprivate _extractComponentBindings(args: any[]) {\r\n\t\tconst componentName = args[0];\r\n\t\tconst bindVariables = args[1].bindings;\r\n\t\tthis._logDirectiveResult(componentName, bindVariables);\r\n\t}\r\n\r\n\tprivate _extractDirectiveBindings(args: any[]) {\r\n\t\tconst directiveName = args[0];\r\n\t\ttry {\r\n\t\t\tconst secondAttribute = args[1];\r\n\t\t\tlet directiveConfig = null;\r\n\t\t\tif (typeof secondAttribute === 'function') {\r\n\t\t\t\tdirectiveConfig = secondAttribute();\r\n\t\t\t} else if (secondAttribute instanceof Array) {\r\n\t\t\t\tdirectiveConfig = secondAttribute[secondAttribute.length - 1]();\r\n\t\t\t}\r\n\t\t\tif (directiveConfig) {\r\n\t\t\t\tconst scope = directiveConfig.scope;\r\n\t\t\t\tconst bindToController = directiveConfig.bindToController;\r\n\t\t\t\tthis._logDirectiveResult(directiveName, undefined, scope, bindToController);\r\n\t\t\t}\r\n\t\t} catch (e) {\r\n\t\t\tthis._logDirectiveResult(directiveName);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _logFunctionArgumentsAndReturnValue(serviceName: string, functionName: string, _args: IArguments, result: any | angular.IPromise<any>) {\r\n\t\tconst args = this.readObjectStructure(Array.prototype.slice.call(_args));\r\n\r\n\t\tlet key: string = null;\r\n\t\ttry {\r\n\t\t\tkey = serviceName + \"~\" + functionName + \"~\" + angular.toJson(args);\r\n\t\t} catch (e) {\r\n\t\t\tthis.error('COULD NOT GENERATE KEY');\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tif (this._keyExists(key)) {\r\n\t\t\treturn result;\r\n\t\t}\r\n\t\tthis._FUNCTION_EXECUTION_DATA[key] = {} as FunctionExecutionData;\r\n\r\n\t\tif (this._resultIsPromise(result)) {\r\n\t\t\treturn result.then((res: any) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tthis._FUNCTION_EXECUTION_DATA[key] = {\r\n\t\t\t\t\t\tserviceName,\r\n\t\t\t\t\t\tfunctionName,\r\n\t\t\t\t\t\targuments: args,\r\n\t\t\t\t\t\tresult: {\r\n\t\t\t\t\t\t\tpromiseValue: this.readObjectStructure(res)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t\tthis.warn(angular.toJson(this._FUNCTION_EXECUTION_DATA[key]));\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tthis.error('COULD NOT STRINGIFY');\r\n\t\t\t\t}\r\n\t\t\t\treturn Promise.resolve(res);\r\n\t\t\t}, (reason: Error) => {\r\n\t\t\t\tthis.error('ERROR WHILE RESOLVING RESULT: ' + reason);\r\n\t\t\t\tthis._FUNCTION_EXECUTION_DATA[key] = {\r\n\t\t\t\t\tserviceName,\r\n\t\t\t\t\tfunctionName,\r\n\t\t\t\t\targuments: args,\r\n\t\t\t\t\tresult: {promiseValue: reason}\r\n\t\t\t\t};\r\n\t\t\t\tthis.warn(angular.toJson(this._FUNCTION_EXECUTION_DATA[key]));\r\n\t\t\t\treturn Promise.reject(reason);\r\n\t\t\t});\r\n\t\t} else {\r\n\r\n\t\t\tthis._FUNCTION_EXECUTION_DATA[key] = {\r\n\t\t\t\tserviceName,\r\n\t\t\t\tfunctionName,\r\n\t\t\t\targuments: args,\r\n\t\t\t\tresult: this.readObjectStructure(result)\r\n\t\t\t};\r\n\t\t\ttry {\r\n\t\t\t\tthis.warn(angular.toJson(this._FUNCTION_EXECUTION_DATA[key]));\r\n\t\t\t} catch (e) {\r\n\t\t\t\tthis.error('COULD NOT STRINGIFY');\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _logDirectiveResult(directiveName: string, bindings?: string[], scope?: angular.IScope, bindToController?: {[boundProperty: string]: string}) {\r\n\t\tthis.warn(angular.toJson({\r\n\t\t\tdirectiveName,\r\n\t\t\tbindings,\r\n\t\t\tscope,\r\n\t\t\tbindToController\r\n\t\t}));\r\n\t}\r\n\r\n\tprivate warn(message: string): void {\r\n\t\t// tslint:disable-next-line\r\n\t\tconsole.warn(message)\r\n\t}\r\n\r\n\tprivate error(message: string): void {\r\n\t\t// tslint:disable-next-line\r\n\t\tconsole.error(message)\r\n\t}\r\n\r\n}\r\n\r\nfunction getItemFromSessionStorage(name: string): Cloneable {\r\n\ttry {\r\n\t\treturn window.sessionStorage.getItem(name);\r\n\t} catch (e) {\r\n\t\t/*\r\n\t\t * would fail if:\r\n\t\t * - sessionStorage is not implemented\r\n\t\t * - accessing sessionStorage is forbidden in CORS because of default \"Block third-party cookies\" settings in chrome\r\n\t\t */\r\n\t\treturn null;\r\n\t}\r\n}\r\n\r\n/** @internal */\r\nexport const instrument = ($provide: any, readObjectStructure: (arg: Cloneable) => Cloneable, TOP_LEVEL_MODULE_NAME: string) => {\r\n\t'ngInject';\r\n\r\n\tif (getItemFromSessionStorage(\"isInstrumented\") === \"true\") {\r\n\t\tnew Instrumentation(readObjectStructure).execute({\r\n\t\t\tglobalExcludedRecipes: [\r\n\t\t\t\t\"assetsService\",\r\n\t\t\t\t\"configurationExtractorService\",\r\n\t\t\t\t\"experienceService\"\r\n\t\t\t],\r\n\t\t\tglobalIncludedRecipes: [\r\n\t\t\t\t\"^.*Interface$\",\r\n\t\t\t\t\"^.*Service$\",\r\n\t\t\t\t\"^.*Helper$\",\r\n\t\t\t\t\"^.*Hanlder$\",\r\n\t\t\t\t\"^.*Editor$\",\r\n\t\t\t\t\"^I.*$\",\r\n\t\t\t\t\"^.*Decorator$\",\r\n\t\t\t\t\"^.*Directive$\",\r\n\t\t\t\t\"^.*Registry$\",\r\n\t\t\t\t\"^.*Listener$\",\r\n\t\t\t\t\"^.*Resource$\",\r\n\t\t\t\t\"^.*Populator$\",\r\n\t\t\t\t\"^.*Constants$\",\r\n\t\t\t\t\"^.*Factory$\",\r\n\t\t\t\t\"^.*Facade$\",\r\n\t\t\t\t\"^.*Interceptor$\",\r\n\t\t\t\t\"^.*Manager$\",\r\n\t\t\t\t\"^.*Class$\",\r\n\t\t\t\t\"^.*Strategy\",\r\n\t\t\t\t\"^.*Predicate\",\r\n\t\t\t\t\"^.*Retry\",\r\n\t\t\t\t\"^.*Gateway\"\r\n\t\t\t],\r\n\t\t\tglobalExcludedFunctions: [\"^_.*$\", \"^\\\\$\", \"lodash\", \"yjQuery\"],\r\n\t\t\tglobalIncludedFunctions: [\"^.*$\"], // this regex helps to exclude private function prefixed with \"_\"\r\n\t\t\tdefaultExcludeModules: [\r\n\t\t\t\t\"yjqueryModule\",\r\n\t\t\t\t\"functionsModule\",\r\n\t\t\t\t\"ycmssmarteditModule\",\r\n\t\t\t\t\"timerModule\",\r\n\t\t\t\t\"ui.bootstrap\",\r\n\t\t\t\t\"ngResource\",\r\n\t\t\t\t\"ui.select\",\r\n\t\t\t\t\"yjQuery\",\r\n\t\t\t\t\"instrumentModule\",\r\n\t\t\t\t\"interceptorHelperModule\",\r\n\t\t\t\t\"i18nInterceptorModule\",\r\n\t\t\t\t'loadConfigModule',\r\n\t\t\t\t'ui.tree',\r\n\t\t\t\t'treeModule' // contains fetchChildren function that extracts dom objects that contains circular structure\r\n\t\t\t],\r\n\r\n\t\t\tmodules: [TOP_LEVEL_MODULE_NAME],\r\n\t\t\t$provide\r\n\t\t}, 15, true);\r\n\t}\r\n};","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport enum SeAlertServiceType {\r\n\tInfo = \"INFO\",\r\n\tSuccess = \"SUCCESS\",\r\n\tWarning = \"WARNING\",\r\n\tDanger = \"DANGER\"\r\n}\r\n\r\nexport interface IAlertConfig {\r\n\tmessage?: string;\r\n\ttype?: SeAlertServiceType;\r\n\tmessagePlaceholders?: {[key: string]: any};\r\n\ttemplate?: string;\r\n\ttemplateUrl?: string;\r\n\tcloseable?: boolean;\r\n\ttimeout?: number;\r\n}\r\n\r\nexport interface IAlertService {\r\n\tshowAlert(alertConf: IAlertConfig | string): void;\r\n\tshowInfo(alertConf: IAlertConfig | string): void;\r\n\tshowDanger(alertConf: IAlertConfig | string): void;\r\n\tshowWarning(alertConf: IAlertConfig | string): void;\r\n\tshowSuccess(alertConf: IAlertConfig | string): void;\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {ISite, IUriContext} from \"smarteditcommons\";\r\nimport {IBaseCatalog, IBaseCatalogVersion, ICatalog, ICatalogVersion} from '../../dtos/ICatalog';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditServicesModule.service:catalogService\r\n *\r\n * @description\r\n * The Catalog Service fetches catalogs for a specified site or for all sites registered on the hybris platform using\r\n * REST calls to the cmswebservices Catalog Version Details API.\r\n */\r\nexport abstract class ICatalogService {\r\n\r\n\t// ------------------------------------------------------------------------------------------------------------------------\r\n\t//  Deprecated\r\n\t// ------------------------------------------------------------------------------------------------------------------------\r\n\r\n\t/**\r\n\t * @deprecated since 6.4\r\n\t *\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getAllCatalogsGroupedById\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Fetches a list of content catalog groupings for all sites.\r\n\t *\r\n\t * @returns {Array} An array of catalog groupings sorted by catalog ID, each of which has a name, a catalog ID, and a list of\r\n\t * catalog version descriptors.\r\n\t */\r\n\tgetAllCatalogsGroupedById(): angular.IPromise<ICatalog[][]> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t// ------------------------------------------------------------------------------------------------------------------------\r\n\t//  Active\r\n\t// ------------------------------------------------------------------------------------------------------------------------\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#retrieveUriContext\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Convenience method to return a full {@link resourceLocationsModule.object:UriContext uriContext} to the invoker through a promise.\r\n\t * <br/>if uriContext is provided, it will be returned as such.\r\n\t * <br/>if uriContext is not provided, A uriContext will be built from the experience present in {@link  smarteditServicesModule.sharedDataService sharedDataService}.\r\n\t * if we fail to find a uriContext in sharedDataService, an exception will be thrown.\r\n\t * @param {=Object=} uriContext An optional uriContext that, if provided, is simply returned wrapped in a promise\r\n\t *\r\n\t * @returns {Object} a {@link resourceLocationsModule.object:UriContext uriContext}\r\n\t */\r\n\tretrieveUriContext(_uriContext?: IUriContext): angular.IPromise<IUriContext> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getContentCatalogsForSite\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Fetches a list of content catalogs for the site that corresponds to the specified site UID.\r\n\t *\r\n\t * @param {String} siteUID The UID of the site that the catalog versions are to be fetched.\r\n\t *\r\n\t * @returns {Array} An array of catalog descriptors. Each descriptor provides the following catalog properties:\r\n\t * catalog (name), catalogId, and catalog version descriptors.\r\n\t */\r\n\tgetContentCatalogsForSite(siteUID: string): angular.IPromise<IBaseCatalog[]> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getAllContentCatalogsGroupedById\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Fetches a list of content catalog groupings for all sites.\r\n\t *\r\n\t * @returns {Array} An array of catalog groupings sorted by catalog ID, each of which has a name, a catalog ID, and a list of\r\n\t * catalog version descriptors.\r\n\t */\r\n\tgetAllContentCatalogsGroupedById(): angular.IPromise<ICatalog[][]> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getCatalogByVersion\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Fetches a list of catalogs for the given site UID and a given catalog version.\r\n\t *\r\n\t * @param {String} siteUID The UID of the site that the catalog versions are to be fetched.\r\n\t * @param {String} catalogVersion The version of the catalog that is to be fetched.\r\n\t *\r\n\t * @returns {Array} An array containing the catalog descriptor (if any). Each descriptor provides the following catalog properties:\r\n\t * catalog (name), catalogId, and catalogVersion.\r\n\t */\r\n\t// FIXME : this method does not seem to be safe for same catalogversion version name across multiple catalogs\r\n\tgetCatalogByVersion(siteUID: string, catalogVersionName: string): angular.IPromise<IBaseCatalog[]> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#isContentCatalogVersionNonActive\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Determines whether the catalog version identified by the given uriContext is a non active one\r\n\t * if no uriContext is provided, an attempt will be made to retrieve an experience from {@link smarteditServicesModule.sharedDataService sharedDataService} \r\n\t *\r\n\t * @param {Object} uriContext the {@link resourceLocationsModule.object:UriContext UriContext}. Optional\r\n\t * @returns {Boolean} true if the given catalog version is non active\r\n\t */\r\n\tisContentCatalogVersionNonActive(_uriContext?: IUriContext): angular.IPromise<boolean> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getContentCatalogActiveVersion\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * find the version that is flagged as active for the given uriContext\r\n\t * if no uriContext is provided, an attempt will be made to retrieve an experience from {@link smarteditServicesModule.sharedDataService sharedDataService} \r\n\t *\r\n\t * @param {Object} uriContext the {@link resourceLocationsModule.object:UriContext UriContext}. Optional\r\n\t * @returns {String} the version name\r\n\t */\r\n\tgetContentCatalogActiveVersion(_uriContext?: IUriContext): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getActiveContentCatalogVersionByCatalogId\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Finds the version name that is flagged as active for the given content catalog.\r\n\t *\r\n\t * @param {String} contentCatalogId The UID of content catalog for which to retrieve its active catalog version name.\r\n\t * @returns {String} the version name\r\n\t */\r\n\tgetActiveContentCatalogVersionByCatalogId(contentCatalogId: string): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getDefaultSiteForContentCatalog\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Finds the ID of the default site configured for the provided content catalog. \r\n\t *\r\n\t * @param {String} contentCatalogId The UID of content catalog for which to retrieve its default site ID.\r\n\t * @returns {String} the ID of the default site found. \r\n\t */\r\n\tgetDefaultSiteForContentCatalog(contentCatalogId: string): angular.IPromise<ISite> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getContentCatalogVersion\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Finds the catalog version given an uriContext object.\r\n\t *\r\n\t * @param {Object} uriContext  An object that represents the current context, containing information about the site.\r\n\t * @returns {angular.IPromise<IBaseCatalogVersion>} A promise that resolves to the catalog version descriptor found.\r\n\t */\r\n\tgetContentCatalogVersion(uriContext: IUriContext): angular.IPromise<IBaseCatalogVersion> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getCatalogVersionByUuid\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Finds the catalog version descriptor identified by the provided UUID. An exception is thrown if no\r\n\t * match is found. \r\n\t *\r\n\t * @param {String} catalogVersionUuid The UID of the catalog version descriptor to find. \r\n\t * @param {String=} siteId the ID of the site where to perform the search. If no ID is provided, the search will \r\n\t * be performed on all permitted sites.\r\n\t * @returns {Promise} A promise that resolves to the catalog version descriptor found. \r\n\t * \r\n\t */\r\n\tgetCatalogVersionByUuid(catalogVersionUuid: string, siteId?: string): angular.IPromise<ICatalogVersion> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getCatalogVersionUUid\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Finds the catalog version UUID given an optional urlContext object. The current catalog version UUID from the active experience selector is returned, if the URL is not present in the call. \r\n\t *\r\n\t * @param {Object} urlContext An object that represents the current context, containing information about the site.  \r\n\t * @returns {Promise<String>} A promise that resolves to the catalog version uuid. \r\n\t * \r\n\t */\r\n\tgetCatalogVersionUUid(_uriContext?: IUriContext): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getProductCatalogsForSite\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Fetches a list of product catalogs for the site that corresponds to the specified site UID.\r\n\t *\r\n\t * @param {String} siteUID The UID of the site that the catalog versions are to be fetched.\r\n\t *\r\n\t * @returns {Array} An array of catalog descriptors. Each descriptor provides the following catalog properties:\r\n\t * catalog (name), catalogId, and catalog version descriptors.\r\n\t */\r\n\tgetProductCatalogsForSite(siteUID: string): angular.IPromise<IBaseCatalog[]> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#getActiveProductCatalogVersionByCatalogId\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Finds the version name that is flagged as active for the given product catalog.\r\n\t *\r\n\t * @param {String} productCatalogId The UID of product catalog for which to retrieve its active catalog version name.\r\n\t * @returns {String} the version name\r\n\t */\r\n\tgetActiveProductCatalogVersionByCatalogId(productCatalogId: string): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:catalogService#returnActiveCatalogVersionUIDs\r\n\t * @methodOf smarteditServicesModule.service:catalogService\r\n\t *\r\n\t * @description\r\n\t * Fetches all the active catalog version uuid's for a provided array of catalogs.\r\n\t *\r\n\t * @param {Array} An array of catalogs objects. Each catalog object must have a versions array.\r\n\t * @returns {Array} An array of catalog version uuid's\r\n\t */\r\n\treturnActiveCatalogVersionUIDs(catalogs: ICatalog[]): string[] {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n}","\r\n/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport {IFeature} from \"./IFeature\";\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:IDecorator\r\n * \r\n * @description\r\n * Interface for IDecorator and it acts as a payload passed to addDecorator method of featureService method to register a decorator as a feature.\r\n */\r\nexport interface IDecorator extends IFeature {\r\n\tdisplayCondition?(componentType: string, componentId: string): ng.IPromise<boolean>;\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as lo from 'lodash';\r\nimport {IExperience, IExperienceCatalogVersion, IPreviewCatalogVersionData, IPreviewData} from 'smarteditcommons/services';\r\nimport {Payload} from 'smarteditcommons/dtos';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditServicesModule.service:ExperienceService\r\n *\r\n * @description\r\n * ExperienceService deals with building experience objects given a context.\r\n */\r\n\r\nexport abstract class IExperienceService {\r\n\r\n\t/** @internal */\r\n\tconstructor(protected lodash: lo.LoDashStatic) {\r\n\t}\r\n\r\n\t/* @internal */\r\n\tupdateExperiencePageContext(pageCatalogVersionUuid: string, pageId: string): angular.IPromise<IExperience> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:ExperienceService#getCurrentExperience\r\n\t * @methodOf smarteditServicesModule.service:ExperienceService\r\n\t *\r\n\t * @description\r\n\t * Retrieves the active experience.\r\n\t *\r\n\t * @returns {IExperience} an {@link smarteditServicesModule.interface:IExperience experience}\r\n\t */\r\n\tgetCurrentExperience(): angular.IPromise<IExperience> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:ExperienceService#setCurrentExperience\r\n\t * @methodOf smarteditServicesModule.service:ExperienceService\r\n\t *\r\n\t * @description\r\n\t * Stores a given experience as current experience.\r\n\t * Invoking this method ensures that a hard refresh of the application will preserve the experience.\r\n\t * \r\n\t * @returns {angular.IPromise<IExperience>} a promise returning the experience\r\n\t */\r\n\tsetCurrentExperience(experience: IExperience): angular.IPromise<IExperience> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:ExperienceService#hasCatalogVersionChanged\r\n\t * @methodOf smarteditServicesModule.service:ExperienceService\r\n\t *\r\n\t * @description\r\n\t * Determines whether the catalog version has changed between the previous and current experience\r\n\t * \r\n\t * @returns {angular.IPromise<boolean>} a promise returning whether thta catalog version has changed\r\n\t */\r\n\thasCatalogVersionChanged(): angular.IPromise<boolean> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.service:ExperienceService#buildRefreshedPreviewUrl\r\n     * @methodOf smarteditServicesModule.service:ExperienceService\r\n     *\r\n     * @description\r\n     * Retrieves the active experience, creates a new preview ticket and returns a new preview url with an updated\r\n     * previewTicketId query param\r\n     *\r\n     * @returns {angular.IPromise<string>} an url containing the new previewTicketId\r\n     */\r\n\tbuildRefreshedPreviewUrl(): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:ExperienceService#updateExperience\r\n\t * @methodOf smarteditServicesModule.service:ExperienceService\r\n\t *\r\n\t * @description\r\n\t * Retrieves the active experience, merges it with a new experience, creates a new preview ticket and reloads the\r\n\t * preview within the iframeManagerService\r\n\t *\r\n\t * @param {Payload=} newExperience The object containing new attributes to be merged with the current experience\r\n\t *\r\n\t * @returns {angular.IPromise<IExperience>} An promise of the updated experience\r\n\t */\r\n\tupdateExperience(newExperience?: Payload): angular.IPromise<IExperience> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/** @internal */\r\n\t_convertExperienceToPreviewData(experience: IExperience, resourcePath: string): IPreviewData {\r\n\t\tconst previewData = this.lodash.cloneDeep(experience) as any;\r\n\t\tconst catalogVersions: IPreviewCatalogVersionData[] = [];\r\n\r\n\t\tdelete previewData.catalogDescriptor;\r\n\t\tdelete previewData.siteDescriptor;\r\n\t\tdelete previewData.languageDescriptor;\r\n\t\tdelete previewData.pageContext;\r\n\t\tdelete previewData.productCatalogVersions;\r\n\r\n\t\tif (experience.productCatalogVersions && experience.productCatalogVersions.length) {\r\n\t\t\texperience.productCatalogVersions.forEach((productCatalogVersion: IExperienceCatalogVersion) => {\r\n\t\t\t\tcatalogVersions.push({\r\n\t\t\t\t\tcatalog: productCatalogVersion.catalog,\r\n\t\t\t\t\tcatalogVersion: productCatalogVersion.catalogVersion\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t\tcatalogVersions.push({\r\n\t\t\tcatalog: experience.catalogDescriptor.catalogId,\r\n\t\t\tcatalogVersion: experience.catalogDescriptor.catalogVersion\r\n\t\t});\r\n\r\n\t\tpreviewData.catalogVersions = catalogVersions;\r\n\t\tpreviewData.language = experience.languageDescriptor.isocode;\r\n\t\tpreviewData.resourcePath = resourcePath;\r\n\r\n\t\treturn previewData as IPreviewData;\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nexport interface InternalFeature {\r\n\r\n    /**\r\n     * @ngdoc property\r\n     * @name key\r\n     * @propertyOf smarteditServicesModule.interface:IFeature\r\n     * @description The feature (could be IDecorator | IToolbarItem | IContextualMenuButton) key defined in the API\r\n     */\r\n\tkey: string;\r\n\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name nameI18nKey\r\n\t * @propertyOf smarteditServicesModule.interface:IFeature\r\n\t * @description The i18n key that stores the feature name to be translated.\r\n\t */\r\n\tnameI18nKey: string;\r\n\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name descriptionI18nKey\r\n\t * @propertyOf smarteditServicesModule.interface:IFeature\r\n\t * @description The i18n key that stores the feature description to be translated. The description is used as a tooltip in the web application. This is an optional parameter.\r\n\t */\r\n\tdescriptionI18nKey?: string;\r\n\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name permissions\r\n\t * @propertyOf smarteditServicesModule.interface:IFeature\r\n\t * @description The list of permissions required to enable the feature.\r\n\t */\r\n\tpermissions?: string[];\r\n\r\n}\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:IFeature\r\n * \r\n * @description\r\n * IFeature - Interface for feature configuration DTO in FeatureService\r\n */\r\n\r\nexport interface IFeature extends InternalFeature {\r\n\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name enablingCallback\r\n\t * @propertyOf smarteditServicesModule.interface:IFeature\r\n\t * @description The callback to be called when feature is enabled.\r\n\t */\r\n\tenablingCallback?: () => void;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name disablingCallback\r\n\t * @propertyOf smarteditServicesModule.interface:IFeature\r\n\t * @description The callback to be called when feature is disbled.\r\n\t */\r\n\tdisablingCallback?: () => void;\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as lo from 'lodash';\r\nimport {CloneableUtils, InternalFeature, IContextualMenuButton, IDecorator, IFeature, IToolbarItem} from 'smarteditcommons';\r\n\r\n/* @internal */\r\nexport interface IFeaturesToAlias {\r\n\t[index: string]: {\r\n\t\tenablingCallback: () => void;\r\n\t\tdisablingCallback: () => void;\r\n\t};\r\n}\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:IFeatureService\r\n *\r\n * @description\r\n * The interface stipulates how to register features in the SmartEdit application and the SmartEdit container.\r\n * The SmartEdit implementation stores two instances of the interface across the {@link smarteditCommonsModule.service:GatewayFactory gateway}: one for the SmartEdit application and one for the SmartEdit container.\r\n */\r\nexport abstract class IFeatureService {\r\n\r\n\tprotected _featuresToAlias: IFeaturesToAlias;\r\n\r\n\t/** @internal */\r\n\tconstructor(private lodash: lo.LoDashStatic, private cloneableUtils: CloneableUtils) {}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IFeatureService#register\r\n\t * @methodOf smarteditServicesModule.interface:IFeatureService\r\n\t * @description\r\n\t * This method registers a feature.\r\n\t * When an end user selects a perspective, all the features that are bound to the perspective\r\n\t * will be enabled when their respective enablingCallback functions are invoked\r\n\t * and all the features that are not bound to the perspective will be disabled when their respective disablingCallback functions are invoked.\r\n\t * The SmartEdit application and the SmartEdit container hold/store an instance of the implementation because callbacks cannot cross the gateway as they are functions.\r\n\t *\r\n\t * this method is meant to register a feature (identified by a key).\r\n\t * When a perspective (registered through {@link smarteditServicesModule.interface:IPerspectiveService#methods_register IPerspectiveService.register}) is selected, all its bound features will be enabled by invocation of their respective enablingCallback functions\r\n\t * and any feature not bound to it will be disabled by invocation of its disablingCallback function.\r\n\t * Both SmartEdit and SmartEditContainer will hold a concrete implementation since Callbacks, being functions, cannot cross the gateway.\r\n\t * The function will keep a frame bound reference on a full feature in order to be able to invoke its callbacks when needed.\r\n\t *\r\n\t * @param {IContextualMenuButton | IDecorator | IToolbarItem} configuration of a {@link smarteditServicesModule.interface:IContextualMenuButton IContextualMenuButton} or \r\n\t * {@link smarteditServicesModule.interface:IDecorator IDecorator} or {@link smarteditServicesModule.interface:IToolbarItem IToolbarItem}\r\n\t * \r\n\t * @return {angular.IPromise<void>} An empty promise\r\n\t */\r\n\tregister(configuration: IFeature): angular.IPromise<void> {\r\n\t\tthis._validate(configuration);\r\n\r\n\t\tthis._featuresToAlias = this._featuresToAlias || {};\r\n\t\tthis._featuresToAlias[configuration.key] = {\r\n\t\t\tenablingCallback: configuration.enablingCallback,\r\n\t\t\tdisablingCallback: configuration.disablingCallback\r\n\t\t};\r\n\r\n\t\tdelete configuration.enablingCallback;\r\n\t\tdelete configuration.disablingCallback;\r\n\r\n\t\treturn this._registerAliases(this.cloneableUtils.makeCloneable(configuration) as any as InternalFeature);\r\n\t}\r\n\r\n\tenable(key: string) {\r\n\t\tif (this._featuresToAlias && this._featuresToAlias[key]) {\r\n\t\t\tthis._featuresToAlias[key].enablingCallback();\r\n\t\t} else {\r\n\t\t\tthis._remoteEnablingFromInner(key);\r\n\t\t}\r\n\t}\r\n\r\n\tdisable(key: string) {\r\n\t\tif (this._featuresToAlias && this._featuresToAlias[key]) {\r\n\t\t\tthis._featuresToAlias[key].disablingCallback();\r\n\t\t} else {\r\n\t\t\tthis._remoteDisablingFromInner(key);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IFeatureService#getFeatureProperty\r\n\t * @methodOf smarteditServicesModule.interface:IFeatureService\r\n\t * @description\r\n\t * Returns a feature property\r\n\t *\r\n\t * @param {String} featureKey the key property value of the feature\r\n\t * @param {String} propertyName name of the property\r\n\t *\r\n\t * @return {angular.IPromise<string | string[] | (() => void)>} returns promise of property value or null if property does not exist\r\n\t */\r\n\tgetFeatureProperty(featureKey: string, propertyName: keyof IFeature): angular.IPromise<string | string[] | (() => void)> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IFeatureService#addToolbarItem\r\n\t * @methodOf smarteditServicesModule.interface:IFeatureService\r\n\t *\r\n\t * @description\r\n\t * This method registers toolbar items as features. It is a wrapper around {@link smarteditServicesModule.interface:IFeatureService#methods_register register}.\r\n\t *\r\n\t * @param {IToolbarItem} configuration The {@link smarteditServicesModule.interface:IToolbarItem configuration} that represents the toolbar action item to be registered.\r\n\t * \r\n\t * @return {angular.IPromise<void>} An empty promise\r\n\t */\r\n\taddToolbarItem(toolbar: IToolbarItem): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IFeatureService#addDecorator\r\n\t * @methodOf smarteditServicesModule.interface:IFeatureService\r\n\t *\r\n\t * @description\r\n\t * this method registers decorator and delegates to the\r\n\t *  {@link decoratorServiceModule.service:decoratorService#methods_enable enable}\r\n\t *  {@link decoratorServiceModule.service:decoratorService#methods_disable disable} methods of\r\n\t *  {@link decoratorServiceModule.service:decoratorService decoratorService}.\r\n\t * This method is not a wrapper around {@link decoratorServiceModule.service:decoratorService#addMappings decoratorService.addMappings}:\r\n\t * From a feature stand point, we deal with decorators, not their mappings to SmartEdit components.\r\n\t * We still need to have a separate invocation of {@link decoratorServiceModule.service:decoratorService#addMappings decoratorService.addMappings}\r\n\t * @param {IDecorator} configuration The {@link smarteditServicesModule.interface:IDecorator configuration} that represents the decorator to be registered.\r\n\t * @return {angular.IPromise<void>} An empty promise\r\n\t */\r\n\taddDecorator(decorator: IDecorator): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IFeatureService#addContextualMenuButton\r\n\t * @methodOf smarteditServicesModule.interface:IFeatureService\r\n\t *\r\n\t * @description\r\n\t * This method registers contextual menu buttons. It is a wrapper around {@link smarteditServicesModule.ContextualMenuService#methods_addItems contextualMenuService.addItems}.\r\n\t *\r\n\t * @param {IContextualMenuButton} btn The {@link smarteditServicesModule.interface:IContextualMenuButton btn} that represents the feature to be registered.\r\n\t * \r\n\t * @return {angular.IPromise<void>} An empty promise\r\n\t */\r\n\taddContextualMenuButton(btn: IContextualMenuButton): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprotected _remoteEnablingFromInner(key: string): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\tprotected _remoteDisablingFromInner(key: string): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * This method registers a feature, identified by a unique key, across the {@link smarteditCommonsModule.service:GatewayFactory gateway}.\r\n\t * It is a simplified version of the register method, from which callbacks have been removed.\r\n\t */\r\n\tprotected _registerAliases(configuration: InternalFeature): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\tprivate _validate(configuration: IFeature) {\r\n\r\n\t\tif (this.lodash.isEmpty(configuration.key)) {\r\n\t\t\tthrow new Error(\"featureService.configuration.key.error.required\");\r\n\t\t}\r\n\t\tif (this.lodash.isEmpty(configuration.nameI18nKey)) {\r\n\t\t\tthrow new Error(\"featureService.configuration.nameI18nKey.error.required\");\r\n\t\t}\r\n\t\tif (!this.lodash.isFunction(configuration.enablingCallback)) {\r\n\t\t\tthrow new Error(\"featureService.configuration.enablingCallback.error.not.function\");\r\n\t\t}\r\n\t\tif (!this.lodash.isFunction(configuration.disablingCallback)) {\r\n\t\t\tthrow new Error(\"featureService.configuration.disablingCallback.error.not.function\");\r\n\t\t}\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface: IBound\r\n * @description\r\n * Interface for mouse bounds\r\n */\r\nexport interface IBound {\r\n\tx: number;\r\n\ty: number;\r\n\twidth: number;\r\n\theight: number;\r\n}\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:INotificationMouseLeaveDetectionService\r\n *\r\n * @description\r\n * The interface defines the methods required to detect when the mouse leaves the notification panel\r\n * in the SmartEdit application and in the SmartEdit container.\r\n *\r\n * It is solely meant to be used with the notificationService.\r\n */\r\nexport abstract class INotificationMouseLeaveDetectionService {\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:INotificationMouseLeaveDetectionService#startDetection\r\n     * @methodOf smarteditServicesModule.interface:INotificationMouseLeaveDetectionService\r\n     *\r\n     * @description\r\n     * This method starts tracking the movement of the mouse pointer in order to detect when it\r\n     * leaves the notification panel.\r\n     *\r\n     * The innerBounds parameter is considered optional. If it is not provided, it will not be\r\n     * validated and detection will only be started in the SmartEdit container.\r\n     *\r\n     * Here is an example of a bounds object:\r\n     *\r\n     * {\r\n     *     x: 100,\r\n     *     y: 100,\r\n     *     width: 200,\r\n     *     height: 50\r\n     * }\r\n     *\r\n     * This method will throw an error if:\r\n     *     - the bounds parameter is not provided\r\n     *     - a bounds object does not contain the X coordinate\r\n     *     - a bounds object does not contain the Y coordinate\r\n     *     - a bounds object does not contain the width dimension\r\n     *     - a bounds object does not contain the height dimension\r\n     */\r\n\r\n\tstartDetection(outerBounds: IBound, innerBounds: IBound, callback: () => any): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:INotificationMouseLeaveDetectionService#stopDetection\r\n     * @methodOf smarteditServicesModule.interface:INotificationMouseLeaveDetectionService\r\n     *\r\n     * @description\r\n     * This method stops tracking the movement of the mouse pointer.\r\n     */\r\n\tstopDetection(): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * This method is used to start tracking the movement of the mouse pointer within the iFrame.\r\n     */\r\n\tprotected _remoteStartDetection(bound: IBound): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * This method is used to stop tracking the movement of the mouse pointer within the iFrame.\r\n     */\r\n\tprotected _remoteStopDetection(): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * This method is used to call the callback function when it is detected from within the iFrame that\r\n     * the mouse left the notification panel\r\n     */\r\n\tprotected _callCallback(): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * This method is called for each mouse movement. It evaluates whether or not the\r\n     * mouse pointer is in the notification panel. If it isn't, it calls the onMouseLeave.\r\n     */\r\n\tprotected _onMouseMove(event: MouseEvent): void {\r\n\r\n\t\tthis._getBounds().then((bounds: IBound) => {\r\n\t\t\tconst isOutsideX = bounds && event && (event.clientX < bounds.x || event.clientX > bounds.x + bounds.width);\r\n\t\t\tconst isOutsideY = bounds && event && (event.clientY < bounds.y || event.clientY > bounds.y + bounds.height);\r\n\r\n\t\t\tif (isOutsideX || isOutsideY) {\r\n\t\t\t\tthis._onMouseLeave();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n    /**\r\n     * This method gets bounds\r\n     */\r\n\tprotected _getBounds(): angular.IPromise<IBound> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * This method gets callback\r\n     */\r\n\tprotected _getCallback(): angular.IPromise<(() => void)> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * This method is triggered when the service has detected that the mouse left the\r\n     * notification panel. It will execute the callback function and stop detection.\r\n     */\r\n\tprivate _onMouseLeave(): void {\r\n\r\n\t\tthis._getCallback().then((callback: () => void) => {\r\n\t\t\tif (callback) {\r\n\t\t\t\tcallback();\r\n\t\t\t\tthis.stopDetection();\r\n\t\t\t} else {\r\n\t\t\t\tthis._callCallback().then(() => {\r\n\t\t\t\t\tthis.stopDetection();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport * as angular from 'angular';\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:INotificationConfiguration\r\n * \r\n * @description\r\n * Interface for Notification Configuration\r\n */\r\nexport interface INotificationConfiguration {\r\n    /**\r\n     * @ngdoc property\r\n     * @name id\r\n     * @propertyOf smarteditServicesModule.interface:INotificationConfiguration\r\n     * @description The notification's unique identifier\r\n     */\r\n\tid: string;\r\n\r\n    /**\r\n     * @ngdoc property\r\n     * @name template\r\n     * @propertyOf smarteditServicesModule.interface:INotificationConfiguration\r\n     * @description The notification's HTML template. Either template or templateUrl should be present but not both.\r\n     */\r\n\ttemplate?: string;\r\n\r\n    /**\r\n     * @ngdoc property\r\n     * @name template\r\n     * @propertyOf smarteditServicesModule.interface:INotificationConfiguration\r\n     * @description The notification's template URL. Either template or templateUrl should be present but not both.\r\n     */\r\n\ttemplateUrl?: string;\r\n}\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:INotificationService\r\n * \r\n * @description\r\n * INotificationService provides a service to display visual cues to inform\r\n * the user of the state of the application in the container or the iFramed application.\r\n * The interface defines the methods required to manage notifications that are to be displayed to the user.\r\n */\r\nexport abstract class INotificationService {\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:INotificationService#pushNotification\r\n     * @methodOf smarteditServicesModule.interface:INotificationService\r\n     * \r\n     * @description\r\n     * This method creates a new notification based on the given configuration and\r\n     * adds it to the top of the list.\r\n     * \r\n     * The configuration must contain either a template or template URL, but not both.\r\n     * \r\n     * @param {Object} configuration The notification's configuration {@link smarteditServicesModule.interface:INotificationConfiguration INotificationConfiguration}\r\n     * \r\n     * @throws An error if no configuration is given.\r\n     * @throws An error if the configuration does not contain a unique identifier.\r\n     * @throws An error if the configuration's unique identifier is an empty string.\r\n     * @throws An error if the configuration does not contain a template or templateUrl.\r\n     * @throws An error if the configuration contains both a template and template Url.\r\n     */\r\n\tpushNotification(configuration: INotificationConfiguration): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:INotificationService#removeNotification\r\n     * @methodOf smarteditServicesModule.interface:INotificationService\r\n     * \r\n     * @description\r\n     * This method removes the notification with the given ID from the list.\r\n     * \r\n     * @param {String} notificationId The notification's unique identifier.\r\n     */\r\n\tremoveNotification(notificationId: string): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:INotificationService#removeAllNotifications\r\n     * @methodOf smarteditServicesModule.interface:INotificationService\r\n     * \r\n     * @description\r\n     * This method removes all notifications.\r\n     */\r\n\tremoveAllNotifications(): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:IPageInfoService\r\n *\r\n * @description\r\n * The IPageInfoService provides information about the storefront page currently loaded in the iFrame.\r\n */\r\n\r\nexport abstract class IPageInfoService {\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IPageInfoService#getPageUID\r\n\t * @methodOf smarteditServicesModule.interface:IPageInfoService\r\n\t *\r\n\t * @description\r\n\t * This extracts the pageUID of the storefront page loaded in the smartedit iframe.\r\n\t *\r\n\t * @return {angular.IPromise<string>} A promise resolving to a string matching the page's ID\r\n\t */\r\n\tgetPageUID(): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IPageInfoService#getPageUUID\r\n\t * @methodOf smarteditServicesModule.interface:IPageInfoService\r\n\t *\r\n\t * @description\r\n\t * This extracts the pageUUID of the storefront page loaded in the smartedit iframe.\r\n\t * The UUID is different from the UID in that it is an encoding of uid and catalog version combined\r\n\t *\r\n\t * @return {angular.IPromise<string>} A promise resolving to the page's UUID\r\n\t */\r\n\tgetPageUUID(): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IPageInfoService#getCatalogVersionUUIDFromPage\r\n\t * @methodOf smarteditServicesModule.interface:IPageInfoService\r\n\t *\r\n\t * @description\r\n\t * This extracts the catalogVersionUUID of the storefront page loaded in the smartedit iframe.\r\n\t * The UUID is different from the UID in that it is an encoding of uid and catalog version combined\r\n\t *\r\n\t * @return {angular.IPromise<string>} A promise resolving to the page's UUID\r\n\t */\r\n\tgetCatalogVersionUUIDFromPage(): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {TypedMap} from \"smarteditcommons\";\r\n\r\nexport interface Rule {\r\n\tnames: string[];\r\n\tverify: (permissionObjects?: PermissionContext[]) => angular.IPromise<boolean>;\r\n}\r\n\r\nexport interface Permission {\r\n\taliases: string[];\r\n\trules: string[];\r\n}\r\n\r\nexport interface MultiNamePermissionContext {\r\n\tnames: string[];\r\n\tcontext?: TypedMap<any>;\r\n}\r\n\r\nexport interface PermissionContext {\r\n\tname: string;\r\n\tcontext?: TypedMap<any>;\r\n}\r\n\r\n/* @internal */\r\nexport interface RuleNames {\r\n\tnames: string[];\r\n}\r\n\r\nconst prepareRuleConfiguration = function(ruleConfiguration: Rule): RuleNames {\r\n\tthis.ruleVerifyFunctions = this.ruleVerifyFunctions || {};\r\n\tthis.ruleVerifyFunctions[ruleConfiguration.names.join(\"-\")] = {\r\n\t\tverify: ruleConfiguration.verify\r\n\t};\r\n\tdelete ruleConfiguration.verify;\r\n\r\n\treturn ruleConfiguration;\r\n};\r\n\r\nconst validateRule = function(rule: Rule): void {\r\n\tif (!(rule.names instanceof Array)) {\r\n\t\tthrow Error(\"Rule names must be array\");\r\n\t}\r\n\r\n\tif (rule.names.length < 1) {\r\n\t\tthrow Error(\"Rule requires at least one name\");\r\n\t}\r\n\r\n\tif (!rule.verify) {\r\n\t\tthrow Error(\"Rule requires a verify function\");\r\n\t}\r\n\r\n\tif (typeof rule.verify !== 'function') {\r\n\t\tthrow Error(\"Rule verify must be a function\");\r\n\t}\r\n};\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditCommonsModule.service:PermissionServiceInterface\r\n *\r\n * @description\r\n * The permission service is used to check if a user has been granted certain permissions.\r\n *\r\n * It is configured with rules and permissions. A rule is used to execute some logic to determine whether or not\r\n * the permission should be granted. A permission references a list of rules. In order for a permission to be\r\n * granted, each rule must be executed successfully and return true.\r\n */\r\nexport abstract class IPermissionService {\r\n\r\n\truleVerifyFunctions: TypedMap<{verify: (obj: any) => angular.IPromise<boolean>}>;\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditCommonsModule.service:PermissionServiceInterface#clearCache\r\n\t * @methodOf smarteditCommonsModule.service:PermissionServiceInterface\r\n\t *\r\n\t * @description\r\n\t * This method clears all cached results in the rules' caches.\r\n\t */\r\n\tclearCache(): void {\r\n\t\t'proxyFunction';\r\n\t\treturn;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditCommonsModule.service:PermissionServiceInterface#getPermission\r\n\t * @methodOf smarteditCommonsModule.service:PermissionServiceInterface\r\n\t *\r\n\t * @description\r\n\t * This method returns the registered permission that contains the given name in its\r\n\t * array of names.\r\n\t *\r\n\t * @param {String} permissionName The name of the permission to lookup.\r\n\t *\r\n\t * @returns {Object} rule The permission with the given name, undefined otherwise.\r\n\t */\r\n\tgetPermission(permission: string): Permission {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditCommonsModule.service:PermissionServiceInterface#isPermitted\r\n\t * @methodOf smarteditCommonsModule.service:PermissionServiceInterface\r\n\t *\r\n\t * @description\r\n\t * This method checks if a user has been granted certain permissions.\r\n\t *\r\n\t * It takes an array of permission objects structured as follows:\r\n\t *\r\n\t * {\r\n\t *     names: [\"permission.aliases\"],\r\n\t *     context: {\r\n\t *         data: \"required to check a permission\"\r\n\t *     }\r\n\t * }\r\n\t *\r\n\t * @param {Object[]} permissions A list of permission objects.\r\n\t *\r\n\t * @returns {IPromise} A promise that resolves to true if permission is granted, rejects to false if it isn't and rejects on error.\r\n\t */\r\n\tisPermitted(permissions: MultiNamePermissionContext[]): angular.IPromise<boolean> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditCommonsModule.service:PermissionServiceInterface#registerPermission\r\n\t * @methodOf smarteditCommonsModule.service:PermissionServiceInterface\r\n\t *\r\n\t * @description\r\n\t * This method registers a permission.\r\n\t *\r\n\t * A permission is defined by a set of aliases and rules. It is verified by its set of rules.\r\n\t * The set of aliases is there for convenience, as there may be different permissions\r\n\t * that use the same set of rules to be verified. The permission aliases property\r\n\t * will resolve if any one alias is in the aliases' array. Calling {@link smarteditCommonsModule.service:PermissionServiceInterface#isPermitted}\r\n\t * with any of these aliases will use the same permission object, therefore the same\r\n\t * combination of rules to check if the user has the appropriate clearance. This reduces the\r\n\t * number of permissions you need to register.\r\n\t *\r\n\t * @param {Object} configuration The configuration of the permission to register.\r\n\t * @param {String[]} configuration.aliases The list of aliases associated to the permission. A permission alias must be prefixed by at least one\r\n\t * namespace followed by a \".\" character to be valid. i.e. \"se.fake.permission\"\r\n\t * @param {String[]} configuration.rules The list of the names of the rules used to verify.\r\n\t *\r\n\t * @throws Will throw an error if the permission has no aliases array\r\n\t * @throws Will throw an error if the permission's aliases array is empty\r\n\t * @throws Will throw an error if the permission has no rules array\r\n\t * @throws Will throw an error if the permission's rule aliases array is empty\r\n\t * @throws Will throw an error if a permission is already registered with a common entry in its array of aliases\r\n\t * @throws Will throw an error if one of the permission's aliases is not name spaced\r\n\t * @throws Will throw an error if no rule is registered with on of the permission's rule names\r\n\t */\r\n\tregisterPermission(permission: Permission): void {\r\n\t\t'proxyFunction';\r\n\t\treturn;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditCommonsModule.service:PermissionServiceInterface#registerRule\r\n\t * @methodOf smarteditCommonsModule.service:PermissionServiceInterface\r\n\t *\r\n\t * @description\r\n\t * This method registers a rule. These rules can be used by registering permissions that\r\n\t * use them to verify if a user has the appropriate clearance.\r\n\t *\r\n\t * To avoid accidentally overriding the default rule, an error is thrown when attempting\r\n\t * to register a rule with the {@link smarteditServicesModule.object:DEFAULT_RULE_NAME\r\n\t * default rule name}.\r\n\t *\r\n\t * To register the default rule, see {@link smarteditCommonsModule.service:PermissionServiceInterface#registerDefaultRule}.\r\n\t *\r\n\t * @param {Object} ruleConfiguration The configuration of the rule to register.\r\n\t * @param {String[]} ruleConfiguration.names The list of names associated to the rule.\r\n\t * @param {Function} ruleConfiguration.verify The verification function of the rule. It must return a promise that responds with true, false, or an error.\r\n\t *\r\n\t * @throws Will throw an error if the list of rule names contains the reserved {@link smarteditServicesModule.object:DEFAULT_RULE_NAME default rule name}.\r\n\t * @throws Will throw an error if the rule has no names array.\r\n\t * @throws Will throw an error if the rule's names array is empty.\r\n\t * @throws Will throw an error if the rule has no verify function.\r\n\t * @throws Will throw an error if the rule's verify parameter is not a function.\r\n\t * @throws Will throw an error if a rule is already registered with a common entry in its names array\r\n\t */\r\n\tregisterRule(ruleConfiguration: Rule): void {\r\n\t\tvalidateRule(ruleConfiguration);\r\n\t\truleConfiguration = prepareRuleConfiguration.bind(this)(ruleConfiguration);\r\n\t\tthis._registerRule(ruleConfiguration);\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditCommonsModule.service:PermissionServiceInterface#registerDefaultRule\r\n\t * @methodOf smarteditCommonsModule.service:PermissionServiceInterface\r\n\t *\r\n\t * @description\r\n\t * This method registers the default rule.\r\n\t *\r\n\t * The default rule is used when no permission is found for a given permission name when\r\n\t * {@link smarteditCommonsModule.service:PermissionServiceInterface#isPermitted} is called.\r\n\t *\r\n\t * @param {Object} ruleConfiguration The configuration of the default rule.\r\n\t * @param {String[]} ruleConfiguration.names The list of names associated to the default rule (must contain {@link smarteditServicesModule.object:DEFAULT_RULE_NAME}).\r\n\t * @param {Function} ruleConfiguration.verify The verification function of the default rule.\r\n\t *\r\n\t * @throws Will throw an error if the default rule's names does not contain {@link smarteditServicesModule.object:DEFAULT_RULE_NAME}\r\n\t * @throws Will throw an error if the default rule has no names array.\r\n\t * @throws Will throw an error if the default rule's names array is empty.\r\n\t * @throws Will throw an error if the default rule has no verify function.\r\n\t * @throws Will throw an error if the default rule's verify parameter is not a function.\r\n\t * @throws Will throw an error if a rule is already registered with a common entry in its names array\r\n\t */\r\n\tregisterDefaultRule(ruleConfiguration: Rule): void {\r\n\t\truleConfiguration = prepareRuleConfiguration.bind(this)(ruleConfiguration);\r\n\t\tthis._registerDefaultRule(ruleConfiguration);\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditCommonsModule.service:PermissionServiceInterface#unregisterDefaultRule\r\n\t * @methodOf smarteditCommonsModule.service:PermissionServiceInterface\r\n\t *\r\n\t * @description\r\n\t * This method un-registers the default rule.\r\n\t */\r\n\tunregisterDefaultRule(): void {\r\n\t\t'proxyFunction';\r\n\t\treturn;\r\n\t}\r\n\r\n\tprotected _registerRule(ruleConfiguration: Rule): void {\r\n\t\t'proxyFunction';\r\n\t\treturn;\r\n\t}\r\n\r\n\tprotected _registerDefaultRule(ruleConfiguration: Rule): void {\r\n\t\t'proxyFunction';\r\n\t\treturn;\r\n\t}\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {IPreviewData, IPreviewResponse} from './IPreview';\r\nimport {UrlUtils} from \"smarteditcommons/utils/UrlUtils\";\r\nimport {SeInjectable} from '../dependencyInjection/di';\r\n\r\n/**\r\n * @name smarteditServicesModule.interface:IPreviewService\r\n *\r\n * @description\r\n *\r\n * Interface for previewService.\r\n *\r\n * This service is for managing the storefront preview ticket and is proxied across the gateway. (implements)\r\n *\r\n */\r\n@SeInjectable()\r\nexport abstract class IPreviewService {\r\n\r\n\tconstructor(private urlUtils: UrlUtils) {\r\n\t}\r\n\r\n    /**\r\n     * @name smarteditServicesModule.interface:IPreviewService#createPreview\r\n     * @methodOf smarteditServicesModule.interface:IPreviewService\r\n     *\r\n     * @description\r\n     * This method will create a new previewTicket for the given experience, using the preview API\r\n     * <br />\r\n     * This method does *NOT* update the current experience.\r\n     *\r\n     * @param {Object} previewData Data representing storefront preview\r\n     *\r\n     * @returns {Object} A {@link smarteditServicesModule.interface:IPreview IPreviewResponse} object\r\n     */\r\n\tcreatePreview(previewData: IPreviewData): angular.IPromise<IPreviewResponse> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @name smarteditServicesModule.interface:IPreviewService#getResourcePathFromPreviewUrl\r\n     * @methodOf smarteditServicesModule.interface:IPreviewService\r\n     *\r\n     * @description\r\n     * This method will preduce a resourcePath from a given preview url\r\n     * <br />\r\n     * This method does *NOT* update the current experience.\r\n     *\r\n     * @param {Object} previewUrl A URL for a storefornt with preview\r\n     *\r\n     * @returns {Object} A {@link smarteditServicesModule.interface:IPreview IPreviewResponse} object\r\n     */\r\n\tgetResourcePathFromPreviewUrl(previewUrl: string): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @name smarteditServicesModule.interface:IPreviewService#updateUrlWithNewPreviewTicketId\r\n     * @methodOf smarteditServicesModule.interface:IPreviewService\r\n     *\r\n     * @description\r\n     * This method will create a new preview ticket, and return the given url with an updated previewTicketId query param\r\n     * <br />\r\n     * This method does *NOT* update the current experience.\r\n     *\r\n     * @param {string} storefrontUrl Existing storefront url\r\n     * @param {Object} previewData JSON representing storefront previewData (catalog, catalaog vesion, etc...)\r\n     *\r\n     * @returns {string} A new string with storefrontUrl having the new ticket ID inside\r\n     */\r\n\tupdateUrlWithNewPreviewTicketId(storefrontUrl: string, previewData: IPreviewData): angular.IPromise<string> {\r\n\t\treturn this.createPreview(previewData).then((preview: IPreviewResponse) => {\r\n\t\t\treturn this.urlUtils.updateUrlParameter(storefrontUrl, 'cmsTicketId', preview.previewTicketId);\r\n\t\t});\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport * as angular from 'angular';\r\nimport {User} from 'smarteditcommons';\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:ISessionService\r\n * @description\r\n * The ISessionService provides information related to the current session\r\n * and the authenticated user (including a user readable and writeable languages). \r\n */\r\nexport abstract class ISessionService {\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:ISessionService#getCurrentUsername\r\n     * @methodOf smarteditServicesModule.interface:ISessionService\r\n     *\r\n     * @description\r\n     * Returns the username, previously mentioned as \"principalUID\",\r\n     * associated to the authenticated user.\r\n     *\r\n     * @returns {angular.IPromise<string>} A promise resolving to the username,\r\n     * previously mentioned as \"principalUID\", associated to the\r\n     * authenticated user.\r\n     */\r\n\tgetCurrentUsername(): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:ISessionService#getCurrentUserDisplayName\r\n     * @methodOf smarteditServicesModule.interface:ISessionService\r\n     *\r\n     * @description\r\n     * Returns the displayed name associated to the authenticated user.\r\n     *\r\n     * @returns {angular.IPromise<string>} A promise resolving to the displayed name\r\n     * associated to the authenticated user.\r\n     */\r\n\tgetCurrentUserDisplayName(): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:ISessionService#getCurrentUser\r\n     * @methodOf smarteditServicesModule.interface:ISessionService \r\n     * \r\n     * @description\r\n     * Returns the data of the current authenticated user. \r\n     * Also note that as part of the User object returned by this method contains \r\n     * the list of readable and writeable languages available to the user. \r\n     * \r\n     * @returns {angular.IPromise<User>} A promise resolving to the data of the current \r\n     * authenticated user. \r\n     */\r\n\tgetCurrentUser(): angular.IPromise<User> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:ISessionService#hasUserChanged\r\n     * @methodOf smarteditServicesModule.interface:ISessionService\r\n     *\r\n     * @description\r\n     * Returns boolean indicating whether the current user is different from\r\n     * the last authenticated one.\r\n     *\r\n     * @returns {angular.IPromise<boolean>} Boolean indicating whether the current user is\r\n     * different from the last authenticated one.\r\n     */\r\n\thasUserChanged(): angular.IPromise<boolean> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:ISessionService#resetCurrentUserData\r\n     * @methodOf smarteditServicesModule.interface:ISessionService\r\n     *\r\n     * @description\r\n     * Reset all data associated to the authenticated user.\r\n     * to the authenticated user.\r\n     * \r\n     * @return {angular.IPromise<void>} returns an empty promise.\r\n     */\r\n\tresetCurrentUserData(): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:ISessionService#setCurrentUsername\r\n     * @methodOf smarteditServicesModule.interface:ISessionService\r\n     *\r\n     * @description\r\n     * Set the username, previously mentioned as \"principalUID\", associated\r\n     * to the authenticated user.\r\n     *\r\n     * @param {String} currentUsername Username, previously mentioned as\r\n     * \"principalUID\", associated to the authenticated user.\r\n     * \r\n     * @return {angular.IPromise<void>} returns an empty promise.\r\n     */\r\n\tsetCurrentUsername(username: string): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {Cloneable} from 'smarteditcommons';\r\nimport * as angular from 'angular';\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:ISharedDataService\r\n *\r\n * @description\r\n * Provides an abstract extensible shared data service. Used to store any data to be used either the SmartEdit\r\n * application or the SmartEdit container.\r\n *\r\n * This class serves as an interface and should be extended, not instantiated.\r\n */\r\nexport abstract class ISharedDataService {\r\n\r\n    /** \r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:ISharedDataService#get\r\n     * @methodOf smarteditServicesModule.interface:ISharedDataService\r\n     *\r\n     * @description\r\n     * Get the data for the given key.\r\n     *\r\n     * @param {String} key The key of the data to fetch\r\n     */\r\n\tget(key: string): angular.IPromise<Cloneable> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /** \r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:ISharedDataService#set\r\n     * @methodOf smarteditServicesModule.interface:ISharedDataService\r\n     *\r\n     * @description\r\n     * Set data for the given key.\r\n     *\r\n     * @param {String} key The key of the data to set\r\n     * @param {object} value The value of the data to set\r\n     */\r\n\tset(key: string, value: Cloneable): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:ISharedDataService#update\r\n     * @methodOf smarteditServicesModule.interface:ISharedDataService\r\n     *\r\n     * @description\r\n     * Convenience method to retrieve and modify on the fly the content stored under a given key\r\n     *\r\n     * @param {String} key The key of the data to store\r\n     * @param {Function} modifyingCallback callback fed with the value stored under the given key. The callback must return the new value of the object to update.\r\n     */\r\n\tupdate(key: string, modifyingCallback: (oldValue: any) => any): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:IAuthToken\r\n * @description\r\n * Interface for Auth token\r\n */\r\nexport interface IAuthToken {\r\n\taccess_token: string;\r\n\texpires_in: number;\r\n\trefresh_token: string;\r\n\tscope: string;\r\n\ttoken_type: string;\r\n}\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:IStorageService\r\n * @description\r\n * Interface for StorageService\r\n */\r\nexport abstract class IStorageService {\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#isInitialized\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * This method is used to determine if the storage service has been initialized properly. It\r\n\t * makes sure that the smartedit-sessions cookie is available in the browser.\r\n\t *\r\n\t * @returns {Boolean} Indicates if the storage service was properly initialized.\r\n\t */\r\n\tisInitialized(): angular.IPromise<boolean> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @deprecated since 6.6\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#storePrincipalIdentifier\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * This method is used to store the principal's login name in storage service. Deprecated since 6.6.\r\n\t *\r\n\t * @param {String} principalUID Value associated to store principal's login.\r\n\t */\r\n\tstorePrincipalIdentifier(principalUID: string): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @deprecated since 6.6\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#removePrincipalIdentifier\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * This method is used to remove the principal's UID from storage service. Deprecated since 6.6.\r\n\t *\r\n\t */\r\n\tremovePrincipalIdentifier(): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @deprecated since 6.6\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#getPrincipalIdentifier\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * This method is used to retrieve the principal's login name from storage service. Deprecated since 6.6.\r\n\t *\r\n\t * @returns {String} principalNameValue principal's name associated with the key.\r\n\t */\r\n\tgetPrincipalIdentifier(): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#storeAuthToken\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * This method creates and stores a new key/value entry. It associates an authentication token with a\r\n\t * URI.\r\n\t *\r\n\t * @param {String} authURI The URI that identifies the resource(s) to be authenticated with the authToken. Will be used as a key.\r\n\t * @param {String} auth The token to be used to authenticate the user in the provided URI.\r\n\t */\r\n\tstoreAuthToken(authURI: string, auth: IAuthToken): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#getAuthToken\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * This method is used to retrieve the authToken associated with the provided URI.\r\n\t *\r\n\t * @param {String} authURI The URI for which the associated authToken is to be retrieved.\r\n\t * @returns {String} The authToken used to authenticate the current user in the provided URI.\r\n\t */\r\n\tgetAuthToken(authURI: string): angular.IPromise<IAuthToken> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#removeAuthToken\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * Removes the authToken associated with the provided URI.\r\n\t *\r\n\t * @param {String} authURI The URI for which its authToken is to be removed.\r\n\t */\r\n\tremoveAuthToken(authURI: string): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#removeAllAuthTokens\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * This method removes all authURI/authToken key/pairs from the storage service.\r\n\t */\r\n\tremoveAllAuthTokens(): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#getValueFromCookie\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * Retrieves the value stored in the cookie identified by the provided name.\r\n\t */\r\n\tgetValueFromCookie(cookieName: string, isEncoded: boolean): angular.IPromise<any> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\tputValueInCookie(cookieName: string, value: any, encode: boolean): void {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#setItem\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * This method is used to store the item.\r\n\t * \r\n\t * @param {String} key The key of the item.\r\n\t * @param {any} value The value of the item.\r\n\t */\r\n\tsetItem(key: string, value: any): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IStorageService#getItem\r\n\t * @methodOf smarteditServicesModule.interface:IStorageService\r\n\t *\r\n\t * @description\r\n\t * Retrieves the value for a given key.\r\n\t * \r\n\t * @param {String} key The key of the item.\r\n\t * \r\n\t * @returns {Promise<any>} A promise that resolves to the item value.\r\n\t */\r\n\tgetItem(key: string): angular.IPromise<any> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:IUrlService\r\n *\r\n * @description\r\n * Provides an abstract extensible url service, Used to open a given URL\r\n * in a new browser url upon invocation. \r\n * \r\n * This class serves as an interface and should be extended, not instantiated.\r\n */\r\nimport {IUriContext} from 'smarteditcommons';\r\n\r\nexport abstract class IUrlService {\r\n\r\n\tconstructor(\r\n\t\tprivate PAGE_CONTEXT_SITE_ID: string,\r\n\t\tprivate PAGE_CONTEXT_CATALOG: string,\r\n\t\tprivate PAGE_CONTEXT_CATALOG_VERSION: string,\r\n\t\tprivate CONTEXT_SITE_ID: string,\r\n\t\tprivate CONTEXT_CATALOG: string,\r\n\t\tprivate CONTEXT_CATALOG_VERSION: string) {\r\n\t}\r\n\r\n\t/** \r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IUrlService#openUrlInPopup\r\n\t * @methodOf smarteditServicesModule.interface:IUrlService\r\n\t *\r\n\t * @description\r\n\t * Opens a given URL in a new browser pop up without authentication.\r\n\t *\r\n\t * @param {String} url - the URL we wish to open.\r\n\t */\r\n\topenUrlInPopup(url: string): void {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IUrlService#path\r\n\t * @methodOf smarteditServicesModule.interface:IUrlService\r\n\t *\r\n\t * @description\r\n\t * Navigates to the given path in the same browser tab.\r\n\t *\r\n\t * @param {String} path - the path we wish to navigate to.\r\n\t */\r\n\tpath(path: string): void {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IUrlService#buildUriContext\r\n\t * @methodOf smarteditServicesModule.interface:IUrlService\r\n\t *\r\n\t * @description\r\n\t * Returns a uri context array populated with the given siteId, catalogId and catalogVersion information\r\n\t *\r\n\t * @param {String} siteId - site Id\r\n\t * @param {String} catalogId - catalog Id\r\n\t * @param {String} catalogVersion - catalog version\r\n\t * \r\n\t * @return {IUriContext} uri context array \r\n\t */\r\n\tbuildUriContext(siteId: string, catalogId: string, catalogVersion: string): IUriContext {\r\n\t\tconst uriContext: IUriContext = {};\r\n\t\turiContext[this.CONTEXT_SITE_ID] = siteId;\r\n\t\turiContext[this.CONTEXT_CATALOG] = catalogId;\r\n\t\turiContext[this.CONTEXT_CATALOG_VERSION] = catalogVersion;\r\n\t\treturn uriContext;\r\n\t}\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IUrlService#buildPageUriContext\r\n\t * @methodOf smarteditServicesModule.interface:IUrlService\r\n\t *\r\n\t * @description\r\n\t * Returns a page uri context array populated with the given siteId, catalogId and catalogVersion information\r\n\t *\r\n\t * @param {String} siteId - site Id\r\n\t * @param {String} catalogId - catalog Id\r\n\t * @param {String} catalogVersion - catalog version\r\n\t * \r\n\t * @return {IUriContext} uri context array \r\n\t */\r\n\tbuildPageUriContext(siteId: string, catalogId: string, catalogVersion: string): IUriContext {\r\n\t\tconst uriContext: IUriContext = {};\r\n\t\turiContext[this.PAGE_CONTEXT_SITE_ID] = siteId;\r\n\t\turiContext[this.PAGE_CONTEXT_CATALOG] = catalogId;\r\n\t\turiContext[this.PAGE_CONTEXT_CATALOG_VERSION] = catalogVersion;\r\n\t\treturn uriContext;\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:IWaitDialogService\r\n *\r\n * @description\r\n * This service be used in order to display (or hide) a 'loading' overlay. The overlay should display on top of everything, preventing\r\n * the user from doing any action until the overlay gets hidden.\r\n */\r\n\r\nexport abstract class IWaitDialogService {\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:IWaitDialogService#showWaitModal\r\n     * @methodOf smarteditServicesModule.interface:IWaitDialogService\r\n     *\r\n     * @description\r\n     * This method can be called to display the loading overlay.\r\n     *\r\n     * @param {String} [customLoadingMessageLocalizedKey=\"se.wait.dialog.message\"] The i18n key that corresponds to the message to be displayed.\r\n     */\r\n\tshowWaitModal(customLoadingMessageLocalizedKey?: string): void {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:IWaitDialogService#hideWaitModal\r\n     * @methodOf smarteditServicesModule.interface:IWaitDialogService\r\n     *\r\n     * @description\r\n     * Removes the loading overlay.\r\n     */\r\n\thideWaitModal(): void {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport {IAlertConfig, IAlertService, SeAlertServiceType} from './IAlertService';\r\nexport {IBrowserService} from './IBrowserService';\r\nexport * from './ICatalogService';\r\nexport * from './IConfiguration';\r\nexport {IContextualMenuButton} from './IContextualMenuButton';\r\nexport {ComponentAttributes, IContextualMenuConfiguration} from './IContextualMenuConfiguration';\r\nexport {IDecorator} from './IDecorator';\r\nexport * from './IExperience';\r\nexport {IExperienceService} from './IExperienceService';\r\nexport {InternalFeature, IFeature} from './IFeature';\r\nexport {IFeatureService, IFeaturesToAlias} from './IFeatureService';\r\nexport {IBound, INotificationMouseLeaveDetectionService} from './INotificationMouseLeaveDetectionService';\r\nexport {INotificationConfiguration, INotificationService} from './INotificationService';\r\nexport {IPageInfoService} from './IPageInfoService';\r\nexport {IPreviewService} from './IPreviewService';\r\nexport {IPreviewCatalogVersionData, IPreviewData, IPreviewResponse} from './IPreview';\r\nexport {IPrioritized} from './IPrioritized';\r\nexport {IProduct} from './IProduct';\r\nexport {IReflectable} from './IReflectable';\r\nexport {ISessionService} from './ISessionService';\r\nexport {ISharedDataService} from './ISharedDataService';\r\nexport {ISite} from './ISite';\r\nexport {IAuthToken, IStorageService} from './IStorageService';\r\nexport {IToolbarItem} from './IToolbarItem';\r\nexport {IUriContext} from './IUriContext';\r\nexport {IUrlService} from './IUrlService';\r\nexport {IWaitDialogService} from './IWaitDialogService';\r\nexport * from './IPermissionService';\r\nexport * from './IResizeListener';\r\nexport * from './IPositionRegistry';\r\nexport * from './IURIBuilder';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport {rarelyChangingContent, Cached} from '../cache';\r\nimport {\r\n\tCrossFrameEventService,\r\n\tIBrowserService,\r\n\tIRestService,\r\n\tIRestServiceFactory,\r\n\tIStorageService\r\n} from \"smarteditcommons\";\r\n\r\nimport {SeInjectable} from '../dependencyInjection/di';\r\nimport {OperationContextRegistered} from '../httpErrorInterceptor/default/retryInterceptor/operationContextAnnotation';\r\nimport {Payload} from 'smarteditcommons/dtos';\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditCommonsModule.interface:ILanguage\r\n * @description\r\n * Interface for language information\r\n */\r\nexport interface ILanguage extends Payload {\r\n\tactive: boolean;\r\n\tisocode: string;\r\n\tname: string;\r\n\tnativeName: string;\r\n\trequired: boolean;\r\n}\r\n\r\nexport interface IToolingLanguage {\r\n\tisoCode: string;\r\n\tname: string;\r\n}\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditCommonsModule.service:LanguageService\r\n */\r\n@OperationContextRegistered('LANGUAGE_RESOURCE_URI', 'TOOLING')\r\n@SeInjectable()\r\n/* @ngInject */\n export class LanguageService {\r\n\tprivate languageRestService: IRestService<{languages: ILanguage[]}>;\r\n\tprivate i18nLanguageRestService: IRestService<{languages: IToolingLanguage[]}>;\r\n\tprivate initDeferred: angular.IDeferred<void> = this.$q.defer();\r\n\r\n\t/** @internal */\r\n\tconstructor(\r\n\t\tprivate $log: angular.ILogService,\r\n\t\tprivate $translate: angular.translate.ITranslateService,\r\n\t\tprivate $q: angular.IQService,\r\n\t\tprivate languageServiceGateway: any,\r\n\t\tprivate crossFrameEventService: CrossFrameEventService,\r\n\t\tprivate browserService: IBrowserService,\r\n\t\tprivate storageService: IStorageService,\r\n\t\tprivate SWITCH_LANGUAGE_EVENT: string,\r\n\t\tprivate SELECTED_LANGUAGE: string,\r\n\t\tLANGUAGE_RESOURCE_URI: string,\r\n\t\tI18N_LANGUAGES_RESOURCE_URI: string,\r\n\t\trestServiceFactory: IRestServiceFactory\r\n\t) {\r\n\t\tthis.languageRestService = restServiceFactory.get(LANGUAGE_RESOURCE_URI);\r\n\t\tthis.i18nLanguageRestService = restServiceFactory.get(I18N_LANGUAGES_RESOURCE_URI);\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#getBrowserLanguageIsoCode\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     * \r\n     * @deprecated since 1808\r\n     * \r\n     * @description\r\n     * Uses the browser's current locale to determine the selected language ISO code.\r\n     *\r\n     * @returns {String} The language ISO code of the browser's currently selected locale.\r\n     */\r\n\tgetBrowserLanguageIsoCode(): string {\r\n\t\treturn window.navigator.language.split('-')[0];\r\n\t}\r\n\r\n\tsetInitialized(initialized: boolean): void {\r\n\t\tinitialized ? this.initDeferred.resolve() : this.initDeferred.reject();\r\n\t}\r\n\r\n\tisInitialized(): angular.IPromise<void> {\r\n\t\treturn this.initDeferred.promise;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#getBrowserLocale\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     * \r\n     * @deprecated since 1808 - use browserService instead.\r\n     *\r\n     * @description\r\n     * determines the browser locale in the format en_US\r\n     *\r\n     * @returns {string} the browser locale\r\n     */\r\n\tgetBrowserLocale(): string {\r\n\t\treturn this.browserService.getBrowserLocale();\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#getResolveLocale\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     *\r\n     * @description\r\n     * Resolve the user preference tooling locale. It determines in the\r\n     * following order:\r\n     *\r\n     * 1. Check if the user has previously selected the language\r\n     * 2. Check if the user browser locale is supported in the system\r\n     * \r\n     * @returns {angular.IPromise<string>} the locale\r\n     */\r\n\tgetResolveLocale(): angular.IPromise<string> {\r\n\t\treturn this.$q.when(this._getDefaultLanguage());\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#getResolveLocaleIsoCode\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     *\r\n     * @description\r\n     * Resolve the user preference tooling locale ISO code. i.e.: If the selected tooling language is 'en_US',\r\n     * the resolved value will be 'en'.\r\n     *\r\n     * @returns {angular.IPromise<string>} A promise that resolves to the isocode of the tooling language.\r\n     */\r\n\tgetResolveLocaleIsoCode(): angular.IPromise<string> {\r\n\t\treturn this.getResolveLocale().then((resolveLocale: string) => {\r\n\t\t\treturn this.convertBCP47TagToJavaTag(resolveLocale).split('_')[0];\r\n\t\t});\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#getLanguagesForSite\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     *\r\n     * @description\r\n     * Fetches a list of language descriptors for the specified storefront site UID.\r\n     * The object containing the list of sites is fetched using REST calls to the cmswebservices languages API.\r\n     * \r\n     * @param {string} siteUID the site unique identifier.\r\n     * \r\n     * @returns {angular.IPromise<ILanguage[]>} A promise that resolves to an array of ILanguage.\r\n     */\r\n\t@Cached({actions: [rarelyChangingContent]})\r\n\tgetLanguagesForSite(siteUID: string): angular.IPromise<ILanguage[]> {\r\n\t\treturn this.languageRestService.get({\r\n\t\t\tsiteUID\r\n\t\t}).then((languagesList) => {\r\n\t\t\treturn languagesList.languages;\r\n\t\t}, (error: any) => {\r\n\t\t\tthis.$log.error('LanguageService.getLanguagesForSite() - Error loading languages');\r\n\t\t\treturn this.$q.reject(error);\r\n\t\t});\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#getToolingLanguages\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     *\r\n     * @description\r\n     * Retrieves a list of language descriptors using REST calls to the smarteditwebservices i18n API.\r\n     *\r\n     * @returns {angular.IPromise<IToolingLanguage[]>} A promise that resolves to an array of IToolingLanguage.\r\n     */\r\n\t@Cached({actions: [rarelyChangingContent]})\r\n\tgetToolingLanguages(): angular.IPromise<IToolingLanguage[]> {\r\n\t\treturn this.i18nLanguageRestService.get({}).then((response) => {\r\n\t\t\treturn this.$q.when(response.languages);\r\n\t\t}, (error) => {\r\n\t\t\tthis.$log.error('LanguageService.getToolingLanguages() - Error loading tooling languages');\r\n\t\t\treturn this.$q.reject(error);\r\n\t\t});\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#setSelectedToolingLanguage\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     *\r\n     * @description\r\n     * Set the user preference language in the storage service\r\n     *\r\n     * @param {IToolingLanguage} language the language object to be saved.\r\n     */\r\n\tsetSelectedToolingLanguage(language: IToolingLanguage): void {\r\n\t\tthis.storageService.putValueInCookie(this.SELECTED_LANGUAGE, language, false);\r\n\t\tthis.$translate.use(language.isoCode);\r\n\t\tthis.languageServiceGateway.publish(this.SWITCH_LANGUAGE_EVENT, {\r\n\t\t\tisoCode: language.isoCode\r\n\t\t});\r\n\t\tthis.crossFrameEventService.publish(this.SWITCH_LANGUAGE_EVENT);\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#registerSwitchLanguage\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     *\r\n     * @description\r\n     * Register a callback function to the gateway in order to switch the tooling language\r\n     */\r\n\tregisterSwitchLanguage(): void {\r\n\t\tthis.languageServiceGateway.subscribe(this.SWITCH_LANGUAGE_EVENT, (eventId: string, language: IToolingLanguage) => this.$translate.use(language.isoCode));\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#convertBCP47TagToJavaTag\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     * \r\n     * @description\r\n     * Method converts the BCP47 language tag representing the locale to the default java representation.\r\n     * For example, method converts \"en-US\" to \"en_US\".\r\n     * \r\n     * @param {string} languageTag the language tag to be converted.\r\n     * \r\n     * @returns {string} the languageTag in java representation\r\n     */\r\n\tconvertBCP47TagToJavaTag(languageTag: string): string {\r\n\t\treturn !!languageTag ? languageTag.replace(/-/g, '_') : languageTag;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditCommonsModule.service:LanguageService#convertJavaTagToBCP47Tag\r\n     * @methodOf smarteditCommonsModule.service:LanguageService\r\n     * \r\n     * @description\r\n     * Method converts the default java language tag representing the locale to the BCP47 representation.\r\n     * For example, method converts \"en_US\" to \"en-US\".\r\n     * \r\n     * @param {string} languageTag the language tag to be converted.\r\n     * \r\n     * @returns {string} the languageTag in BCP47 representation\r\n     */\r\n\tconvertJavaTagToBCP47Tag(languageTag: string): string {\r\n\t\treturn !!languageTag ? languageTag.replace(/_/g, '-') : languageTag;\r\n\t}\r\n\r\n\tprivate _getDefaultLanguage(): angular.IPromise<string> {\r\n\t\treturn this.storageService.getValueFromCookie(this.SELECTED_LANGUAGE, false).then((lang: {name: string, isoCode: string}) => {\r\n\t\t\treturn lang ? lang.isoCode : this.browserService.getBrowserLocale();\r\n\t\t}, () => {\r\n\t\t\treturn this.browserService.getBrowserLocale();\r\n\t\t}\r\n\t\t);\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport {GatewayFactory} from 'smarteditcommons';\r\nimport {SeInjectable} from '../dependencyInjection/di';\r\n/** @internal */\r\n@SeInjectable()\r\n/* @ngInject */\n export class LanguageServiceGateway {\r\n\tconstructor(gatewayFactory: GatewayFactory) {\r\n\t\treturn gatewayFactory.createGateway('languageSwitch');\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport {IPerspective} from 'smarteditcommons/services/perspectives/IPerspective';\r\n\r\n/**\r\n * @ngdoc interface\r\n * @name smarteditServicesModule.interface:IPerspectiveService\r\n * \r\n * @description\r\n * Interface for Perspective Service\r\n */\r\nexport abstract class IPerspectiveService {\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:IPerspectiveService#register\r\n     * @methodOf smarteditServicesModule.interface:IPerspectiveService\r\n     * \r\n     * @description\r\n     * This method registers a perspective.\r\n     * When an end user selects a perspective in the SmartEdit web application,\r\n     * all features bound to the perspective will be enabled when their respective enablingCallback functions are invoked\r\n     * and all features not bound to the perspective will be disabled when their respective disablingCallback functions are invoked.\r\n     * \r\n     * @param {Object} configuration The perspective's configuration {@link smarteditServicesModule.interface:IPerspective IPerspective}\r\n     * \r\n     * @return {angular.IPromise<void>} An empty promise\r\n     */\r\n\tregister(configuration: IPerspective): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:IPerspectiveService#switchTo\r\n     * @methodOf smarteditServicesModule.interface:IPerspectiveService\r\n     *\r\n     * @description\r\n     * This method activates a perspective identified by its key and deactivates the currently active perspective.\r\n     * Activating a perspective consists in activating any feature that is bound to the perspective\r\n     * or any feature that is bound to the perspective's referenced perspectives and deactivating any features\r\n     * that are not bound to the perspective or to its referenced perspectives.\r\n     * After the perspective is changed, the {@link seConstantsModule.object:EVENT_PERSPECTIVE_CHANGED\r\n     * EVENT_PERSPECTIVE_CHANGED} event is published on the {@link smarteditCommonsModule.service:CrossFrameEventService\r\n     * crossFrameEventService}, with no data.\r\n     *\r\n     * @param {String} key The key that uniquely identifies the perspective to be activated. This is the same key as the key used in the {@link smarteditServicesModule.interface:IPerspectiveService#methods_register register} method.\r\n     * @return {angular.IPromise<void>} An empty promise\r\n     */\r\n\tswitchTo(key: string): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:IPerspectiveService#hasActivePerspective\r\n     * @methodOf smarteditServicesModule.interface:IPerspectiveService\r\n     *\r\n     * @description\r\n     * This method returns true if a perspective is selected.\r\n     *\r\n     * @returns {angular.IPromise<boolean>} A promise with the value of the key of the active perspective.\r\n     */\r\n\thasActivePerspective(): angular.IPromise<boolean> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:IPerspectiveService#selectDefault\r\n     * @methodOf smarteditServicesModule.interface:IPerspectiveService\r\n     *\r\n     * @description\r\n     * This method switches the currently-selected perspective to the default perspective.\r\n     * It will also disable all features for the default perspective before enabling them all back.\r\n     * If no value has been stored in the smartedit-perspectives cookie, the value of the default perspective is se.none.\r\n     * If a value is stored in the cookie, that value is used as the default perspective.\r\n     * \r\n     * @return {angular.IPromise<void>} An empty promise\r\n     */\r\n\tselectDefault(): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:IPerspectiveService#isEmptyPerspectiveActive\r\n     * @methodOf smarteditServicesModule.interface:IPerspectiveService\r\n     *\r\n     * @description\r\n     * This method returns true if the current active perspective is the Preview mode (No active overlay).\r\n     *\r\n     * @returns {angular.IPromise<boolean>} A promise with the boolean flag that indicates if the current perspective is the Preview mode.\r\n     */\r\n\tisEmptyPerspectiveActive(): angular.IPromise<boolean> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name smarteditServicesModule.interface:IPerspectiveService#refreshPerspective\r\n     * @methodOf smarteditServicesModule.interface:IPerspectiveService\r\n     *\r\n     * @description\r\n     * This method is used to refresh the prespective.\r\n     * If there is an exising perspective set then it is refreshed by replaying all the features associated to the current perspective.\r\n     * If there is no perspective set or if the perspective is not permitted then we set the default perspective.\r\n     * \r\n     * @return {angular.IPromise<void>} An empty promise\r\n     */\r\n\trefreshPerspective(): angular.IPromise<void> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IPerspectiveService#getActivePerspectiveKey\r\n\t * @methodOf smarteditServicesModule.interface:IPerspectiveService\r\n\t *\r\n\t * @description\r\n\t * \tThis method returns the key of the perspective that is currently loaded.\r\n\t *\r\n\t * @returns {angular.IPromise<string>} A promise that resolves to the key of the current perspective loaded in the storefront, null otherwise.\r\n\t */\r\n\tgetActivePerspectiveKey(): angular.IPromise<string> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.interface:IPerspectiveService#isHotkeyEnabledForActivePerspective\r\n\t * @methodOf smarteditServicesModule.interface:IPerspectiveService\r\n\t *\r\n\t * @description\r\n\t * This method returns true if the active perspective has the hotkey enabled\r\n\t *\r\n\t * @returns {angular.IPromise<boolean>} A promise with the boolean flag that indicates if the current perspective has the hotkey enabled.\r\n\t */\r\n\tisHotkeyEnabledForActivePerspective(): angular.IPromise<boolean> {\r\n\t\t'proxyFunction';\r\n\t\treturn null;\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {IRestService} from \"./IRestService\";\r\nimport {IRestServiceFactory} from \"./IRestServiceFactory\";\r\nimport {Cached, InvalidateCache} from 'smarteditcommons/services/cache';\r\nimport {Page, Pageable, Payload} from 'smarteditcommons/dtos';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditServicesModule.service:AbstractCachedRestService\r\n * \r\n * @description\r\n * Base class to implement Cache enabled {@link smarteditServicesModule.interface:IRestService IRestServices}.\r\n * <br/>Implementing classes just need declare a class level {@link smarteditServicesModule.object:@CacheConfig @CacheConfig} annotation\r\n * with at least one {@link smarteditServicesModule.object:CacheAction CacheAction} and one {@link smarteditServicesModule.object:EvictionTag EvictionTag}.\r\n * <br/>Cache policies called by the set of {@link smarteditServicesModule.object:CacheAction CacheActions} will have access to\r\n * REST call response headers being added to the response under \"headers\" property.\r\n * <br/>Those headers are then stripped from the response.\r\n * \r\n * <h2>Usage</h2>\r\n * <pre>\r\n * &#64;CacheConfig({actions: [rarelyChangingContent], tags: [userEvictionTag]})\r\n * &#64;SeInjectable()\r\n * export class ProductCatalogRestService extends AbstractCachedRestService<IBaseCatalogs> {\r\n * \tconstructor(restServiceFactory: IRestServiceFactory) {\r\n * \t\tsuper(restServiceFactory, '/productcatalogs');\r\n * \t}\r\n * } \r\n * </pre>\r\n */\r\nexport abstract class AbstractCachedRestService<T> implements IRestService<T> {\r\n\r\n\tprotected innerRestService: IRestService<T>;\r\n\r\n\tconstructor(restServiceFactory: IRestServiceFactory, uri: string, identifier?: string) {\r\n\r\n\t\tthis.innerRestService = restServiceFactory.get(uri, identifier);\r\n\t\tthis.innerRestService.activateMetadata();\r\n\r\n\t}\r\n\r\n\t@StripResponseHeaders\r\n\t@Cached()\r\n\tgetById(identifier: string): angular.IPromise<T> {\r\n\t\treturn this.innerRestService.getById(identifier);\r\n\t}\r\n\r\n\t@StripResponseHeaders\r\n\t@Cached()\r\n\tget(searchParams: void | Payload): angular.IPromise<T> {\r\n\t\treturn this.innerRestService.get(searchParams);\r\n\t}\r\n\r\n\t@StripResponseHeaders\r\n\t@Cached()\r\n\tquery(searchParams: Payload): angular.IPromise<T[]> {\r\n\t\treturn this.innerRestService.query(searchParams);\r\n\t}\r\n\r\n\t@StripResponseHeaders\r\n\t@Cached()\r\n\tpage(searchParams: Pageable): angular.IPromise<Page<T>> {\r\n\t\treturn this.innerRestService.page(searchParams);\r\n\t}\r\n\r\n\t@StripResponseHeaders\r\n\t@InvalidateCache()\r\n\tupdate(payload: Payload): angular.IPromise<T> {\r\n\t\treturn this.innerRestService.update(payload);\r\n\t}\r\n\r\n\t@InvalidateCache()\r\n\tremove(payload: Payload): angular.IPromise<void> {\r\n\t\treturn this.innerRestService.remove(payload);\r\n\t}\r\n\r\n\t@StripResponseHeaders\r\n\tsave(payload: Payload): angular.IPromise<T> {\r\n\t\treturn this.innerRestService.save(payload);\r\n\t}\r\n\r\n}\r\n\r\nfunction StripResponseHeaders(target: any, propertyName: string, descriptor: TypedPropertyDescriptor<(...x: any[]) => any>) {\r\n\r\n\tconst originalMethod = descriptor.value;\r\n\r\n\tdescriptor.value = function() {\r\n\t\treturn originalMethod.apply(this, arguments).then((response: any) => {\r\n\t\t\tdelete response.headers;\r\n\t\t\treturn response;\r\n\t\t});\r\n\t};\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {SeModule} from \"smarteditcommons/services/dependencyInjection/di\";\r\nimport {PermissionsRestService} from \"smarteditcommons/services/rest/PermissionsRestService\";\r\n\r\n@SeModule({\r\n\tproviders: [\r\n\t\tPermissionsRestService\r\n\t]\r\n})\r\nexport class CommonsRestServiceModule {}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {IRestServiceFactory} from \"smarteditcommons/services/rest/IRestServiceFactory\";\r\nimport {SeInjectable} from \"smarteditcommons/services/dependencyInjection/di\";\r\nimport {IRestService} from \"smarteditcommons/services/rest/IRestService\";\r\nimport {IPermissionsRestServiceQueryData, IPermissionsRestServiceResult} from \"smarteditcommons/dtos/IPermissionsDto\";\r\n\r\n@SeInjectable()\r\n/* @ngInject */\n export class PermissionsRestService {\r\n\r\n\tprivate readonly URI = \"/permissionswebservices/v1/permissions/principals/:user/global\";\r\n\r\n\tprivate readonly resource: IRestService<IPermissionsRestServiceResult>;\r\n\r\n\tconstructor(restServiceFactory: IRestServiceFactory) {\r\n\t\tthis.resource = restServiceFactory.get<IPermissionsRestServiceResult>(this.URI);\r\n\t}\r\n\r\n\tget(queryData: IPermissionsRestServiceQueryData): angular.IPromise<IPermissionsRestServiceResult> {\r\n\t\treturn this.resource.get(queryData as any).then((data: IPermissionsRestServiceResult) => {\r\n\t\t\treturn {\r\n\t\t\t\tpermissions: data.permissions\r\n\t\t\t};\r\n\t\t});\r\n\t}\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {IBaseCatalogs} from 'smarteditcommons/dtos/ICatalog';\r\nimport {contentCatalogUpdateEvictionTag, pageEvictionTag, rarelyChangingContent, userEvictionTag, CacheConfig} from \"smarteditcommons/services/cache\";\r\nimport {IRestServiceFactory} from \"smarteditcommons/services/rest/IRestServiceFactory\";\r\nimport {AbstractCachedRestService} from \"smarteditcommons/services/rest/AbstractCachedRestService\";\r\nimport {SeInjectable} from \"smarteditcommons/services/dependencyInjection/di\";\r\nimport {OperationContextRegistered} from 'smarteditcommons/services/httpErrorInterceptor/default/retryInterceptor/operationContextAnnotation';\r\n\r\nconst CONTENT_CATALOG_VERSION_DETAILS_RESOURCE_API = '/cmssmarteditwebservices/v1/sites/:siteUID/contentcatalogs';\r\n\r\n@CacheConfig({actions: [rarelyChangingContent], tags: [userEvictionTag, pageEvictionTag, contentCatalogUpdateEvictionTag]})\r\n@OperationContextRegistered(CONTENT_CATALOG_VERSION_DETAILS_RESOURCE_API, ['CMS', 'INTERACTIVE'])\r\n@SeInjectable()\r\n/* @ngInject */\n export class ContentCatalogRestService extends AbstractCachedRestService<IBaseCatalogs> {\r\n\r\n\tconstructor(restServiceFactory: IRestServiceFactory) {\r\n\t\tsuper(restServiceFactory, CONTENT_CATALOG_VERSION_DETAILS_RESOURCE_API);\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {IBaseCatalogs} from 'smarteditcommons/dtos/ICatalog';\r\nimport {rarelyChangingContent, userEvictionTag, CacheConfig} from \"smarteditcommons/services/cache\";\r\nimport {IRestServiceFactory} from \"smarteditcommons/services/rest/IRestServiceFactory\";\r\nimport {AbstractCachedRestService} from \"smarteditcommons/services/rest/AbstractCachedRestService\";\r\nimport {SeInjectable} from \"smarteditcommons/services/dependencyInjection/di\";\r\n\r\n@CacheConfig({actions: [rarelyChangingContent], tags: [userEvictionTag]})\r\n@SeInjectable()\r\n/* @ngInject */\n export class ProductCatalogRestService extends AbstractCachedRestService<IBaseCatalogs> {\r\n\r\n\tconstructor(restServiceFactory: IRestServiceFactory) {\r\n\t\tsuper(restServiceFactory, '/cmssmarteditwebservices/v1/sites/:siteUID/productcatalogs');\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './AbstractCachedRestService';\r\nexport * from './IRestService';\r\nexport * from './IRestServiceFactory';\r\n\r\nexport * from './daos/ContentCatalogRestService';\r\nexport * from './daos/ProductCatalogRestService';\r\n\r\nexport * from './PermissionsRestService';","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n// Manager\r\nexport * from './manager/NamespacedStorageManager';\r\nexport * from './manager/StorageManagerFactory';\r\nexport * from './manager/StorageNamespaceConverter';\r\n\r\n\r\nexport * from './IStorage';\r\nexport * from './IStorageController';\r\nexport * from './IStorageFactory';\r\nexport * from './IStorageGateway';\r\nexport * from './IStorageManager';\r\nexport * from './IStorageManagerFactory';\r\nexport * from './IStorageManagerGateway';\r\nexport * from './IStorageOptions';\r\nexport * from './IStorageProperties';\r\nexport * from './IStoragePropertiesService';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {IStorage} from \"../IStorage\";\r\nimport {IStorageController} from \"../IStorageController\";\r\nimport {IStorageManager} from \"../IStorageManager\";\r\nimport {IStorageOptions} from \"../IStorageOptions\";\r\nimport {StorageNamespaceConverter} from \"./StorageNamespaceConverter\";\r\n\r\n\r\nimport * as angular from \"angular\";\r\n\r\n/** @internal */\r\nexport class NamespacedStorageManager implements IStorageManager {\r\n\r\n\tconstructor(private readonly storageManager: IStorageManager, private namespace: string) {\r\n\t}\r\n\r\n\tgetStorage(storageConfiguration: IStorageOptions): angular.IPromise<IStorage<any, any>> {\r\n\t\tstorageConfiguration.storageId = this.getNamespaceStorageId(storageConfiguration.storageId);\r\n\t\treturn this.storageManager.getStorage(storageConfiguration);\r\n\t}\r\n\r\n\tdeleteStorage(storageId: string, force: boolean = false): angular.IPromise<boolean> {\r\n\t\treturn this.storageManager.deleteStorage(this.getNamespaceStorageId(storageId), force);\r\n\t}\r\n\r\n\tdeleteExpiredStorages(force: boolean = false): angular.IPromise<boolean> {\r\n\t\treturn this.storageManager.deleteExpiredStorages(force);\r\n\t}\r\n\r\n\thasStorage(storageId: string): boolean {\r\n\t\treturn this.storageManager.hasStorage(this.getNamespaceStorageId(storageId));\r\n\t}\r\n\r\n\tregisterStorageController(controller: IStorageController): void {\r\n\t\treturn this.storageManager.registerStorageController(controller);\r\n\t}\r\n\r\n\tgetNamespaceStorageId(storageId: string): string {\r\n\t\treturn StorageNamespaceConverter.getNamespacedStorageId(this.namespace, storageId);\r\n\t}\r\n\r\n\tgetStorageManager(): IStorageManager {\r\n\t\treturn this.storageManager;\r\n\t}\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {IStorageManager} from \"../IStorageManager\";\r\nimport {IStorageManagerFactory} from \"../IStorageManagerFactory\";\r\nimport {NamespacedStorageManager} from \"./NamespacedStorageManager\";\r\n\r\n/** @internal */\r\nexport class StorageManagerFactory implements IStorageManagerFactory {\r\n\r\n\tstatic ERR_INVALID_NAMESPACE(namespace: string): Error {\r\n\t\treturn new Error(`StorageManagerFactory Error: invalid namespace [${namespace}]. Namespace must be a non-empty string`);\r\n\t}\r\n\r\n\tconstructor(private theOneAndOnlyStorageManager: IStorageManager) {\r\n\t}\r\n\r\n\tgetStorageManager(namespace: string) {\r\n\t\tthis.validateNamespace(namespace);\r\n\t\treturn new NamespacedStorageManager(this.theOneAndOnlyStorageManager, namespace);\r\n\t}\r\n\r\n\tprivate validateNamespace(namespace: string) {\r\n\t\tif (typeof namespace !== 'string' || namespace.length <= 0) {\r\n\t\t\tthrow StorageManagerFactory.ERR_INVALID_NAMESPACE(namespace);\r\n\t\t}\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/** @internal */\r\nexport abstract class StorageNamespaceConverter {\r\n\r\n    /**\r\n     * Given:\r\n     *  namespace = nmsp\r\n     *  storageId = stoid\r\n     *\r\n     * Produces:\r\n     *  newStorageId = nmsp<ns:id>stoid\r\n     *\r\n     * Fastest implementation I could think of that (most likely) will not clash with weird storageIds\r\n     *\r\n     * This algorithm is a bit overly simple, and assumes that neither storageId nor namespace contains \"<ns:id>\"\r\n     * I think this is a fairly safe assumption, but if we have time in the future, we should escape any existing\r\n     * matches of the string.\r\n     */\r\n\r\n\tstatic ERR_INVALID_NAMESPACED_ID(id: string): Error {\r\n\t\treturn new Error(`StorageNamespaceConverter - Invalid namespaced id [${id}]`);\r\n\t}\r\n\r\n\tstatic getNamespacedStorageId(namespace: string, storageId: string): string {\r\n\t\treturn `${namespace}${this.separator}${storageId}`;\r\n\t}\r\n\r\n\tstatic getStorageIdFromNamespacedId(namespacedId: string): string {\r\n\t\tconst matches: RegExpMatchArray = namespacedId.match(new RegExp(this.namespaceDecoderRegexStr));\r\n\t\tif (matches && matches[2].length > 0) {\r\n\t\t\treturn matches[2];\r\n\t\t}\r\n\t\tthrow StorageNamespaceConverter.ERR_INVALID_NAMESPACED_ID(namespacedId);\r\n\t}\r\n\r\n\tstatic getNamespaceFromNamespacedId(namespacedId: string): string {\r\n\t\tconst matches: RegExpMatchArray = namespacedId.match(new RegExp(this.namespaceDecoderRegexStr));\r\n\t\tif (matches && matches[1].length > 0) {\r\n\t\t\treturn matches[1];\r\n\t\t}\r\n\t\tthrow StorageNamespaceConverter.ERR_INVALID_NAMESPACED_ID(namespacedId);\r\n\t}\r\n\r\n\tprivate static readonly separator = '<ns:id>';\r\n\r\n\tprivate static readonly namespaceDecoderRegexStr = \"(.*)\" + StorageNamespaceConverter.separator + \"(.*)\";\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {SeInjectable} from './dependencyInjection/di';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name smarteditServicesModule.service:TestModeService\r\n *\r\n * @description\r\n * Used to determine whether smartedit is running in a e2e (test) mode\r\n */\r\n/** @internal */\r\n@SeInjectable()\r\n/* @ngInject */\n export class TestModeService {\r\n\r\n\t// Constants\r\n\tprivate readonly TEST_KEY: string = 'e2eMode';\r\n\r\n\tconstructor(private $injector: angular.auto.IInjectorService) {\r\n\t}\r\n\r\n\t/** \r\n\t * @ngdoc method\r\n\t * @name smarteditServicesModule.service:TestModeService#isE2EMode\r\n\t * @methodOf smarteditServicesModule.service:TestModeService\r\n\t *\r\n\t * @description\r\n\t * returns true if smartedit is running in e2e (test) mode\r\n\t *\r\n\t * @returns {Boolean} true/false\r\n\t */\r\n\tpublic isE2EMode(): boolean {\r\n\t\treturn this.$injector.has(this.TEST_KEY) && this.$injector.get(this.TEST_KEY);\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as lo from 'lodash';\r\nimport {TruncatedText} from \"smarteditcommons/dtos/TruncatedText\";\r\nimport {SeInjectable} from 'smarteditcommons/services/dependencyInjection/di';\r\n\r\n/**\r\n * @internal\r\n * \r\n * @name TextTruncateService\r\n *\r\n * @description\r\n * Service containing truncate string functions.\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class TextTruncateService {\r\n\r\n\tconstructor(private lodash: lo.LoDashStatic) {}\r\n\r\n    /**\r\n     * @name TextTruncateService#truncateToNearestWord\r\n     * @methodOf TextTruncateService\r\n     *\r\n     * @description\r\n     * Truncates text to the nearest word depending on character length. Truncates below character length.\r\n     *\r\n     * @param {number} limit index in text to truncate to\r\n     * @param {string} text text to be truncated\r\n     * @return {TruncatedText}\r\n     */\r\n\tpublic truncateToNearestWord(limit: number, text: string, ellipsis: string = \"\"): TruncatedText {\r\n\t\tif (this.lodash.isNil(text) || limit > text.length) {\r\n\t\t\treturn new TruncatedText(text, text, false);\r\n\t\t}\r\n\t\tconst regexp: RegExp = /(\\s)/g;\r\n\t\tconst truncatedGroups: RegExpMatchArray = text.match(regexp);\r\n\r\n\t\tlet truncateIndex = 0;\r\n\t\tif (!truncatedGroups) {\r\n\t\t\ttruncateIndex = limit;\r\n\t\t} else {\r\n\t\t\tfor (let i = 0; i < truncatedGroups.length; i++) {\r\n\t\t\t\tconst nextPosition: number = this.getPositionOfCharacters(text, truncatedGroups[i], i + 1);\r\n\t\t\t\tif (nextPosition > limit) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\ttruncateIndex = nextPosition;\r\n\t\t\t}\r\n\t\t}\r\n\t\tconst truncated: string = text.substr(0, truncateIndex);\r\n\t\treturn new TruncatedText(text, truncated, true, ellipsis);\r\n\t}\r\n\r\n\tprivate getPositionOfCharacters(searchString: string, characters: string, index: number): number {\r\n\t\treturn searchString.split(characters, index).join(characters).length;\r\n\t}\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {SeInjectable} from \"../dependencyInjection/SeInjectable\";\r\nimport {WizardConfig, WizardService, WizardStep} from \"./WizardService\";\r\nimport {WizardAction, WizardActions} from \"./WizardActions\";\r\n\r\nexport interface IWizardActionStrategy {\r\n\tapplyStrategy(wizardService: WizardService, conf: WizardConfig): void;\r\n}\r\n\r\n/* @internal */\r\n@SeInjectable()\r\n/* @ngInject */\n export class DefaultWizardActionStrategy implements IWizardActionStrategy {\r\n\r\n\tconstructor(\r\n\t\tprivate wizardActions: WizardActions\r\n\t) {}\r\n\r\n\tapplyStrategy(wizardService: WizardService, conf: WizardConfig): void {\r\n\t\tconst nextAction = this.applyOverrides(wizardService, this.wizardActions.next(), conf.nextLabel, conf.onNext, conf.isFormValid);\r\n\t\tconst doneAction = this.applyOverrides(wizardService, this.wizardActions.done(), conf.doneLabel, conf.onDone, conf.isFormValid);\r\n\r\n\t\tconst backConf = conf.backLabel ? {\r\n\t\t\ti18n: conf.backLabel\r\n\t\t} : null;\r\n\t\tconst backAction = this.wizardActions.back(backConf);\r\n\r\n\t\tconf.steps.forEach((step: WizardStep, index: number) => {\r\n\t\t\tstep.actions = [];\r\n\t\t\tif (index > 0) {\r\n\t\t\t\tstep.actions.push(backAction);\r\n\t\t\t}\r\n\t\t\tif (index === (conf.steps.length - 1)) {\r\n\t\t\t\tstep.actions.push(doneAction);\r\n\t\t\t} else {\r\n\t\t\t\tstep.actions.push(nextAction);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tconf.cancelAction = this.applyOverrides(wizardService, this.wizardActions.cancel(), conf.cancelLabel, conf.onCancel, null);\r\n\t\tconf.templateOverride = 'modalWizardNavBarTemplate.html';\r\n\t}\r\n\r\n\tprivate applyOverrides(wizardService: WizardService, action: WizardAction, label: string, executeCondition: (stepId: string) => boolean, enableCondition: (stepId: string) => boolean): WizardAction {\r\n\r\n\t\tif (label) {\r\n\t\t\taction.i18n = label;\r\n\t\t}\r\n\t\tif (executeCondition) {\r\n\t\t\taction.executeIfCondition = function() {\r\n\t\t\t\treturn executeCondition(wizardService.getCurrentStepId());\r\n\t\t\t};\r\n\t\t}\r\n\t\tif (enableCondition) {\r\n\t\t\taction.enableIfCondition = function() {\r\n\t\t\t\treturn enableCondition(wizardService.getCurrentStepId());\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\treturn action;\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from \"angular\";\r\nimport {SeInjectable} from \"../dependencyInjection/SeInjectable\";\r\nimport {IModalService} from \"smarteditcommons/services/interfaces/IModalService\";\r\nimport {WizardAction} from \"./WizardActions\";\r\nimport {ModalWizardControllerFactory} from \"./ModalWizardControllerFactory\";\r\n\r\n/**\r\n * @ngdoc service\r\n * @name wizardServiceModule.modalWizard\r\n *\r\n * @description\r\n * The modalWizard service is used to create wizards that are embedded into the {@link modalServiceModule modalService}\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class ModalWizard {\r\n\r\n\tconstructor(\r\n\t\tprivate modalService: IModalService,\r\n\t) {}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.modalWizard#open\r\n\t * @methodOf wizardServiceModule.modalWizard\r\n\t *\r\n\t * @description\r\n\t * Open provides a simple way to create modal wizards, with much of the boilerplate taken care of for you, such as look\r\n\t * and feel, and wizard navigation.\r\n\t *\r\n\t * @param {WizardAction} conf configuration\r\n\t * @param {String|function|Array} conf.controller An angular controller which will be the underlying controller\r\n\t * for all of the wizard. This controller MUST implement the function <strong>getWizardConfig()</strong> which\r\n\t * returns a {@link wizardServiceModule.object:ModalWizardConfig ModalWizardConfig}.<br />\r\n\t * If you need to do any manual wizard manipulation, 'wizardManager' can be injected into your controller.\r\n\t * See {@link wizardServiceModule.WizardManager WizardManager}\r\n\t * @param {String} conf.controllerAs (OPTIONAL) An alternate controller name that can be used in your wizard step\r\n\t * @param {=String=} conf.properties A map of properties to initialize the wizardManager with. They are accessible under wizardManager.properties.\r\n\t * templates. By default the controller name is wizardController.\r\n\t *\r\n\t * @returns {function} {@link https://docs.angularjs.org/api/ng/service/$q promise} that will either be resolved (wizard finished) or\r\n\t * rejected (wizard cancelled).\r\n\t */\r\n\topen(config: WizardAction): angular.IPromise<any> {\r\n\t\tthis.validateConfig(config);\r\n\t\treturn this.modalService.open({\r\n\t\t\ttemplateUrl: 'modalWizardTemplate.html',\r\n\t\t\tcontroller: ModalWizardControllerFactory(config)\r\n\t\t});\r\n\t}\r\n\r\n\tprivate validateConfig(config: WizardAction): void {\r\n\t\tif (!config.controller) {\r\n\t\t\tthrow new Error(\"WizardService - initialization exception. No controller provided\");\r\n\t\t}\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from \"angular\";\r\nimport {WizardAction, WizardActions} from \"./WizardActions\";\r\nimport {TypedMap} from \"smarteditcommons\";\r\nimport {WizardConfig, WizardService, WizardStep} from \"./WizardService\";\r\nimport {IWizardActionStrategy} from \"smarteditcommons/services/wizard/DefaultWizardActionStrategy\";\r\nimport * as lo from \"lodash\";\r\n\r\ninterface ModalWizardScope extends angular.IScope {\r\n\t[name: string]: any;\r\n}\r\n\r\n/* @internal */\r\nexport const ModalWizardControllerFactory = (config: WizardAction): angular.IControllerConstructor => {\r\n\r\n\t/* @ngInject */\r\n\tclass ModalWizardController {\r\n\r\n\t\tpublic executeAction: (action: WizardAction) => void;\r\n\r\n\t\tprivate getWizardConfig: () => WizardConfig;\r\n\t\tprivate _wizardContext: {_steps: WizardStep[], templateUrl?: string, navActions?: WizardAction[], templateOverride?: string};\r\n\t\tprivate wizardService: WizardService;\r\n\r\n\t\tconstructor(\r\n\t\t\tprivate lodash: lo.LoDashStatic,\r\n\t\t\tprivate $scope: ModalWizardScope,\r\n\t\t\tprivate $rootScope: angular.IRootScopeService,\r\n\t\t\tprivate modalManager: any,\r\n\t\t\t$controller: angular.IControllerService,\r\n\t\t\tprivate wizardActions: WizardActions,\r\n\t\t\tprivate MODAL_BUTTON_STYLES: TypedMap<string>,\r\n\t\t\tprivate $q: angular.IQService,\r\n\t\t\tdefaultWizardActionStrategy: IWizardActionStrategy,\r\n\t\t\tgenerateIdentifier: () => string\r\n\t\t) {\r\n\t\t\tthis.wizardService = new WizardService(this.$q, defaultWizardActionStrategy, generateIdentifier);\r\n\t\t\tthis.wizardService.properties = config.properties;\r\n\t\t\tthis.lodash.assign(this, $controller(config.controller, {\r\n\t\t\t\t$scope,\r\n\t\t\t\twizardManager: this.wizardService\r\n\t\t\t}));\r\n\r\n\t\t\tif (config.controllerAs) {\r\n\t\t\t\tthis.$scope[config.controllerAs] = this;\r\n\t\t\t}\r\n\r\n\t\t\tif (typeof this.getWizardConfig !== 'function') {\r\n\t\t\t\tthrow new Error(\"The provided controller must provide a getWizardConfig() function.\");\r\n\t\t\t}\r\n\r\n\t\t\tconst modalConfig = this.getWizardConfig();\r\n\r\n\t\t\tthis._wizardContext = {\r\n\t\t\t\t_steps: modalConfig.steps\r\n\t\t\t};\r\n\r\n\t\t\tthis.executeAction = (action: WizardAction) => {\r\n\t\t\t\tthis.wizardService.executeAction(action);\r\n\t\t\t};\r\n\r\n\t\t\tlet unregisterWatch: () => void;\r\n\r\n\t\t\tthis.wizardService.onLoadStep = (stepIndex: number, step: WizardStep) => {\r\n\t\t\t\tthis.modalManager.title = step.title;\r\n\t\t\t\tthis._wizardContext.templateUrl = step.templateUrl;\r\n\t\t\t\tthis.modalManager.removeAllButtons();\r\n\t\t\t\t(step.actions || []).forEach((action) => {\r\n\t\t\t\t\tif (typeof action.enableIfCondition === 'function') {\r\n\t\t\t\t\t\tunregisterWatch = this.$rootScope.$watch(action.enableIfCondition, (newVal) => {\r\n\t\t\t\t\t\t\tif (newVal) {\r\n\t\t\t\t\t\t\t\tthis.modalManager.enableButton(action.id);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.modalManager.disableButton(action.id);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tthis.modalManager.addButton(this.convertActionToButtonConf(action));\r\n\t\t\t\t});\r\n\t\t\t};\r\n\r\n\t\t\tthis.wizardService.onClose = (result: unknown) => {\r\n\t\t\t\tthis.modalManager.close(result);\r\n\t\t\t\tunregisterWatch();\r\n\t\t\t};\r\n\r\n\t\t\tthis.wizardService.onCancel = () => {\r\n\t\t\t\tthis.modalManager.dismiss();\r\n\t\t\t\tunregisterWatch();\r\n\t\t\t};\r\n\r\n\t\t\tthis.wizardService.onStepsUpdated = (steps: WizardStep[]) => {\r\n\t\t\t\tthis.setupNavBar(steps);\r\n\t\t\t\tthis._wizardContext._steps = steps;\r\n\t\t\t};\r\n\r\n\t\t\tthis.wizardService.initialize(modalConfig);\r\n\t\t\tthis.setupModal(modalConfig);\r\n\t\t}\r\n\r\n\t\tprivate setupNavBar(steps: WizardStep[]) {\r\n\t\t\tthis._wizardContext.navActions = steps.map((step, index: number) => {\r\n\t\t\t\tconst action = this.wizardActions.navBarAction({\r\n\t\t\t\t\tid: 'NAV-' + step.id,\r\n\t\t\t\t\tstepIndex: index,\r\n\t\t\t\t\twizardService: this.wizardService,\r\n\t\t\t\t\tdestinationIndex: index,\r\n\t\t\t\t\ti18n: step.name,\r\n\t\t\t\t\tisCurrentStep: () => {\r\n\t\t\t\t\t\treturn action.stepIndex === this.wizardService.getCurrentStepIndex();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\treturn action;\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tprivate setupModal(setupConfig: WizardConfig) {\r\n\t\t\tthis._wizardContext.templateOverride = setupConfig.templateOverride;\r\n\t\t\tif (setupConfig.cancelAction) {\r\n\t\t\t\tthis.modalManager.setDismissCallback(() => {\r\n\t\t\t\t\tthis.wizardService.executeAction(setupConfig.cancelAction);\r\n\t\t\t\t\treturn this.$q.reject();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tthis.setupNavBar(setupConfig.steps);\r\n\t\t}\r\n\r\n\t\tprivate convertActionToButtonConf(action: WizardAction) {\r\n\t\t\treturn {\r\n\t\t\t\tid: action.id,\r\n\t\t\t\tstyle: action.isMainAction ? this.MODAL_BUTTON_STYLES.PRIMARY : this.MODAL_BUTTON_STYLES.SECONDARY,\r\n\t\t\t\tlabel: action.i18n,\r\n\t\t\t\tcallback: () => {\r\n\t\t\t\t\tthis.wizardService.executeAction(action);\r\n\t\t\t\t}\r\n\t\t\t};\r\n\t\t}\r\n\t}\r\n\r\n\treturn ModalWizardController;\r\n};","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {SeInjectable} from \"../dependencyInjection/SeInjectable\";\r\nimport {WizardService} from \"./WizardService\";\r\nimport * as angular from \"angular\";\r\nimport {TypedMap} from \"smarteditcommons\";\r\n\r\nexport interface WizardAction {\r\n\tid?: string;\r\n\ti18n: string;\r\n\tcontroller?: angular.IControllerService;\r\n\tcontrollerAs?: string;\r\n\tisMainAction?: boolean;\r\n\tdestinationIndex?: number;\r\n\tstepIndex?: number;\r\n\twizardService?: WizardService;\r\n\tproperties?: TypedMap<any>;\r\n\tisCurrentStep?(): boolean;\r\n\tenableIfCondition?(): boolean;\r\n\texecuteIfCondition?(): boolean;\r\n\texecute?(wizardService: WizardService): void;\r\n}\r\n\r\nconst DEFAULT_WIZARD_ACTION: WizardAction = {\r\n\tid: \"wizard_action_id\",\r\n\ti18n: 'wizard_action_label',\r\n\tisMainAction: true,\r\n\tenableIfCondition() {\r\n\t\treturn true;\r\n\t},\r\n\texecuteIfCondition() {\r\n\t\treturn true;\r\n\t},\r\n\texecute(wizardService: WizardService) {\r\n\t\treturn;\r\n\t}\r\n};\r\n\r\n/* @internal */\r\n@SeInjectable()\r\n/* @ngInject */\n export class WizardActions {\r\n\r\n\tcustomAction(configuration: WizardAction): WizardAction {\r\n\t\treturn this.createNewAction(configuration);\r\n\t}\r\n\r\n\tdone(configuration?: WizardAction): WizardAction {\r\n\t\tconst custom = {\r\n\t\t\tid: 'ACTION_DONE',\r\n\t\t\ti18n: 'se.action.done',\r\n\t\t\texecute: (wizardService: WizardService) => {\r\n\t\t\t\twizardService.close();\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn this.createNewAction(configuration, custom);\r\n\t}\r\n\r\n\tnext(configuration?: WizardAction): WizardAction {\r\n\t\tconst custom = {\r\n\t\t\tid: 'ACTION_NEXT',\r\n\t\t\ti18n: 'se.action.next',\r\n\t\t\texecute(wizardService: WizardService) {\r\n\t\t\t\twizardService.goToStepWithIndex(wizardService.getCurrentStepIndex() + 1);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn this.createNewAction(configuration, custom);\r\n\t}\r\n\r\n\tnavBarAction(configuration: WizardAction): WizardAction {\r\n\t\tif (!configuration.wizardService || configuration.destinationIndex === null) {\r\n\t\t\tthrow new Error(\"Error initializating navBarAction, must provide the wizardService and destinationIndex fields\");\r\n\t\t}\r\n\r\n\t\tconst custom = {\r\n\t\t\tid: 'ACTION_GOTO',\r\n\t\t\ti18n: 'action.goto',\r\n\t\t\tenableIfCondition: () => {\r\n\t\t\t\treturn configuration.wizardService.getCurrentStepIndex() >= configuration.destinationIndex;\r\n\t\t\t},\r\n\t\t\texecute: (wizardService: WizardService) => {\r\n\t\t\t\twizardService.goToStepWithIndex(configuration.destinationIndex);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn this.createNewAction(configuration, custom);\r\n\t}\r\n\r\n\tback(configuration: WizardAction): WizardAction {\r\n\t\tconst custom = {\r\n\t\t\tid: 'ACTION_BACK',\r\n\t\t\ti18n: 'se.action.back',\r\n\t\t\tisMainAction: false,\r\n\t\t\texecute(wizardService: WizardService) {\r\n\t\t\t\tconst currentIndex = wizardService.getCurrentStepIndex();\r\n\t\t\t\tif (currentIndex <= 0) {\r\n\t\t\t\t\tthrow new Error(\"Failure to execute BACK action, no previous index exists!\");\r\n\t\t\t\t}\r\n\t\t\t\twizardService.goToStepWithIndex(currentIndex - 1);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\treturn this.createNewAction(configuration, custom);\r\n\t}\r\n\r\n\tcancel(): WizardAction {\r\n\t\treturn this.createNewAction({\r\n\t\t\tid: 'ACTION_CANCEL',\r\n\t\t\ti18n: 'se.action.cancel',\r\n\t\t\tisMainAction: false,\r\n\t\t\texecute(wizardService: WizardService) {\r\n\t\t\t\twizardService.cancel();\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate createNewAction(configuration: WizardAction = null, customConfiguration: WizardAction = null): WizardAction {\r\n\t\treturn {...DEFAULT_WIZARD_ACTION, ...customConfiguration, ...configuration};\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from \"angular\";\r\nimport {TypedMap} from \"smarteditcommons\";\r\nimport {WizardAction} from \"./WizardActions\";\r\nimport {IWizardActionStrategy} from \"./DefaultWizardActionStrategy\";\r\n\r\n/**\r\n * @ngdoc object\r\n * @name wizardServiceModule.object:WizardStepConfig\r\n * @description\r\n * A plain JSON object, representing the configuration options for a single step in a wizard\r\n */\r\n\r\nexport interface WizardStep {\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name id\r\n\t * @propertyOf wizardServiceModule.object:WizardStepConfig\r\n\t * @description\r\n\t * An optional unique ID for this step in the wizard. If no ID is provided, one is automatically generated.<br />\r\n\t * You may choose to provide an ID, making it easier to reference this step explicitly via the wizard service, or\r\n\t * be able to identify for which step a callback is being triggered.\r\n\t */\r\n\tid: string;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name templateUrl\r\n\t * @propertyOf wizardServiceModule.object:WizardStepConfig\r\n\t * @description The url of the html template for this step\r\n\t */\r\n\ttemplateUrl: string;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name title\r\n\t * @propertyOf wizardServiceModule.object:WizardStepConfig\r\n\t * @description An i18n key, representing the title that will be displayed at the top of the wizard for this step.\r\n\t */\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name name\r\n\t * @propertyOf wizardServiceModule.object:WizardStepConfig\r\n\t * @description An i18n key representing a meaning (short) name for this step.\r\n\t * This name will be displayed in the wizard navigation menu.\r\n\t */\r\n\tname: string;\r\n\ttitle: string;\r\n\tactions: WizardAction[];\r\n}\r\n\r\n/**\r\n * @ngdoc object\r\n * @name wizardServiceModule.object:ModalWizardConfig\r\n * @description\r\n * A plain JSON object, representing the configuration options for a modal wizard\r\n */\r\nexport interface WizardConfig {\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name steps (Array)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An ordered array of {@link wizardServiceModule.object:WizardStepConfig WizardStepConfig}\r\n\t */\r\n\tsteps: WizardStep[];\r\n\tactionStrategy: IWizardActionStrategy;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name resultFn (Function)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An optional callback function that has no parameters. This callback is triggered after the done\r\n\t * action is fired, and the wizard is about to be closed. If this function is defined and returns a value, this\r\n\t * value will be returned in the resolved promise returned by the {@link wizardServiceModule.modalWizard#methods_open modalWizard.open()}\r\n\t * This is an easy way to pass a result from the wizard to the caller.\r\n\t */\r\n\tresultFn: () => void;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name isFormValid (Function)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An optional callback function that receives a single parameter, the current step ID. This callback\r\n\t * is used to enable/disable the next action and the done action.\r\n\t * The callback should return a boolean to enabled the action. Null, or if this callback is not defined defaults to\r\n\t * true (enabled)\r\n\t */\r\n\tisFormValid?: (stepId: string) => boolean;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name onNext (Function)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An optional callback function that receives a single parameter, the current step ID.\r\n\t * This callback is triggered after the next action is fired. You have the opportunity to halt the Next action by\r\n\t * returning promise and rejecting it, otherwise the wizard will continue and load the next step.\r\n\t */\r\n\tonNext?: (stepId: string) => boolean;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name onCancel (Function)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An optional callback function that receives a single parameter, the current step ID.\r\n\t * This callback is triggered after the cancel action is fired. You have the opportunity to halt the cancel action\r\n\t * (thereby stopping the wizard from being closed), by returning a promise and rejecting it, otherwise the wizard will\r\n\t * continue the cancel action.\r\n\t */\r\n\tonCancel?: (stepId: string) => boolean;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name onDone (Function)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An optional callback function that has no parameters. This callback is triggered after the done\r\n\t * action is fired. You have the opportunity to halt the done action (thereby stopping the wizard from being closed),\r\n\t * by returning a promise and rejecting it, otherwise the wizard will continue and close the wizard.\r\n\t */\r\n\tonDone?: (stepId: string) => boolean;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name doneLabel (String)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An optional i18n key to override the default label for the Done button\r\n\t */\r\n\tdoneLabel?: string;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name nextLabel (String)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An optional i18n key to override the default label for the Next button\r\n\t */\r\n\tnextLabel?: string;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name backLabel (String)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An optional i18n key to override the default label for the Back button\r\n\t */\r\n\tbackLabel?: string;\r\n\t/**\r\n\t * @ngdoc property\r\n\t * @name cancelLabel (String)\r\n\t * @propertyOf wizardServiceModule.object:ModalWizardConfig\r\n\t * @description An optional i18n key to override the default label for the Cancel button\r\n\t */\r\n\tcancelLabel?: string;\r\n\ttemplateOverride?: string;\r\n\tcancelAction?: WizardAction;\r\n}\r\n\r\n/**\r\n * @ngdoc service\r\n * @name wizardServiceModule.WizardManager\r\n *\r\n * @description\r\n * The Wizard Manager is a wizard management service that can be injected into your wizard controller.\r\n *\r\n */\r\nexport class WizardService {\r\n\r\n\tpublic onLoadStep: (index: number, nextStep: WizardStep) => void;\r\n\tpublic onClose: (result: unknown) => void;\r\n\tpublic onCancel: () => void;\r\n\tpublic onStepsUpdated: (steps: WizardStep[]) => void;\r\n\tpublic properties: TypedMap<any>;\r\n\r\n\tprivate _actionStrategy: IWizardActionStrategy;\r\n\tprivate _currentIndex: number;\r\n\tprivate _conf: WizardConfig;\r\n\tprivate _steps: WizardStep[];\r\n\tprivate _getResult: () => void;\r\n\r\n\tconstructor(\r\n\t\tprivate $q: angular.IQService,\r\n\t\tprivate defaultWizardActionStrategy: IWizardActionStrategy,\r\n\t\tprivate generateIdentifier: () => string\r\n\t) {\r\n\t\t// the overridable callbacks\r\n\t\tthis.onLoadStep = function(index: number, nextStep: WizardStep) {\r\n\t\t\treturn;\r\n\t\t};\r\n\t\tthis.onClose = function(result: unknown) {\r\n\t\t\treturn;\r\n\t\t};\r\n\t\tthis.onCancel = function() {\r\n\t\t\treturn;\r\n\t\t};\r\n\t\tthis.onStepsUpdated = function(steps: WizardStep[]) {\r\n\t\t\treturn;\r\n\t\t};\r\n\t}\r\n\r\n\t/* @internal */\r\n\tinitialize(conf: WizardConfig): void {\r\n\r\n\t\tthis.validateConfig(conf);\r\n\r\n\t\tthis._actionStrategy = conf.actionStrategy || this.defaultWizardActionStrategy;\r\n\t\tthis._actionStrategy.applyStrategy(this, conf);\r\n\r\n\t\tthis._currentIndex = 0;\r\n\t\tthis._conf = {...conf};\r\n\t\tthis._steps = this._conf.steps;\r\n\t\tthis._getResult = conf.resultFn;\r\n\t\tthis.validateStepUids(this._steps);\r\n\r\n\t\tthis.goToStepWithIndex(0);\r\n\t}\r\n\r\n\t/* @internal */\r\n\texecuteAction(action: WizardAction): angular.IPromise<void> {\r\n\t\tif (action.executeIfCondition) {\r\n\t\t\treturn this.$q.resolve(action.executeIfCondition()).then(() => {\r\n\t\t\t\treturn action.execute(this);\r\n\t\t\t});\r\n\t\t}\r\n\t\treturn this.$q.resolve(action.execute(this));\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#goToStepWithIndex\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @description Navigates the wizard to the given step\r\n\t * @param {Number} index The 0-based index from the steps array returned by the wizard controllers getWizardConfig() function\r\n\t */\r\n\tgoToStepWithIndex(index: number): void {\r\n\t\tconst nextStep = this.getStepWithIndex(index);\r\n\t\tif (nextStep) {\r\n\t\t\tthis.onLoadStep(index, nextStep);\r\n\t\t\tthis._currentIndex = index;\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#goToStepWithId\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @description Navigates the wizard to the given step\r\n\t * @param {String} id The ID of a step returned by the wizard controllers getWizardConfig() function. Note that if\r\n\t * no id was provided for a given step, then one is automatically generated.\r\n\t */\r\n\tgoToStepWithId(id: string): void {\r\n\t\tthis.goToStepWithIndex(this.getStepIndexFromId(id));\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#addStep\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @description Adds an additional step to the wizard at runtime\r\n\t * @param {Object} newStep A {@link wizardServiceModule.object:WizardStepConfig WizardStepConfig}\r\n\t * @param {Number} index (OPTIONAL) A 0-based index position in the steps array. Default is 0.\r\n\t */\r\n\taddStep(newStep: WizardStep, index: number): void {\r\n\t\tif (parseInt(newStep.id, 10) !== 0 && !newStep.id) {\r\n\t\t\tnewStep.id = this.generateIdentifier();\r\n\t\t}\r\n\t\tif (!index) {\r\n\t\t\tindex = 0;\r\n\t\t}\r\n\t\tif (this._currentIndex >= index) {\r\n\t\t\tthis._currentIndex++;\r\n\t\t}\r\n\t\tthis._steps.splice(index, 0, newStep);\r\n\t\tthis.validateStepUids(this._steps);\r\n\t\tthis._actionStrategy.applyStrategy(this, this._conf);\r\n\t\tthis.onStepsUpdated(this._steps);\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#removeStepById\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @description Remove a step form the wizard at runtime. If you are removing the currently displayed step, the\r\n\t * wizard will return to the first step. Removing all the steps will result in an error.\r\n\t * @param {String} id The id of the step you wish to remove\r\n\t */\r\n\tremoveStepById(id: string): void {\r\n\t\tthis.removeStepByIndex(this.getStepIndexFromId(id));\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#removeStepByIndex\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @description Remove a step form the wizard at runtime. If you are removing the currently displayed step, the\r\n\t * wizard will return to the first step. Removing all the steps will result in an error.\r\n\t * @param {Number} index The 0-based index of the step you wish to remove.\r\n\t */\r\n\tremoveStepByIndex(index: number): void {\r\n\t\tif (index >= 0 && index < this.getStepsCount()) {\r\n\t\t\tthis._steps.splice(index, 1);\r\n\t\t\tif (index === this._currentIndex) {\r\n\t\t\t\tthis.goToStepWithIndex(0);\r\n\t\t\t}\r\n\t\t\tthis._actionStrategy.applyStrategy(this, this._conf);\r\n\t\t\tthis.onStepsUpdated(this._steps);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#close\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @description Close the wizard. This will return a resolved promise to the creator of the wizard, and if any\r\n\t * resultFn was provided in the {@link wizardServiceModule.object:ModalWizardConfig ModalWizardConfig} the returned\r\n\t * value of this function will be passed as the result.\r\n\t */\r\n\tclose(): void {\r\n\t\tlet result: unknown;\r\n\t\tif (typeof this._getResult === 'function') {\r\n\t\t\tresult = this._getResult();\r\n\t\t}\r\n\t\tthis.onClose(result);\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#cancel\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @description Cancel the wizard. This will return a rejected promise to the creator of the wizard.\r\n\t */\r\n\tcancel(): void {\r\n\t\tthis.onCancel();\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#getSteps\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @returns {Array} An array of all the steps in the wizard\r\n\t */\r\n\tgetSteps(): WizardStep[] {\r\n\t\treturn this._steps;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#getStepIndexFromId\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @param {String} id A step ID\r\n\t * @returns {Number} The index of the step with the provided ID\r\n\t */\r\n\tgetStepIndexFromId(id: string): number {\r\n\t\tconst index = this._steps.findIndex((step) => {\r\n\t\t\treturn step.id === id;\r\n\t\t});\r\n\t\treturn index;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#containsStep\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @param {String} id A step ID\r\n\t * @returns {Boolean} True if the ID exists in one of the steps\r\n\t */\r\n\tcontainsStep(stepId: string): boolean {\r\n\t\treturn this.getStepIndexFromId(stepId) >= 0;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#getCurrentStepId\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @returns {String} The ID of the currently displayed step\r\n\t */\r\n\tgetCurrentStepId(): string {\r\n\t\treturn this.getCurrentStep().id;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#getCurrentStepIndex\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @returns {Number} The index of the currently displayed step\r\n\t */\r\n\tgetCurrentStepIndex() {\r\n\t\treturn this._currentIndex;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#getCurrentStep\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @returns {Object} The currently displayed step\r\n\t */\r\n\tgetCurrentStep(): WizardStep {\r\n\t\treturn this.getStepWithIndex(this._currentIndex);\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#getStepsCount\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @returns {Number} The number of steps in the wizard. This should always be equal to the size of the array\r\n\t * returned by {@link wizardServiceModule.WizardManager#methods_getSteps getSteps()}\r\n\t */\r\n\tgetStepsCount(): number {\r\n\t\treturn this._steps.length;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#getStepWithId\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @param {String} id The ID of a step\r\n\t * @returns {Object} The {@link wizardServiceModule.object:WizardStepConfig step} with the given ID\r\n\t */\r\n\tgetStepWithId(id: string): WizardStep {\r\n\t\tconst index = this.getStepIndexFromId(id);\r\n\t\tif (index >= 0) {\r\n\t\t\treturn this.getStepWithIndex(index);\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name wizardServiceModule.WizardManager#getStepWithIndex\r\n\t * @methodOf wizardServiceModule.WizardManager\r\n\t * @param {Number} index The ID of a step\r\n\t * @returns {Object} The {@link wizardServiceModule.object:WizardStepConfig step} with the given index\r\n\t */\r\n\tgetStepWithIndex(index: number): WizardStep {\r\n\t\tif (index >= 0 && index < this.getStepsCount()) {\r\n\t\t\treturn this._steps[index];\r\n\t\t}\r\n\t\tthrow new Error((\"wizardService.getStepForIndex - Index out of bounds: \" + index));\r\n\t}\r\n\r\n\tprivate validateConfig(config: WizardConfig): void {\r\n\t\tif (!config.steps || config.steps.length <= 0) {\r\n\t\t\tthrow new Error(\"Invalid WizardService configuration - no steps provided\");\r\n\t\t}\r\n\r\n\t\tconfig.steps.forEach((step) => {\r\n\t\t\tif (!step.templateUrl) {\r\n\t\t\t\tthrow new Error(`Invalid WizardService configuration - Step missing a url: ${step}`);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tprivate validateStepUids(steps: WizardStep[]): void {\r\n\t\tconst stepIds: TypedMap<string> = {};\r\n\t\tsteps.forEach((step) => {\r\n\t\t\tif (!step.id) {\r\n\t\t\t\tstep.id = this.generateIdentifier();\r\n\t\t\t} else if (stepIds[step.id]) {\r\n\t\t\t\tthrow new Error(`Invalid (Duplicate) step id: ${step.id}`);\r\n\t\t\t} else {\r\n\t\t\t\tstepIds[step.id] = step.id;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {SeModule} from \"../dependencyInjection/SeModule\";\r\nimport {DefaultWizardActionStrategy} from \"./DefaultWizardActionStrategy\";\r\nimport {ModalWizard} from \"./ModalWizard\";\r\nimport {WizardActions} from \"./WizardActions\";\r\n\r\n/**\r\n * @ngdoc overview\r\n * @name wizardServiceModule\r\n *\r\n * @description\r\n * # The wizardServiceModule\r\n * The wizardServiceModule is a module containing all wizard related services\r\n * # Creating a modal wizard in a few simple steps\r\n * 1. Add the wizardServiceModule to your module dependencies\r\n * 2. Inject {@link wizardServiceModule.modalWizard modalWizard} where you want to use the wizard.\r\n * 3. Create a new controller for your wizard. This controller will be used for all steps of the wizard.\r\n * 4. Implement a function in your new controller called <strong>getWizardConfig</strong> that returns a {@link wizardServiceModule.object:ModalWizardConfig ModalWizardConfig}\r\n * 5. Use {@link wizardServiceModule.modalWizard#methods_open modalWizard.open()} passing in your new controller\r\n *\r\n * <pre>\r\n * @SeInjectable()\r\n * export class MyWizardService {\r\n * \t\tconstructor(private modalWizard) {}\r\n * \t\topen() {\r\n * \t\t\tthis.modalWizard.open({\r\n * \t\t\t\tcontroller: (wizardManager: any) => {\r\n * \t\t\t\t\t'ngInject';\r\n * \t\t\t\t\treturn {\r\n * \t\t\t\t\t\tsteps: [{\r\n * \t\t\t\t\t\t\tid: 'step1',\r\n * \t\t\t\t\t\t\tname: 'i18n.step1.name',\r\n * \t\t\t\t\t\t\ttitle: 'i18n.step1.title',\r\n * \t\t\t\t\t\t\ttemplateUrl: 'some/template1.html'\r\n * \t\t\t\t\t\t}, {\r\n * \t\t\t\t\t\t\tid: 'step2',\r\n * \t\t\t\t\t\t\tname: 'i18n.step2.name',\r\n * \t\t\t\t\t\t\ttitle: 'i18n.step2.title',\r\n * \t\t\t\t\t\t\ttemplateUrl: 'some/template2.html'\r\n * \t\t\t\t\t\t}]\r\n * \t\t\t\t\t};\r\n * \t\t\t\t}\r\n * \t\t\t});\r\n * \t\t}\r\n * }\r\n * </pre>\r\n */\r\n@SeModule({\r\n\timports: [\r\n\t\t'ui.bootstrap',\r\n\t\t'translationServiceModule',\r\n\t\t'functionsModule',\r\n\t\t'coretemplates',\r\n\t\t'modalServiceModule'\r\n\t],\r\n\tproviders: [\r\n\t\tDefaultWizardActionStrategy,\r\n\t\tModalWizard,\r\n\t\tWizardActions,\r\n\t]\r\n})\r\nexport class WizardServiceModule {}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as CryptoJS from 'crypto-js';\r\nimport {SeInjectable} from 'smarteditcommons/services/dependencyInjection/di';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name functionsModule.service:CryptographicUtils\r\n *\r\n * @description\r\n * utility service around Cryptographic operations.\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class CryptographicUtils {\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:CryptographicUtils#sha1Hash\r\n     * @methodOf functionsModule.service:CryptographicUtils\r\n     *\r\n     * @description\r\n     * A utility function that takes an input string and provides a cryptographic SHA1 hash value.\r\n     * \r\n     * @param {String} data The input string to be encrypted.\r\n     * @returns {String} the encrypted hashed result.\r\n     */\r\n\tsha1Hash(data: string): string {\r\n\t\treturn CryptoJS.SHA1(data).toString();\r\n\t}\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from 'angular';\r\nimport {SeInjectable} from '../services/dependencyInjection/di';\r\nimport {TypedMap} from '../dtos';\r\n\r\nexport interface DiscardablePromise<T> {\r\n\tpromise: angular.IPromise<T> | Promise<T>;\r\n\tsuccessCallback: (...args: any[]) => any;\r\n\tfailureCallback: (...args: any[]) => any;\r\n\tdiscardableHolder?: {successCallback: (...args: any[]) => any, failureCallback: (...args: any[]) => any};\r\n}\r\n/**\r\n * @ngdoc service\r\n * @name functionsModule.service:DiscardablePromiseUtils\r\n * @description\r\n * helper to handle competing promises\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class DiscardablePromiseUtils {\r\n\r\n\tprivate _map = {} as TypedMap<DiscardablePromise<any>>;\r\n\r\n\tconstructor(private $log: angular.ILogService) {\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @methodOf DiscardablePromiseUtils\r\n\t * @name functionsModule.service:DiscardablePromiseUtils#apply\r\n\t * @methodOf functionsModule.service:DiscardablePromiseUtils\r\n\t * @description\r\n\t * selects a new promise as candidate for invoking a given callback\r\n\t * each invocation of this method for a given key discards the previously selected promise\r\n\t * @param {string} key the string key identifying the discardable promise\r\n\t * @param {Promise} promise the discardable promise instance once a new candidate is called with this method\r\n\t * @param {Function} successCallback the success callback to ultimately apply on the last promise not discarded\r\n\t * @param {Function=} failureCallback the failure callback to ultimately apply on the last promise not discarded. Optional.\r\n\t */\r\n\tapply<T>(key: string, promise: angular.IPromise<T> | Promise<T>, successCallback: (arg: T) => any, failureCallback?: (arg: Error) => any) {\r\n\r\n\t\tif (!this._map[key]) {\r\n\t\t\tthis._map[key] = {\r\n\t\t\t\tpromise,\r\n\t\t\t\tsuccessCallback,\r\n\t\t\t\tfailureCallback\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tthis.$log.debug(`competing promise for key ${key}`);\r\n\t\t\tdelete this._map[key].discardableHolder.successCallback;\r\n\t\t\tdelete this._map[key].discardableHolder.failureCallback;\r\n\t\t\tthis._map[key].promise = promise;\r\n\t\t}\r\n\r\n\t\tthis._map[key].discardableHolder = {\r\n\t\t\tsuccessCallback: this._map[key].successCallback,\r\n\t\t\tfailureCallback: this._map[key].failureCallback\r\n\t\t};\r\n\r\n\t\tconst self = this;\r\n\t\tconst p = this._map[key].promise;\r\n\t\t(p as Promise<T>).then(\r\n\t\t\tfunction(response: T) {\r\n\r\n\t\t\t\tif (this.successCallback) {\r\n\t\t\t\t\tdelete self._map[key];\r\n\t\t\t\t\tthis.successCallback.apply(undefined, arguments);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.$log.debug(`aborted successCallback for promise identified by ${key}`);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this._map[key].discardableHolder),\r\n\t\t\tfunction(error: Error) {\r\n\t\t\t\tif (this.failureCallback) {\r\n\t\t\t\t\tdelete self._map[key];\r\n\t\t\t\t\tthis.failureCallback.apply(undefined, arguments);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tself.$log.debug(`aborted failureCallback for promise identified by ${key}`);\r\n\t\t\t\t}\r\n\t\t\t}.bind(this._map[key].discardableHolder)\r\n\t\t);\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as lo from 'lodash';\r\nimport {SeInjectable} from 'smarteditcommons/services/dependencyInjection/di';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name functionsModule.service:FunctionsUtils\r\n *\r\n * @description\r\n * utility service around Functions.\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class FunctionsUtils {\r\n\r\n\t/*\r\n\t * regexp matching function(a, $b){} and function MyFunction(a, $b){}\r\n\t */\r\n\tprivate signatureArgsRegexp: RegExp = /function[\\s\\w]*\\(([\\w\\s\\$,]*)\\)[\\s]*{/;\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:FunctionsUtils#isEmpty\r\n     * @methodOf functionsModule.service:FunctionsUtils\r\n     *\r\n     * @description\r\n     * Will determine whether a function body is empty or should be considered empty for proxying purposes\r\n     *\r\n     * @param {Function} func, the function to evaluate\r\n     * @returns {Boolean} a boolean.\r\n     */\r\n\tisEmpty(func: (...args: any[]) => any) {\r\n\t\treturn func.toString().match(/\\{([\\s\\S]*)\\}/m)[1].trim() === '' || /(proxyFunction)/g.test(func.toString().replace(/\\s/g, \"\"));\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:FunctionsUtils#getArguments\r\n     * @methodOf functionsModule.service:FunctionsUtils\r\n     *\r\n     * @description\r\n     * Returns the array of string arguments of the given function signature\r\n     * \r\n     * @param {Function} func the function to analyze\r\n     * @returns {string[]} an array of string arguments\r\n     */\r\n\tgetArguments(func: (...args: any[]) => any) {\r\n\t\ttry {\r\n\t\t\treturn this.signatureArgsRegexp.exec(func.toString())[1].replace(/\\s/g, \"\").split(\",\");\r\n\t\t} catch (e) {\r\n\t\t\tthrow new Error(`failed to retrieve arguments list of ${func}`);\r\n\t\t}\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:FunctionsUtils#hasArguments\r\n     * @methodOf functionsModule.service:FunctionsUtils\r\n     *\r\n     * @description\r\n     * Determines whether a given function (anonymous or not) has arguments in it signature\r\n     * \r\n     * @param {Function} func the function to analyze\r\n     * @returns {boolean} true if the function has signature arguments\r\n     */\r\n\thasArguments(func: (...args: any[]) => any) {\r\n\t\ttry {\r\n\t\t\treturn !this.getLodash().isEmpty(this.signatureArgsRegexp.exec(func.toString())[1]);\r\n\t\t} catch (e) {\r\n\t\t\tthrow new Error(`failed to retrieve arguments list of ${func}`);\r\n\t\t}\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:FunctionsUtils#getConstructorName\r\n     * @methodOf functionsModule.service:FunctionsUtils\r\n     *\r\n     * @description\r\n     * Returns the constructor name in a cross browser fashion\r\n     * \r\n     * @param {Function} func the function to analyze\r\n     * @returns {string} the constructor name\r\n     */\r\n\tgetConstructorName(func: new (...args: any[]) => any) {\r\n\t\ttry {\r\n\t\t\t// IE does not support constructor.name\r\n\t\t\treturn func.name || /function (\\$?\\w+)\\s*\\(/.exec(func.toString())[1];\r\n\t\t} catch {\r\n\t\t\tthrow new Error(\"[FunctionsUtils] - Cannot get name from invalid constructor.\");\r\n\t\t}\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:FunctionsUtils#getInstanceConstructorName\r\n     * @methodOf functionsModule.service:FunctionsUtils\r\n     *\r\n     * @description\r\n     * Returns the constructor name in a cross browser fashion of a class instance\r\n     *\r\n     * @param {Object} instance instance class to analyze\r\n     * @returns {string} the constructor name of the instance\r\n     */\r\n\tgetInstanceConstructorName(instance: object): string {\r\n\t\treturn this.getConstructorName(Object.getPrototypeOf(instance).constructor);\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:FunctionsUtils#extendsConstructor\r\n     * @methodOf functionsModule.service:FunctionsUtils\r\n     *\r\n     * @description\r\n     * Overrides a given constructor with a new constructor body. The resulting constructor will share the same prototype as the original one.\r\n     * \r\n     * @param {(...args:any[]) => T} originalConstructor the original constructor to override\r\n     * @returns {(...args:any[]) => T} newConstructorBody the new constructor body to execute in the override. It may or may not return an instance. Should it return an instance, the latter will be returned by the override.\r\n     */\r\n\textendsConstructor<T>(originalConstructor: (...args: any[]) => T, newConstructorBody: (...args: any[]) => T): any {\r\n\t\t// the new constructor behaviour\r\n\t\tconst newConstructor: any = function(...args: any[]) {\r\n\t\t\tconst result = newConstructorBody.apply(this, args);\r\n\t\t\tif (result) {\r\n\t\t\t\treturn result;\r\n\t\t\t}\r\n\t\t};\r\n\t\t// copy prototype so intanceof operator still works\r\n\t\tnewConstructor.prototype = originalConstructor.prototype;\r\n\r\n\t\treturn newConstructor;\r\n\t}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:FunctionsUtils#getLodash\r\n     * @methodOf functionsModule.service:FunctionsUtils\r\n     *\r\n     * @description\r\n     * Returns lodash service instance in a portable way\r\n     * This is onyl to be used in unit testing and runtime code where angular DI is not available\r\n     * @returns {lodash.LoDashStatic} the instance of the lodash service\r\n     */\r\n\tpublic getLodash(): lo.LoDashStatic {\r\n\t\treturn (window as any).smarteditLodash;\r\n\t}\r\n\r\n\t/** @internal */\r\n\tisUnitTestMode(): boolean {\r\n\t\treturn typeof (window as any).__karma__ !== 'undefined';\r\n\t}\r\n\r\n}\r\n\r\nexport const functionsUtils = new FunctionsUtils();\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {SeInjectable} from 'smarteditcommons/services/dependencyInjection/di';\r\n\r\n/**\r\n * @ngdoc service\r\n * @name functionsModule.service:StringUtils\r\n *\r\n * @description\r\n * utility service around Strings.\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class StringUtils {\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.regExpFactory\r\n     * @name functionsModule.service:StringUtils#regExpFactory\r\n     * @methodOf functionsModule.service:StringUtils\r\n     *\r\n     * @description\r\n     * <b>regExpFactory</b> will convert a given pattern into a regular expression.\r\n     * This method will prepend and append a string with ^ and $ respectively replaces\r\n     * and wildcards (*) by proper regex wildcards.\r\n     *\r\n     * @param {String} pattern any string that needs to be converted to a regular expression.\r\n     *\r\n     * @returns {RegExp} a regular expression generated from the given string.\r\n     *\r\n     */\r\n\r\n\tregExpFactory(pattern: string): RegExp {\r\n\r\n\t\tconst onlyAlphanumericsRegex = new RegExp(/^[a-zA-Z\\d]+$/i);\r\n\t\tconst antRegex = new RegExp(/^[a-zA-Z\\d\\*]+$/i);\r\n\r\n\t\tlet regexpKey;\r\n\t\tif (onlyAlphanumericsRegex.test(pattern)) {\r\n\t\t\tregexpKey = ['^', '$'].join(pattern);\r\n\t\t} else if (antRegex.test(pattern)) {\r\n\t\t\tregexpKey = ['^', '$'].join(pattern.replace(/\\*/g, '.*'));\r\n\t\t} else {\r\n\t\t\tregexpKey = pattern;\r\n\t\t}\r\n\r\n\t\treturn new RegExp(regexpKey, 'g');\r\n\t}\r\n\r\n}\r\n\r\nexport const stringUtils = new StringUtils();\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\n/**\r\n * @ngdoc service\r\n * @name functionsModule.service:UrlUtils\r\n *\r\n * @description\r\n * A collection of utility methods for manipulating URLs\r\n */\r\nexport class UrlUtils {\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:UrlUtils#updateUrlParameter\r\n     * @methodOf functionsModule.service:UrlUtils\r\n     *\r\n     * @description\r\n     * Updates a URL to contain the query param and value provided. If already exists then it is updated,\r\n     * if it did not previously exist, then it will be added.\r\n     *\r\n     * @param {String} url The url to be updated (this param will not be modified)\r\n     * @param {String} key The query param key\r\n     * @param {String} value The query param value\r\n     *\r\n     * @returns {String} The url with updated key/value\r\n     */\r\n\tupdateUrlParameter(url: string, key: string, value: string): string {\r\n\t\tconst i = url.indexOf('#');\r\n\t\tconst hash = i === -1 ? '' : url.substr(i);\r\n\t\turl = i === -1 ? url : url.substr(0, i);\r\n\t\tconst regex = new RegExp(\"([?&])\" + key + \"=.*?(&|$)\", \"i\");\r\n\t\tconst separator = url.indexOf('?') !== -1 ? \"&\" : \"?\";\r\n\r\n\t\tif (url.match(regex)) {\r\n\t\t\turl = url.replace(regex, '$1' + key + \"=\" + value + '$2');\r\n\t\t} else {\r\n\t\t\turl = url + separator + key + \"=\" + value;\r\n\t\t}\r\n\t\treturn url + hash;\r\n\t}\r\n\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {SeInjectable} from 'smarteditcommons/services/dependencyInjection/di';\r\nimport * as angular from \"angular\";\r\n\r\n/**\r\n * @ngdoc service\r\n * @name functionsModule.service:WindowUtils\r\n *\r\n * @description\r\n * A collection of utility methods for windows.\r\n */\r\n@SeInjectable()\r\n/* @ngInject */\n export class WindowUtils {\r\n\r\n\tconstructor(\r\n\t\tprivate isIframe: any,\r\n\t\tprivate SMARTEDIT_IFRAME_ID: string,\r\n\t\tprivate $window: angular.IWindowService,\r\n\t) {}\r\n\r\n    /**\r\n     * @ngdoc method\r\n     * @name functionsModule.service:WindowUtils#getTargetIFrame\r\n     * @methodOf functionsModule.service:WindowUtils\r\n     *\r\n     * @description\r\n     * Retrieves the iframe from the inner or outer app.\r\n     *\r\n     * @returns {Window} The content window or null if it does not exists.\r\n     */\r\n\tgetTargetIFrame(): Window {\r\n\t\tif (this.isIframe()) {\r\n\t\t\treturn this.$window.parent;\r\n\t\t} else if (this.$window.document.getElementById(this.SMARTEDIT_IFRAME_ID)) {\r\n\t\t\treturn (this.$window.document.getElementById(this.SMARTEDIT_IFRAME_ID) as HTMLIFrameElement).contentWindow;\r\n\t\t}\r\n\t\treturn null;\r\n\t}\r\n\r\n}","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nimport * as lo from 'lodash';\r\nimport * as angular from 'angular';\r\nimport {CloneableUtils} from '../dtos/Cloneable';\r\nimport {CryptographicUtils} from './CryptographicUtils';\r\nimport {UrlUtils} from './UrlUtils';\r\nimport {FunctionsUtils} from './FunctionsUtils';\r\nimport {DiscardablePromiseUtils} from './DiscardablePromiseUtils';\r\nimport {StringUtils} from './StringUtils';\r\nimport {WindowUtils} from \"./WindowUtils\";\r\nimport {SeFactory, SeModule} from \"../services/dependencyInjection/di\";\r\nimport {TypedMap} from \"../dtos\";\r\n\r\ndeclare let moment: any;\r\ndeclare let $script: any;\r\n\r\n/**\r\n * @ngdoc service\r\n * @name functionsModule\r\n *\r\n * @description\r\n * provides a list of useful functions that can be used as part of the SmartEdit framework.\r\n */\r\n@SeModule({\r\n\timports: [\r\n\t\t'yjqueryModule',\r\n\t\t'yLoDashModule',\r\n\t\t'ngSanitize'\r\n\t],\r\n\tproviders: [\r\n\t\tCloneableUtils,\r\n\t\tUrlUtils,\r\n\t\tCryptographicUtils,\r\n\t\tFunctionsUtils,\r\n\t\tStringUtils,\r\n\t\tWindowUtils,\r\n\t\tDiscardablePromiseUtils,\r\n\t\t{\r\n\t\t\tprovide: \"ParseError\",\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(value: any) {\r\n\t\t\t\t\tthis.value = value;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.getResourcePath\r\n\t\t * \r\n\t\t * @description\r\n\t\t * makes url absolute (with provided domain) if not yet\r\n\t\t * \r\n\t\t * @param {String} domain the domain with witch to prepend the url if not absolute\r\n\t\t * @param {String} url the url to tests\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: \"getAbsoluteURL\",\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn (domain: string, url: string) => {\r\n\t\t\t\t\t// url regex\r\n\t\t\t\t\t// scheme:[//[user[:password]@]host[:port]][/path][?query][#fragment]\r\n\t\t\t\t\tconst re = new RegExp(\r\n\t\t\t\t\t\t\"([a-zA-Z0-9]+://)\" + // scheme\r\n\t\t\t\t\t\t\"([a-zA-Z0-9_]+:[a-zA-Z0-9_]+@)?\" + // user:password\r\n\t\t\t\t\t\t\"([a-zA-Z0-9.-]+)\" + // hostname\r\n\t\t\t\t\t\t\"|([0-9]+\\\\.[0-9]+\\\\.[0-9]+\\\\.[0-9]+)\" + // or ip\r\n\t\t\t\t\t\t\"(:[0-9]+)?\" + // port\r\n\t\t\t\t\t\t\"(/.*)?\" // everything else\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (re.exec(url)) {\r\n\t\t\t\t\t\treturn url;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn domain + url;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.getOrigin\r\n\t\t * \r\n\t\t * @description\r\n\t\t * returns document location origin\r\n\t\t * Some browsers still do not support W3C document.location.origin, this function caters for gap.\r\n\t\t * \r\n\t\t * @param {String =} url optional any url\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'getOrigin',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn (url: string) => {\r\n\t\t\t\t\tif (url) {\r\n\t\t\t\t\t\tlet link = document.createElement('a');\r\n\t\t\t\t\t\tlink.setAttribute('href', url);\r\n\t\t\t\t\t\tconst origin = link.protocol + \"//\" + link.hostname + (link.port ? ':' + link.port : '');\r\n\t\t\t\t\t\tlink = null; // GC\r\n\t\t\t\t\t\treturn origin;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.isBlank\r\n\t\t * \r\n\t\t * @description\r\n\t\t * <b>isBlank</b> will check if a given string is undefined or null or empty.\r\n\t\t * - returns TRUE for undefined / null/ empty string\r\n\t\t * - returns FALSE otherwise\r\n\t\t * \r\n\t\t * @param {String} inputString any input string.\r\n\t\t * \r\n\t\t * @returns {boolean} true if the string is null else false\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'isBlank',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn (value: string) => {\r\n\t\t\t\t\treturn (typeof value === 'undefined' || value === null || value === \"null\" || value.toString().trim().length === 0);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.extend\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>extend</b> provides a convenience to either default a new child or \"extend\" an existing child with the prototype of the parent\r\n\t\t *\r\n\t\t * @param {Class} ParentClass which has a prototype you wish to extend.\r\n\t\t * @param {Class} ChildClass will have its prototype set.\r\n\t\t *\r\n\t\t * @returns {Class} ChildClass which has been extended\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'extend',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn (ParentClass: SeFactory, ChildClass?: SeFactory) => {\r\n\t\t\t\t\tif (!ChildClass) {\r\n\t\t\t\t\t\t// tslint:disable-next-line:no-empty\r\n\t\t\t\t\t\tChildClass = function() {};\r\n\t\t\t\t\t}\r\n\t\t\t\t\tChildClass.prototype = Object.create(ParentClass.prototype);\r\n\t\t\t\t\treturn ChildClass;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @deprecated since 6.6, use {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind bind} instead\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.hitch\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>hitch</b> will create a new function that will pass our desired context (scope) to the given function.\r\n\t\t * This method will also pre-bind the given parameters.\r\n\t\t *\r\n\t\t * @param {Object} scope scope that is to be assigned.\r\n\t\t * @param {Function} method the method that needs binding.\r\n\t\t *\r\n\t\t * @returns {Function} a new function thats binded to the given scope\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'hitch',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(scope: any, method: any) {\r\n\r\n\t\t\t\t\tconst argumentArray = Array.prototype.slice.call(arguments); // arguments is not an array\r\n\t\t\t\t\t// (from  http://www.sitepoint.com/arguments-a-javascript-oddity/)\r\n\r\n\t\t\t\t\tconst preboundArguments = argumentArray.slice(2);\r\n\r\n\t\t\t\t\treturn function lockedMethod() {\r\n\r\n\t\t\t\t\t\t// from here, \"arguments\" are the arguments passed to lockedMethod\r\n\r\n\t\t\t\t\t\tconst postBoundArguments = Array.prototype.slice.call(arguments);\r\n\r\n\t\t\t\t\t\treturn method.apply(scope, preboundArguments.concat(postBoundArguments));\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.customTimeout\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>customTimeout</b> will call the javascrit's native setTimeout method to execute a given function after a specified period of time.\r\n\t\t * This method is better than using $timeout since it is difficult to assert on $timeout during end-to-end testing.\r\n\t\t *\r\n\t\t * @param {Function} func function that needs to be executed after the specified duration.\r\n\t\t * @param {Number} duration time in milliseconds.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'customTimeout',\r\n\t\t\tuseFactory: ($rootScope: angular.IRootScopeService) => {\r\n\t\t\t\treturn (func: SeFactory, duration: number) => {\r\n\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\tfunc();\r\n\t\t\t\t\t\t$rootScope.$digest();\r\n\t\t\t\t\t}, duration);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['$rootScope']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.copy\r\n\t\t * \r\n\t\t * @description\r\n\t\t * <b>copy</b> will do a deep copy of the given input object.\r\n\t\t * \r\n\t\t * @param {Object} candidate the javaScript value that needs to be deep copied.\r\n\t\t * \r\n\t\t * @returns {Object} A deep copy of the input\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'copy',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn (candidate: JSON) => {\r\n\t\t\t\t\treturn JSON.parse(JSON.stringify(candidate));\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.merge\r\n\t\t * \r\n\t\t * @description\r\n\t\t * <b>merge</b> will merge the contents of two objects together into the first object.\r\n\t\t * \r\n\t\t * @param {Object} target any JavaScript object.\r\n\t\t * @param {Object} source any JavaScript object.\r\n\t\t * \r\n\t\t * @returns {Object} a new object as a result of merge\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'merge',\r\n\t\t\tuseFactory: (yjQuery: any) => {\r\n\t\t\t\treturn (source: any, target: any) => {\r\n\r\n\t\t\t\t\tyjQuery.extend(source, target);\r\n\r\n\t\t\t\t\treturn source;\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['yjQuery']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.getQueryString\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>getQueryString</b> will convert a given object into a query string.\r\n\t\t *\r\n\t\t * Below is the code snippet for sample input and sample output:\r\n\t\t *\r\n\t\t * <pre>\r\n\t\t * var params = {\r\n\t\t *  key1 : 'value1',\r\n\t\t *  key2 : 'value2',\r\n\t\t *  key3 : 'value3'\r\n\t\t *  }\r\n\t\t *\r\n\t\t *  var output = getQueryString(params);\r\n\t\t *\r\n\t\t *  // The output is '?&key1=value1&key2=value2&key3=value3'\r\n\t\t *\r\n\t\t * </pre>\r\n\t\t *\r\n\t\t * @param {Object} params Object containing a list of params.\r\n\t\t *\r\n\t\t * @returns {String} a query string\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'getQueryString',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn (params: TypedMap<string>) => {\r\n\r\n\t\t\t\t\tlet queryString = \"\";\r\n\t\t\t\t\tif (params) {\r\n\t\t\t\t\t\tfor (const param in params) {\r\n\t\t\t\t\t\t\tif (params.hasOwnProperty(param)) {\r\n\t\t\t\t\t\t\t\tqueryString += '&' + param + \"=\" + params[param];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn \"?\" + queryString;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.getURI\r\n\t\t *\r\n\t\t * @description\r\n\t\t * Will return the URI part of a URL\r\n\t\t * @param {String} url the URL the URI of which is to be returned\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'getURI',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(url: string) {\r\n\t\t\t\t\treturn url && url.indexOf(\"?\") > -1 ? url.split(\"?\")[0] : url;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.parseQuery\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>parseQuery</b> will convert a given query string to an object.\r\n\t\t *\r\n\t\t * Below is the code snippet for sample input and sample output:\r\n\t\t *\r\n\t\t * <pre>\r\n\t\t * var query = '?key1=value1&key2=value2&key3=value3';\r\n\t\t *\r\n\t\t * var output = parseQuery(query);\r\n\t\t *\r\n\t\t * // The output is { key1 : 'value1', key2 : 'value2', key3 : 'value3' }\r\n\t\t *\r\n\t\t * </pre>\r\n\t\t *\r\n\t\t * @param {String} query String that needs to be parsed.\r\n\t\t *\r\n\t\t * @returns {Object} an object containing all params of the given query\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'parseQuery',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn (str: any) => {\r\n\r\n\t\t\t\t\tconst objURL = {} as any;\r\n\r\n\t\t\t\t\tstr.replace(new RegExp(\"([^?=&]+)(=([^&]*))?\", \"g\"), function($0: any, $1: any, $2: any, $3: any) {\r\n\t\t\t\t\t\tobjURL[$1] = $3;\r\n\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn objURL;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.trim\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>trim</b> will remove spaces at the beginning and end of a given string.\r\n\t\t *\r\n\t\t * @param {String} inputString any input string.\r\n\t\t *\r\n\t\t * @returns {String} the newly modified string without spaces at the beginning and the end\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'trim',\r\n\t\t\tuseFactory: () => {\r\n\r\n\t\t\t\treturn function(aString: string) {\r\n\t\t\t\t\tconst regExpBeginning = /^\\s+/;\r\n\t\t\t\t\tconst regExpEnd = /\\s+$/;\r\n\t\t\t\t\treturn aString.replace(regExpBeginning, \"\").replace(regExpEnd, \"\");\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.convertToArray\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>convertToArray</b> will convert the given object to array.\r\n\t\t * The output array elements are an object that has a key and value,\r\n\t\t * where key is the original key and value is the original object.\r\n\t\t *\r\n\t\t * @param {Object} inputObject any input object.\r\n\t\t *\r\n\t\t * @returns {Array} the array created from the input object\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'convertToArray',\r\n\t\t\tuseFactory: () => {\r\n\r\n\t\t\t\treturn (object: any) => {\r\n\t\t\t\t\tconst configuration = [];\r\n\t\t\t\t\tfor (const key in object) {\r\n\t\t\t\t\t\tif (key.indexOf('$') !== 0 && key.indexOf('toJSON') !== 0) {\r\n\t\t\t\t\t\t\tconfiguration.push({\r\n\t\t\t\t\t\t\t\tkey,\r\n\t\t\t\t\t\t\t\tvalue: object[key]\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn configuration;\r\n\t\t\t\t};\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.injectJS\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>injectJS</b> will inject script tags into html for a given set of sources.\r\n\t\t *\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'injectJS',\r\n\t\t\tuseFactory: () => {\r\n\r\n\t\t\t\tfunction getInjector() {\r\n\t\t\t\t\treturn $script;\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn {\r\n\t\t\t\t\tgetInjector,\r\n\t\t\t\t\texecute(conf: {srcs: string[], callback: SeFactory, index?: number}) {\r\n\t\t\t\t\t\tconst srcs = conf.srcs;\r\n\t\t\t\t\t\tlet index = conf.index;\r\n\t\t\t\t\t\tconst callback = conf.callback;\r\n\t\t\t\t\t\tif (!srcs.length) {\r\n\t\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (index === undefined) {\r\n\t\t\t\t\t\t\tindex = 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (srcs[index] !== undefined) {\r\n\t\t\t\t\t\t\tthis.getInjector()(srcs[index], () => {\r\n\t\t\t\t\t\t\t\tif (index + 1 < srcs.length) {\r\n\t\t\t\t\t\t\t\t\tthis.execute({\r\n\t\t\t\t\t\t\t\t\t\tsrcs,\r\n\t\t\t\t\t\t\t\t\t\tindex: index + 1,\r\n\t\t\t\t\t\t\t\t\t\tcallback\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else if (typeof callback === 'function') {\r\n\t\t\t\t\t\t\t\t\tcallback();\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.uniqueArray\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>uniqueArray</b> will return the first Array argument supplemented with new entries from the second Array argument.\r\n\t\t *\r\n\t\t * @param {Array} array1 any JavaScript array.\r\n\t\t * @param {Array} array2 any JavaScript array.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'uniqueArray',\r\n\t\t\tuseFactory: () => {\r\n\r\n\t\t\t\treturn (array1: any[], array2: any[]) => {\r\n\r\n\t\t\t\t\tarray2.forEach(function(instance: any) {\r\n\t\t\t\t\t\tif (array1.indexOf(instance) === -1) {\r\n\t\t\t\t\t\t\tarray1.push(instance);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\treturn array1;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.regExpFactory\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>regExpFactory</b> will convert a given pattern into a regular expression.\r\n\t\t * This method will prepend and append a string with ^ and $ respectively replaces\r\n\t\t * and wildcards (*) by proper regex wildcards.\r\n\t\t *\r\n\t\t * @param {String} pattern any string that needs to be converted to a regular expression.\r\n\t\t *\r\n\t\t * @returns {RegExp} a regular expression generated from the given string.\r\n\t\t * \r\n\t\t * @deprecated since 1811, use {@link functionsModule.service:StringUtils#regExpFactory StringUtils#regExpFactory}\r\n\t\t *\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'regExpFactory',\r\n\t\t\tuseFactory: (stringUtils: StringUtils) => {\r\n\t\t\t\treturn stringUtils.regExpFactory;\r\n\t\t\t},\r\n\t\t\tdeps: ['stringUtils']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.generateIdentifier\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>generateIdentifier</b> will generate a unique string based on system time and a random generator.\r\n\t\t *\r\n\t\t * @returns {String} a unique identifier.\r\n\t\t *\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'generateIdentifier',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn () => {\r\n\t\t\t\t\tlet d = new Date().getTime();\r\n\t\t\t\t\tif (window.performance && typeof window.performance.now === \"function\") {\r\n\t\t\t\t\t\td += window.performance.now(); // use high-precision timer if available\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\r\n\t\t\t\t\t\tconst r = (d + Math.random() * 16) % 16 | 0;\r\n\t\t\t\t\t\td = Math.floor(d / 16);\r\n\t\t\t\t\t\treturn (c === 'x' ? r : (r & 0x3 | 0x8)).toString(16);\r\n\t\t\t\t\t});\r\n\t\t\t\t\treturn uuid;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.escapeHtml\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>escapeHtml</b> will escape &, <, >, \" and ' characters .\r\n\t\t *\r\n\t\t * @param {String} a string that needs to be escaped.\r\n\t\t *\r\n\t\t * @returns {String} the escaped string.\r\n\t\t *\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'escapeHtml',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn (str: string) => {\r\n\t\t\t\t\tif (typeof str === 'string') {\r\n\t\t\t\t\t\treturn str.replace(/&/g, '&amp;')\r\n\t\t\t\t\t\t\t.replace(/>/g, '&gt;')\r\n\t\t\t\t\t\t\t.replace(/</g, '&lt;')\r\n\t\t\t\t\t\t\t.replace(/\"/g, '&quot;')\r\n\t\t\t\t\t\t\t.replace(/'/g, '&apos;');\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\treturn str;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.sanitize\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>escapes any harmful scripting from a string, leaves innocuous HTML untouched/b>\r\n\t\t *\r\n\t\t * @param {String} a string that needs to be sanitized.\r\n\t\t *\r\n\t\t * @returns {String} the sanitized string.\r\n\t\t *\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'sanitize',\r\n\t\t\tuseFactory: (isBlank: any) => {\r\n\t\t\t\treturn function(str: string) {\r\n\t\t\t\t\t/* The correct solution for this is to use Negative Lookbehind Regex expression which is available as part of ES2018. // str.replace(/(?:(?<!\\\\)([()]))/g, '\\\\$1')\r\n\t\t\t\t\tBut in order to support cross browser compatibility, the string is reversed and negative lookahead is used instead. */\r\n\t\t\t\t\treturn !isBlank(str) ? str.split('').reverse().join('').replace(/(?:(([()])(?!\\\\)))/g, '$1\\\\').split('').reverse().join('') : str;\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['isBlank']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.sanitizeHTML\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>sanitizeHTML</b> will remove breaks and space .\r\n\t\t *\r\n\t\t * @param {String} a string that needs to be escaped.\r\n\t\t *\r\n\t\t * @returns {String} the sanitized HTML.\r\n\t\t *\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'sanitizeHTML',\r\n\t\t\tuseFactory: (isBlank: any) => {\r\n\t\t\t\treturn function(obj: any) {\r\n\t\t\t\t\tlet result = angular.copy(obj);\r\n\t\t\t\t\tif (!isBlank(result)) {\r\n\t\t\t\t\t\tresult = result.replace(/(\\r\\n|\\n|\\r)/gm, '').replace(/>\\s+</g, '><').replace(/<\\/br\\>/g, '');\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn result;\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['isBlank']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.toPromise\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>toPromise</> transforms a function into a function that is guaranteed to return a Promise that resolves to the\r\n\t\t * original return value of the function, rejects with the rejected return value and rejects with an exception object when the invocation fails\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'toPromise',\r\n\t\t\tuseFactory: ($q: angular.IQService, $log: angular.ILogService) => {\r\n\t\t\t\treturn (method: any, context: any) => {\r\n\t\t\t\t\treturn function() {\r\n\t\t\t\t\t\ttry {\r\n\t\t\t\t\t\t\treturn $q.when(method.apply(context, arguments));\r\n\t\t\t\t\t\t} catch (e) {\r\n\t\t\t\t\t\t\t$log.error('execution of a method that was turned into a promise failed');\r\n\t\t\t\t\t\t\t$log.error(e);\r\n\t\t\t\t\t\t\treturn $q.reject(e);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['$q', '$log']\r\n\t\t},\r\n\t\t/**\r\n\t\t * Checks if `value` is a function.\r\n\t\t *\r\n\t\t * @static\r\n\t\t * @category Objects\r\n\t\t * @param {*} value The value to check.\r\n\t\t * @returns {boolean} Returns `true` if the `value` is a function, else `false`.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'isFunction',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn (value: any) => {\r\n\t\t\t\t\treturn typeof value === 'function';\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t// check if the value is the ECMAScript language type of Object\r\n\t\t{\r\n\t\t\tprovide: 'isObject',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\t/** Used to determine if values are of the language type Object */\r\n\t\t\t\tconst objectTypes = {\r\n\t\t\t\t\tboolean: false,\r\n\t\t\t\t\tfunction: true,\r\n\t\t\t\t\tobject: true,\r\n\t\t\t\t\tnumber: false,\r\n\t\t\t\t\tstring: false,\r\n\t\t\t\t\tundefined: false\r\n\t\t\t\t} as any;\r\n\t\t\t\treturn (value: any) => {\r\n\t\t\t\t\treturn !!(value && objectTypes[typeof value]);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tprovide: 'debounce',\r\n\t\t\tuseFactory: (isFunction: any, isObject: any) => {\r\n\t\t\t\t// tslint:disable-next-line\r\n\t\t\t\tclass TypeError {\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t\treturn function(func: any, wait: any, options: any) {\r\n\t\t\t\t\tlet args: any;\r\n\t\t\t\t\tlet maxTimeoutId: any;\r\n\t\t\t\t\tlet result: any;\r\n\t\t\t\t\tlet stamp: any;\r\n\t\t\t\t\tlet thisArg: any;\r\n\t\t\t\t\tlet timeoutId: any;\r\n\t\t\t\t\tlet trailingCall: any;\r\n\t\t\t\t\tlet leading: any;\r\n\t\t\t\t\tlet lastCalled = 0;\r\n\t\t\t\t\tlet maxWait: any = false;\r\n\t\t\t\t\tlet trailing = true;\r\n\t\t\t\t\tlet isCalled: any;\r\n\r\n\t\t\t\t\tif (!isFunction(func)) {\r\n\t\t\t\t\t\tthrow new TypeError();\r\n\t\t\t\t\t}\r\n\t\t\t\t\twait = Math.max(0, wait) || 0;\r\n\t\t\t\t\tif (options === true) {\r\n\t\t\t\t\t\tleading = true;\r\n\t\t\t\t\t\ttrailing = false;\r\n\t\t\t\t\t} else if (isObject(options)) {\r\n\t\t\t\t\t\tleading = options.leading;\r\n\t\t\t\t\t\tmaxWait = 'maxWait' in options && (Math.max(wait, options.maxWait) || 0);\r\n\t\t\t\t\t\ttrailing = 'trailing' in options ? options.trailing : trailing;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst delayed = function() {\r\n\t\t\t\t\t\tconst remaining = wait - (Date.now() - stamp);\r\n\t\t\t\t\t\tif (remaining <= 0) {\r\n\t\t\t\t\t\t\tif (maxTimeoutId) {\r\n\t\t\t\t\t\t\t\tclearTimeout(maxTimeoutId);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tisCalled = trailingCall;\r\n\t\t\t\t\t\t\tmaxTimeoutId = timeoutId = trailingCall = undefined;\r\n\t\t\t\t\t\t\tif (isCalled) {\r\n\t\t\t\t\t\t\t\tlastCalled = Date.now();\r\n\t\t\t\t\t\t\t\tresult = func.apply(thisArg, args);\r\n\t\t\t\t\t\t\t\tif (!timeoutId && !maxTimeoutId) {\r\n\t\t\t\t\t\t\t\t\targs = thisArg = null;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\ttimeoutId = setTimeout(delayed, remaining);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tconst maxDelayed = function() {\r\n\t\t\t\t\t\tif (timeoutId) {\r\n\t\t\t\t\t\t\tclearTimeout(timeoutId);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tmaxTimeoutId = timeoutId = trailingCall = undefined;\r\n\t\t\t\t\t\tif (trailing || (maxWait !== wait)) {\r\n\t\t\t\t\t\t\tlastCalled = Date.now();\r\n\t\t\t\t\t\t\tresult = func.apply(thisArg, args);\r\n\t\t\t\t\t\t\tif (!timeoutId && !maxTimeoutId) {\r\n\t\t\t\t\t\t\t\targs = thisArg = null;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\treturn function() {\r\n\t\t\t\t\t\targs = arguments;\r\n\t\t\t\t\t\tstamp = Date.now();\r\n\t\t\t\t\t\tthisArg = this;\r\n\t\t\t\t\t\ttrailingCall = trailing && (timeoutId || !leading);\r\n\t\t\t\t\t\tlet leadingCall;\r\n\r\n\t\t\t\t\t\tif (maxWait === false) {\r\n\t\t\t\t\t\t\tleadingCall = leading && !timeoutId;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tif (!maxTimeoutId && !leading) {\r\n\t\t\t\t\t\t\t\tlastCalled = stamp;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconst remaining = maxWait - (stamp - lastCalled);\r\n\t\t\t\t\t\t\tisCalled = remaining <= 0;\r\n\r\n\t\t\t\t\t\t\tif (isCalled) {\r\n\t\t\t\t\t\t\t\tif (maxTimeoutId) {\r\n\t\t\t\t\t\t\t\t\tmaxTimeoutId = clearTimeout(maxTimeoutId);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\tlastCalled = stamp;\r\n\t\t\t\t\t\t\t\tresult = func.apply(thisArg, args);\r\n\t\t\t\t\t\t\t} else if (!maxTimeoutId) {\r\n\t\t\t\t\t\t\t\tmaxTimeoutId = setTimeout(maxDelayed, remaining);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isCalled && timeoutId) {\r\n\t\t\t\t\t\t\ttimeoutId = clearTimeout(timeoutId);\r\n\t\t\t\t\t\t} else if (!timeoutId && wait !== maxWait) {\r\n\t\t\t\t\t\t\ttimeoutId = setTimeout(delayed, wait);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (leadingCall) {\r\n\t\t\t\t\t\t\tisCalled = true;\r\n\t\t\t\t\t\t\tresult = func.apply(thisArg, args);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (isCalled && !timeoutId && !maxTimeoutId) {\r\n\t\t\t\t\t\t\targs = thisArg = null;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['isFunction', 'isObject']\r\n\t\t},\r\n\t\t{\r\n\t\t\tprovide: 'throttle',\r\n\t\t\tuseFactory: (debounce: any, isFunction: any, isObject: any) => {\r\n\t\t\t\treturn function(func: any, wait: any, options: any) {\r\n\t\t\t\t\tlet leading = true;\r\n\t\t\t\t\tlet trailing = true;\r\n\r\n\t\t\t\t\tif (!isFunction(func)) {\r\n\t\t\t\t\t\tthrow new TypeError();\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (options === false) {\r\n\t\t\t\t\t\tleading = false;\r\n\t\t\t\t\t} else if (isObject(options)) {\r\n\t\t\t\t\t\tleading = 'leading' in options ? options.leading : leading;\r\n\t\t\t\t\t\ttrailing = 'trailing' in options ? options.trailing : trailing;\r\n\t\t\t\t\t}\r\n\t\t\t\t\toptions = {};\r\n\t\t\t\t\toptions.leading = leading;\r\n\t\t\t\t\toptions.maxWait = wait;\r\n\t\t\t\t\toptions.trailing = trailing;\r\n\r\n\t\t\t\t\treturn debounce(func, wait, options);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['debounce', 'isFunction', 'isObject']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.parseHTML\r\n\t\t *\r\n\t\t * @description\r\n\t\t * parses a string HTML into a queriable DOM object, stripping any JavaScript from the HTML.\r\n\t\t *\r\n\t\t * @param {String} stringHTML, the string representation of the HTML to parse\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'parseHTML',\r\n\t\t\tuseFactory: (yjQuery: any) => {\r\n\t\t\t\treturn function(stringHTML: any) {\r\n\t\t\t\t\treturn yjQuery.parseHTML(stringHTML);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['yjQuery']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.unsafeParseHTML\r\n\t\t *\r\n\t\t * @description\r\n\t\t * parses a string HTML into a queriable DOM object, preserving any JavaScript present in the HTML.\r\n\t\t * Note - as this preserves the JavaScript present it must only be used on HTML strings originating\r\n\t\t * from a known safe location. Failure to do so may result in an XSS vulnerability.\r\n\t\t *\r\n\t\t * @param {String} stringHTML, the string representation of the HTML to parse\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'unsafeParseHTML',\r\n\t\t\tuseFactory: (yjQuery: any) => {\r\n\t\t\t\treturn function(stringHTML: any) {\r\n\t\t\t\t\treturn yjQuery.parseHTML(stringHTML, null, true);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['yjQuery']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.extractFromElement\r\n\t\t *\r\n\t\t * @description\r\n\t\t * parses a string HTML into a queriable DOM object\r\n\t\t *\r\n\t\t * @param {Object} parent, the DOM element from which we want to extract matching selectors\r\n\t\t * @param {String} extractionSelector, the yjQuery selector identifying the elements to be extracted\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'extractFromElement',\r\n\t\t\tuseFactory: (yjQuery: any) => {\r\n\t\t\t\treturn function(parent: any, extractionSelector: any) {\r\n\t\t\t\t\tparent = yjQuery(parent);\r\n\t\t\t\t\treturn parent.filter(extractionSelector).add(parent.find(extractionSelector));\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['yjQuery']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.closeOpenModalsOnBrowserBack\r\n\t\t *\r\n\t\t * @description\r\n\t\t * close any open modal window when a user clicks browser back button\r\n\t\t *\r\n\t\t * @param {Object} modalStack, the $modalStack service of angular-ui.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'closeOpenModalsOnBrowserBack',\r\n\t\t\tuseFactory: ($uibModalStack: any) => {\r\n\t\t\t\treturn function() {\r\n\t\t\t\t\tif ($uibModalStack.getTop()) {\r\n\t\t\t\t\t\t$uibModalStack.dismissAll();\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['$uibModalStack']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:URIBuilder\r\n\t\t *\r\n\t\t * @description\r\n\t\t * builder or URIs, build() method must be invoked to actually retrieve a URI\r\n\t\t *\r\n\t\t * @param {Object} modalStack, the $modalStack service of angular-ui.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'URIBuilder',\r\n\t\t\tuseFactory(lodash: lo.LoDashStatic) {\r\n\t\t\t\treturn function URIBuilder(uri: string) {\r\n\r\n\t\t\t\t\tthis.uri = uri;\r\n\r\n\t\t\t\t\tthis.build = function() {\r\n\t\t\t\t\t\treturn this.uri;\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\t/**\r\n\t\t\t\t\t * @ngdoc method\r\n\t\t\t\t\t * @name functionsModule.service:URIBuilder#replaceParams\r\n\t\t\t\t\t * @methodOf functionsModule.service:URIBuilder\r\n\t\t\t\t\t *\r\n\t\t\t\t\t * @description\r\n\t\t\t\t\t * Substitute all placeholders in the URI with the matching values in the given params\r\n\t\t\t\t\t *\r\n\t\t\t\t\t * @param {Object} params a map of placeholder names / values\r\n\t\t\t\t\t */\r\n\t\t\t\t\tthis.replaceParams = function(params: TypedMap<string>) {\r\n\t\t\t\t\t\tconst clone = lodash.cloneDeep(this);\r\n\t\t\t\t\t\tif (params) {\r\n\t\t\t\t\t\t\t// order the keys by descending length\r\n\t\t\t\t\t\t\tconst keys = Object.keys(params).sort(function(a, b) {\r\n\t\t\t\t\t\t\t\treturn b.length - a.length;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tkeys.forEach(function(key) {\r\n\t\t\t\t\t\t\t\tconst re = new RegExp('\\\\b' + key + '\\\\b');\r\n\t\t\t\t\t\t\t\tclone.uri = clone.uri.replace(':' + key, params[key]).replace(re, params[key]);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn clone;\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: [\"lodash\"]\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:getDataFromResponse\r\n\t\t *\r\n\t\t * @description\r\n\t\t * when provided with a response returned from a backend call, will filter the response\r\n\t\t * to retrieve the data of interest.\r\n\t\t *\r\n\t\t * @param {Object} response, response returned from a backend call.\r\n\t\t * @returns {Array} Returns the array from the response.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'getDataFromResponse',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(response: any) {\r\n\t\t\t\t\tconst dataKey = Object.keys(response).filter(function(key) {\r\n\t\t\t\t\t\treturn response[key] instanceof Array;\r\n\t\t\t\t\t})[0];\r\n\r\n\t\t\t\t\treturn response[dataKey];\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:getKeyHoldingDataFromResponse\r\n\t\t *\r\n\t\t * @description\r\n\t\t * when provided with a response returned from a backend call, will filter the response\r\n\t\t * to retrieve the key holding the data of interest.\r\n\t\t *\r\n\t\t * @param {Object} response, response returned from a backend call.\r\n\t\t * @returns {String} Returns the name of the key holding the array from the response.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'getKeyHoldingDataFromResponse',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(response: any) {\r\n\t\t\t\t\tconst dataKey = Object.keys(response).filter(function(key) {\r\n\t\t\t\t\t\treturn response[key] instanceof Array;\r\n\t\t\t\t\t})[0];\r\n\r\n\t\t\t\t\treturn dataKey;\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:resetObject\r\n\t\t *\r\n\t\t * @description\r\n\t\t * Resets a given object's properties' values\r\n\t\t *\r\n\t\t * @param {Object} targetObject, the object to reset\r\n\t\t * @param {Object} modelObject, an object that contains the structure that targetObject should have after a reset\r\n\t\t * @returns {Object} Returns the object that has been reset\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'resetObject',\r\n\t\t\tuseFactory: (copy: any) => {\r\n\t\t\t\treturn function(targetObject: any, modelObject: any) {\r\n\t\t\t\t\tif (!targetObject) {\r\n\t\t\t\t\t\ttargetObject = copy(modelObject);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tfor (const i in targetObject) {\r\n\t\t\t\t\t\t\tif (targetObject.hasOwnProperty(i)) {\r\n\t\t\t\t\t\t\t\tdelete targetObject[i];\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tangular.extend(targetObject, copy(modelObject));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\treturn targetObject;\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['copy']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:isFunctionEmpty\r\n\t\t *\r\n\t\t * @description\r\n\t\t * Will determine whether a function body is empty or should be considered empty for proxying purposes\r\n\t\t * @deprecated since 1808, use {@link functionsModule.service:FunctionsUtils#isEmpty FunctionsUtils#isEmpty}\r\n\t\t * @param {Function} fn, the function to evaluate\r\n\t\t * @returns {Boolean} a boolean.\r\n\t\t * @deprecated since 1808, use {@link functionsModule.service:FunctionsUtils#isEmpty FunctionsUtils#isEmpty}\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'isFunctionEmpty',\r\n\t\t\tuseFactory: (functionsUtils: any) => {\r\n\t\t\t\treturn function(fn: any) {\r\n\t\t\t\t\treturn functionsUtils.isEmpty(fn);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['functionsUtils']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:isObjectEmptyDeep\r\n\t\t *\r\n\t\t * @description\r\n\t\t * Will check if the object is empty and will return true if each and every property of the object is empty\r\n\t\t *\r\n\t\t * @param {Object} value, the value to evaluate\r\n\t\t * @returns {Boolean} a boolean.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'isObjectEmptyDeep',\r\n\t\t\tuseFactory: (lodash: lo.LoDashStatic) => {\r\n\t\t\t\treturn function(value: any) {\r\n\t\t\t\t\tif (lodash.isObject(value)) {\r\n\t\t\t\t\t\tfor (const key in value) {\r\n\t\t\t\t\t\t\tif (value.hasOwnProperty(key)) {\r\n\t\t\t\t\t\t\t\tif (!lodash.isEmpty(value[key])) {\r\n\t\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn true;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn lodash.isString(value) ? lodash.isEmpty(value) : lodash.isNil(value);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['lodash']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:isAllTruthy\r\n\t\t *\r\n\t\t * @description\r\n\t\t * Iterate on the given array of Functions, return true if each function returns true\r\n\t\t *\r\n\t\t * @param {Array} arguments the functions\r\n\t\t *\r\n\t\t * @return {Boolean} true if every function returns true\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'isAllTruthy',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function() {\r\n\t\t\t\t\tconst fns = Array.prototype.slice.call(arguments);\r\n\t\t\t\t\treturn function() {\r\n\t\t\t\t\t\tconst args = arguments;\r\n\t\t\t\t\t\treturn fns.every(function(f: any) {\r\n\t\t\t\t\t\t\treturn f.apply(f, args);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:isAnyTruthy\r\n\t\t *\r\n\t\t * @description\r\n\t\t * Iterate on the given array of Functions, return true if at least one function returns true\r\n\t\t *\r\n\t\t * @param {Array} arguments the functions\r\n\t\t *\r\n\t\t * @return {Boolean} true if at least one function returns true\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'isAnyTruthy',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function() {\r\n\t\t\t\t\tconst fns = Array.prototype.slice.call(arguments);\r\n\t\t\t\t\treturn function() {\r\n\t\t\t\t\t\tconst args = arguments;\r\n\t\t\t\t\t\treturn fns.some(function(f: any) {\r\n\t\t\t\t\t\t\treturn f.apply(f, args);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:formatDateAsUtc\r\n\t\t *\r\n\t\t * @description\r\n\t\t * Formats provided dateTime as utc.\r\n\t\t *\r\n\t\t * @param {Object|String} dateTime DateTime to format in utc.\r\n\t\t *\r\n\t\t * @return {String} formatted string.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'formatDateAsUtc',\r\n\t\t\tuseFactory: (DATE_CONSTANTS: any) => {\r\n\t\t\t\treturn function(dateTime: any) {\r\n\t\t\t\t\treturn moment(dateTime).utc().format(DATE_CONSTANTS.MOMENT_ISO);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['DATE_CONSTANTS']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.getEncodedString\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>getEncodedString</b> will creates a base-64 encoded ASCII string\r\n\t\t * from the String passed as input\r\n\t\t *\r\n\t\t * @returns {String} a base-64 encoded ASCII string.\r\n\t\t *\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'getEncodedString',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(passedString: any) {\r\n\t\t\t\t\tif (typeof passedString === \"string\") {\r\n\t\t\t\t\t\treturn btoa(passedString);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthrow new Error('getEncodedString called with input of type \"' + typeof passedString + '\" when only \"string\" is accepted.');\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.encode\r\n\t\t *\r\n\t\t * @description\r\n\t\t * will return a encoded value for any JSON object passed as argument\r\n\t\t * @param {object} JSON object to be encoded\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'encode',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(object: any) {\r\n\t\t\t\t\t/* first we use encodeURIComponent to get percent-encoded UTF-8,\r\n\t\t\t\t\t * then we convert the percent encodings into raw bytes which\r\n\t\t\t\t\t * can be fed into btoa.\r\n\t\t\t\t\t * from https://developer.mozilla.org/en-US/docs/Web/API/WindowBase64/Base64_encoding_and_decoding\r\n\t\t\t\t\t */\r\n\t\t\t\t\treturn btoa(encodeURIComponent(JSON.stringify(object)).replace(/%([0-9A-F]{2})/g,\r\n\t\t\t\t\t\tfunction toSolidBytes(match: any, p1: string) {\r\n\t\t\t\t\t\t\t// return String.fromCharCode('0x' + p1);\r\n\t\t\t\t\t\t\treturn String.fromCharCode(parseInt(p1, 16));\r\n\t\t\t\t\t\t}));\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.service:compareHTMLElementsPosition\r\n\t\t *\r\n\t\t * @description\r\n\t\t * A function to sort an array containing DOM elements according to their position in the DOM\r\n\t\t *\r\n\t\t * @param {key =} key Optional key value to get the\r\n\t\t *\r\n\t\t * @return {Function} the compare function to use with array.sort(compareFunction) to order DOM elements as they would appear in the DOM\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'compareHTMLElementsPosition',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(key: any) {\r\n\t\t\t\t\treturn function(a: any, b: any) {\r\n\r\n\t\t\t\t\t\tif (key) {\r\n\t\t\t\t\t\t\ta = a[key];\r\n\t\t\t\t\t\t\tb = b[key];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (a === b) {\r\n\t\t\t\t\t\t\treturn 0;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (!a.compareDocumentPosition) {\r\n\t\t\t\t\t\t\t// support for IE8 and below\r\n\t\t\t\t\t\t\treturn a.sourceIndex - b.sourceIndex;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tif (a.compareDocumentPosition(b) & 2) {\r\n\t\t\t\t\t\t\t// Note: CompareDocumentPosition returns the compared value as a bitmask that can take several values. \r\n\t\t\t\t\t\t\t// 2 represents DOCUMENT_POSITION_PRECEDING, which means that b comes before a. \r\n\t\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t};\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.isIframe\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>isIframe</b> will check if the current document is in an iFrame.\r\n\t\t *\r\n\t\t * @returns {boolean} true if the current document is in an iFrame.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'isIframe',\r\n\t\t\tuseFactory: ($window: any) => {\r\n\t\t\t\treturn function() {\r\n\t\t\t\t\treturn $window.top !== $window;\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['$window']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.isPointOverElement\r\n\t\t *\r\n\t\t * @description\r\n\t\t * <b>isPointOverElement</b> will check if the given point is over the htmlElement\r\n\t\t * \r\n\t\t * @param {Object} point point coordinates\r\n\t\t * @param {Number} point.x mouse x position\r\n\t\t * @param {Number} point.y mouse y position\r\n\t\t * @param {HTMLElement} htmlElement htmlElement to test\r\n\t\t *\r\n\t\t * @returns {boolean} true if the given point is over the htmlElement\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'isPointOverElement',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(point: any, htmlElement: any) {\r\n\t\t\t\t\tconst domRect = htmlElement.getBoundingClientRect();\r\n\t\t\t\t\treturn (point.x >= domRect.left && point.x <= domRect.right && point.y >= domRect.top && point.y <= domRect.bottom);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.areIntersecting\r\n\t\t *\r\n\t\t * @description\r\n\t\t * determines whether 2 BoundingClientRect are intersecting even partially\r\n\t\t * \r\n\t\t * @param {Object} boundingClientRect1 size of an element and its position relative to the viewport as per {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect API}\r\n\t\t * @param {Object} boundingClientRect2 size of an element and its position relative to the viewport as per {@link https://developer.mozilla.org/en-US/docs/Web/API/Element/getBoundingClientRect API}\r\n\t\t * @returns {boolean} true if there is a partial or total intersection\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'areIntersecting',\r\n\t\t\tuseFactory: () => {\r\n\t\t\t\treturn function(boundingClientRect1: any, boundingClientRect2: any) {\r\n\t\t\t\t\treturn !(boundingClientRect2.left > (boundingClientRect1.left + boundingClientRect1.width) ||\r\n\t\t\t\t\t\t(boundingClientRect2.left + boundingClientRect2.width) < boundingClientRect1.left ||\r\n\t\t\t\t\t\tboundingClientRect2.top > (boundingClientRect1.top + boundingClientRect1.height) ||\r\n\t\t\t\t\t\t(boundingClientRect2.top + boundingClientRect2.height) < boundingClientRect1.top);\r\n\t\t\t\t};\r\n\t\t\t}\r\n\r\n\t\t},\r\n\r\n\t\t{\r\n\t\t\tprovide: 'EXTENDED_VIEW_PORT_MARGIN',\r\n\t\t\tuseValue: 1000\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.isInExtendedViewPort\r\n\t\t *\r\n\t\t * @description\r\n\t\t * determines whether a DOM element is partially or totally intersecting with the \"extended\" viewPort\r\n\t\t * the \"extended\" viewPort is the real viewPort that extends up and down by a margin, in pixels, given by the overridable constant EXTENDED_VIEW_PORT_MARGIN\r\n\t\t * @param {HtmlElement} element a DOM element\r\n\t\t * @returns {boolean} true if the given element is in the extended view port\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'isInExtendedViewPort',\r\n\t\t\tuseFactory: ($document: any, yjQuery: any, areIntersecting: any, EXTENDED_VIEW_PORT_MARGIN: any) => {\r\n\t\t\t\treturn function(element: any) {\r\n\t\t\t\t\tif (!yjQuery.contains($document[0], element)) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst bounds = yjQuery(element).offset();\r\n\t\t\t\t\tbounds.width = yjQuery(element).outerWidth();\r\n\t\t\t\t\tbounds.height = yjQuery(element).outerHeight();\r\n\r\n\t\t\t\t\tconst doc = document.scrollingElement || document.documentElement;\r\n\r\n\t\t\t\t\treturn areIntersecting({\r\n\t\t\t\t\t\tleft: -EXTENDED_VIEW_PORT_MARGIN + doc.scrollLeft,\r\n\t\t\t\t\t\twidth: window.innerWidth + 2 * EXTENDED_VIEW_PORT_MARGIN,\r\n\t\t\t\t\t\ttop: -EXTENDED_VIEW_PORT_MARGIN + doc.scrollTop,\r\n\t\t\t\t\t\theight: window.innerHeight + 2 * EXTENDED_VIEW_PORT_MARGIN\r\n\t\t\t\t\t}, bounds);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['$document', 'yjQuery', 'areIntersecting', 'EXTENDED_VIEW_PORT_MARGIN']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.deepIterateOverObjectWith\r\n\t\t *\r\n\t\t * @description\r\n\t\t * Iterates over object and allows to modify a value using callback function.\r\n\t\t * @param {Object} obj an object to iterate.\r\n\t\t * @param {Function} callback callback to apply to each object value.\r\n\t\t * @returns {Object} the object with modified values.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'deepIterateOverObjectWith',\r\n\t\t\tuseFactory: (lodash: lo.LoDashStatic) => {\r\n\t\t\t\treturn function deepIterateOverObjectWith(obj: any, callback: any) {\r\n\t\t\t\t\treturn lodash.reduce(obj, (result: any, value: any, key: any) => {\r\n\t\t\t\t\t\tif (lodash.isPlainObject(value)) {\r\n\t\t\t\t\t\t\tresult[key] = deepIterateOverObjectWith(value, callback);\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tresult[key] = callback(value);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\treturn result;\r\n\t\t\t\t\t}, {});\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['lodash']\r\n\t\t},\r\n\t\t/**\r\n\t\t * @ngdoc service\r\n\t\t * @name functionsModule.deepObjectPropertyDiff\r\n\t\t *\r\n\t\t * @description\r\n\t\t * Returns an object that contains list of fields and for each field it has a boolean value \r\n\t\t * which is true when the property was modified, added or removed, false otherwise.\r\n\t\t * @param {Object} object The first object to inspect.\r\n\t\t * @param {Object} source The second object to inspect.\r\n\t\t * @returns {Object} the diff object.\r\n\t\t */\r\n\t\t{\r\n\t\t\tprovide: 'deepObjectPropertyDiff',\r\n\t\t\tuseFactory: (lodash: lo.LoDashStatic, deepIterateOverObjectWith: any) => {\r\n\t\t\t\treturn function(firstObject: any, secondObject: any) {\r\n\t\t\t\t\t// tslint:disable-next-line:no-empty\r\n\t\t\t\t\tfunction CHANGED_PROPERTY() {}\r\n\r\n\t\t\t\t\t// tslint:disable-next-line:no-empty\r\n\t\t\t\t\tfunction NON_CHANGED_PROPERTY() {}\r\n\r\n\t\t\t\t\tconst mergedObj = lodash.mergeWith(lodash.cloneDeep(firstObject), secondObject, function(prValue: any, cpValue: any) {\r\n\t\t\t\t\t\tif (!lodash.isPlainObject(prValue)) {\r\n\t\t\t\t\t\t\treturn !lodash.isEqual(prValue, cpValue) ? CHANGED_PROPERTY : NON_CHANGED_PROPERTY;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t// Note: Previous versions of lodash could work with null, but the latest version of lodash requires \r\n\t\t\t\t\t\t// undefined to be returned. \r\n\t\t\t\t\t\treturn undefined;\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// If the field is not CHANGED_PROPERTY/NON_CHANGED_PROPERTY then it was removed or added.\r\n\t\t\t\t\tconst sanitizedObj = deepIterateOverObjectWith(mergedObj, function(value: any) {\r\n\t\t\t\t\t\tif (value !== CHANGED_PROPERTY && value !== NON_CHANGED_PROPERTY) {\r\n\t\t\t\t\t\t\treturn CHANGED_PROPERTY;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn value;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t// If it's CHANGED_PROPERTY return true otherwise false.\r\n\t\t\t\t\treturn deepIterateOverObjectWith(sanitizedObj, function(value: any) {\r\n\t\t\t\t\t\treturn value === CHANGED_PROPERTY ? true : false;\r\n\t\t\t\t\t});\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['lodash', 'deepIterateOverObjectWith']\r\n\t\t},\r\n\r\n\t\t{\r\n\t\t\tprovide: 'isInDOM',\r\n\t\t\tuseFactory: ($document: any, yjQuery: any) => {\r\n\t\t\t\treturn function(component: any) {\r\n\t\t\t\t\treturn yjQuery.contains($document[0], component);\r\n\t\t\t\t};\r\n\t\t\t},\r\n\t\t\tdeps: ['$document', 'yjQuery']\r\n\t\t},\r\n\t\t{\r\n\t\t\tprovide: 'readObjectStructureFactory',\r\n\t\t\tuseValue: () => {\r\n\t\t\t\tconst readObjectStructure = function(json: any) {\r\n\t\t\t\t\tconst currentWindow = window as any;\r\n\r\n\t\t\t\t\tif (json === undefined || json === null || json.then) {\r\n\t\t\t\t\t\treturn json;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (typeof json === 'function') {\r\n\t\t\t\t\t\treturn \"FUNCTION\";\r\n\t\t\t\t\t} else if (typeof json === 'number') {\r\n\t\t\t\t\t\treturn \"NUMBER\";\r\n\t\t\t\t\t} else if (typeof json === 'string') {\r\n\t\t\t\t\t\treturn \"STRING\";\r\n\t\t\t\t\t} else if (typeof json === 'boolean') {\r\n\t\t\t\t\t\treturn \"BOOLEAN\";\r\n\t\t\t\t\t} else if (currentWindow.smarteditLodash.isElement(json)) {\r\n\t\t\t\t\t\treturn \"ELEMENT\";\r\n\t\t\t\t\t} else if (json.hasOwnProperty && json.hasOwnProperty('length')) { // jquery or Array\r\n\t\t\t\t\t\tif (json.forEach) {\r\n\t\t\t\t\t\t\tconst arr: any = [];\r\n\t\t\t\t\t\t\tjson.forEach(function(arrayElement: any) {\r\n\t\t\t\t\t\t\t\tarr.push(readObjectStructure(arrayElement));\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\treturn arr;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\treturn \"JQUERY\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else { // JSON\r\n\t\t\t\t\t\tconst clone = {} as any;\r\n\t\t\t\t\t\tObject.keys(json).forEach(function(directKey) {\r\n\t\t\t\t\t\t\tif (directKey.indexOf(\"$\") !== 0) {\r\n\t\t\t\t\t\t\t\tclone[directKey] = readObjectStructure(json[directKey]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\treturn clone;\r\n\t\t\t\t\t}\r\n\t\t\t\t};\r\n\t\t\t\treturn readObjectStructure;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t]\r\n})\r\nexport class FunctionsModule {}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './UrlUtils';\r\n\r\n// barrel\r\nexport {CryptographicUtils} from './CryptographicUtils';\r\nexport {FunctionsUtils} from './FunctionsUtils';\r\nexport {StringUtils} from \"./StringUtils\";\r\nexport {WindowUtils} from \"./WindowUtils\";\r\nexport {FunctionsModule} from './functionsModule';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport 'jasmine';\r\nimport {\r\n\tCachedAnnotationFactory,\r\n\tCacheConfigAnnotationFactory,\r\n\tCacheService,\r\n\tClassAnnotationFactory,\r\n\tGatewayProxiedAnnotationFactory,\r\n\tGatewayProxy,\r\n\tInvalidateCacheAnnotationFactory,\r\n\tMethodAnnotationFactory,\r\n\tOperationContextAnnotationFactory,\r\n\tOperationContextService\r\n} from \"smarteditcommons\";\r\n\r\nexport class CoreAnnotationsHelperMocks {\r\n\r\n\tcacheService: jasmine.SpyObj<CacheService>;\r\n\tgatewayProxy: jasmine.SpyObj<GatewayProxy>;\r\n\toperationContextService: jasmine.SpyObj<OperationContextService>;\r\n}\r\n\r\n// at the time a factory is added to the smarteditcommons namespace, it may have already been ngInjected hence changed into an array\r\nfunction getFactory(factory: ClassAnnotationFactory | MethodAnnotationFactory): any {\r\n\treturn (window as any).smarteditLodash.isArray(factory) ? (factory as any)[factory.length - 1] : factory;\r\n}\r\n\r\n// tslint:disable-next-line:max-classes-per-file\r\nclass CoreAnnotationsHelper {\r\n\r\n\tinitCached(): jasmine.SpyObj<CacheService> {\r\n\r\n\t\t///////////////////////////////////////////////////////\r\n\r\n\t\tconst $log = jasmine.createSpyObj('$log', ['debug']);\r\n\r\n\t\tgetFactory(CacheConfigAnnotationFactory)($log);\r\n\r\n\t\t///////////////////////////////////////////////////////\r\n\r\n\t\tconst cacheService: jasmine.SpyObj<CacheService> = jasmine.createSpyObj<CacheService>('cacheService', ['handle', 'evict']);\r\n\t\tcacheService.handle.and.callFake((target: any, methdName: string, method: (...args: any[]) => any, invocationArguments: IArguments) => {\r\n\t\t\treturn method.apply(undefined, invocationArguments);\r\n\t\t});\r\n\t\tgetFactory(CachedAnnotationFactory)(cacheService);\r\n\r\n\t\tgetFactory(InvalidateCacheAnnotationFactory)(cacheService);\r\n\r\n\t\treturn cacheService;\r\n\r\n\t}\r\n\r\n\r\n\tinitGatewayProxied(): jasmine.SpyObj<any> {\r\n\r\n\t\tconst gatewayProxy: GatewayProxy = jasmine.createSpyObj<any>('gatewayProxy', ['initForService']);\r\n\t\tconst $log = jasmine.createSpyObj('$log', ['debug']);\r\n\r\n\t\tgetFactory(GatewayProxiedAnnotationFactory)(gatewayProxy, $log);\r\n\t\treturn gatewayProxy;\r\n\t}\r\n\r\n\tinitOperationContextService(): jasmine.SpyObj<OperationContextService> {\r\n\t\tconst $injector = jasmine.createSpyObj<any>('$injector', ['has', 'get']);\r\n\t\tconst operationContextService: jasmine.SpyObj<OperationContextService> = jasmine.createSpyObj<OperationContextService>('operationContextService', ['register']);\r\n\t\tconst OPERATION_CONTEXT = jasmine.createSpy();\r\n\r\n\t\tgetFactory(OperationContextAnnotationFactory)($injector, operationContextService, OPERATION_CONTEXT);\r\n\t\treturn operationContextService;\r\n\t}\r\n\r\n\tinit(): CoreAnnotationsHelperMocks {\r\n\r\n\t\treturn {\r\n\t\t\tcacheService: this.initCached(),\r\n\t\t\tgatewayProxy: this.initGatewayProxied(),\r\n\t\t\toperationContextService: this.initOperationContextService()\r\n\t\t};\r\n\r\n\t}\r\n}\r\n\r\nexport const coreAnnotationsHelper = new CoreAnnotationsHelper();\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport {Payload} from 'smarteditcommons';\r\n\r\nexport interface ExtentedDocument extends Document {\r\n\tmockScrollingElement(scrollingElement: Element): void;\r\n}\r\nexport interface ExtentedIDocumentService extends angular.IDocumentService {\r\n\tgetDocument(): jasmine.SpyObj<ExtentedDocument>;\r\n}\r\n\r\nexport interface ElementForJQuery extends HTMLElement {\r\n\tmockedMethodsOfJQueryWrapper?: Payload\r\n}\r\n\r\nclass DomHelper {\r\n\r\n\telement(name?: string, mockedMethodsOfJQueryWrapper?: Payload): jasmine.SpyObj<ElementForJQuery> {\r\n\t\tname = name || \"element_\" + Math.random();\r\n\t\tconst prototype = jasmine.createSpyObj<ElementForJQuery>(name, ['dispatchEvent', 'getBoundingClientRect']);\r\n\r\n\t\t/*\r\n\t\t * trick for lodash to be able to consider as an Element:\r\n\t\t * - not be a plain object (achieved by beign born off a constructor)\r\n\t\t * - have nodeType 1\r\n\t\t */\r\n\r\n\t\tclass Clazz {\r\n\t\t}\r\n\t\tClazz.prototype = prototype;\r\n\r\n\t\tconst mock: any = new Clazz();\r\n\r\n\t\t(mock as any).nodeType = 1;\r\n\t\t(mock as ElementForJQuery).mockedMethodsOfJQueryWrapper = mockedMethodsOfJQueryWrapper;\r\n\t\treturn mock;\r\n\t}\r\n\r\n\tcustomEvent(name?: string): jasmine.SpyObj<CustomEvent> {\r\n\t\tname = name || \"CustomEvent_\" + Math.random();\r\n\t\treturn jasmine.createSpyObj<CustomEvent>(name, ['initCustomEvent']);;\r\n\t}\r\n\r\n\tevent(name?: string): jasmine.SpyObj<JQuery.Event> {\r\n\t\tname = name || \"JQueryEvent\" + Math.random();\r\n\t\treturn jasmine.createSpyObj<JQuery.Event>(name, ['preventDefault', 'stopPropagation']);\r\n\t}\r\n\r\n\r\n\t$document(): jasmine.SpyObj<ExtentedIDocumentService> {\r\n\t\tconst $document = {\r\n\t\t\tgetDocument(): jasmine.SpyObj<ExtentedDocument> {\r\n\t\t\t\treturn this[0];\r\n\t\t\t}\r\n\t\t} as jasmine.SpyObj<ExtentedIDocumentService>;\r\n\r\n\t\tconst doc = jasmine.createSpyObj<ExtentedDocument>(\"document\", ['createEvent']);\r\n\t\t(doc as any).mockScrollingElement = function(scrollingElement: Element) {\r\n\t\t\tthis.scrollingElement = scrollingElement;\r\n\t\t};\r\n\r\n\t\t($document as any)[0] = doc;\r\n\r\n\t\treturn $document;\r\n\t}\r\n\r\n}\r\n\r\nexport const domHelper = new DomHelper();","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nexport * from './domHelper';\r\nexport * from './jQueryHelper';\r\nexport * from './promiseHelper';\r\nexport * from './logHelper';\r\nexport {coreAnnotationsHelper} from './coreAnnotationsHelper';\r\nimport './setupUnitTestEnv';\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as lo from 'lodash';\r\nimport {domHelper, ElementForJQuery} from 'testhelpers';\r\nimport {Primitive} from 'smarteditcommons';\r\n\r\nconst lodash: lo.LoDashStatic = (window as any).smarteditLodash;\r\n\r\nclass JQueryHelper {\r\n\r\n\tprivate IDEMPOTENT_METHODS = ['show', 'hide', 'on', 'off'];\r\n\tprivate DEFAULT_MOCKED_JQUERY_FUNCTIONS = ['get', 'data', 'css', 'width', 'height', 'offset'];\r\n\r\n\tjQuery(selectorTransform?: (selector: string) => jasmine.SpyObj<JQuery>): JQueryStatic {\r\n\t\tconst jq = (window as any).$ || (window as any).smarteditJQuery;\r\n\t\tconst jqSpy = jasmine.createSpy(\"jQueryMock\", jq);\r\n\r\n\t\tjqSpy.and.callFake((element: ElementForJQuery | string) => {\r\n\t\t\tif (typeof element === 'string') {\r\n\t\t\t\tif (selectorTransform) {\r\n\t\t\t\t\treturn selectorTransform(element);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.wrap(\"jqSpyForElement\", domHelper.element(`Element Mock for selector ${element}`));\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn this.wrap(\"jqSpyForElement\", element);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn (jqSpy as any) as JQueryStatic;\r\n\t}\r\n\r\n\twrap(name: string, ...elementsArray: ElementForJQuery[]): jasmine.SpyObj<JQuery> {\r\n\r\n\t\tconst filteredElementsArray = elementsArray.filter((element) => !!element);\r\n\r\n\t\tconst elementWithMocks = filteredElementsArray.find((element) => !!element.mockedMethodsOfJQueryWrapper);\r\n\r\n\t\tconst mockedMethodsOfJQueryWrapperNames = !!elementWithMocks ? lodash.uniq(lodash.cloneDeep(this.DEFAULT_MOCKED_JQUERY_FUNCTIONS).concat(Object.keys(elementWithMocks.mockedMethodsOfJQueryWrapper))) : this.DEFAULT_MOCKED_JQUERY_FUNCTIONS;\r\n\r\n\t\tconst elementsWrapper = jasmine.createSpyObj<JQuery>(name, this.IDEMPOTENT_METHODS.concat(mockedMethodsOfJQueryWrapperNames));\r\n\r\n\t\tfilteredElementsArray.forEach((element, index) => {\r\n\t\t\tconst wrapper = elementsWrapper as any;\r\n\t\t\twrapper[index] = element;\r\n\t\t});\r\n\r\n\t\t(elementsWrapper as any).length = filteredElementsArray.length;\r\n\r\n\t\tthis.DEFAULT_MOCKED_JQUERY_FUNCTIONS.forEach((methodName: Extract<keyof JQuery, string>) => {\r\n\t\t\telementsWrapper[methodName].and.returnValue({});\r\n\t\t});\r\n\r\n\t\tif (elementWithMocks) {\r\n\t\t\tlodash.forEach(elementWithMocks.mockedMethodsOfJQueryWrapper, (value: Primitive, methodName: Extract<keyof JQuery, string>) => {\r\n\t\t\t\telementsWrapper[methodName].and.returnValue(value);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tthis.IDEMPOTENT_METHODS.forEach((methodName: Extract<keyof JQuery, string>) => {\r\n\t\t\telementsWrapper[methodName].and.returnValue(elementsWrapper);\r\n\t\t});\r\n\r\n\t\treturn elementsWrapper;\r\n\t}\r\n\r\n}\r\n\r\nexport const jQueryHelper = new JQueryHelper();","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport * as angular from \"angular\";\r\n\r\nexport class LogHelper implements angular.ILogService {\r\n\r\n\tdebug: angular.ILogCall = function() {\r\n\t\tconst f: any = (...args: any[]) => {\r\n\t\t\treturn console.debug.call(this, args);\r\n\t\t};\r\n\t\tf.logs = [];\r\n\t\treturn f;\r\n\t}();\r\n\r\n\r\n\tinfo: angular.ILogCall = function() {\r\n\t\tconst f: any = (...args: any[]) => {\r\n\t\t\treturn console.info.call(this, args);\r\n\t\t};\r\n\t\tf.logs = [];\r\n\t\treturn f;\r\n\t}();\r\n\r\n\tlog: angular.ILogCall = function() {\r\n\t\tconst f: any = (...args: any[]) => {\r\n\t\t\treturn console.log.call(this, args);\r\n\t\t};\r\n\t\tf.logs = [];\r\n\t\treturn f;\r\n\t}();\r\n\r\n\terror: angular.ILogCall = function() {\r\n\t\tconst f: any = (...args: any[]) => {\r\n\t\t\treturn console.error.call(this, args);\r\n\t\t};\r\n\t\tf.logs = [];\r\n\t\treturn f;\r\n\t}();\r\n\r\n\twarn: angular.ILogCall = function() {\r\n\t\tconst f: any = (...args: any[]) => {\r\n\t\t\treturn console.warn.call(this, args);\r\n\t\t};\r\n\t\tf.logs = [];\r\n\t\treturn f;\r\n\t}();\r\n\r\n\tconstructor() {\r\n\t\tspyOn(this, 'debug');\r\n\t\tspyOn(this, 'info');\r\n\t\tspyOn(this, 'log');\r\n\t\tspyOn(this, 'error');\r\n\t\tspyOn(this, 'warn');\r\n\t}\r\n\r\n\t// from angular-mocks\r\n\tassertEmpty(): void {\r\n\t\tthrow new Error(`LogHelper.assertEmpty() was not implemented`);\r\n\t}\r\n\r\n\t// from angular-mocks\r\n\treset(): void {\r\n\t\tthrow new Error(`LogHelper.reset() was not implemented`);\r\n\t}\r\n\r\n}\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\nimport 'jasmine';\r\nimport * as angular from 'angular';\r\n\r\nimport IPromise = angular.IPromise;\r\nimport SpyObj = jasmine.SpyObj;\r\n\r\nexport enum PromiseType {\r\n\tRESOLVES, REJECTS\r\n}\r\n/**\r\n * @ngdoc interface\r\n * @name testHelpers.interface:IExtensiblePromise<T>\r\n * @description\r\n * extended spied on angular promise that stores its promiseType (REJECTS or RESOLVES) and its value\r\n */\r\nexport interface IExtensiblePromise<T> extends SpyObj<IPromise<T>> {\r\n\tvalue: T;\r\n\tpromiseType: PromiseType;\r\n\tname: string;\r\n}\r\n/**\r\n * @ngdoc service\r\n * @name testHelpers.service:PromiseHelper\r\n * @description\r\n * Helper to easily make use of immediately resolving/rejecting promises in unit tests\r\n */\r\nclass PromiseHelper {\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name testHelpers.service:PromiseHelper#buildPromise\r\n\t * @methodOf testHelpers.service:PromiseHelper\r\n\t * @description\r\n\t * Builds an immediately resolving or rejecting promise\r\n\t * @param {string} name the name of the promise\r\n\t * @param {PromiseType} promiseType enum of values RESOLVES and REJECTS to indicate the behaviour of the promise\r\n\t * @param {object} value  the object to which the promise resolves or rejects, it will be passed as argument to its resolveFunction or rejectFunction passed as arguments of .then method\r\n\t */\r\n\tbuildPromise<T>(name: string, promiseType: PromiseType = PromiseType.RESOLVES, value?: T): IExtensiblePromise<T> {\r\n\r\n\t\tconst promise = jasmine.createSpyObj<IPromise<T>>(name, ['then', 'finally', 'catch']) as IExtensiblePromise<T>;\r\n\r\n\t\tpromise.promiseType = promiseType;\r\n\t\tpromise.value = value;\r\n\t\tpromise.name = name;\r\n\t\tpromise.then.and.callFake((resolveFunction: (response: any) => any, rejectFunction: (response: any) => any) => {\r\n\t\t\tlet newValue: any = null;\r\n\t\t\tif (promise.promiseType === PromiseType.RESOLVES) {\r\n\t\t\t\tif (resolveFunction) {\r\n\t\t\t\t\tnewValue = resolveFunction(promise.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewValue = promise.value;\r\n\t\t\t\t}\r\n\t\t\t\tif (newValue && newValue.then) {\r\n\t\t\t\t\treturn newValue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.buildPromise(name + \"_chained\", PromiseType.RESOLVES, newValue);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tif (rejectFunction) {\r\n\t\t\t\t\tnewValue = rejectFunction(promise.value);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tnewValue = promise.value;\r\n\t\t\t\t}\r\n\t\t\t\tif (newValue && newValue.then) {\r\n\t\t\t\t\treturn newValue;\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn this.buildPromise(name + \"_chained\", PromiseType.REJECTS, newValue);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tpromise.finally.and.callFake((finallyFunction: (response: any) => any) => {\r\n\t\t\tlet newValue: any = finallyFunction(promise.value);\r\n\t\t\treturn this.buildPromise(name + \"_chained\", promise.promiseType, newValue);\r\n\t\t});\r\n\r\n\t\tpromise.catch.and.callFake((rejectFunction: (response: any) => any) => {\r\n\t\t\tif (promise.promiseType === PromiseType.REJECTS) {\r\n\t\t\t\tlet newValue: any = rejectFunction(promise.value);\r\n\t\t\t\treturn this.buildPromise(name + \"_chained\", PromiseType.REJECTS, newValue);\r\n\t\t\t}\r\n\r\n\t\t\treturn promise;\r\n\t\t});\r\n\r\n\t\treturn promise;\r\n\t}\r\n\r\n\t/**\r\n\t * @ngdoc method\r\n\t * @name testHelpers.service:PromiseHelper#$q\r\n\t * @methodOf testHelpers.service:PromiseHelper\r\n\t * @description\r\n\t * Builds an immediately resolving or rejecting mock of angular $q\r\n\t */\r\n\t$q(): SpyObj<angular.IQService> {\r\n\r\n\t\tconst $q: SpyObj<angular.IQService> = jasmine.createSpyObj<angular.IQService>('$q', ['all', 'defer', 'when', 'resolve', 'reject']);\r\n\r\n\t\t$q.all.and.callFake((promises: IExtensiblePromise<any>[]) => {\r\n\r\n\t\t\tconst collector: any[] = [];\r\n\r\n\t\t\tpromises\r\n\t\t\t\t.filter((promise) => promise.promiseType === PromiseType.RESOLVES)\r\n\t\t\t\t.forEach((promise) => {\r\n\t\t\t\t\tpromise.then((response) => {\r\n\t\t\t\t\t\tcollector.push(response);\r\n\t\t\t\t\t});\r\n\t\t\t\t});\r\n\r\n\t\t\tconst oneRejected = promises.find((promise) => promise.promiseType === PromiseType.REJECTS);\r\n\r\n\t\t\tif (!oneRejected) {\r\n\t\t\t\treturn this.buildPromise(\"arrayPromise\", PromiseType.RESOLVES, collector);\r\n\t\t\t} else {\r\n\t\t\t\treturn this.buildPromise(\"arrayPromise\", PromiseType.REJECTS, oneRejected.value);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$q.when.and.callFake((value: any) => {\r\n\t\t\tif (value && value.then) {\r\n\t\t\t\treturn value;\r\n\t\t\t} else {\r\n\t\t\t\treturn this.buildPromise(\"whenPromise\", PromiseType.RESOLVES, value);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$q.defer.and.callFake(() => {\r\n\r\n\t\t\tconst deferred: angular.IDeferred<any> = {\r\n\r\n\t\t\t\tpromise: this.buildPromise<any>(\"deferredPromise\", PromiseType.REJECTS),\r\n\r\n\t\t\t\tresolve(value: any) {\r\n\t\t\t\t\tthis.promise.promiseType = PromiseType.RESOLVES;\r\n\t\t\t\t\tthis.promise.value = value;\r\n\t\t\t\t},\r\n\r\n\t\t\t\treject(value: any) {\r\n\t\t\t\t\tthis.promise.promiseType = PromiseType.REJECTS;\r\n\t\t\t\t\tthis.promise.value = value;\r\n\t\t\t\t},\r\n\r\n\t\t\t\tnotify(state?: any) {angular.noop();}\r\n\t\t\t};\r\n\t\t\treturn deferred;\r\n\t\t});\r\n\r\n\t\t$q.resolve.and.callFake((value: any) => {\r\n\t\t\tif (value && value.then) {\r\n\t\t\t\treturn value;\r\n\t\t\t} else {\r\n\t\t\t\treturn this.buildPromise(\"resolvePromise\", PromiseType.RESOLVES, value);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$q.reject.and.callFake((value: any) => {\r\n\t\t\tif (value && value.then) {\r\n\t\t\t\treturn value;\r\n\t\t\t} else {\r\n\t\t\t\treturn this.buildPromise(\"rejectPromise\", PromiseType.REJECTS, value);\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\treturn $q;\r\n\t}\r\n}\r\n\r\nexport const promiseHelper = new PromiseHelper();","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n// necessary for registration of decorators and hence required by downstream teams that flag smarteditcommons as external\r\n// without smarteditcommons flagged as external, import of functions, like decorators, in downstream extensions fail\r\nimport * as angular from 'angular';\r\n\r\nbeforeEach((angular as any).mock.module(function($provide: any) {\r\n\t$provide.value('$log', console);\r\n}));\r\n","/*\r\n * [y] hybris Platform\r\n *\r\n * Copyright (c) 2018 SAP SE or an SAP affiliate company. All rights reserved.\r\n *\r\n * This software is the confidential and proprietary information of SAP\r\n * (\"Confidential Information\"). You shall not disclose such Confidential\r\n * Information and shall use it only in accordance with the terms of the\r\n * license agreement you entered into with SAP.\r\n */\r\n\r\nexport {\r\n\tCachedAnnotationFactory,\r\n\tCacheConfigAnnotationFactory,\r\n\tInvalidateCacheAnnotationFactory,\r\n} from 'smarteditcommons/services/cache/cachedAnnotation';\r\n\r\nexport {\r\n\tGatewayProxiedAnnotationFactory\r\n} from 'smarteditcommons/services/gatewayProxiedAnnotation';\r\n\r\nexport {OperationContextAnnotationFactory} from 'smarteditcommons/services/httpErrorInterceptor/default/retryInterceptor/operationContextAnnotation';\r\n\r\nexport {\r\n\tannotationService\r\n} from 'smarteditcommons/services/annotationService';\r\n\r\nexport {\r\n\tSeInjectable,\r\n\tSeComponent,\r\n\tSeModule\r\n} from 'smarteditcommons/services/dependencyInjection/di';\r\n\r\nexport {\r\n\tFunctionsModule\r\n} from 'smarteditcommons/utils';\r\n\r\nexport {ConfigModule} from 'smarteditcommons/services/ConfigModule';\r\n\r\nimport {coreAnnotationsHelper} from 'testhelpers';\r\n\r\ncoreAnnotationsHelper.init();\r\n","module.exports = angular;","module.exports = CryptoJS;","module.exports = jasmine;"],"sourceRoot":""}