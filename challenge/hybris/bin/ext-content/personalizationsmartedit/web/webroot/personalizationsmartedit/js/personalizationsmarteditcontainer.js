!function(t){var e={};function __webpack_require__(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,__webpack_require__),i.l=!0,i.exports}__webpack_require__.m=t,__webpack_require__.c=e,__webpack_require__.d=function(t,e,n){__webpack_require__.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},__webpack_require__.t=function(t,e){if(1&e&&(t=__webpack_require__(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)__webpack_require__.d(n,i,function(e){return t[e]}.bind(null,i));return n},__webpack_require__.n=function(t){var e=t&&t.__esModule?function getDefault(){return t.default}:function getModuleExports(){return t};return __webpack_require__.d(e,"a",e),e},__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=28)}([function(t,e){t.exports=angular},function(t,e){t.exports=smarteditcommons},function(t,e){t.exports=moment},function(t,e,n){var i={"./combinedView/personalizationsmarteditCombinedView.js":4,"./commonComponents/catalogFilterDropdown.js":5,"./commonComponents/catalogVersionFilterDropdown.js":6,"./commonComponents/hasMulticatalog.js":7,"./commonComponents/pageFilterDropdown.js":8,"./commonComponents/statusFilterDropdown.js":9,"./contextMenu/personalizationsmarteditContextMenu.js":10,"./customizeView/customizationsList/customizationsList.js":11,"./customizeView/personalizationsmarteditCustomizeView.js":12,"./customizeView/personalizationsmarteditCustomizeViewService.js":13,"./dataFactory/dataFactory.js":14,"./management/commerceCustomizationView/personalizationsmarteditCommerceCustomizationView.js":15,"./management/manageCustomizationView/segmentView/personalizationsmarteditSegmentView.js":16,"./management/manageCustomizationView/segmentView/segmentExpressionAsHtml/personalizationsmarteditSegmentExpressionAsHtml.js":17,"./management/managerView/personalizationsmarteditManagerView.js":18,"./service/personalizationsmarteditPreviewService.js":19,"./service/personalizationsmarteditRulesAndPermissionsRegistrationService.js":20,"./templates.js":21,"./toolbarContext/personalizationsmarteditToolbarContext.js":22};function webpackContext(t){var e=webpackContextResolve(t);return n(e)}function webpackContextResolve(t){var e=i[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}webpackContext.keys=function webpackContextKeys(){return Object.keys(i)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id=3},function(t,e){angular.module("personalizationsmarteditCombinedViewModule",["personalizationsmarteditCommons","personalizationsmarteditCommonsModule","ui.select","personalizationsmarteditServicesModule","renderServiceModule","personalizationsmarteditDataFactory","modalServiceModule","personalizationsmarteditPreviewServiceModule","pageFilterDropdownModule","catalogFilterDropdownModule","hasMulticatalogModule","componentMenuServiceModule","permissionServiceModule"]).factory("personalizationsmarteditCombinedView",["$controller","modalService","MODAL_BUTTON_ACTIONS","MODAL_BUTTON_STYLES","personalizationsmarteditContextService","personalizationsmarteditCombinedViewCommons","personalizationsmarteditContextUtils",function(t,e,n,i,a,o,r){var s={openManagerAction:function(){e.open({title:"personalization.modal.combinedview.title",templateUrl:"personalizationsmarteditCombinedViewConfigureTemplate.html",controller:["$scope","modalManager",function(e,n){e.modalManager=n,angular.extend(this,t("personalizationsmarteditCombinedViewController",{$scope:e}))}],buttons:[{id:"confirmCancel",label:"personalization.modal.combinedview.button.cancel",style:i.SECONDARY,action:n.DISMISS},{id:"confirmOk",label:"personalization.modal.combinedview.button.ok",action:n.CLOSE}]}).then(function(){r.clearCombinedViewCustomizeContext(a),a.getCombinedView().enabled&&o.updatePreview(o.getVariationsForPreviewTicket())},function(){})}};return s}]).factory("personalizationsmarteditCombinedViewCommons",["$q","$filter","personalizationsmarteditContextService","personalizationsmarteditPreviewService","personalizationsmarteditRestService","personalizationsmarteditUtils",function(t,e,n,i,a,o){var r={};return r.updatePreview=function(e){i.updatePreviewTicketWithVariations(e),function(){var e=n.getCombinedView(),i=[];(e.selectedItems||[]).forEach(function(t){i.push(a.getActions(t.customization.code,t.variation.code,t.variation).then(function successCallback(e){t.variation.actions=e.actions}))}),t.all(i).then(function(){n.setCombinedView(e)})}()},r.getVariationsForPreviewTicket=function(){var t=[];return(n.getCombinedView().selectedItems||[]).forEach(function(e){t.push({customizationCode:e.customization.code,variationCode:e.variation.code,catalog:e.variation.catalog,catalogVersion:e.variation.catalogVersion})}),t},r.combinedViewEnabledEvent=function(t){var e=n.getCombinedView();e.enabled=t,n.setCombinedView(e);var i=n.getCustomize();i.selectedCustomization=null,i.selectedVariations=null,i.selectedComponents=null,n.setCustomize(i),t?r.updatePreview(r.getVariationsForPreviewTicket()):r.updatePreview([])},r.isItemFromCurrentCatalog=function(t){return o.isItemFromCurrentCatalog(t,n.getSeData())},r}]).controller("personalizationsmarteditCombinedViewMenuController",["$scope","$filter","personalizationsmarteditUtils","personalizationsmarteditMessageHandler","personalizationsmarteditRestService","personalizationsmarteditContextService","personalizationsmarteditCombinedViewCommons","permissionService",function(t,e,n,i,a,o,r,s){t.combinedView=o.getCombinedView(),t.selectedItems=t.combinedView.selectedItems||[];t.itemClick=function(l){var c=o.getCombinedView();c.enabled&&(t.selectedItems.forEach(function(t){t.highlighted=!1}),l.highlighted=!0,c.customize.selectedCustomization=l.customization,c.customize.selectedVariations=l.variation,o.setCombinedView(c),s.isPermitted([{names:["se.edit.page"]}]).then(function(t){t&&function(t,n,r,s){a.getComponenentsIdsForVariation(t,n,r,s).then(function successCallback(t){var e=o.getCombinedView();e.customize.selectedComponents=t.components,o.setCombinedView(e)},function errorCallback(){i.sendError(e("translate")("personalization.error.gettingcomponentsforvariation"))})}(l.customization.code,l.variation.code,l.customization.catalog,l.customization.catalogVersion)}),r.updatePreview(n.getVariationKey(l.customization.code,[l.variation])))},t.getClassForElement=function(t){return n.getClassForElement(t)},t.getLetterForElement=function(t){return n.getLetterForElement(t)},t.combinedViewEnabledChangeEvent=function(){r.combinedViewEnabledEvent(t.combinedView.enabled)},t.isItemFromCurrentCatalog=function(t){return r.isItemFromCurrentCatalog(t)},t.$watch("combinedView.selectedItems",function(e,n){e!==n&&(t.selectedItems=t.combinedView.selectedItems||[])},!0)}]).controller("personalizationsmarteditCombinedViewController",["$q","$scope","$filter","customizationDataFactory","PaginationHelper","personalizationsmarteditCombinedViewCommons","personalizationsmarteditContextService","personalizationsmarteditRestService","personalizationsmarteditMessageHandler","personalizationsmarteditUtils","PERSONALIZATION_VIEW_STATUS_MAPPING_CODES","PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER","componentMenuService",function(t,e,n,i,a,o,r,s,l,c,d,m,u){i.resetData();var p=function(t){e.pagination=new a(t.pagination),e.selectionArray.length=0,i.items.map(function(t){t.variations.filter(function(t){return c.isItemVisible(t)}).forEach(function(n){e.selectionArray.push({customization:{code:t.code,name:t.name,rank:t.rank,catalog:t.catalog,catalogVersion:t.catalogVersion},variation:{code:n.code,name:n.name,catalog:n.catalog,catalogVersion:n.catalogVersion}})})}),e.moreCustomizationsRequestProcessing=!1},g=function(){l.sendError(n("translate")("personalization.error.gettingcustomizations")),e.moreCustomizationsRequestProcessing=!1},v=function(){var t={currentSize:e.pagination.count,currentPage:e.pagination.page+1,name:e.customizationFilter.name,statuses:c.getStatusesMapping().filter(function(t){return t.code===d.ALL})[0].modelStatuses,catalogs:e.catalogFilter};return e.customizationPageFilter===m.ONLY_THIS_PAGE&&(t.pageId=r.getSeData().pageId,t.pageCatalogId=r.getSeData().seExperienceData.pageContext.catalogId),t};e.pagination=new a,e.pagination.reset(),e.combinedView=r.getCombinedView(),e.selectedItems=[],angular.copy(e.combinedView.selectedItems||[],e.selectedItems),e.selectedElement={},e.selectionArray=[],e.moreCustomizationsRequestProcessing=!1,e.addMoreItems=function(){e.pagination.page<e.pagination.totalPages-1&&!e.moreCustomizationsRequestProcessing&&(e.moreCustomizationsRequestProcessing=!0,function(t){var e={filter:t,dataArrayName:"customizations"};i.updateData(e,p,g)}(v()))},e.selectElement=function(t){e.selectedItems.push(t),u.getValidContentCatalogVersions().then(function(t){var n=t.map(function(t){return t.id});e.selectedItems.sort(function(t,e){var i=t.customization.catalog+"/"+t.customization.catalogVersion,a=e.customization.catalog+"/"+e.customization.catalogVersion;return i===a?t.customization.rank-e.customization.rank:n.indexOf(a)-n.indexOf(i)})}),e.selectedElement=null,e.searchInputKeypress(null,"")},e.initUiSelect=function(t){t.isActive=function(){return!1}},e.removeSelectedItem=function(t){e.selectedItems.splice(e.selectedItems.indexOf(t),1),e.selectedElement=null,e.searchInputKeypress(null,"")},e.getClassForElement=function(t){return c.getClassForElement(t)},e.getLetterForElement=function(t){return c.getLetterForElement(t)},e.isItemInSelectDisabled=function(t){return e.selectedItems.find(function(e){return e.customization.code===t.customization.code})},e.isItemSelected=function(t){return e.selectedItems.find(function(e){return e.customization.code===t.customization.code&&e.variation.code===t.variation.code})},e.customizationFilter={name:""},e.searchInputKeypress=function(t,n){t&&[37,38,39,40].indexOf(t.which)>-1||(e.pagination.reset(),e.customizationFilter.name=n,i.resetData(),e.addMoreItems())};e.modalManager.setButtonHandler(function(n){var i=t.defer();if("confirmOk"===n){var a=r.getCombinedView();return a.selectedItems=e.selectedItems,a.enabled&&null!==a.customize.selectedVariations&&function(t){return 0===t.selectedItems.filter(function(e){return e.customization.code===t.customize.selectedCustomization.code&&e.variation.code===t.customize.selectedVariations.code}).length}(a)&&(a.customize.selectedCustomization=null,a.customize.selectedVariations=null,a.customize.selectedComponents=null),r.setCombinedView(a),i.resolve()}return i.reject()}),e.$watch("selectedItems",function(t,n){if(e.modalManager.disableButton("confirmOk"),t!==n){var i=r.getCombinedView(),a=0===(i.selectedItems||[]).length&&0===e.selectedItems.length;(a=a||angular.equals(i.selectedItems,e.selectedItems))||e.modalManager.enableButton("confirmOk")}},!0),e.pageFilerChange=function(t){e.customizationPageFilter=t,e.pagination.reset(),i.resetData(),e.addMoreItems()},e.catalogFilerChange=function(t){e.catalogFilter=t,e.pagination.reset(),i.resetData(),e.addMoreItems()},e.isItemFromCurrentCatalog=function(t){return o.isItemFromCurrentCatalog(t)},e.getAndSetCatalogVersionNameL10N=function(t){return c.getAndSetCatalogVersionNameL10N(t)}}])},function(t,e){angular.module("catalogFilterDropdownModule",["personalizationsmarteditCommons","personalizationsmarteditCommonsModule","ySelectModule"]).constant("PERSONALIZATION_CATALOG_FILTER",{ALL:"all",CURRENT:"current",PARENTS:"parents"}).controller("catalogFilterDropdownController",["$q","personalizationsmarteditUtils","PERSONALIZATION_CATALOG_FILTER",function(t,e,n){var i=this;this.$onInit=function(){i.items=[{id:n.ALL,label:"personalization.filter.catalog.all"},{id:n.CURRENT,label:"personalization.filter.catalog.current"},{id:n.PARENTS,label:"personalization.filter.catalog.parents"}],i.selectedId=i.initialValue||i.items[1].id},this.fetchStrategy={fetchAll:function(){return t.when(i.items)}},this.onChange=function(){i.onSelectCallback({value:i.selectedId})}}]).component("catalogFilterDropdown",{templateUrl:"pageFilterDropdownTemplate.html",controller:"catalogFilterDropdownController",controllerAs:"ctrl",transclude:!0,bindings:{onSelectCallback:"&",initialValue:"<?"}})},function(t,e){angular.module("catalogVersionFilterDropdownModule",["personalizationsmarteditCommons","personalizationsmarteditCommonsModule","personalizationsmarteditServicesModule","ySelectModule","componentMenuServiceModule","l10nModule"]).controller("catalogVersionFilterDropdownController",["$q","personalizationsmarteditUtils","componentMenuService","personalizationsmarteditContextService",function(t,e,n,i){var a=this;this.$onInit=function(){a.itemTemplate="catalogVersionFilterDropdownItemTemplate.html",n.getValidContentCatalogVersions().then(function(t){a.items=t;var e=i.getSeData().seExperienceData;a.items.forEach(function(t){t.isCurrentCatalog=t.id===e.catalogDescriptor.catalogVersionUuid}),n.getInitialCatalogVersion(a.items).then(function(t){a.selectedId=a.initialValue||t.id})})},this.fetchStrategy={fetchAll:function(){return t.when(a.items)}},this.onChange=function(){a.onSelectCallback({value:a.selectedId})}}]).component("catalogVersionFilterDropdown",{templateUrl:"pageFilterDropdownTemplate.html",controller:"catalogVersionFilterDropdownController",controllerAs:"ctrl",transclude:!0,bindings:{onSelectCallback:"&",initialValue:"<?"}})},function(t,e){angular.module("hasMulticatalogModule",["personalizationsmarteditServicesModule"]).controller("hasMulticatalogController",["personalizationsmarteditContextService",function(t){var e=this;this.$onInit=function(){e.hasMulticatalog=t.getSeData().seExperienceData.siteDescriptor.contentCatalogs.length>1}}]).component("hasMulticatalog",{templateUrl:"hasMulticatalogTemplate.html",controller:"hasMulticatalogController",controllerAs:"ctrl",transclude:!0,bindings:{}})},function(t,e){angular.module("pageFilterDropdownModule",["personalizationsmarteditCommons","personalizationsmarteditCommonsModule","ySelectModule"]).constant("PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER",{ALL:"all",ONLY_THIS_PAGE:"onlythispage"}).controller("pageFilterDropdownController",["$q","personalizationsmarteditUtils","PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER",function(t,e,n){var i=this;this.$onInit=function(){i.items=[{id:n.ALL,label:"personalization.filter.page.all"},{id:n.ONLY_THIS_PAGE,label:"personalization.filter.page.onlythispage"}],i.selectedId=i.initialValue||i.items[1].id},this.fetchStrategy={fetchAll:function(){return t.when(i.items)}},this.onChange=function(){i.onSelectCallback({value:i.selectedId})}}]).component("pageFilterDropdown",{templateUrl:"pageFilterDropdownTemplate.html",controller:"pageFilterDropdownController",controllerAs:"ctrl",transclude:!0,bindings:{onSelectCallback:"&",initialValue:"<?"}})},function(t,e){angular.module("statusFilterDropdownModule",["personalizationsmarteditCommons","personalizationsmarteditCommonsModule","ySelectModule"]).controller("statusFilterDropdownController",["$q","personalizationsmarteditUtils",function(t,e){var n=this;this.$onInit=function(){n.items=e.getStatusesMapping().map(function(t){return{id:t.code,label:t.text,modelStatuses:t.modelStatuses}}),n.selectedId=n.initialValue||n.items[0].id},this.fetchStrategy={fetchAll:function(){return t.when(n.items)}},this.onChange=function(){n.onSelectCallback({value:n.selectedId})}}]).component("statusFilterDropdown",{templateUrl:"pageFilterDropdownTemplate.html",controller:"statusFilterDropdownController",controllerAs:"ctrl",transclude:!0,bindings:{onSelectCallback:"&",initialValue:"<?"}})},function(t,e){angular.module("personalizationsmarteditContextMenu",["modalServiceModule","personalizationsmarteditCommons","personalizationsmarteditCommonsModule","ui.select","genericEditorModule","editorModalServiceModule","smarteditRootModule","personalizationsmarteditServicesModule","renderServiceModule","personalizationsmarteditDataFactory","slotRestrictionsServiceModule","catalogVersionFilterDropdownModule","hasMulticatalogModule"]).factory("personalizationsmarteditContextModal",["$controller","modalService","MODAL_BUTTON_ACTIONS","MODAL_BUTTON_STYLES","$filter","personalizationsmarteditMessageHandler","gatewayProxy","personalizationsmarteditContextService","renderService","personalizationsmarteditRestService","editorModalService",function(t,e,n,i,a,o,r,s,l,c,d){var m=function(){this.gatewayId="personalizationsmarteditContextModal",r.initForService(this)},u=[{id:"cancel",label:"personalization.modal.addeditaction.button.cancel",style:i.SECONDARY,action:n.DISMISS},{id:"submit",label:"personalization.modal.addeditaction.button.submit",action:n.CLOSE}],p=[{id:"confirmCancel",label:"personalization.modal.deleteaction.button.cancel",style:i.SECONDARY,action:n.DISMISS},{id:"confirmOk",label:"personalization.modal.deleteaction.button.ok",action:n.CLOSE}];return m.prototype.openDeleteAction=function(n){e.open({size:"md",title:"personalization.modal.deleteaction.title",templateInline:'<div id="confirmationModalDescription">{{ "personalization.modal.deleteaction.content" | translate }}</div>',controller:["$scope","modalManager",function(e,i){angular.merge(e,n),e.modalManager=i,angular.extend(this,t("modalDeleteActionController",{$scope:e}))}],cssClasses:"yFrontModal",buttons:p}).then(function(){if(s.getCombinedView().enabled)c.getActions(n.selectedCustomizationCode,n.selectedVariationCode,n).then(function successCallback(t){var e=s.getCombinedView();e.customize.selectedComponents&&e.customize.selectedComponents.splice(e.customize.selectedComponents.indexOf(n.containerSourceId),1),angular.forEach(e.selectedItems,function(e){e.customization.code===n.selectedCustomizationCode&&e.variation.code===n.selectedVariationCode&&(e.variation.actions=t.actions)}),s.setCombinedView(e)},function errorCallback(){o.sendError(a("translate")("personalization.error.gettingactions"))});else{var t=s.getCustomize();t.selectedComponents.splice(t.selectedComponents.indexOf(n.containerSourceId),1),s.setCustomize(t)}l.renderSlots(n.slotsToRefresh)})},m.prototype.openAddAction=function(n){e.open({title:"personalization.modal.addaction.title",templateUrl:"personalizationsmarteditAddEditActionTemplate.html",controller:["$scope","modalManager",function(e,i){angular.merge(e,n),e.defaultComponentId=n.componentId,e.modalManager=i,e.editEnabled=!1,angular.extend(this,t("modalAddEditActionController",{$scope:e})),angular.extend(this,t("modalAddActionController",{$scope:e}))}],cssClasses:"yPersonalizationContextModal",buttons:u}).then(function(t){if(s.getCombinedView().enabled){var e=s.getCombinedView();e.customize.selectedComponents.push(t),s.setCombinedView(e)}else{var i=s.getCustomize();i.selectedComponents.push(t),s.setCustomize(i)}l.renderSlots(n.slotsToRefresh)},function(){})},m.prototype.openEditAction=function(n){e.open({title:"personalization.modal.editaction.title",templateUrl:"personalizationsmarteditAddEditActionTemplate.html",controller:["$scope","modalManager",function(e,i){angular.merge(e,n),e.modalManager=i,e.editEnabled=!0,angular.extend(this,t("modalAddEditActionController",{$scope:e})),angular.extend(this,t("modalEditActionController",{$scope:e}))}],cssClasses:"yPersonalizationContextModal",buttons:u}).then(function(){l.renderSlots(n.slotsToRefresh)})},m.prototype.openEditComponentAction=function(t){d.open(t)},new m}]).controller("modalAddEditActionController",["$scope","$filter","$q","$timeout","editorModalService","personalizationsmarteditContextService","personalizationsmarteditRestService","personalizationsmarteditMessageHandler","PaginationHelper","slotRestrictionsService","PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING",function(t,e,n,i,a,o,r,s,l,c,d){t.actions=[{id:"create",name:e("translate")("personalization.modal.addeditaction.createnewcomponent")},{id:"use",name:e("translate")("personalization.modal.addeditaction.usecomponent")}],t.newComponent={},t.component={},t.components=[],t.newComponentTypes=[];var m=function(n){r.getComponent(n).then(function successCallback(e){t.component.selected=e},function errorCallback(){s.sendError(e("translate")("personalization.error.gettingcomponents"))})};t.newComponentTypeSelectedEvent=function(){var n={smarteditComponentType:t.newComponent.selected.code,catalogVersionUuid:o.getSeData().seExperienceData.pageContext.catalogVersionUuid};a.open(n).then(function(n){t.action={selected:e("filter")(t.actions,{id:"use"},!0)[0]},t.componentUuid=n.uuid,m(t.componentUuid)},function(){t.newComponent={}})};t.modalManager.setButtonHandler(function(i){if("submit"===i){t.modalManager.disableButton("submit");var a=t.component.selected.catalogVersion.substring(0,t.component.selected.catalogVersion.indexOf("/")),o={catalog:t.selectedCustomization.catalog,catalogVersion:t.selectedCustomization.catalogVersion},l={slotCatalog:t.slotCatalog,oldComponentCatalog:t.componentCatalog};return angular.extend(l,o),t.editEnabled?function(t,i,a,o,l,c){var d=n.defer();return r.editAction(t,i,a,o,l,c).then(function successCallback(){s.sendSuccess(e("translate")("personalization.info.updatingaction")),d.resolve()},function errorCallback(){s.sendError(e("translate")("personalization.error.updatingaction")),d.reject()}),d.promise}(t.selectedCustomization.code,t.selectedVariation.code,t.actionId,t.component.selected.uid,a,o):r.replaceComponentWithContainer(t.defaultComponentId,t.slotId,l).then(function successCallback(i){return function(t,i,a,o,l,c){var d=n.defer();return r.addActionToContainer(t,i,a,o,l,c).then(function successCallback(){s.sendSuccess(e("translate")("personalization.info.creatingaction")),d.resolve(a)},function errorCallback(){s.sendError(e("translate")("personalization.error.creatingaction")),d.reject()}),d.promise}(t.component.selected.uid,a,i.sourceId,t.selectedCustomization.code,t.selectedVariation.code,o)},function errorCallback(){return s.sendError(e("translate")("personalization.error.replacingcomponent")),n.defer().reject()})}return n.defer().reject()}),t.componentFilter={name:""};t.componentPagination=new l,t.componentPagination.reset(),t.moreComponentRequestProcessing=!1,t.addMoreComponentItems=function(){t.componentPagination.page<t.componentPagination.totalPages-1&&!t.moreComponentRequestProcessing&&t.newComponentTypes.length>0&&(t.moreComponentRequestProcessing=!0,r.getComponents(function(){var e=t.newComponentTypes.map(function(t){return t.code}).join(",");return{currentPage:t.componentPagination.page+1,mask:t.componentFilter.name,pageSize:50,sort:"name",catalog:t.catalogFilter,catalogVersion:t.catalogVersionFilter,typeCodes:e}}()).then(function successCallback(e){var n=e.response.filter(function(t){return!t.restricted});Array.prototype.push.apply(t.components,n),t.componentPagination=new l(e.pagination),t.moreComponentRequestProcessing=!1,t.components.length<20&&i(function(){t.addMoreComponentItems()},0)},function errorCallback(){s.sendError(e("translate")("personalization.error.gettingcomponents")),t.moreComponentRequestProcessing=!1}))},t.componentSearchInputKeypress=function(e,n){e&&[37,38,39,40].indexOf(e.which)>-1||(t.componentPagination.reset(),t.componentFilter.name=n,t.components.length=0,t.addMoreComponentItems())};t.catalogVersionFilerChange=function(e){var n=e.split("/");t.catalogFilter=n[0],t.catalogVersionFilter=n[1],t.componentPagination.reset(),t.components.length=0,t.addMoreComponentItems()},t.$watch("action.selected",function(e,n){e!==n&&(t.component.selected=void 0,t.editEnabled&&m(t.componentUuid))},!0),t.$watch("component.selected",function(e){t.modalManager.disableButton("submit"),void 0!==e&&t.modalManager.enableButton("submit")},!0),t.$watch("newComponentTypes",function(e){void 0!==e&&(t.componentPagination=new l,t.componentPagination.reset(),t.moreComponentRequestProcessing=!1,t.addMoreComponentItems())},!0),r.getCustomization({code:t.selectedCustomizationCode}).then(function successCallback(e){t.selectedCustomization=e,t.selectedVariation=e.variations.filter(function(e){return e.code===t.selectedVariationCode})[0]},function errorCallback(){s.sendError(e("translate")("personalization.error.gettingcustomization"))}),t.editEnabled&&m(t.componentUuid),c.getSlotRestrictions(t.slotId).then(function(n){r.getNewComponentTypes().then(function success(e){t.newComponentTypes=e.componentTypes.filter(function(t){return n.indexOf(t.code)>-1})},function error(){s.sendError(e("translate")("personalization.error.gettingcomponentstypes"))})},function error(){s.sendError(e("translate")("personalization.error.gettingslotrestrictions"))}),function(){var e=o.getCombinedView();e.enabled&&(e.selectedItems||[]).forEach(function(e,n){var i=t.selectedCustomizationCode===e.customization.code;i=i&&t.selectedVariationCode===e.variation.code;var a=n%Object.keys(d).length;i&&(t.letterIndicatorForElement=String.fromCharCode("a".charCodeAt()+a).toUpperCase(),t.colorIndicatorForElement=d[a].listClass)})}()}]).controller("modalAddActionController",["$scope",function(t){t.action={}}]).controller("modalEditActionController",["$scope","$filter",function(t,e){t.action={selected:e("filter")(t.actions,{id:"use"},!0)[0]}}]).controller("modalDeleteActionController",["$scope","$q","personalizationsmarteditRestService",function(t,e,n){t.modalManager.setButtonHandler(function(i){if("confirmOk"===i){var a={catalog:t.catalog,catalogVersion:t.catalogVersion};return n.deleteAction(t.selectedCustomizationCode,t.selectedVariationCode,t.actionId,a)}return e.defer().reject()})}])},function(t,e){angular.module("customizationsListModule",["personalizationsmarteditCommons","personalizationsmarteditServicesModule","personalizationsmarteditPreviewServiceModule","personalizationsmarteditManageCustomizationViewModule","personalizationsmarteditCustomizeViewServiceModule","smarteditCommonsModule","personalizationsmarteditCommonsModule"]).controller("customizationsListController",["$q","$filter","personalizationsmarteditContextService","personalizationsmarteditRestService","personalizationsmarteditCommerceCustomizationService","personalizationsmarteditMessageHandler","personalizationsmarteditUtils","personalizationsmarteditDateUtils","personalizationsmarteditContextUtils","personalizationsmarteditPreviewService","personalizationsmarteditManager","personalizationsmarteditCustomizeViewProxy","systemEventService",function(t,e,n,i,a,o,r,s,l,c,d,m,u){var p=this,g=function(t,n){i.getCxCmsActionsOnPageForCustomization(t,n).then(function successCallback(e){t.variations.forEach(function(t){var i=e.actions.filter(function(e){return function(t,e){return t.variationCode===e.code&&t.actionCatalog===e.catalog&&t.actionCatalogVersion===e.catalogVersion}(e,t)});t.numberOfAffectedComponents=0===n?0:t.numberOfAffectedComponents,t.numberOfAffectedComponents+=function(t){var e=0;return t.forEach(function(t){e+=parseInt(p.sourceContainersComponentsInfo[t.containerId])||0}),e}(i)});var i=n+1;i<e.pagination.totalPages&&g(t,i)},function errorCallback(){o.sendError(e("translate")("personalization.error.gettingnumberofaffectedcomponentsforvariation"))})},v=function(i){var a=n.getCustomize(),r=(a.selectedComponents||[]).every(function(t){return void 0!==p.sourceContainersComponentsInfo[t]});!r||null===a.selectedComponents||angular.equals(p.sourceContainersComponentsInfo,{})?function(){var n=t.defer();return m.getSourceContainersInfo().then(function successCallback(t){p.sourceContainersComponentsInfo=t,n.resolve()},function errorCallback(){o.sendError(e("translate")("personalization.error.gettingnumberofaffectedcomponentsforvariation")),n.reject()}),n.promise}().finally(function(){g(i,0)}):r&&g(i,0)},f=function(t){i.getVariationsForCustomization(t.code,t).then(function successCallback(e){e.variations.forEach(function(e){e.numberOfAffectedComponents=function(t,e){return(t.filter(function(t){return t.code===e})[0]||{}).numberOfAffectedComponents}(t.variations,e.code)}),t.variations=e.variations||[],t.variations.forEach(function(t){t.numberOfCommerceActions=a.getCommerceActionsCount(t),t.commerceCustomizations=a.getCommerceActionsCountMap(t)}),v(t)},function errorCallback(){o.sendError(e("translate")("personalization.error.gettingcustomization"))})},z=function(t,a,r,s){i.getComponenentsIdsForVariation(t,a,r,s).then(function successCallback(t){var e=n.getCustomize();e.selectedComponents=t.components,n.setCustomize(e)},function errorCallback(){o.sendError(e("translate")("personalization.error.gettingcomponentsforvariation"))})},h=function(t,e){var n=r.getVariationKey(t,e);c.updatePreviewTicketWithVariations(n)};this.initCustomization=function(t){t.collapsed=!0,(n.getCustomize().selectedCustomization||{}).code===t.code&&(t.collapsed=!1,f(t)),r.getAndSetCatalogVersionNameL10N(t)},this.editCustomizationAction=function(t){l.clearCombinedViewContextAndReloadPreview(c,n),d.openEditCustomizationModal(t.code)},this.customizationRowClick=function(t,e){this.clearAllSubMenu(),t.collapsed=!t.collapsed,t.collapsed||f(t),e&&this.customizationClick(t),p.customizationsList.filter(function(e){return t.code!==e.code}).forEach(function(t){t.collapsed=!0})},this.customizationClick=function(t){var e=n.getCombinedView(),i=n.getCustomize().selectedVariations,a=function(t){return r.getVisibleItems(t.variations)}(t),o=n.getCustomize();if(o.selectedCustomization=t,o.selectedVariations=a,n.setCustomize(o),a.length>0){var s=r.getVariationCodes(a).join(",");z(t.code,s,t.catalog,t.catalogVersion)}(angular.isObject(i)&&!angular.isArray(i)||e.enabled)&&h(),e.enabled=!1,n.setCombinedView(e)},this.getSelectedVariationClass=function(t){if(angular.equals(t.code,(n.getCustomize().selectedVariations||{}).code))return"selectedVariation"},this.getSelectedCustomizationClass=function(t){if(angular.equals(t.code,(n.getCustomize().selectedCustomization||{}).code)&&angular.isArray(n.getCustomize().selectedVariations))return"selectedCustomization"},this.variationClick=function(t,e){var i=n.getCustomize();i.selectedCustomization=t,i.selectedVariations=e,n.setCustomize(i);var a=n.getCombinedView();a.enabled=!1,n.setCombinedView(a),z(t.code,e.code,t.catalog,t.catalogVersion),h(t.code,[e])},this.hasCommerceActions=function(t){return r.hasCommerceActions(t)},this.getCommerceCustomizationTooltip=function(t,e,n){return r.getCommerceCustomizationTooltipHTML(t,e,n)},this.getActivityStateForCustomization=function(t){return r.getActivityStateForCustomization(t)},this.getActivityStateForVariation=function(t,e){return r.getActivityStateForVariation(t,e)},this.clearAllSubMenu=function(){angular.forEach(p.customizationsList,function(t){t.subMenu=!1})},this.getEnablementTextForCustomization=function(t){return r.getEnablementTextForCustomization(t,"personalization.toolbar.pagecustomizations")},this.getEnablementTextForVariation=function(t){return r.getEnablementTextForVariation(t,"personalization.toolbar.pagecustomizations")},this.isEnabled=function(t){return r.isPersonalizationItemEnabled(t)},this.getDatesForCustomization=function(t){var e="",n="",i="";return(t.enabledStartDate||t.enabledEndDate)&&(n=s.formatDateWithMessage(t.enabledStartDate),i=s.formatDateWithMessage(t.enabledEndDate),t.enabledStartDate||(n=" ..."),t.enabledEndDate||(i="... "),e+=" ("+n+" - "+i+") "),e},this.customizationSubMenuAction=function(t){t.subMenu||p.clearAllSubMenu(),t.subMenu=!t.subMenu},this.isCustomizationFromCurrentCatalog=function(t){return r.isItemFromCurrentCatalog(t,n.getSeData())},this.$onInit=function(){p.sourceContainersComponentsInfo={},u.registerEventHandler("CUSTOMIZATIONS_MODIFIED",function(){return function(){var t=angular.copy(n.getCustomize());t.selectedCustomization&&i.getCustomization(t.selectedCustomization).then(function successCallback(e){t.selectedCustomization=e,t.selectedVariations&&!angular.isArray(t.selectedVariations)&&e.variations.filter(function(e){return t.selectedVariations.code===e.code}).forEach(function(e){t.selectedVariations=e,r.isItemVisible(e)||(t.selectedCustomization=null,t.selectedVariations=null,c.removePersonalizationDataFromPreview())}),n.setCustomize(t)},function errorCallback(){o.sendError(e("translate")("personalization.error.gettingcustomization"))})}(),t.when()})}}]).component("customizationsList",{templateUrl:"customizationsListTemplate.html",controller:"customizationsListController",controllerAs:"ctrl",transclude:!0,bindings:{customizationsList:"<",requestProcessing:"<"}})},function(t,e){angular.module("personalizationsmarteditCustomizeViewModule",["personalizationsmarteditCommons","personalizationsmarteditCommonsModule","personalizationsmarteditServicesModule","personalizationsmarteditDataFactory","customizationsListModule","catalogFilterDropdownModule","hasMulticatalogModule","statusFilterDropdownModule","pageFilterDropdownModule"]).controller("personalizationsmarteditCustomizeViewController",["$filter","customizationDataFactory","PaginationHelper","personalizationsmarteditContextService","personalizationsmarteditMessageHandler","personalizationsmarteditUtils","PERSONALIZATION_CUSTOMIZATION_PAGE_FILTER",function(t,e,n,i,a,o,r){var s=this,l=function(){a.sendError(t("translate")("personalization.error.gettingcustomizations")),s.moreCustomizationsRequestProcessing=!1},c=function(t){s.pagination=new n(t.pagination),s.moreCustomizationsRequestProcessing=!1},d=function(t){var n={filter:t,dataArrayName:"customizations"};e.updateData(n,c,l)},m=function(){var t={currentSize:s.pagination.count,currentPage:s.pagination.page+1,name:s.nameFilter,statuses:(void 0===s.statusFilter?o.getStatusesMapping()[0]:o.getStatusesMapping().filter(function(t){return t.code===s.statusFilter})[0]).modelStatuses,catalogs:s.catalogFilter};return s.pageFilter===r.ONLY_THIS_PAGE&&(t.pageId=i.getSeData().pageId,t.pageCatalogId=(i.getSeData().seExperienceData.pageContext||{}).catalogId),t},u=function(){s.moreCustomizationsRequestProcessing||(s.moreCustomizationsRequestProcessing=!0,s.pagination.reset(),e.resetData(),d(m()))};this.catalogFilerChange=function(t){s.catalogFilter=t,u()},this.pageFilerChange=function(t){s.pageFilter=t,u()},this.statusFilerChange=function(t){s.statusFilter=t,u()},this.nameInputKeypress=function(t){(13===t.which||s.nameFilter.length>2||0===s.nameFilter.length)&&u()},this.addMoreCustomizationItems=function(){s.pagination.page<s.pagination.totalPages-1&&!s.moreCustomizationsRequestProcessing&&(s.moreCustomizationsRequestProcessing=!0,d(m()))},this.$onInit=function(){i.refreshExperienceData(),s.pagination=new n,s.pagination.reset(),s.moreCustomizationsRequestProcessing=!1,s.customizationsList=e.items,e.resetData();var t=i.getCustomizeFiltersState();s.catalogFilter=t.catalogFilter,s.pageFilter=t.pageFilter,s.statusFilter=t.statusFilter,s.nameFilter=t.nameFilter},this.$onDestroy=function(){var t=i.getCustomizeFiltersState();t.catalogFilter=s.catalogFilter,t.pageFilter=s.pageFilter,t.statusFilter=s.statusFilter,t.nameFilter=s.nameFilter,i.setCustomizeFiltersState(t)},this.$onChanges=function(t){t.isMenuOpen&&t.isMenuOpen.currentValue&&u()}}]).component("personalizationsmarteditCustomizeView",{templateUrl:"personalizationsmarteditCustomizeViewTemplate.html",controller:"personalizationsmarteditCustomizeViewController",controllerAs:"ctrl",transclude:!0,bindings:{isMenuOpen:"<"}})},function(t,e){angular.module("personalizationsmarteditCustomizeViewServiceModule",["smarteditRootModule"]).factory("personalizationsmarteditCustomizeViewProxy",["gatewayProxy",function(t){var e=function(){this.gatewayId="personalizationsmarteditCustomizeViewGateway",t.initForService(this)};return e.prototype.getSourceContainersInfo=function(){},new e}])},function(t,e){angular.module("personalizationsmarteditDataFactory",["personalizationsmarteditServicesModule"]).factory("customizationDataFactory",["personalizationsmarteditRestService",function(t){var e={},n={},i="customizations",a=function(){},o=function(){},r=function(n){t.getCustomizations(n).then(function(t){Array.prototype.push.apply(e.items,t[i]),a(t)},function(t){o(t)})};return e.items=[],e.updateData=function(t,e,s){n=(t=t||{}).filter||n,i=t.dataArrayName||i,e&&"function"==typeof e&&(a=e),s&&"function"==typeof s&&(o=s),r(n)},e.refreshData=function(){if(!angular.equals({},n)){var t={};angular.copy(n,t),t.currentSize=e.items.length,t.currentPage=0,e.resetData(),r(t)}},e.resetData=function(){e.items.length=0},e.pushData=function(t){angular.isObject(t)&&(angular.isArray(t)?Array.prototype.push.apply(e.items,t):e.items.push(t))},e}])},function(t,e){angular.module("personalizationsmarteditCommerceCustomizationModule",["modalServiceModule","personalizationsmarteditCommons","personalizationsmarteditCommonsModule","smarteditCommonsModule","personalizationsmarteditServicesModule","confirmationModalServiceModule"]).constant("PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES",{OLD:"old",NEW:"new",DELETE:"delete",UPDATE:"update"}).factory("personalizationsmarteditCommerceCustomizationView",["$controller","modalService","MODAL_BUTTON_ACTIONS","MODAL_BUTTON_STYLES",function(t,e,n,i){var a={openCommerceCustomizationAction:function(a,o){e.open({title:"personalization.modal.commercecustomization.title",templateUrl:"personalizationsmarteditCommerceCustomizationViewTemplate.html",controller:["$scope","modalManager",function(e,n){e.customization=a,e.variation=o,e.modalManager=n,angular.extend(this,t("personalizationsmarteditCommerceCustomizationViewController",{$scope:e}))}],buttons:[{id:"confirmCancel",label:"personalization.modal.commercecustomization.button.cancel",style:i.SECONDARY,action:n.CLOSE},{id:"confirmSave",label:"personalization.modal.commercecustomization.button.submit",action:n.CLOSE}]}).then(function(){},function(){})}};return a}]).factory("actionsDataFactory",["PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES",function(t){var e={actions:[],removedActions:[],getActions:function(){return e.actions},getRemovedActions:function(){return e.removedActions},resetActions:function(){e.actions.length=0},resetRemovedActions:function(){e.removedActions.length=0},addAction:function(n,i){var a=!1;if(e.actions.forEach(function(t){a=a||i(n,t.action)}),!a){var o=t.NEW,r=-1;e.removedActions.forEach(function(t,e){i(n,t.action)&&(r=e)}),r>=0&&(o=t.OLD,e.removedActions.splice(r,1)),e.actions.push({action:n,status:o})}},isItemInSelectedActions:function(t,n){return e.actions.find(function(e){return n(t,e.action)})}};return e}]).controller("personalizationsmarteditCommerceCustomizationViewController",["$scope","$filter","$q","$log","actionsDataFactory","personalizationsmarteditRestService","personalizationsmarteditMessageHandler","systemEventService","personalizationsmarteditCommerceCustomizationService","personalizationsmarteditContextService","personalizationsmarteditUtils","confirmationModalService","PERSONALIZATION_COMMERCE_CUSTOMIZATION_ACTION_STATUSES",function(t,e,n,i,a,o,r,s,l,c,d,m,u){t.availableTypes=[],t.select={},a.resetActions(),a.resetRemovedActions(),t.actions=a.getActions(),t.removedActions=a.getRemovedActions();var p=function(e){for(var n=0;n<t.availableTypes.length;++n)if(t.availableTypes[n].type===e)return t.availableTypes[n];return{}},g=function(){s.sendSynchEvent("CUSTOMIZATIONS_MODIFIED",{})},v=function(){return t.isDirty()?m.confirm({description:"personalization.modal.commercecustomization.cancelconfirmation"}).then(function(){return n.resolve()},function(){return n.reject()}):n.resolve()};t.getActionsToDisplay=function(){return a.getActions()},t.isItemInSelectedActions=function(t,e){return a.isItemInSelectedActions(t,e)},t.displayAction=function(t){var e=t.action,n=p(e.type);return n.getName?n.getName(e):e.code},t.addAction=function(t,e){a.addAction(t,e)},t.removeSelectedAction=function(e){var n=t.actions.indexOf(e);if(!(n<0)){var i=t.actions.splice(n,1);i[0].status!==u.OLD&&i[0].status!==u.UPDATE||(i[0].status=u.DELETE,t.removedActions.push(i[0]))}},t.isDirty=function(){var e=!1;return t.actions.forEach(function(t){e=e||t.status===u.NEW||t.status===u.UPDATE}),e=e||t.removedActions.length>0},t.customizationStatusText=d.getEnablementTextForCustomization(t.customization,"personalization.modal.commercecustomization"),t.variationStatusText=d.getEnablementTextForVariation(t.variation,"personalization.modal.commercecustomization"),t.customizationStatus=d.getActivityStateForCustomization(t.customization),t.variationStatus=d.getActivityStateForVariation(t.customization,t.variation);var f=function(n,a,o,s,l){(function(e){return e.map(function(t){return t.type}).filter(function(t,e,n){return n.indexOf(t)===e}).map(function(e){return t.availableTypes.filter(function(t){return t.type===e})[0]})})(o.actions).forEach(function(t){if(t.updateActions){var c=o.actions.filter(function(e){return p(e.type)===t});t.updateActions(n,a,c,s,l).then(function successCallback(){r.sendSuccess(e("translate")("personalization.info.updatingactions")),g()},function errorCallback(){r.sendError(e("translate")("personalization.error.updatingactions"))})}else i.debug(e("translate")("personalization.error.noupdatingactions"))})};t.onSave=function(){var i={actions:t.actions.filter(function(t){return t.status===u.NEW}).map(function(t){return t.action})},a=t.removedActions.filter(function(t){return t.status===u.DELETE}).map(function(t){return t.action.code}),s={actions:t.actions.filter(function(t){return t.status===u.UPDATE}).map(function(t){return t.action})},l=i.actions.length>0,c=a.length>0,d=s.actions.length>0;(l?function(t,i,a){var s=n.defer();return o.createActions(t,i,a).then(function successCallback(t){r.sendSuccess(e("translate")("personalization.info.creatingaction")),g(),s.resolve(t)},function errorCallback(){r.sendError(e("translate")("personalization.error.creatingaction")),s.reject()}),s.promise}(t.customization.code,t.variation.code,i):n.resolve()).then(function(i){(c?function(t,i,a){var s=n.defer();return o.deleteActions(t,i,a).then(function successCallback(t){r.sendSuccess(e("translate")("personalization.info.removingaction")),g(),s.resolve(t)},function errorCallback(){r.sendError(e("translate")("personalization.error.removingaction")),s.resolve()}),s.promise}(t.customization.code,t.variation.code,a):n.resolve()).then(function(e){d&&f(t.customization.code,t.variation.code,s,i,e)})})},t.$watch("actions",function(){t.isDirty()?t.modalManager.enableButton("confirmSave"):t.modalManager.disableButton("confirmSave")},!0),t.modalManager.setButtonHandler(function(e){if("confirmSave"===e)t.onSave();else if("confirmCancel"===e)return v()}),t.modalManager.setDismissCallback(function(){return v()}),t.availableTypes=l.getAvailableTypes(c.getSeData().seConfigurationData),t.select={type:t.availableTypes[0]},o.getActions(t.customization.code,t.variation.code).then(function successCallback(t){var e=t.actions.filter(function(t){return"cxCmsActionData"!==t.type}).map(function(t){return{action:t,status:u.OLD}});a.resetActions(),Array.prototype.push.apply(a.getActions(),e)},function errorCallback(){r.sendError(e("translate")("personalization.error.gettingactions"))})}])},function(t,e){angular.module("personalizationsmarteditSegmentViewModule",["modalServiceModule","personalizationsmarteditCommons","personalizationsmarteditCommonsModule","personalizationsmarteditServicesModule","confirmationModalServiceModule","personalizationsmarteditManageCustomizationViewModule","personalizationsmarteditCommerceCustomizationModule","personalizationsmarteditDataFactory","ui.tree","personalizationsmarteditSegmentExpressionAsHtml","personalizationsmarteditManagementModule"]).controller("personalizationsmarteditSegmentViewController",["personalizationsmarteditRestService","personalizationsmarteditMessageHandler","personalizationsmarteditTriggerService","PaginationHelper","$timeout","$filter","confirmationModalService","triggerTabService",function(t,e,n,i,a,o,r,s){var l=this;this.actions=n.actions;var c=0;Object.defineProperty(this,"elementToScrollHeight",{get:function(){return c},set:function(t){c=t}});var d=function(t,e,n){return this===t?(n.splice(e,0,angular.copy(this)),!0):(l.isContainer(t)&&t.nodes.some(d,this),!1)},m={type:"dropzone"},u=[{type:"container",operation:l.actions[0],nodes:[m]}],p=function(t){t.forEach(function(t,e,n){l.isDropzone(t)&&n.splice(e,1)})},g=function(t){t.forEach(function(t){l.isEmptyContainer(t)&&t.nodes.push(m),l.isContainer(t)&&g(t.nodes)})};this.treeOptions={dragStart:function(){l.scrollZoneVisible=l.isScrollZoneVisible()},dropped:function(t){l.scrollZoneVisible=!1,p(t.dest.nodesScope.$modelValue),a(function(){g(l.expression)},0)},dragMove:function(t){l.highlightedContainer=t.dest.nodesScope.$nodeScope.$modelValue.$$hashKey,l.isScrollZoneVisible()!==l.scrollZoneVisible?l.scrollZoneVisible=l.isScrollZoneVisible():Math.abs(l.elementToScrollHeight-l.elementToScroll.get(0).scrollHeight)>10&&(l.elementToScrollHeight=l.elementToScroll.get(0).scrollHeight,l.scrollZoneVisible=!1)}},this.isScrollZoneVisible=function(){return l.elementToScroll.get(0).scrollHeight>l.elementToScroll.get(0).clientHeight},this.getElementToScroll=function(){return l.elementToScroll},this.removeItem=function(t){n.isNotEmptyContainer(t.$modelValue)&&!l.isContainerWithDropzone(t.$modelValue)?r.confirm({description:o("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.segments.removecontainerconfirmation")}).then(function(){t.remove(),a(function(){g(l.expression)},0)}):(t.remove(),a(function(){g(l.expression)},0))},this.duplicateItem=function(t){l.expression[0].nodes.some(d,t)},this.toggle=function(t){t.toggle()},this.newSubItem=function(t,e){var n=t.$modelValue;p(n.nodes),n.nodes.unshift({type:e,operation:"item"===e?"":l.actions[0],nodes:[m]}),t.expand(),a(function(){t.childNodes()[0].expand()},0)},this.segments=[],this.segmentPagination=new i,this.segmentPagination.reset(),this.segmentFilter={code:""},this.segmentSearchInputKeypress=function(t,e){t&&[37,38,39,40].indexOf(t.which)>-1||(l.segmentPagination.reset(),l.segmentFilter.code=e,l.segments.length=0,l.addMoreSegmentItems())},this.segmentSelectedEvent=function(t){l.expression[0].nodes.unshift({type:"item",operation:"",selectedSegment:t,nodes:[]}),l.singleSegment=null,l.highlightedContainer=l.expression[0].$$hashKey,p(l.expression[0].nodes)},this.moreSegmentRequestProcessing=!1,this.addMoreSegmentItems=function(){l.segmentPagination.page<l.segmentPagination.totalPages-1&&!l.moreSegmentRequestProcessing&&(l.moreSegmentRequestProcessing=!0,t.getSegments({code:l.segmentFilter.code,pageSize:l.segmentPagination.count,currentPage:l.segmentPagination.page+1}).then(function successCallback(t){Array.prototype.push.apply(l.segments,t.segments),l.segmentPagination=new i(t.pagination),l.moreSegmentRequestProcessing=!1},function errorCallback(){e.sendError(o("translate")("personalization.error.gettingsegments")),l.moreSegmentRequestProcessing=!1}))},this.isTopContainer=function(t){return angular.equals(l.expression[0],t.node)},this.isEmptyContainer=function(t){return l.isContainer(t)&&0===t.nodes.length},this.isContainerWithDropzone=function(t){return l.isContainer(t)&&1===t.nodes.length&&l.isDropzone(t.nodes[0])},this.isItem=function(t){return n.isItem(t)},this.isDropzone=function(t){return n.isDropzone(t)},this.isContainer=function(t){return n.isContainer(t)},this.isHighlightedContainer=function(t){return t.$$hashKey===l.highlightedContainer},this.$onInit=function(){l.triggers=l.triggers||(s.getTriggerDataState().selectedVariation||{}).triggers,l.expression=l.expression||s.getTriggerDataState().expression,l.triggers&&l.triggers.length>0?l.expression=n.buildData(l.triggers):l.expression=angular.copy(u),s.getTriggerDataState().expression=l.expression,l.elementToScroll=angular.element(".sliderpanel-body")}}]).component("multiSegmentView",{templateUrl:"personalizationsmarteditSegmentViewTemplate.html",controller:"personalizationsmarteditSegmentViewController",controllerAs:"ctrl",bindings:{triggers:"<?",expression:"=?"}})},function(t,e){angular.module("personalizationsmarteditSegmentExpressionAsHtml",["personalizationsmarteditManageCustomizationViewModule"]).controller("personalizationsmarteditSegmentExpressionAsHtmlController",["personalizationsmarteditTriggerService",function(t){var e=this,n={};Object.defineProperty(this,"segmentExpression",{get:function(){return n},set:function(t){n=t}});var i=["AND","OR","NOT"];Object.defineProperty(this,"operators",{get:function(){return i}});Object.defineProperty(this,"emptyGroup",{get:function(){return"[]"}});var a=e.operators.concat("[]");Object.defineProperty(this,"emptyGroupAndOperators",{get:function(){return a}}),this.getExpressionAsArray=function(){return angular.isDefined(e.segmentExpression)&&!angular.isDefined(e.segmentExpression.operation)&&(e.segmentExpression=t.buildData(e.segmentExpression)[0]),t.getExpressionAsString(e.segmentExpression).split(" ")},this.getLocalizationKeyForOperator=function(t){return"personalization.modal.customizationvariationmanagement.targetgrouptab.expression."+t.toLowerCase()}}]).component("personalizationsmarteditSegmentExpressionAsHtml",{templateUrl:"personalizationsmarteditSegmentExpressionAsHtmlTemplate.html",controller:"personalizationsmarteditSegmentExpressionAsHtmlController",controllerAs:"ctrl",transclude:!0,bindings:{segmentExpression:"<"}})},function(t,e){angular.module("personalizationsmarteditManagerViewModule",["modalServiceModule","personalizationsmarteditCommons","personalizationsmarteditCommonsModule","personalizationsmarteditServicesModule","confirmationModalServiceModule","personalizationsmarteditManageCustomizationViewModule","personalizationsmarteditCommerceCustomizationModule","smarteditCommonsModule","personalizationsmarteditDataFactory","personalizationsmarteditCommonsModule","waitDialogServiceModule","ui.tree"]).factory("personalizationsmarteditManagerView",["modalService",function(t){var e={openManagerAction:function(){t.open({title:"personalization.modal.manager.title",templateUrl:"personalizationsmarteditManagerViewTemplate.html",controller:"personalizationsmarteditManagerViewController",size:"fullscreen",cssClasses:"perso-library"}).then(function(){},function(){})}};return e}]).controller("personalizationsmarteditManagerViewController",["$q","$scope","$filter","$timeout","confirmationModalService","personalizationsmarteditRestService","personalizationsmarteditMessageHandler","personalizationsmarteditContextService","personalizationsmarteditManager","systemEventService","personalizationsmarteditUtils","personalizationsmarteditDateUtils","personalizationsmarteditCommerceCustomizationView","personalizationsmarteditCommerceCustomizationService","PERSONALIZATION_VIEW_STATUS_MAPPING_CODES","PERSONALIZATION_MODEL_STATUS_CODES","PaginationHelper","waitDialogService",function(t,e,n,i,a,o,r,s,l,c,d,m,u,p,g,v,f,z){var h=function(){e.pagination.reset(),e.customizations.length=0,e.addMoreItems()},C=function(){return e.statuses.filter(function(t){return t.code===g.ALL})[0]},b=function(e,i){var a=t.defer();return o.updateCustomizationRank(e,i).then(function successCallback(){a.resolve()},function errorCallback(){r.sendError(n("translate")("personalization.error.updatingcustomization")),a.reject()}),a.promise},S=function(e,i,a){var s=t.defer();return o.getVariation(e.code,i).then(function successCallback(t){t.rank=t.rank+a,o.editVariation(e.code,t).then(function successCallback(){s.resolve()},function errorCallback(){r.sendError(n("translate")("personalization.error.editingvariation")),s.reject()})},function errorCallback(){r.sendError(n("translate")("personalization.error.gettingvariation")),s.reject()}),s.promise},T=function(t,e,n,i,a){var o=a>0?i.source.index:i.dest.index,r=a>0?i.dest.index:i.source.index;n[i.dest.index].rank=e.rank;for(var s=o;s<=r;s++)s!==i.dest.index&&(n[s].rank+=a>0?-1:1)},_=function(t){for(var e=0;e<t.length-1;e++)if(t[e].rank>t[e+1].rank){h();break}},y=s.getSeData().seExperienceData,A=y.languageDescriptor.isocode;e.catalogName=y.catalogDescriptor.name[A],e.catalogName+=" - "+y.catalogDescriptor.catalogVersion,e.customizations=[],e.filteredCustomizationsCount=0,e.scrollZoneElement=void 0,e.statuses=d.getStatusesMapping(),e.search={name:"",status:C()},e.moreCustomizationsRequestProcessing=!1,e.addMoreItems=function(){e.pagination.page<e.pagination.totalPages-1&&!e.moreCustomizationsRequestProcessing&&(e.moreCustomizationsRequestProcessing=!0,function(t){o.getCustomizations(t).then(function successCallback(t){Array.prototype.push.apply(e.customizations,t.customizations),e.filteredCustomizationsCount=t.pagination.totalCount,e.pagination=new f(t.pagination),e.moreCustomizationsRequestProcessing=!1},function errorCallback(){r.sendError(n("translate")("personalization.error.gettingcustomizations")),e.moreCustomizationsRequestProcessing=!1})}({active:"all",name:e.search.name,currentSize:e.pagination.count,currentPage:e.pagination.page+1,statuses:e.search.status.modelStatuses}))},e.pagination=new f,e.pagination.reset(),e.searchInputKeypress=function(t){(13===t.which||e.search.name.length>2||0===e.search.name.length)&&h()},e.resetSearchInput=function(){e.search.name="",e.search.status=C(),h()},e.editCustomizationAction=function(t){l.openEditCustomizationModal(t.code)},e.deleteCustomizationAction=function(t){a.confirm({description:"personalization.modal.manager.deletecustomization.content"}).then(function(){o.getCustomization(t).then(function successCallback(i){i.status="DELETED",o.updateCustomization(i).then(function successCallback(){e.customizations.splice(e.customizations.indexOf(t),1)},function errorCallback(){r.sendError(n("translate")("personalization.error.deletingcustomization"))})},function errorCallback(){r.sendError(n("translate")("personalization.error.deletingcustomization"))})})},e.editVariationAction=function(t,e){l.openEditCustomizationModal(t.code,e.code)},e.isCommerceCustomizationEnabled=function(){return p.isCommerceCustomizationEnabled(s.getSeData().seConfigurationData)},e.manageCommerceCustomization=function(t,e){u.openCommerceCustomizationAction(t,e)},e.isDeleteVariationEnabled=function(t){return d.getVisibleItems(t.variations).length>1},e.deleteVariationAction=function(t,i,s){e.isDeleteVariationEnabled(t)?a.confirm({description:"personalization.modal.manager.deletevariation.content"}).then(function(){o.getVariation(t.code,i.code).then(function successCallback(e){e.status="DELETED",o.editVariation(t.code,e).then(function successCallback(t){i.status=t.status},function errorCallback(){r.sendError(n("translate")("personalization.error.deletingvariation"))})},function errorCallback(){r.sendError(n("translate")("personalization.error.deletingvariation"))})}):s.stopPropagation()},e.openNewModal=function(){l.openCreateCustomizationModal()},e.toogleVariationActive=function(t,e){o.getVariation(t.code,e.code).then(function successCallback(i){i.enabled=!i.enabled,i.status=i.enabled?v.ENABLED:v.DISABLED,o.editVariation(t.code,i).then(function successCallback(t){e.enabled=t.enabled,e.status=t.status},function errorCallback(){r.sendError(n("translate")("personalization.error.editingvariation"))})},function errorCallback(){r.sendError(n("translate")("personalization.error.gettingvariation"))})},e.isUndefined=function(t){return void 0===t},e.customizationClickAction=function(e){var i=t.defer();return o.getVariationsForCustomization(e.code,e).then(function successCallback(t){e.variations.forEach(function(e){e.actions=function(t,e){var n=(e=e||[]).filter(function(e){return t===e.code})[0];return n?n.actions:[]}(e.code,t.variations),e.numberOfComponents=p.getNonCommerceActionsCount(e),e.commerceCustomizations=p.getCommerceActionsCountMap(e),e.numberOfCommerceActions=p.getCommerceActionsCount(e)}),i.resolve()},function errorCallback(){r.sendError(n("translate")("personalization.error.gettingcustomization")),i.reject()}),i.promise},e.hasCommerceActions=function(t){return d.hasCommerceActions(t)},e.getCommerceCustomizationTooltip=function(t){return d.getCommerceCustomizationTooltipHTML(t)},e.getFormattedDate=function(t){return t?m.formatDate(t):""},e.getEnablementTextForCustomization=function(t){return d.getEnablementTextForCustomization(t,"personalization.modal.manager")},e.getEnablementTextForVariation=function(t){return d.getEnablementTextForVariation(t,"personalization.modal.manager")},e.getEnablementActionTextForVariation=function(t){return d.getEnablementActionTextForVariation(t,"personalization.modal.manager")},e.getActivityStateForCustomization=function(t){return d.getActivityStateForCustomization(t)},e.getActivityStateForVariation=function(t,e){return d.getActivityStateForVariation(t,e)},e.allCustomizationsCollapsed=function(){return e.customizations.map(function(t){return t.isCollapsed}).reduce(function(t,e){return t&&e},!0)},e.isReturnToTopButtonVisible=function(){return e.scrollZoneElement.scrollTop()>50},e.scrollZoneReturnToTop=function(){e.scrollZoneElement.animate({scrollTop:0},500)},e.treeOptions={dragStart:function(t){e.scrollZoneVisible=e.isScrollZoneVisible(),t.source.nodeScope.$modelValue.isDragging=!0},dragStop:function(t){t.source.nodeScope.$modelValue.isDragging=void 0},dropped:function(t){e.scrollZoneVisible=!1;var n=t.source.nodeScope.$modelValue;t.source.index!==t.dest.index&&(n.variations?function(t,n){var a=e.customizations[n.dest.index],o=a.rank-t.rank;0!==o&&(z.showWaitModal(),b(t.code,o).then(function successCallback(){T(0,a,e.customizations,n,o),i(function(){_(e.customizations)},100)}).finally(function(){z.hideWaitModal()}))}(n,t):function(t,e){var n=e.source.nodesScope.$modelValue[e.dest.index],a=n.rank-t.rank,o=e.source.nodesScope.$parent.$modelValue;0!==a&&(z.showWaitModal(),S(o,t.code,a).then(function successCallback(){T(0,n,o.variations,e,a),i(function(){_(o.variations)},100)}).finally(function(){z.hideWaitModal()}))}(n,t))},accept:function(t,e){return!!(angular.isArray(e.$modelValue)&&e.$modelValue.indexOf(t.$modelValue)>-1)}},e.isScrollZoneVisible=function(){return e.scrollZoneElement.get(0).scrollHeight>e.scrollZoneElement.get(0).clientHeight},e.isSearchResultHidden=function(){return e.scrollZoneElement.scrollTop()>=125},e.isSearchGridHeaderHidden=function(){return e.scrollZoneElement.scrollTop()>=220},e.setScrollZoneElement=function(t){e.scrollZoneElement=t},e.getElementToScroll=function(){return e.scrollZoneElement},e.statusNotDeleted=function(t){return d.isItemVisible(t)},e.isFilterEnabled=function(){return""!==e.search.name||e.search.status!==C()},e.setCustomizationRank=function(t,n){var i=e.customizations[e.customizations.indexOf(t)+n];z.showWaitModal(),b(t.code,i.rank-t.rank).then(function successCallback(){t.rank+=n,i.rank-=n;var a=e.customizations.indexOf(t),o=e.customizations.splice(a,1);e.customizations.splice(a+n,0,o[0])}).finally(function(){z.hideWaitModal()})},e.setVariationRank=function(t,e,n){var i=t.variations[t.variations.indexOf(e)+n];z.showWaitModal(),S(t,e.code,n).then(function successCallback(){e.rank+=n,i.rank-=n;var a=t.variations.indexOf(e),o=t.variations.splice(a,1);t.variations.splice(a+n,0,o[0])}).finally(function(){z.hideWaitModal()})},e.$watch("search.status",function(t,e){t!==e&&h()},!0),c.registerEventHandler("CUSTOMIZATIONS_MODIFIED",function(){return h(),t.when()})}])},function(t,e){angular.module("personalizationsmarteditPreviewServiceModule",["experienceServiceModule"]).factory("personalizationsmarteditPreviewService",["experienceService",function(t){var e={removePersonalizationDataFromPreview:function(){return e.updatePreviewTicketWithVariations([])},updatePreviewTicketWithVariations:function(e){return t.getCurrentExperience().then(function(n){if(n)return n.variations=e,t.setCurrentExperience(n).then(function(){return t.updateExperience()})})}};return e}])},function(t,e){angular.module("personalizationsmarteditRulesAndPermissionsRegistrationModule",["permissionServiceModule","personalizationsmarteditServicesModule"]).run(["$q","permissionService","personalizationsmarteditRestService","personalizationsmarteditContextService",function(t,e,n,i){e.registerRule({names:["se.access.personalization"],verify:function(){return i.refreshExperienceData().then(function(){return n.getCustomizations({currentPage:0,currentSize:1}).then(function(){return t.when(!0)},function(e){return 403===e.status?t.when(!1):t.when(!0)})})}}),e.registerPermission({aliases:["se.personalization.open"],rules:["se.read.page","se.access.personalization"]})}])},function(t,e){angular.module("personalizationsmarteditcontainerTemplates",[]).run(["$templateCache",function(t){"use strict";t.put("web/features/personalizationsmarteditcontainer/combinedView/personalizationsmarteditCombinedViewConfigureTemplate.html",'<form>\n    <div class="form-group">\n        <div class="pe-combinedview-config__select-group-layout">\n            <div class="pe-combinedview-config__select-group-label-layout">\n                <label for="CombinedViewSearchField1"\n                    class="control-label required pe-combinedview-config__label"\n                    data-translate="personalization.modal.combinedview.search.label"></label>\n                <div class="pe-combinedview-config__filter-layout">\n                    <label for="PageFilterDropdownField001"\n                        class="personalization-modal__label pe-combinedview-config__filter-label"\n                        data-translate="personalization.commons.filter.label"></label>\n                    <page-filter-dropdown id="PageFilterDropdownField001"\n                        data-on-select-callback="pageFilerChange(value)"></page-filter-dropdown>\n                    <has-multicatalog>\n                        <catalog-filter-dropdown data-on-select-callback="catalogFilerChange(value)" />\n                    </has-multicatalog>\n                </div>\n            </div>\n            <ui-select data-ng-init="initUiSelect($select)"\n                ng-model="selectedElement"\n                theme="select2"\n                class="form-control"\n                ng-keyup="searchInputKeypress($event, $select.search)"\n                on-select="selectElement($item)"\n                reset-search-input="false"\n                id="CombinedViewSearchField1">\n                <ui-select-match placeholder="{{ \'personalization.modal.combinedview.search.placeholder\' | translate}}">\n                    <span class="pe-combinedview-config__ui-select-placeholder">{{\'personalization.modal.combinedview.search.placeholder\' | translate}}</span>\n                </ui-select-match>\n                <ui-select-choices repeat="item in selectionArray"\n                    position="down"\n                    ui-disable-choice="isItemInSelectDisabled(item)"\n                    personalization-infinite-scroll="addMoreItems()"\n                    personalization-infinite-scroll-distance="1">\n                    <div class="pe-combinedview-config__ui-select-choices-layout"\n                        data-ng-class="{\'pe-combinedview-config__ui-select-item--selected\': isItemSelected(item)}">\n                        <div class="pe-combinedview-config__ui-select-choices-col1">\n                            <div class="perso-wrap-ellipsis"\n                                data-ng-bind="item.customization.name + \' > \' + item.variation.name"\n                                title="{{item.customization.name}} > {{item.variation.name}}">\n                            </div>\n                        </div>\n                        <div class="pe-combinedview-config__ui-select-choices-col2">\n                            <has-multicatalog>\n                                <div data-ng-if="catalogFilter!==\'current\'"\n                                    data-ng-init="getAndSetCatalogVersionNameL10N(item.variation)">\n                                    <div class="perso-wrap-ellipsis"\n                                        data-ng-if="!isItemFromCurrentCatalog(item.variation)"\n                                        data-ng-bind="item.variation.catalogVersionNameL10N"\n                                        title="{{item.variation.catalogVersionNameL10N}}">\n                                    </div>\n                                    <div class="perso-wrap-ellipsis"\n                                        data-ng-if="isItemFromCurrentCatalog(item.variation)"\n                                        data-translate="personalization.filter.catalog.current"\n                                        title="{{\'personalization.filter.catalog.current\' | translate }}">\n                                    </div>\n                                </div>\n                            </has-multicatalog>\n                        </div>\n                    </div>\n                </ui-select-choices>\n            </ui-select>\n        </div>\n    </div>\n    <div class="form-group">\n        <label for="CombinedViewSelectedField1"\n            data-ng-show="selectedItems.length > 0"\n            class="personalization-modal__label pe-combinedview-config__list-label"\n            data-translate="personalization.modal.combinedview.selected.label"></label>\n        <div id="CombinedViewSelectedField1"\n            class="pe-combinedview-config__list-layout"\n            data-ng-repeat="item in selectedItems"\n            data-ng-class="{\'pe-combinedview-config__divider\': $first}">\n            <div class="pe-combinedview-config__letter-layout">\n                <div data-ng-class="getClassForElement($index)"\n                    data-ng-bind="getLetterForElement($index)"></div>\n            </div>\n            <div class="pe-combinedview-config__names-layout">\n                <div class="perso-wrap-ellipsis pe-combinedview-config__cname"\n                    data-ng-bind="item.customization.name"\n                    title="{{item.customization.name}}"></div>\n                <span> ></span>\n                <div class="perso-wrap-ellipsis pe-combinedview-config__vname"\n                    data-ng-bind="item.variation.name"\n                    title="{{item.variation.name}}"></div>\n            </div>\n            <div class="pe-combinedview-config__hyicon-globe">\n                <span data-ng-if="!isItemFromCurrentCatalog(item.variation)"\n                    class="perso__globe-icon hyicon hyicon-globe"\n                    data-uib-tooltip="{{item.variation.catalogVersionNameL10N}}"\n                    data-tooltip-placement="top-right"></span>\n            </div>\n            <div class="pe-combinedview-config__hyicon-remove">\n                <span class="hyicon hyicon-remove"\n                    data-ng-click="removeSelectedItem(item)"\n                    title="{{\'personalization.modal.combinedview.icon.remove.title\' | translate}}"></span>\n            </div>\n        </div>\n    </div>\n</form>'),t.put("web/features/personalizationsmarteditcontainer/combinedView/personalizationsmarteditCombinedViewMenuTemplate.html",'<div data-ng-controller="topToolbarMenuController"\n    data-uib-dropdown\n    data-is-open="item.isOpen"\n    class="btn-group pe-toolbar-action pe-combined-view-menu"\n    data-auto-close="disabled">\n    <button type="button"\n        class="btn btn-default pe-toolbar-action__button"\n        data-uib-dropdown-toggle\n        data-ng-disabled="disabled"\n        aria-pressed="false"\n        data-ng-class="{\'pe-toolbar-action__button-with-context\': isCombinedViewCustomizationSelected()}">\n        <span class="hyicon hyicon-combinedview pe-toolbar-menu-ddlb__button-icon"></span>\n        <span class="pe-toolbar-action__button-txt"\n            data-translate="personalization.toolbar.combinedview.name"></span>\n    </button>\n\n    <personalizationsmartedit-combined-view-toolbar-context></personalizationsmartedit-combined-view-toolbar-context>\n\n    <div data-uib-dropdown-menu\n        class="btn-block pe-toolbar-action--include">\n\n        <ul class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized"\n            role="menu">\n            <div class="se-toolbar-menu-content--pe-customized__headers">\n                <h2 class="se-toolbar-menu-content--pe-customized__headers--h2"\n                    data-translate="personalization.toolbar.combinedview.header.title"></h2>\n                <y-help class="se-toolbar-menu-content__y-help"\n                    data-template="\'<span data-translate=personalization.toolbar.combinedview.header.description></span>\'"></y-help>\n            </div>\n            <div class="pe-combined-view-menu">\n                <div class="pe-combined-view-panel__wrapper"\n                    data-ng-controller="personalizationsmarteditCombinedViewMenuController">\n                    <div class="pe-combined-view-panel__configure-layout">\n                        <button class="btn btn-link pe-combined-view-panel__configure-btn perso-wrap-ellipsis"\n                            data-ng-click="$parent.combinedViewClick()"\n                            data-translate="personalization.toolbar.combinedview.openconfigure.button"\n                            title="{{\'personalization.toolbar.combinedview.openconfigure.button\' | translate}}">\n                        </button>\n                        <div class="perso-toggle">\n                            <label class="personalization-modal__label perso-toggle__label perso-wrap-ellipsis"\n                                data-translate="personalization.toolbar.combinedview.toggle.label"\n                                title="{{\'personalization.toolbar.combinedview.toggle.label\' | translate}}"></label>\n                            <span class="y-toggle y-toggle-lg">\n                                <input type="checkbox"\n                                    id="combinedview-checkbox-1"\n                                    data-ng-change="combinedViewEnabledChangeEvent()"\n                                    data-ng-model="combinedView.enabled" />\n                                <label class="perso-toggle__checkbox-label"\n                                    for="combinedview-checkbox-1"></label>\n                            </span>\n                        </div>\n                    </div>\n                    <div data-ng-class="combinedView.enabled ? \'\':\'pe-combined-view-panel--disabled\'">\n                        <div class="pe-combined-view-panel__list-layout"\n                            data-ng-repeat="item in selectedItems"\n                            data-ng-click="itemClick(item)"\n                            data-ng-class="{\'pe-combined-view-panel-list__item--highlighted\': item.highlighted}">\n                            <div class="pe-combined-view-panel-list__letter-layout">\n                                <div data-ng-class="getClassForElement($index)"\n                                    data-ng-bind="getLetterForElement($index)"></div>\n                            </div>\n                            <div class="pe-combined-view-panel-list__names-layout">\n                                <div class="perso-wrap-ellipsis"\n                                    data-ng-bind="item.customization.name"\n                                    title="{{item.customization.name}}"></div>\n                                <div class="perso-wrap-ellipsis perso-tree__primary-data"\n                                    data-ng-bind="item.variation.name"\n                                    title="{{item.variation.name}}"></div>\n                            </div>\n                            <div class="pe-combined-view-panel-list__icon">\n                                <span data-ng-if="!isItemFromCurrentCatalog(item.variation)"\n                                    class="perso__globe-icon hyicon hyicon-globe"\n                                    data-uib-tooltip="{{item.variation.catalogVersionNameL10N}}"\n                                    data-tooltip-placement="auto top"\n                                    data-tooltip-enable="combinedView.enabled"></span>\n                            </div>\n                        </div>\n                        <div class="pe-spinner--outer"\n                            data-ng-show="moreCustomizationsRequestProcessing">\n                            <div data-ng-include="\'waitDialog.html\'"></div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n        </ul>\n    </div>\n\n</div>'),t.put("web/features/personalizationsmarteditcontainer/commonComponents/catalogVersionFilterDropdownItemTemplate.html",'<div>\n    <span class="hyicon hyicon-globe"\n        data-ng-if="item.isCurrentCatalog === false"></span>\n    <span data-ng-if="item.isCurrentCatalog === false">{{item.catalogName | l10n}} - {{item.catalogVersionId}}</span>\n    <span data-ng-if="item.isCurrentCatalog === true"\n        data-translate="personalization.filter.catalog.current"></span>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/commonComponents/hasMulticatalogTemplate.html",'<div data-ng-if="ctrl.hasMulticatalog">\n    <div data-ng-transclude></div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/commonComponents/pageFilterDropdownTemplate.html",'<y-select class="perso-filter"\n    data-ng-model="ctrl.selectedId"\n    data-on-change="ctrl.onChange"\n    data-fetch-strategy="ctrl.fetchStrategy"\n    data-item-template="::ctrl.itemTemplate"\n    data-search-enabled="false" />'),t.put("web/features/personalizationsmarteditcontainer/contextMenu/personalizationsmarteditAddEditActionTemplate.html",'<div class="perso-customize-component">\n    <div class="perso-customize-component__title-layout">\n        <div data-ng-show=\'letterIndicatorForElement\'\n            class="perso-customize-component__title-layout__letter-block">\n            <span data-ng-class="colorIndicatorForElement"\n                data-ng-bind="letterIndicatorForElement">\n            </span>\n        </div>\n        <div class="perso-customize-component__title-layout__cust-name perso-wrap-ellipsis"\n            data-ng-bind="selectedCustomization.name"\n            title="{{selectedCustomization.name}}">\n        </div>\n        <div class="perso-customize-component__title-layout__target-group-name perso-wrap-ellipsis"\n            data-ng-bind="\'> \'+ selectedVariation.name"\n            title="{{selectedVariation.name}}">\n        </div>\n    </div>\n\n    <dl class="perso-customize-component__data-list">\n        <label class="personalization-modal__label"\n            data-translate="personalization.modal.addeditaction.selected.mastercomponent.title"></label>\n        <dd>{{componentType}}</dd>\n    </dl>\n\n    <label class="control-label required"\n        data-translate="personalization.modal.addeditaction.selected.actions.title"></label>\n    <y-help data-template="\'<span data-translate=personalization.modal.addeditaction.selected.actions.help.label></span>\'">\n    </y-help>\n\n    <ui-select class="perso-customize-component__select2-container"\n        ng-model="action.selected"\n        theme="select2"\n        title=""\n        search-enabled="false">\n        <ui-select-match placeholder="{{\'personalization.modal.addeditaction.dropdown.placeholder\' | translate}}">\n            <span ng-bind="$select.selected.name"></span>\n        </ui-select-match>\n        <ui-select-choices repeat="item in actions"\n            position="down">\n            <span ng-bind="item.name "></span>\n        </ui-select-choices>\n    </ui-select>\n    <div class="perso-customize-component__select-group-label-layout">\n        <div data-ng-show="action.selected.id == \'use\'">\n            <label class="control-label required"\n                data-translate="personalization.modal.addeditaction.selected.component.title"></label>\n        </div>\n        <has-multicatalog data-ng-show="action.selected.id == \'use\'">\n            <div class="perso-customize-component__filter-layout">\n                <label class="personalization-modal__label perso-customize-component__filter-label"\n                    data-translate="personalization.commons.filter.label"></label>\n                <catalog-version-filter-dropdown data-on-select-callback="catalogVersionFilerChange(value)" />\n            </div>\n        </has-multicatalog>\n    </div>\n\n    <ui-select class="perso-customize-component__select2-container"\n        ng-show="action.selected.id == \'use\'"\n        ng-model="component.selected"\n        ng-keyup="componentSearchInputKeypress($event, $select.search)"\n        theme="select2"\n        title=""\n        reset-search-input="false">\n        <ui-select-match placeholder="{{\'personalization.modal.addeditaction.dropdown.componentlist.placeholder\' | translate}}">\n            <span ng-bind="$select.selected.name | translate"></span>\n        </ui-select-match>\n        <ui-select-choices repeat="item in components"\n            position="down"\n            personalization-infinite-scroll="addMoreComponentItems()"\n            personalization-infinite-scroll-distance="2">\n            <div class="row">\n                <span class="col-md-7"\n                    ng-bind="item.name"></span>\n                <span class="col-md-5"\n                    ng-bind="item.typeCode"></span>\n            </div>\n        </ui-select-choices>\n    </ui-select>\n\n    <ui-select class="perso-customize-component__select2-container"\n        ng-show="action.selected.id == \'create\'"\n        on-select="newComponentTypeSelectedEvent($item, $model)"\n        ng-model="newComponent.selected"\n        theme="select2"\n        title=""\n        search-enabled="false">\n        <ui-select-match placeholder="{{\'personalization.modal.addeditaction.dropdown.componenttype.placeholder\' | translate}}">\n            <span ng-bind="$select.selected.name"></span>\n        </ui-select-match>\n        <ui-select-choices repeat="item in newComponentTypes"\n            position="down">\n            <span ng-bind="item.i18nKey | translate"></span>\n        </ui-select-choices>\n    </ui-select>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/customizeView/customizationsList/customizationsListTemplate.html",'<div class="pe-customize-panel-list">\n    <div data-ng-class="$last && customization.collapsed && ctrl.isCustomizationFromCurrentCatalog(customization) ? \'pe-customize-panel-list__item-last\':\'\'"\n        data-ng-repeat="customization in ctrl.customizationsList track by $index"\n        data-ng-init="ctrl.initCustomization(customization)">\n        <div class="pe-customize-panel-list__row-layout"\n            data-ng-class="ctrl.getSelectedCustomizationClass(customization)">\n            <div class="pe-customize-panel-list__icon-layout pe-customize-panel-list__icon-divider"\n                data-ng-click="ctrl.customizationRowClick(customization);">\n                <a class="pe-customize-panel-list__btn-link btn btn-link"\n                    title="{{customization.collapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\' | translate}}">\n                    <span data-ng-class="customization.collapsed ? \'glyphicon-chevron-right\' : \'glyphicon-chevron-down\'"\n                        class="perso__chevron-down-icon glyphicon"></span>\n                </a>\n            </div>\n            <div class="pe-customize-panel-list__row"\n                data-ng-click="ctrl.customizationRowClick(customization,true);">\n                <div class="pe-customize-panel-list__col-lg">\n                    <div class="perso-wrap-ellipsis pe-customize-panel-list__parent-layout perso-tree__primary-data"\n                        data-ng-bind="customization.name"\n                        title={{customization.name}}></div>\n                </div>\n                <div class="pe-customize-panel-list__col-md"></div>\n                <div class="pe-customize-panel-list__col-md">\n                    <div class="perso-tree__status"\n                        data-ng-class="ctrl.getActivityStateForCustomization(customization)"\n                        data-ng-bind="ctrl.getEnablementTextForCustomization(customization)"></div>\n                    <div class="perso-tree__dates-layout"\n                        data-ng-if="ctrl.isEnabled(customization)"\n                        data-ng-bind="ctrl.getDatesForCustomization(customization)"></div>\n                </div>\n                <div class="pe-customize-panel-list__col-sm">\n                    <span data-ng-if="!ctrl.isCustomizationFromCurrentCatalog(customization)"\n                        class="perso__globe-icon hyicon hyicon-globe"\n                        data-uib-tooltip="{{customization.catalogVersionNameL10N}}"\n                        data-tooltip-placement="auto top"></span>\n                </div>\n            </div>\n            <div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown">\n                <div data-ng-if="ctrl.isCustomizationFromCurrentCatalog(customization)"\n                    class="dropdown"\n                    data-ng-init="ctrl.clearAllSubMenu();">\n                    <button type="button"\n                        class="pe-customize-panel-list__btn-link btn btn-link customization-rank-{{customization.rank}}-dropdown-toggle"\n                        data-ng-click="ctrl.customizationSubMenuAction(customization)">\n                        <span class="perso__more-icon hyicon hyicon-more"></span>\n                    </button>\n                    <ul data-ng-if="customization.subMenu"\n                        class="pull-right dropdown-menu pe-customize-panel-list__dropdown-menu"\n                        role="menu">\n                        <li>\n                            <a class="pe-customize-panel-list__dropdown-menu__item cutomization-rank-{{customization.rank}}-edit-button"\n                                data-ng-click="ctrl.clearAllSubMenu(); ctrl.editCustomizationAction(customization);"\n                                data-translate="personalization.toolbar.pagecustomizations.customization.options.edit "></a>\n                        </li>\n                    </ul>\n                </div>\n            </div>\n        </div>\n        \x3c!--end customization row--\x3e\n        <div data-uib-collapse="customization.collapsed">\n            <div class="pe-customize-panel-list__row-layout"\n                data-ng-repeat="variation in customization.variations | statusNotDeleted"\n                data-ng-class="ctrl.getSelectedVariationClass(variation)"\n                data-ng-click="ctrl.clearAllSubMenu(); ctrl.variationClick(customization, variation);">\n                <div class="pe-customize-panel-list__icon-layout">\n                    <div class="pe-customize-panel-list__btn-link btn btn-link"></div>\n                </div>\n                <div class="pe-customize-panel-list__row">\n                    <div class="pe-customize-panel-list__col-lg">\n                        <div class="perso-wrap-ellipsis pe-customize-panel-list__child-layout"\n                            data-ng-bind="variation.name"\n                            title={{variation.name}}></div>\n                    </div>\n                    <div class="pe-customize-panel-list__col-md">\n                        <div class="pe-customize-panel-list__components-layout">\n                            <div data-ng-show="variation.numberOfAffectedComponents >= 0"\n                                class="pe-customize-panel-list__number-layout">{{variation.numberOfAffectedComponents}}</div>\n                            <div data-ng-hide="variation.numberOfAffectedComponents >= 0"\n                                class="pe-customize-panel-list__number-layout">#</div>\n                            <div class="perso-wrap-ellipsis"\n                                data-translate="personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label"\n                                title="{{\'personalization.toolbar.pagecustomizations.variation.numberofaffectedcomponents.label\' | translate}}">\n                            </div>\n                        </div>\n                    </div>\n                    <div class="pe-customize-panel-list__col-md perso-tree__status"\n                        data-ng-class="ctrl.getActivityStateForVariation(customization, variation)"\n                        data-ng-bind="ctrl.getEnablementTextForVariation(variation)"></div>\n                    <div class="pe-customize-panel-list__col-sm">\n                        <span class="pe-customize-panel-list__cc-icon hyicon hyicon-commerce"\n                            data-ng-class="{\'pe-customize-panel-list__cc-icon--hidden\': !ctrl.hasCommerceActions(variation)}"\n                            data-uib-tooltip-html="ctrl.getCommerceCustomizationTooltip(variation)"\n                            data-tooltip-placement="auto top"></span>\n                    </div>\n                </div>\n                <div class="pe-customize-panel-list__col-xs pe-customize-panel-list__dropdown"></div>\n            </div>\n        </div>\n    </div>\n    \x3c!--end data repeat--\x3e\n    <div class="pe-spinner--outer"\n        data-ng-show="ctrl.requestProcessing">\n        <div data-ng-include="\'waitDialog.html\'"></div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/customizeView/personalizationsmarteditCustomizeViewTemplate.html",'<div id="personalizationsmartedit-right-toolbar-item-template">\n    <div class="pe-customize-panel__filter-label-layout">\n        <label class="personalization-modal__label pe-customize-panel__filter-label"\n            data-translate="personalization.commons.filter.label"></label>\n        <div class="pe-customize-panel__filter-layout">\n            <page-filter-dropdown data-initial-value="ctrl.pageFilter"\n                data-on-select-callback="ctrl.pageFilerChange(value)"></page-filter-dropdown>\n            <has-multicatalog>\n                <catalog-filter-dropdown data-initial-value="ctrl.catalogFilter"\n                    data-on-select-callback="ctrl.catalogFilerChange(value)" />\n            </has-multicatalog>\n            <status-filter-dropdown data-initial-value="ctrl.statusFilter"\n                data-on-select-callback="ctrl.statusFilerChange(value)"></status-filter-dropdown>\n        </div>\n    </div>\n    <div data-ng-class="ctrl.customizationsList.length == 0 ? \'pe-customize-panel-list--empty\':\'\'">\n        <div class="pe-customize-panel__search-layout">\n            <div class="perso-search perso-search-panel perso-input-group">\n                <div class="perso-input-group__addon">\n                    <span class="hyicon hyicon-search perso-search__search-icon"></span>\n                </div>\n                <input type="text"\n                    class="perso-input-group__input ng-pristine ng-untouched ng-valid"\n                    placeholder="{{ \'personalization.toolbar.pagecustomizations.search.placeholder\' | translate}}"\n                    data-ng-model="ctrl.nameFilter"\n                    data-ng-keyup="ctrl.nameInputKeypress($event)">\n                </input>\n                <div class="perso-input-group__addon">\n                    <span data-ng-show="ctrl.nameFilter"\n                        class="glyphicon glyphicon-remove-sign perso-search__reset-icon"\n                        data-ng-click="ctrl.nameFilter=\'\'; ctrl.nameInputKeypress($event)">\n                    </span>\n                </div>\n            </div>\n            <div class="perso-search__results">\n                <span data-ng-bind="ctrl.pagination.totalCount"></span>\n                <span data-translate="personalization.toolbar.pagecustomizations.search.result.label"></span>\n            </div>\n        </div>\n    </div>\n    <div class="pe-customize-panel__wrapper"\n        personalization-infinite-scroll="ctrl.addMoreCustomizationItems()"\n        personalization-infinite-scroll-distance="2"\n        data-customizations-loaded="{{ctrl.customizationsList.length > 0}}">\n        <customizations-list data-customizations-list="ctrl.customizationsList"\n            data-request-processing="ctrl.moreCustomizationsRequestProcessing" />\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/customizeView/personalizationsmarteditCustomizeViewWrapperTemplate.html",'<div data-ng-controller="topToolbarMenuController"\n    data-uib-dropdown\n    data-is-open="item.isOpen"\n    class="btn-group pe-toolbar-action pe-combined-view-menu"\n    data-auto-close="outsideClick">\n    <button type="button"\n        class="btn btn-default pe-toolbar-action__button personalizationsmarteditTopToolbarCustomizeButton"\n        data-uib-dropdown-toggle\n        data-ng-disabled="disabled"\n        aria-pressed="false"\n        data-ng-class="{\'pe-toolbar-action__button-with-context\': isCustomizeCustomizationSelected()}">\n        <span class="hyicon hyicon-customize pe-toolbar-menu-ddlb__button-icon"></span>\n        <span class="pe-toolbar-action__button-txt"\n            data-translate="personalization.toolbar.pagecustomizations"></span>\n    </button>\n\n    <personalizationsmartedit-customize-toolbar-context></personalizationsmartedit-customize-toolbar-context>\n\n    <div data-uib-dropdown-menu\n        class="btn-block pe-toolbar-action--include">\n        <div class="pe-toolbar-menu-content se-toolbar-menu-content--pe-customized-customizations-panel"\n            role="menu">\n            <div class="se-toolbar-menu-content--pe-customized__headers">\n                <h2 class="se-toolbar-menu-content--pe-customized__headers--h2"\n                    data-translate="personalization.toolbar.pagecustomizations.header.title"></h2>\n                <y-help class="se-toolbar-menu-content__y-help"\n                    data-template="\'<span data-translate=personalization.toolbar.pagecustomizations.header.description></span>\'"></y-help>\n            </div>\n            <div role="menuitem"\n                class="pe-combined-view-menu">\n                <personalizationsmartedit-customize-view data-is-menu-open="item.isOpen" />\n            </div>\n        </div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/commerceCustomizationView/personalizationsmarteditCommerceCustomizationViewTemplate.html",'<div id="commerceCustomizationBody-002"\n    class="perso-cc-modal">\n    <div class="perso-cc-modal__title-layout">\n        <div class="perso-wrap-ellipsis perso-cc-modal__title-cname"\n            data-ng-bind="customization.name"\n            title="{{customization.name}}">\n        </div>\n        <div class="perso-cc-modal__title-status"\n            data-ng-class="customizationStatus"\n            data-ng-bind="\' (\' + customizationStatusText + \') \'">\n        </div>\n        <span> > </span>\n        <div class="perso-wrap-ellipsis perso-cc-modal__title-vname"\n            data-ng-bind="variation.name"\n            title="{{variation.name}}">\n        </div>\n        <div class="perso-cc-modal__title-status"\n            data-ng-class="variationStatus"\n            data-ng-bind="\' (\' + variationStatusText + \')\'">\n        </div>\n    </div>\n    <div class="form-group perso-cc-modal__content-layout">\n        <label for="commerce-customization-type-1"\n            class="personalization-modal__label"\n            data-translate="personalization.modal.commercecustomization.action.type"></label>\n        <ui-select id="commerce-customization-type-1"\n            class="form-control"\n            ng-model="select.type"\n            theme="select2"\n            search-enabled="false">\n            <ui-select-match>\n                <span data-ng-bind="$select.selected.text | translate"></span>\n            </ui-select-match>\n            <ui-select-choices repeat="item in availableTypes"\n                position="down">\n                <span data-ng-bind="item.text | translate"></span>\n            </ui-select-choices>\n        </ui-select>\n    </div>\n    <div class="form-group perso-cc-modal__content-layout">\n        <ng-include src="select.type.template" />\n    </div>\n    <div class="select2-choices">\n        <div class="ui-select-match-item select2-search-choice perso-cc-modal__ui-select--small"\n            data-ng-repeat="action in getActionsToDisplay()">\n            <span data-ng-bind="displayAction(action)"></span>\n            <span class="ui-select-match-close select2-search-choice-close"\n                data-ng-click="removeSelectedAction(action)"></span>\n        </div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/basicInfoTabTemplate.html",'<div class="pe-customization-modal">\n    <form>\n        <div class="form-group">\n            <label for="customization-name"\n                data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.name"\n                class="control-label required"></label>\n            <input type="text"\n                class="form-control"\n                placeholder="{{\'personalization.modal.customizationvariationmanagement.basicinformationtab.name.placeholder\' | translate}}"\n                name="{{$ctrl.customization.name}}_key"\n                data-ng-model="$ctrl.customization.name"\n                data-ng-required="true"\n                id="customization-name">\n        </div>\n        <div class="form-group">\n            <label for="customization-description"\n                data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details"\n                class="personalization-modal__label"></label>\n            <textarea rows="2"\n                class="form-control pe-customization-modal__textarea"\n                placeholder="{{\'personalization.modal.customizationvariationmanagement.basicinformationtab.details.placeholder\' | translate}}"\n                name="{{$ctrl.customization.description}}_key"\n                data-ng-model="$ctrl.customization.description"\n                id="customization-description"></textarea>\n        </div>\n        <div class="form-group">\n            <label for="customization-status"\n                data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.status"\n                class="personalization-modal__label"></label>\n            <div class="status-toggle">\n                <span class="y-toggle y-toggle-lg"\n                    id="customization-status">\n                    <input type="checkbox"\n                        id="test-checkbox"\n                        data-ng-model="$ctrl.customization.statusBoolean"\n                        data-ng-change="$ctrl.customizationStatusChange()" />\n                    <label for="test-checkbox"></label>\n                </span>\n            </div>\n        </div>\n        <div class="form-group">\n            <div>\n                <a data-ng-show="!$ctrl.datetimeConfigurationEnabled"\n                    data-ng-click="$ctrl.datetimeConfigurationEnabled = !$ctrl.datetimeConfigurationEnabled"\n                    data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.showdateconfigdata"></a>\n                <a data-ng-show="$ctrl.datetimeConfigurationEnabled"\n                    data-ng-click="$ctrl.datetimeConfigurationEnabled = !$ctrl.datetimeConfigurationEnabled; $ctrl.resetDateTimeConfiguration();"\n                    data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.hidedateconfigdata"></a>\n            </div>\n            <div data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.statusfortimeframe.description"></div>\n        </div>\n        <div class="form-group">\n            <div data-ng-show="$ctrl.datetimeConfigurationEnabled">\n                <div class="row pe-customization-modal__dates-group">\n                    <date-time-picker-range name="data-date-time-from-to-key"\n                        data-date-from="$ctrl.customization.enabledStartDate"\n                        data-date-to="$ctrl.customization.enabledEndDate"\n                        data-is-editable="true"\n                        date-format="$ctrl.DATE_CONSTANTS.MOMENT_FORMAT"></date-time-picker-range>\n                </div>\n            </div>\n        </div>\n    </form>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/basicInfoTabWrapperTemplate.html",'<basic-info-tab-component data-customization="$ctrl.customization" />'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/manageCustomizationViewMenuTemplate.html",'<div data-ng-controller="topToolbarMenuController"\n    data-uib-dropdown\n    data-is-open="item.isOpen"\n    class="btn-group pe-toolbar-action pe-combined-view-menu"\n    data-auto-close="outsideClick">\n    <button type="button"\n        class="btn btn-default pe-toolbar-action__button"\n        data-uib-dropdown-toggle\n        data-ng-disabled="disabled"\n        aria-pressed="false">\n        <span class="hyicon hyicon-library se-toolbar-menu-ddlb--button__icon"></span>\n        <span class="pe-toolbar-action__button-txt"\n            data-translate="personalization.toolbar.library.name"></span>\n    </button>\n\n    <div data-uib-dropdown-menu\n        class="btn-block pe-toolbar-action--include">\n        <div class="se-toolbar-menu-content se-toolbar-menu-content--pe-customized"\n            role="menu">\n            <div class="se-toolbar-menu-content--pe-customized__headers">\n                <h2 class="se-toolbar-menu-content--pe-customized__headers--h2"\n                    data-translate="personalization.toolbar.library.header.title"></h2>\n                <y-help class="se-toolbar-menu-content__y-help"\n                    data-template="\'<span data-translate=personalization.toolbar.library.header.description></span>\'"></y-help>\n            </div>\n            <div class="se-toolbar-menu-content--pe-customized__item">\n                <a class="se-toolbar-menu-content--pe-customized__item__link"\n                    id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor"\n                    data-translate="personalization.toolbar.library.manager.name"\n                    data-ng-click="managerViewClick();item.isOpen=false"></a>\n            </div>\n            <div class="se-toolbar-menu-content--pe-customized__item se-toolbar-menu-content--pe-customized__item--last">\n                <a class="se-toolbar-menu-content--pe-customized__item__link"\n                    id="personalizationsmartedit-pagecustomizations-toolbar-customization-anchor"\n                    data-translate="personalization.toolbar.library.customizationvariationmanagement.name"\n                    data-ng-click="createCustomizationClick();item.isOpen=false"></a>\n            </div>\n        </div>\n    </div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/manageCustomizationViewTemplate.html",'<div>\n    <uib-tabset active="$ctrl.activeTabNumber">\n        <uib-tab ng-repeat="tab in $ctrl.tabsArr"\n            select="$ctrl.selectTab(tab)"\n            disable="tab.disabled"\n            heading="{{tab.heading}}">\n            <form name="{{tab.formName}}"\n                novalidate>\n                <div>\n                    <data-ng-include src="tab.template"></data-ng-include>\n                </div>\n            </form>\n        </uib-tab>\n    </uib-tabset>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/multipleTriggersComponent/multipleTriggersComponentTemplate.html",'<y-tabset data-tabs-list="$ctrl.tabsList"\n    data-num-tabs-displayed="{{$ctrl.tabsList.length}}">\n</y-tabset>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/segmentView/personalizationsmarteditSegmentNodeTemplate.html",'<div data-ng-class="{\'perso-segments-tree__layout\': ctrl.isContainer(node), \'perso-segments-tree__empty-container\': ctrl.isContainerWithDropzone(node), \'perso-segments-tree__collapsed-container\': collapsed }">\n    <div class="perso-segments-tree"\n        data-ng-class="{\'perso-segments-tree__node\': ctrl.isItem(node), \'perso-segments-tree__container\': ctrl.isContainer(node)}">\n        <div data-ng-if="ctrl.isContainer(node)">\n            <div class="perso-segments-tree__toggle"\n                data-ng-click="ctrl.toggle(this)"\n                title="{{collapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\' | translate}}">\n                <span class="glyphicon perso-segments-tree__glyphicon"\n                    data-ng-class="{\'glyphicon-chevron-right\': collapsed, \'glyphicon-chevron-down\': !collapsed}"></span>\n            </div>\n            <div class="perso-segments-tree__dropdown">\n                <ui-select data-ng-model="node.operation"\n                    theme="select2"\n                    title=""\n                    search-enabled="false">\n                    <ui-select-match>\n                        <span data-ng-bind="$select.selected.name | translate"></span>\n                    </ui-select-match>\n                    <ui-select-choices repeat="item in ctrl.actions"\n                        position="down">\n                        <span data-ng-bind="item.name | translate"></span>\n                    </ui-select-choices>\n                </ui-select>\n            </div>\n        </div>\n        <div data-ng-if="ctrl.isItem(node)"\n            ui-tree-handle\n            class="perso-segments-tree__node-content"\n            data-ng-bind="node.selectedSegment.code"></div>\n\n        <div data-ng-if="ctrl.isDropzone(node)"\n            class="perso-segments-tree__empty-container-node">\n            <div class="perso-segments-tree__empty-container-node-text"\n                data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.dropzone"></div>\n        </div>\n\n        <div data-ng-if="ctrl.isContainer(node)"\n            ui-tree-handle\n            class="perso-segments-tree__angular-ui-tree-handle--empty"></div>\n        <div data-nodrag>\n            <span class="pull-right">\n                <a data-ng-if="ctrl.isItem(node)"\n                    class="perso-segments-tree__actions perso-segments-tree__node-icon"\n                    data-ng-click="ctrl.duplicateItem(node)"\n                    title="{{\'personalization.commons.icon.title.duplicate\' | translate}}">\n                    <span class="hyicon hyicon-duplicate"></span>\n                </a>\n                <a data-ng-if="!ctrl.isTopContainer(this)"\n                    class="perso-segments-tree__actions"\n                    data-ng-click="ctrl.removeItem(this)">\n                    <div data-ng-if="ctrl.isContainer(node)"\n                        class="btn btn-link perso-segments-tree__container-btn-icon"\n                        title="{{\'personalization.commons.icon.title.remove\' | translate}}">\n                        <span class="hyicon hyicon-removelg"></span>\n                    </div>\n                    <div data-ng-if="ctrl.isItem(node)"\n                        class="perso-segments-tree__node-icon"\n                        title="{{\'personalization.commons.icon.title.remove\' | translate}}">\n                        <span class="hyicon hyicon-removelg"></span>\n                    </div>\n                </a>\n            </span>\n            <a data-ng-if="ctrl.isContainer(node)"\n                class="btn btn-link perso-segments-tree__btn"\n                data-ng-click="ctrl.newSubItem(this, \'container\')">\n                <span class="pe-customization-modal__sliderpanel__btn-link"\n                    data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.button"></span>\n            </a>\n        </div>\n    </div>\n\n    <ol data-ng-if="ctrl.isItem(node)"\n        ui-tree-nodes\n        data-nodrop-enabled="true"\n        data-ng-model="node.nodes"\n        data-ng-class="{hidden: collapsed}">\n        <li data-ng-repeat="node in node.nodes"\n            ui-tree-node\n            data-collapsed="true"\n            data-expand-on-hover="500"\n            data-ng-include="\'personalizationsmarteditSegmentNodeTemplate.html\'">\n        </li>\n    </ol>\n    <ol data-ng-if="ctrl.isContainer(node)"\n        ui-tree-nodes\n        data-ng-model="node.nodes"\n        data-ng-class="{hidden: collapsed}">\n        <li data-ng-repeat="node in node.nodes"\n            ui-tree-node\n            data-collapsed="true"\n            data-expand-on-hover="500"\n            data-ng-include="\'personalizationsmarteditSegmentNodeTemplate.html\'">\n        </li>\n    </ol>\n\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/segmentView/personalizationsmarteditSegmentViewTemplate.html",'<div>\n    <personalizationsmartedit-scroll-zone data-scroll-zone-id="\'segmentview\'"\n        data-scroll-zone-visible="ctrl.scrollZoneVisible"\n        data-get-element-to-scroll="ctrl.getElementToScroll()"></personalizationsmartedit-scroll-zone>\n    <div class="form-group">\n        <personalizationsmartedit-segment-expression-as-html data-segment-expression="ctrl.expression[0]"></personalizationsmartedit-segment-expression-as-html>\n    </div>\n    <div class="form-group">\n        <label class="personalization-modal__label"\n            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments"></label>\n        <ui-select class="form-control"\n            ng-model="ctrl.singleSegment"\n            theme="select2"\n            ng-keyup="ctrl.segmentSearchInputKeypress($event, $select.search)"\n            on-select="ctrl.segmentSelectedEvent($item, $select.items)"\n            reset-search-input="false">\n            <ui-select-match placeholder="{{ \'personalization.modal.customizationvariationmanagement.targetgrouptab.segments.placeholder\' | translate}}">\n                <span>{{\'personalization.modal.customizationvariationmanagement.targetgrouptab.segments.placeholder\' | translate}}</span>\n            </ui-select-match>\n            <ui-select-choices repeat="item in ctrl.segments"\n                position="down"\n                personalization-infinite-scroll="ctrl.addMoreSegmentItems()"\n                personalization-infinite-scroll-distance="2">\n                <div ng-bind="item.code"\n                    class="perso__item-name"></div>\n                <div class="perso-wrap-ellipsis perso__wrapper-description"\n                    data-ng-bind="item.description"\n                    title="{{item.description}}"></div>\n            </ui-select-choices>\n        </ui-select>\n    </div>\n\n    <div ui-tree="ctrl.treeOptions"\n        id="tree-root">\n        <div ui-tree-nodes\n            ng-model="ctrl.expression"\n            data-nodrop-enabled="true">\n            <div ng-repeat="node in ctrl.expression"\n                data-collapsed="false"\n                ui-tree-node\n                ng-include="\'personalizationsmarteditSegmentNodeTemplate.html\'"></div>\n        </div>\n    </div>\n\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/segmentView/personalizationsmarteditSegmentViewWrapperTemplate.html",'<label class="personalization-modal__label"\n    data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupexpression"></label>\n<multi-segment-view></multi-segment-view>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/segmentView/segmentExpressionAsHtml/personalizationsmarteditSegmentExpressionAsHtmlTemplate.html",'<span data-ng-repeat="word in ctrl.getExpressionAsArray() track by $index">\n    <span data-ng-if="ctrl.operators.indexOf(word) > -1"\n        class="pe-customization-modal__expression-text"> {{ ctrl.getLocalizationKeyForOperator(word) | translate }} </span>\n    <span data-ng-if="ctrl.emptyGroup === word"\n        class="text-primary hyicon hyicon-caution"\n        data-uib-tooltip="{{\'personalization.modal.customizationvariationmanagement.targetgrouptab.segments.group.tooltip\' | translate}}"\n        data-tooltip-placement="auto top"></span>\n    <span data-ng-if="ctrl.emptyGroupAndOperators.indexOf(word) === -1">{{word}}</span>\n</span>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/targetGroupTabTemplate.html",'<div class="pe-customization-modal">\n    <div class="pe-customization-modal__title">\n        <div class="pe-customization-modal__title-header">\n            <div class="pe-customization-modal__title-header-name perso-wrap-ellipsis"\n                data-ng-bind="$ctrl.customization.name"\n                title={{$ctrl.customization.name}}></div>\n            <div>\n                <span class="pe-customization-modal__title-header-badge badge"\n                    data-ng-class="{\'perso__status--enabled\':\'badge-success\', \'perso__status--disabled\':\'\', \'perso__status--ignore\':\'\'}[$ctrl.getActivityStateForCustomization($ctrl.customization)]">\n                    {{\'personalization.modal.customizationvariationmanagement.targetgrouptab.customization.\' + $ctrl.customization.status | lowercase | translate}}\n                </span>\n            </div>\n        </div>\n        <div class="pe-customization-modal__title-subarea">\n            <div data-ng-if="$ctrl.customization.status === $ctrl.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED"\n                class="pe-customization-modal__title-dates">\n                <span data-ng-if=\'!$ctrl.customization.enabledStartDate && $ctrl.customization.enabledEndDate\'>...</span>\n                <span data-ng-bind="$ctrl.customization.enabledStartDate"></span>\n                <span data-ng-if=\'$ctrl.customization.enabledStartDate || $ctrl.customization.enabledEndDate\'> - </span>\n                <span data-ng-bind="$ctrl.customization.enabledEndDate"></span>\n                <span data-ng-if="$ctrl.personalizationsmarteditDateUtils.isDateInThePast($ctrl.customization.enabledEndDate)"\n                    class="section-help help-inline help-inline--section help-inline--tooltip">\n                    <span class="hyicon hyicon-msgwarning hyicon-msgwarning--dates help-icon-inline"></span>\n                    <span class="pe-help-block--inline help-block-inline help-block-inline--text"\n                        data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.datetooltip"></span>\n                </span>\n                <span data-ng-if=\'$ctrl.customization.enabledStartDate && !$ctrl.customization.enabledEndDate\'>...</span>\n            </div>\n        </div>\n    </div>\n    <div class="pe-customization-modal__y-add-btn">\n        <button class="y-add-btn"\n            type="button"\n            data-ng-click="$ctrl.addVariationAction()">\n            <span class="hyicon hyicon-add"></span>\n            <span data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.addtargetgroup.button"></span>\n        </button>\n    </div>\n    <ul data-ng-show=\'filteredVariations.length > 0\'\n        class="pe-customization-modal__list-group">\n        <li class="pe-customization-modal__list-group__item"\n            data-ng-repeat="variation in $ctrl.customization.variations | filter:$ctrl.personalizationsmarteditUtils.isItemVisible as filteredVariations">\n            <div class="pe-customization-modal__list-group__item-col1">\n                <a class="pe-customization-modal__list-group__item-link"\n                    data-ng-bind="variation.name"\n                    data-ng-click="$ctrl.editVariationAction(variation)"></a>\n                <span data-ng-class="$ctrl.getActivityStateForVariation($ctrl.customization, variation)"\n                    data-ng-bind="$ctrl.getEnablementTextForVariation(variation)"></span>\n                <div data-ng-show="$ctrl.personalizationsmarteditTriggerService.isDefault(variation.triggers)">\n                    <span class="pe-customization-modal__title-label-segments"\n                        data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span>\n                    <span data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></span>\n                </div>\n                <div data-ng-show="!$ctrl.personalizationsmarteditTriggerService.isDefault(variation.triggers)">\n                    <div>\n                        <span class="pe-customization-modal__title-label-segments"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.segments.colon"></span>\n                        <personalizationsmartedit-segment-expression-as-html data-segment-expression="variation.triggers"></personalizationsmartedit-segment-expression-as-html>\n                    </div>\n                </div>\n            </div>\n            <div data-uib-dropdown\n                class="pe-customization-modal__dropdown">\n                <button type="button"\n                    data-uib-dropdown-toggle\n                    class="dropdown-toggle btn btn-link"\n                    id="dropdownMenu1"\n                    aria-haspopup="true"\n                    aria-expanded="true">\n                    <span class="hyicon hyicon-more"></span>\n                </button>\n                <ul data-uib-dropdown-menu\n                    aria-labelledby="dropdownMenu1"\n                    role="menu">\n                    <li>\n                        <a data-ng-click="$ctrl.editVariationAction(variation)"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.edit" />\n                    </li>\n                    <li>\n                        <a data-ng-click="$ctrl.toogleVariationActive(variation)"\n                            data-ng-bind="$ctrl.getActivityActionTextForVariation(variation)" />\n                    </li>\n                    <li data-ng-class="$first ? \'disabled\' : \'\' ">\n                        <a data-ng-click="$ctrl.setVariationRank(variation, -1, $event, $first)"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.moveup" />\n                    </li>\n                    <li data-ng-class="$last ? \'disabled\' : \'\' ">\n                        <a data-ng-click="$ctrl.setVariationRank(variation, 1, $event, $last)"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.movedown" />\n                    </li>\n                    <li role="separator"\n                        class="divider"></li>\n                    <li>\n                        <a data-ng-click="$ctrl.removeVariationClick(variation)"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.remove" />\n                    </li>\n                </ul>\n            </div>\n        </li>\n    </ul>\n\n    <y-slider-panel data-slider-panel-show="$ctrl.showSliderPanel"\n        data-slider-panel-hide="$ctrl.hideSliderPanel"\n        data-slider-panel-configuration="$ctrl.sliderPanelConfiguration"\n        class="pe-customization-modal__sliderpanel">\n        <content>\n            <div class="pe-customization-modal__sliderpanel__btn-layout">\n                <button class="btn btn-link pe-customization-modal__sliderpanel__btn-link"\n                    data-ng-init="$ctrl.isFullscreen=false"\n                    data-ng-click="$ctrl.toggleSliderFullscreen(); $ctrl.isFullscreen=!$ctrl.isFullscreen">\n                    <div>\n                        <div data-ng-if="!$ctrl.isFullscreen">\n                            <span class="hyicon hyicon-maximize"></span>\n                            <span data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.open"></span>\n                        </div>\n                        <div data-ng-if="$ctrl.isFullscreen">\n                            <span class="hyicon hyicon-minimize"></span>\n                            <span data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.fullscreen.close"></span>\n                        </div>\n                    </div>\n                </button>\n            </div>\n            <form>\n                <div class="form-group">\n                    <label for="targetgroup-name"\n                        class="control-label required"\n                        data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname"></label>\n                    <input type="text"\n                        class="form-control"\n                        placeholder="{{\'personalization.modal.customizationvariationmanagement.targetgrouptab.targetgroupname.placeholder\' | translate}}"\n                        name="variationname_key"\n                        data-ng-model="$ctrl.edit.name"\n                        id="targetgroup-name">\n                </div>\n                <div class="form-group">\n                    <div class="checkbox">\n                        <input type="checkbox"\n                            id="targetgroup-isDefault-001"\n                            data-ng-model="$ctrl.edit.isDefault"\n                            data-ng-change="$ctrl.confirmDefaultTrigger($ctrl.edit.isDefault);" />\n                        <label for="targetgroup-isDefault-001"\n                            data-translate="personalization.modal.customizationvariationmanagement.targetgrouptab.variation.default"></label>\n                    </div>\n                </div>\n\n                <div data-ng-show="$ctrl.edit.showExpression">\n\n                    <multiple-triggers></multiple-triggers>\n\n                </div>\n            </form>\n\n        </content>\n    </y-slider-panel>\n\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/manageCustomizationView/targetGroupTabWrapperTemplate.html",'<target-group-tab-component data-customization="$ctrl.customization"\n    data-variation="$ctrl.edit.selectedVariation" />'),t.put("web/features/personalizationsmarteditcontainer/management/managerView/personalizationsmarteditManagerViewGridHeaderTemplate.html",'<div class="tree-head hidden-sm hidden-xs">\n    <div class="tree-head__col--lg perso-wrap-ellipsis"\n        data-translate="personalization.modal.manager.grid.header.customization"\n        title="{{\'personalization.modal.manager.grid.header.customization\' | translate}}"></div>\n    <div class="tree-head__col--xs"\n        data-translate="personalization.modal.manager.grid.header.variations"\n        title="{{\'personalization.modal.manager.grid.header.variations\' | translate}}"></div>\n    <div class="tree-head__col--xs perso-wrap-ellipsis"\n        data-translate="personalization.modal.manager.grid.header.components"\n        title="{{\'personalization.modal.manager.grid.header.components\' | translate}}"></div>\n    <div class="tree-head__col--md"\n        data-translate="personalization.modal.manager.grid.header.status"\n        title="{{\'personalization.modal.manager.grid.header.status\' | translate}}"></div>\n    <div class="tree-head__col--sm perso-wrap-ellipsis"\n        data-translate="personalization.modal.manager.grid.header.startdate"\n        title="{{\'personalization.modal.manager.grid.header.startdate\' | translate}}"></div>\n    <div class="tree-head__col--sm perso-wrap-ellipsis"\n        data-translate="personalization.modal.manager.grid.header.enddate"\n        title="{{\'personalization.modal.manager.grid.header.enddate\' | translate}}"></div>\n</div>\n<div class="row tree-head visible-sm visible-xs">\n    <div class="col-xs-10 text-left"\n        data-translate="personalization.modal.manager.grid.header.customization"></div>\n</div>'),t.put("web/features/personalizationsmarteditcontainer/management/managerView/personalizationsmarteditManagerViewNodeTemplate.html",'<div class="y-tree-row"\n    data-ng-init="customization.isCollapsed=true"\n    data-ng-class="allCustomizationsCollapsed()? \'active-level\' : \'inactive-level\'">\n    <div class="desktop-layout hidden-sm hidden-xs customization-rank-{{customization.rank}}-row">\n        <div data-ng-click="customization.isCollapsed =! customization.isCollapsed">\n            <a class="btn btn-link category-toggle"\n                title="{{customization.isCollapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\' | translate}}">\n                <span data-ng-class="customization.isCollapsed ? \'glyphicon-chevron-right\' : \'glyphicon-chevron-down\'"\n                    class="glyphicon"></span>\n            </a>\n        </div>\n        <div ui-tree-handle\n            class="y-tree-row__angular-ui-tree-handle">\n            <div class="y-tree__col--lg">\n                <div class="perso-wrap-ellipsis perso-tree__primary-data"\n                    title={{customization.name}}>\n                    <span class="personalizationsmartedit-customization-code"\n                        data-ng-bind="customization.name"></span>\n                </div>\n            </div>\n            <div class="y-tree__col--xs"\n                data-ng-bind="(customization.variations | statusNotDeleted).length || 0">\n            </div>\n            <div class="y-tree__col--xs"></div>\n            <div class="y-tree__col--md perso-tree__status"\n                data-ng-class="getActivityStateForCustomization(customization)">\n                <span data-ng-bind="getEnablementTextForCustomization(customization)"\n                    class="perso-library__status-layout"></span>\n            </div>\n            <div class="y-tree__col--sm">\n                <div data-ng-show="customization.status === PERSONALIZATION_MODEL_STATUS_CODES.ENABLED"\n                    class="perso-tree__dates-layout">\n                    <span data-ng-bind="getFormattedDate(customization.enabledStartDate)"></span>\n                </div>\n            </div>\n            <div class="y-tree__col--sm">\n                <div data-ng-show="customization.status === PERSONALIZATION_MODEL_STATUS_CODES.ENABLED"\n                    class="perso-tree__dates-layout">\n                    <span data-ng-bind="getFormattedDate(customization.enabledEndDate)"></span>\n                </div>\n            </div>\n        </div>\n        <div>\n            <div data-uib-dropdown>\n                <button type="button"\n                    data-uib-dropdown-toggle\n                    class="btn btn-link">\n                    <span class="hyicon hyicon-more"></span>\n                </button>\n                <ul data-uib-dropdown-menu\n                    class="pull-right text-left"\n                    role="menu">\n                    <li>\n                        <a data-ng-click="editCustomizationAction(customization)"\n                            data-translate="personalization.modal.manager.customization.options.edit"></a>\n                    </li>\n                    <li data-ng-class="isFilterEnabled() || $first ? \'disabled\' : \'\' ">\n                        <a data-ng-click="(isFilterEnabled() || $first) ? $event.stopPropagation() : setCustomizationRank(customization, -1)"\n                            data-translate="personalization.modal.manager.customization.options.moveup"></a>\n                    </li>\n                    <li data-ng-class="isFilterEnabled() || $last ? \'disabled\' : \'\' ">\n                        <a data-ng-click="(isFilterEnabled() || $last) ? $event.stopPropagation() : setCustomizationRank(customization, 1)"\n                            data-translate="personalization.modal.manager.customization.options.movedown"></a>\n                    </li>\n                    <li role="separator"\n                        class="divider"></li>\n                    <li>\n                        <a data-ng-click="deleteCustomizationAction(customization)"\n                            data-translate="personalization.modal.manager.customization.options.delete"></a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n\n        \x3c!--end contextual menu dropdown--\x3e\n    </div>\n    \x3c!--end desktop-layout for customization row--\x3e\n\n    <div class="mobile-layout hidden-xl hidden-lg hidden-md customization-rank-{{customization.rank}}-row">\n        <div data-ng-click="customization.isCollapsed =! customization.isCollapsed">\n            <a class="btn btn-link category-toggle"\n                title="{{customization.isCollapsed ? \'personalization.commons.icon.title.expand\' : \'personalization.commons.icon.title.collapse\' | translate}}">\n                <span data-ng-class="customization.isCollapsed ? \'glyphicon-chevron-right\' : \'glyphicon-chevron-down\'"\n                    class="glyphicon customization__glyphicon-chevron"></span>\n            </a>\n        </div>\n        <div ui-tree-handle\n            class="y-tree-row__angular-ui-tree-handle--mobile">\n            <p class="y-tree__col-xl--mobile perso-tree__primary-data perso-wrap-ellipsis"\n                title={{customization.name}}>\n                <span class="personalizationsmartedit-customization-code"\n                    data-ng-bind="customization.name"></span>\n            </p>\n            <div class="mobile-data">\n                <span class="perso-library__tree-head--mobile"\n                    data-translate="personalization.modal.manager.grid.header.variations"></span>\n                <div class="perso-library__number-data--mobile"\n                    data-ng-bind="(customization.variations | statusNotDeleted).length || 0"></div>\n            </div>\n            <div class="mobile-data perso-tree__status"\n                data-ng-class="getActivityStateForCustomization(customization)">\n                <span data-ng-bind="getEnablementTextForCustomization(customization)"></span>\n            </div>\n            <div data-ng-show="customization.status === PERSONALIZATION_MODEL_STATUS_CODES.ENABLED">\n                <div class="mobile-data"\n                    data-ng-if=\'customization.enabledStartDate || customization.enabledEndDate\'>\n                    <span data-ng-if=\'customization.enabledStartDate\'\n                        class="perso-library__tree-head--mobile"\n                        data-translate="personalization.modal.manager.grid.header.startdate"></span>\n                    <p data-ng-bind="getFormattedDate(customization.enabledStartDate)"></p>\n                    <span data-ng-if=\'customization.enabledEndDate\'\n                        class="perso-library__tree-head--mobile"\n                        data-translate="personalization.modal.manager.grid.header.enddate"></span>\n                    <p data-ng-bind="getFormattedDate(customization.enabledEndDate)"></p>\n                </div>\n            </div>\n        </div>\n        <div>\n            <div data-uib-dropdown\n                class="mobile-more-menu">\n                <button type="button"\n                    data-uib-dropdown-toggle\n                    class="btn btn-link">\n                    <span class="hyicon hyicon-more"></span>\n                </button>\n                <ul data-uib-dropdown-menu\n                    class="pull-right text-left"\n                    role="menu">\n                    <li>\n                        <a data-ng-click="editCustomizationAction(customization)"\n                            data-translate="personalization.modal.manager.customization.options.edit"></a>\n                    </li>\n                    <li data-ng-class="isFilterEnabled() || $first ? \'disabled\' : \'\' ">\n                        <a data-ng-click="(isFilterEnabled() || $first) ? $event.stopPropagation() : setCustomizationRank(customization, -1)"\n                            data-translate="personalization.modal.manager.customization.options.moveup"></a>\n                    </li>\n                    <li data-ng-class="isFilterEnabled() || $last ? \'disabled\' : \'\' ">\n                        <a data-ng-click="(isFilterEnabled() || $last) ? $event.stopPropagation() : setCustomizationRank(customization, 1)"\n                            data-translate="personalization.modal.manager.customization.options.movedown"></a>\n                    </li>\n                    <li role="separator"\n                        class="divider"></li>\n                    <li>\n                        <a data-ng-click="deleteCustomizationAction(customization)"\n                            data-translate="personalization.modal.manager.customization.options.delete"></a>\n                    </li>\n                </ul>\n            </div>\n        </div>\n        \x3c!--end contextual menu dropdown--\x3e\n    </div>\n    \x3c!--end mobile-layout for customization row--\x3e\n</div>\n\x3c!--end angular-ui-tree-handle--\x3e\n<div data-uib-collapse="customization.isCollapsed"\n    data-expanding="customizationClickAction(customization)">\n    <div ui-tree-nodes\n        data-ng-model="customization.variations">\n        <div class="y-tree-row child-row active-level"\n            data-ng-class="{\'perso-library__angular-ui-tree-drag\': variation.isDragging}"\n            ui-tree-node\n            data-ng-repeat="variation in customization.variations"\n            data-ng-if="statusNotDeleted(variation)"\n            data-ng-init="variation.isCommerceCustomizationEnabled=isCommerceCustomizationEnabled()">\n            <div class="desktop-layout variation-rank-{{variation.rank}}-row hidden-sm hidden-xs"\n                data-ng-class="$last ? \'active-level--last\':\'\'">\n                <div>\n                    <span class="perso__cc-icon hyicon hyicon-commerce"\n                        data-ng-class="{\'perso__cc-icon--hidden\': !hasCommerceActions(variation)}"\n                        data-uib-tooltip-html="getCommerceCustomizationTooltip(variation)"\n                        data-tooltip-placement="top-left"></span>\n                </div>\n                <div ui-tree-handle\n                    class="y-tree-row__angular-ui-tree-handle">\n                    <div class="y-tree__col--xl perso-wrap-ellipsis"\n                        title={{variation.name}}>\n                        <span data-ng-bind="variation.name"></span>\n                    </div>\n                    <div class="y-tree__col--xs"\n                        data-ng-bind="variation.numberOfComponents">\n                    </div>\n                    <div class="y-tree__col--md perso-tree__status"\n                        data-ng-class="getActivityStateForVariation(customization,variation)">\n                        <span data-ng-bind="getEnablementTextForVariation(variation)"\n                            class="perso-library__status-layout"></span>\n                    </div>\n                    <div class="y-tree__col--lg"></div>\n                </div>\n                <div>\n                    <div data-uib-dropdown>\n                        <button type="button"\n                            data-uib-dropdown-toggle\n                            class="btn btn-link">\n                            <span class="hyicon hyicon-more"></span>\n                        </button>\n                        <ul data-uib-dropdown-menu\n                            class="pull-right text-left"\n                            role="menu">\n                            <li>\n                                <a data-ng-click="editVariationAction(customization, variation)"\n                                    data-translate="personalization.modal.manager.variation.options.edit"></a>\n                            </li>\n                            <li>\n                                <a data-ng-click="toogleVariationActive(customization,variation)"\n                                    data-ng-bind="getEnablementActionTextForVariation(variation)"></a>\n                            </li>\n                            <li data-ng-show="variation.isCommerceCustomizationEnabled">\n                                <a data-ng-click="manageCommerceCustomization(customization, variation)"\n                                    data-translate="personalization.modal.manager.variation.options.commercecustomization"></a>\n                            </li>\n                            <li data-ng-class="$first ? \'disabled\' : \'\' ">\n                                <a data-ng-click="$first ? $event.stopPropagation() : setVariationRank(customization, variation, -1)"\n                                    data-translate="personalization.modal.manager.variation.options.moveup"></a>\n                            </li>\n                            <li data-ng-class="$last ? \'disabled\' : \'\' ">\n                                <a data-ng-click="$last ? $event.stopPropagation() : setVariationRank(customization, variation, 1)"\n                                    data-translate="personalization.modal.manager.variation.options.movedown"></a>\n                            </li>\n                            <li role="separator"\n                                class="divider"></li>\n                            <li data-ng-class="isDeleteVariationEnabled(customization) ? \'\' : \'disabled\' ">\n                                <a data-ng-click="deleteVariationAction(customization, variation, $event)"\n                                    data-translate="personalization.modal.manager.variation.options.delete"></a>\n                            </li>\n                        </ul>\n                    </div>\n                </div>\n                \x3c!--end contextual menu dropdown--\x3e\n            </div>\n            \x3c!--end desktop-layout for variation row--\x3e\n            <div class="mobile-layout hidden-xl hidden-lg hidden-md variation-rank-{{variation.rank}}-row"\n                data-ng-class="$last ? \'active-level--last\':\'\'">\n                <div>\n                    <span class="perso__cc-icon hyicon hyicon-commerce"\n                        data-ng-class="{\'perso__cc-icon--hidden\': !hasCommerceActions(variation)}"\n                        data-uib-tooltip-html="getCommerceCustomizationTooltip(variation)"\n                        data-tooltip-placement="top-left"></span>\n                </div>\n                <div ui-tree-handle\n                    class="y-tree-row__angular-ui-tree-handle--mobile">\n                    <div>\n                        <p class="y-tree__col-xl--mobile perso-wrap-ellipsis"\n                            title="{{variation.name}}">\n                            <span data-ng-bind="variation.name"></span>\n                        </p>\n                        <div class="mobile-data">\n                            <span class="perso-library__tree-head--mobile"\n                                data-translate="personalization.modal.manager.grid.header.components"></span>\n                            <div data-ng-bind="variation.numberOfComponents"></div>\n                        </div>\n                        <div class="mobile-data perso-tree__status"\n                            data-ng-class="getActivityStateForVariation(customization,variation)">\n                            <span data-ng-bind="getEnablementTextForVariation(variation)"></span>\n                        </div>\n                    </div>\n                </div>\n                <div>\n                    <div class="mobile-more-menu">\n                        <div data-uib-dropdown>\n                            <button type="button"\n                                data-uib-dropdown-toggle\n                                class="btn btn-link">\n                                <span class="hyicon hyicon-more"></span>\n                            </button>\n                            <ul data-uib-dropdown-menu\n                                class="pull-right text-left"\n                                role="menu">\n                                <li>\n                                    <a data-ng-click="editVariationAction(customization, variation)"\n                                        data-translate="personalization.modal.manager.variation.options.edit"></a>\n                                </li>\n                                <li>\n                                    <a data-ng-click="toogleVariationActive(customization,variation)"\n                                        data-ng-bind="getEnablementActionTextForVariation(variation)"></a>\n                                </li>\n                                <li data-ng-show="variation.isCommerceCustomizationEnabled">\n                                    <a data-ng-click="manageCommerceCustomization(customization, variation)"\n                                        data-translate="personalization.modal.manager.variation.options.commercecustomization"></a>\n                                </li>\n                                <li data-ng-class="$first ? \'disabled\' : \'\' ">\n                                    <a data-ng-click="$first ? $event.stopPropagation() : setVariationRank(customization, variation, -1)"\n                                        data-translate="personalization.modal.manager.variation.options.moveup"></a>\n                                </li>\n                                <li data-ng-class="$last ? \'disabled\' : \'\' ">\n                                    <a data-ng-click="$last ? $event.stopPropagation() : setVariationRank(customization, variation, 1)"\n                                        data-translate="personalization.modal.manager.variation.options.movedown"></a>\n                                </li>\n                                <li role="separator"\n                                    class="divider"></li>\n                                <li data-ng-class="isDeleteVariationEnabled(customization) ? \'\' : \'disabled\' ">\n                                    <a data-ng-click="deleteVariationAction(customization, variation, $event)"\n                                        data-translate="personalization.modal.manager.variation.options.delete"></a>\n                                </li>\n                            </ul>\n                        </div>\n                    </div>\n                    \x3c!--end contextual menu dropdown--\x3e\n                </div>\n            </div>\n            \x3c!--end mobile-layout for variation row--\x3e\n        </div>\n        \x3c!--end variation-repeat--\x3e\n    </div>\n</div>\n\x3c!--end collapse--\x3e'),t.put("web/features/personalizationsmarteditcontainer/management/managerView/personalizationsmarteditManagerViewTemplate.html",'<div id="editConfigurationsBody-001"\n    class="perso-library">\n\n    <personalizationsmartedit-scroll-zone data-ng-if="scrollZoneElement != null"\n        data-is-transparent="true"\n        data-scroll-zone-id="\'managerview\'"\n        data-scroll-zone-visible="scrollZoneVisible"\n        data-get-element-to-scroll="getElementToScroll()"></personalizationsmartedit-scroll-zone>\n\n    <div class="perso-library__scroll-zone perso__scrollbar--hidden"\n        personalization-current-element="setScrollZoneElement"\n        personalization-infinite-scroll="addMoreItems()"\n        personalization-infinite-scroll-distance="2">\n        <div>\n            <h2 class="perso-library__header"\n                data-ng-bind="catalogName"></h2>\n            <div class="perso-library__search-area-layout">\n                <div class="perso-search perso-search-gutter perso-input-group">\n                    <div class="perso-input-group__addon">\n                        <span class="hyicon hyicon-search perso-search__search-icon"></span>\n                    </div>\n                    <input type="text"\n                        class="perso-input-group__input ng-pristine ng-untouched ng-valid"\n                        placeholder="{{ \'personalization.modal.manager.search.placeholder\' | translate}}"\n                        ng-model="search.name"\n                        ng-keyup="searchInputKeypress($event)">\n                    </input>\n                    <div class="perso-input-group__addon">\n                        <span data-ng-show="search.name"\n                            class="glyphicon glyphicon-remove-sign perso-search__reset-icon"\n                            ng-click="search.name=\'\'; searchInputKeypress($event)">\n                        </span>\n                    </div>\n                </div>\n                <div class="perso-library__filter-layout perso-library__filter-layout--mobile">\n                    <ui-select ng-model="search.status"\n                        theme="select2"\n                        title=""\n                        search-enabled="false">\n                        <ui-select-match>\n                            <span ng-bind="$select.selected.text | translate"></span>\n                        </ui-select-match>\n                        <ui-select-choices repeat="item in statuses"\n                            position="down">\n                            <span ng-bind="item.text | translate"></span>\n                        </ui-select-choices>\n                    </ui-select>\n                </div>\n            </div>\n\n            <div data-ng-show="isSearchResultHidden()"\n                class="perso-library__search-results--fixed">\n                <span data-ng-bind="filteredCustomizationsCount"></span>\n                <span data-translate="personalization.modal.manager.search.result.label"></span>\n            </div>\n            <div class="perso-library__search-results">\n                <span data-ng-bind="filteredCustomizationsCount"></span>\n                <span data-translate="personalization.modal.manager.search.result.label"></span>\n            </div>\n\n            <button class="y-add y-add-btn perso-library__add-button"\n                type="button"\n                data-ng-click="openNewModal();">\n                <span class="hyicon hyicon-add"\n                    data-translate="personalization.modal.manager.add.button"></span>\n            </button>\n\n            <div class="y-tree perso-library__y-tree">\n                \x3c!-- headers --\x3e\n                <div data-ng-show="isSearchGridHeaderHidden()"\n                    class="y-tree-header y-tree-header--fixed">\n                    <data-ng-include src="\'personalizationsmarteditManagerViewGridHeaderTemplate.html\'"></data-ng-include>\n                </div>\n                <div class="y-tree-header">\n                    <data-ng-include src="\'personalizationsmarteditManagerViewGridHeaderTemplate.html\'"></data-ng-include>\n                </div>\n                \x3c!--end y-tree-header--\x3e\n\n                <div ui-tree="treeOptions"\n                    id="tree-root">\n                    <div ui-tree-nodes\n                        data-ng-model="customizations">\n                        <div data-ng-repeat="customization in customizations"\n                            data-ng-class="{\'perso-library__angular-ui-tree-drag\': customization.isDragging}"\n                            ui-tree-node\n                            data-ng-include="\'personalizationsmarteditManagerViewNodeTemplate.html\'"></div>\n                    </div>\n                </div>\n\n                <div class="pe-spinner--outer"\n                    data-ng-show="moreCustomizationsRequestProcessing">\n                    <div data-ng-include="\'waitDialog.html\'"></div>\n                </div>\n                \x3c!--end customization-repeat--\x3e\n            </div>\n            \x3c!--end y-tree--\x3e\n        </div>\n    </div>\n    \x3c!--end scroll zone--\x3e\n\n    <a class="perso-library__back-to-top-button"\n        title="{{\'personalization.commons.button.title.backtotop\' | translate}}"\n        data-ng-show="isReturnToTopButtonVisible()"\n        data-ng-click="scrollZoneReturnToTop()">\n        <span class="hyicon hyicon-top back-to-top"></span>\n    </a>\n\n</div>'),t.put("web/features/personalizationsmarteditcontainer/toolbarContext/personalizationsmarteditToolbarContextTemplate.html",'<div data-ng-show="ctrl.visible"\n    class="pe-toolbar-item-context">\n    <div class="btn btn-default pe-toolbar-item-context__btn">\n        <div class="pe-toolbar-item-context__btn-txt">\n            <div title="{{ctrl.title}}"\n                class="perso-wrap-ellipsis pe-toolbar-item-context__btn-title">{{ctrl.title}}</div>\n            <div title="{{ctrl.subtitle}}"\n                class="perso-wrap-ellipsis pe-toolbar-item-context__btn-subtitle">{{ctrl.subtitle}}</div>\n        </div>\n    </div>\n    <div class="btn btn-default pe-toolbar-item-context__btn-hyicon"\n        data-ng-click="ctrl.clear()">\n        <span class="hyicon hyicon-remove"></span>\n    </div>\n</div>')}])},function(t,e){angular.module("personalizationsmarteditToolbarContextModule",[]).controller("topToolbarMenuController",["$scope","personalizationsmarteditManager","personalizationsmarteditManagerView","personalizationsmarteditPreviewService","personalizationsmarteditContextService","personalizationsmarteditContextUtils","personalizationsmarteditCombinedView",function(t,e,n,i,a,o,r){t.status={isopen:!1},t.preventDefault=function(t){t.stopPropagation()},t.createCustomizationClick=function(){e.openCreateCustomizationModal()},t.managerViewClick=function(){o.clearCombinedViewCustomizeContext(a),o.clearCustomizeContextAndReloadPreview(i,a),o.clearCombinedViewContextAndReloadPreview(i,a),n.openManagerAction()},t.combinedViewClick=function(){o.clearCustomizeContextAndReloadPreview(i,a),r.openManagerAction()},t.isCustomizeCustomizationSelected=function(){return a.getCustomize().selectedCustomization},t.isCombinedViewCustomizationSelected=function(){return a.getCombinedView().customize.selectedCustomization}}]).controller("personalizationsmarteditCustomizeToolbarContextController",["$scope","$timeout","personalizationsmarteditContextService","personalizationsmarteditPreviewService","personalizationsmarteditContextUtils",function(t,e,n,i,a){var o=this;t.$watch(function(){return n.getCustomize().selectedCustomization},function(t,e){t&&t!==e?(o.title=t.name,o.visible=!0):t||(o.visible=!1)}),t.$watch(function(){return n.getCustomize().selectedVariations},function(t,e){t&&t!==e&&(o.subtitle=t.name)}),o.clear=function(){a.clearCustomizeContextAndReloadPreview(i,n),e(function(){angular.element(".personalizationsmarteditTopToolbarCustomizeButton[aria-expanded='true']").click()},0)},o.$onInit=function(){o.visible=!1,n.getCustomize().selectedCustomization&&(o.title=n.getCustomize().selectedCustomization.name,o.visible=!0,angular.isArray(n.getCustomize().selectedVariations)||(o.subtitle=n.getCustomize().selectedVariations.name))}}]).controller("personalizationsmarteditCombinedViewToolbarContextController",["$scope","personalizationsmarteditCombinedViewCommons","$timeout","personalizationsmarteditContextService","personalizationsmarteditContextUtils",function(t,e,n,i,a){var o=this;t.$watch(function(){return i.getCombinedView().customize.selectedCustomization},function(t,e){t&&t!==e?(o.title=t.name,o.subtitle=i.getCombinedView().customize.selectedVariations.name,o.visible=!0):t||(o.visible=!1)}),t.$watch(function(){return i.getCombinedView().enabled},function(t,e){!1===t&&t!==e&&a.clearCombinedViewCustomizeContext(i)}),o.clear=function(){a.clearCombinedViewCustomizeContext(i);var t=[];(i.getCombinedView().selectedItems||[]).forEach(function(e){t.push({customizationCode:e.customization.code,variationCode:e.variation.code,catalog:e.variation.catalog,catalogVersion:e.variation.catalogVersion})}),e.updatePreview(t)},o.$onInit=function(){o.visible=!1,i.getCombinedView().customize.selectedCustomization&&(o.title=i.getCombinedView().customize.selectedCustomization.name,o.subtitle=i.getCombinedView().customize.selectedVariations.name,o.visible=!0)}}]).component("personalizationsmarteditCustomizeToolbarContext",{templateUrl:"personalizationsmarteditToolbarContextTemplate.html",controller:"personalizationsmarteditCustomizeToolbarContextController",controllerAs:"ctrl",transclude:!0}).component("personalizationsmarteditCombinedViewToolbarContext",{templateUrl:"personalizationsmarteditToolbarContextTemplate.html",controller:"personalizationsmarteditCombinedViewToolbarContextController",controllerAs:"ctrl",transclude:!0})},function(t,e,n){var i={"./personalizationsmarteditCommons.js":24,"./personalizationsmarteditInfiniteScroll.js":25,"./templates.js":26};function webpackContext(t){var e=webpackContextResolve(t);return n(e)}function webpackContextResolve(t){var e=i[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}webpackContext.keys=function webpackContextKeys(){return Object.keys(i)},webpackContext.resolve=webpackContextResolve,t.exports=webpackContext,webpackContext.id=23},function(t,e){angular.module("personalizationsmarteditCommons",["personalizationcommonsTemplates","yjqueryModule","alertServiceModule","seConstantsModule","l10nModule","smarteditServicesModule","personalizationsmarteditCommonsModule"]).run(["$rootScope","PERSONALIZATION_MODEL_STATUS_CODES",function(t,e){t.PERSONALIZATION_MODEL_STATUS_CODES=e}]).filter("statusNotDeleted",["personalizationsmarteditUtils",function(t){return function(e){return angular.isArray(e)?t.getVisibleItems(e):e}}]).directive("negate",[function(){return{require:"ngModel",link:function(t,e,n,i){i.$isEmpty=function(t){return!!t},i.$formatters.unshift(function(t){return!t}),i.$parsers.unshift(function(t){return!t})}}}]).directive("personalizationCurrentElement",[function(){return{restrict:"A",link:function(t,e,n){n.personalizationCurrentElement&&t.$eval(n.personalizationCurrentElement)(e)}}}]).directive("personalizationPreventParentScroll",function(){return{restrict:"A",scope:!1,link:function(t,e){var n=function(t){var n=t.originalEvent&&(t.originalEvent.wheelDeltaY||t.originalEvent.wheelDelta),i=-(t.deltaY||t.delta)||0;e[0].scrollTop-=t.wheelDeltaY||n||t.wheelDelta||i,t.stopPropagation(),t.preventDefault(),t.returnValue=!1};e[0].addEventListener("wheel",n,!1),t.$on("$destroy",function(){e[0].removeEventListener("wheel",n,!1)})}}})},function(t,e){angular.module("personalizationsmarteditCommons").directive("personalizationInfiniteScroll",["$rootScope","yjQuery","$window","$timeout",function(t,e,n,i){return{link:function(a,o,r){var s,l,c,d;return n=angular.element(n),c=0,null!==r.personalizationInfiniteScrollDistance&&a.$watch(r.personalizationInfiniteScrollDistance,function(t){return c=parseInt(t,10)}),d=!0,s=!1,null!==r.personalizationInfiniteScrollDisabled&&a.$watch(r.personalizationInfiniteScrollDisabled,function(t){if((d=!t)&&s)return s=!1,l()}),t.$on("refreshStart",function(){o.animate({scrollTop:"0"})}),l=function(){var n,i,l;if(!(o.children().length<=0))return n=e(o.children()[0]),i=o.offset().top+o.height(),(l=n.offset().top+n.height()-i<=o.height()*c)&&d?t.$$phase?a.$eval(r.personalizationInfiniteScroll):a.$apply(r.personalizationInfiniteScroll):l?s=!0:void 0},o.on("scroll",l),a.$on("$destroy",function(){return n.off("scroll",l)}),i(function(){return r.personalizationInfiniteScrollImmediateCheck?a.$eval(r.personalizationInfiniteScrollImmediateCheck)?l():void 0:l()},0)}}}])},function(t,e){angular.module("personalizationcommonsTemplates",[]).run(["$templateCache",function(t){"use strict";t.put("web/features/personalizationcommons/dateTimePickerRange/dateTimePickerRangeTemplate.html",'<div class="pe-datetime-range">\n    <div class="col-md-6 pe-datetime-range__from"\n        data-ng-class="{\'has-error\': !$ctrl.isFromDateValid}">\n        <label for="customization-start-date"\n            data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate"\n            class="personalization-modal__label"></label>\n        <y-help data-template="\'<span data-translate=personalization.modal.customizationvariationmanagement.basicinformationtab.details.startdate.help></span>\'">\n        </y-help>\n        <div class="input-group date pe-date-field"\n            id="date-picker-range-from"\n            data-ng-show="$ctrl.isEditable">\n            <input type=\'text\'\n                name="date_from_key"\n                class="form-control pe-date-field__input"\n                placeholder="{{ $ctrl.placeholderText | translate}}"\n                data-ng-disabled="!$ctrl.isEditable"\n                name="{{$ctrl.name}}"\n                data-ng-model="$ctrl.dateFrom"\n                id="customization-start-date" />\n            <span class="input-group-addon pe-datetime-range__picker"\n                data-ng-show="$ctrl.isEditable">\n                <span class="glyphicon glyphicon-calendar pe-datetime-range__picker__icon"></span>\n            </span>\n        </div>\n        <div class="input-group date pe-date-field"\n            id="date-picker-range-from"\n            data-ng-show="!$ctrl.isEditable">\n            <input type=\'text\'\n                name="date_from_key"\n                class="form-control pe-date-field__input "\n                data-ng-class="{\'pe-input--is-disabled\': !$ctrl.isEditable}"\n                data-ng-model="$ctrl.dateFrom"\n                data-date-formatter\n                id="customization-start-date"\n                data-ng-disabled="true"\n                data-format-type="short">\n        </div>\n        <span data-ng-if="!$ctrl.isFromDateValid"\n            class="help-block pe-datetime__error-msg pe-datetime__msg"\n            data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformatfrom.description">\n        </span>\n    </div>\n    <div class="col-md-6 pe-datetime-range__to"\n        data-ng-class="{\'has-error\':!$ctrl.isToDateValid, \'has-warning\':$ctrl.isEndDateInThePast}">\n        <label for="customization-end-date"\n            data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate"\n            class="personalization-modal__label"></label>\n        <y-help data-template="\'<span data-translate=personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddate.help></span>\'">\n        </y-help>\n        <div class="input-group date pe-date-field"\n            id="date-picker-range-to">\n            <input type=\'text\'\n                name="date_to_key"\n                class="form-control pe-date-field__input"\n                placeholder="{{ $ctrl.placeholderText | translate}}"\n                data-ng-disabled="!$ctrl.isEditable"\n                name="{{$ctrl.name}}"\n                data-ng-model="$ctrl.dateTo"\n                id="customization-end-date" />\n            <span class="input-group-addon pe-datetime-range__picker"\n                data-ng-show="$ctrl.isEditable">\n                <span class="glyphicon glyphicon-calendar pe-datetime-range__picker__icon"></span>\n            </span>\n        </div>\n        <div class="input-group date pe-date-field"\n            id="date-picker-range-to"\n            data-ng-show="!$ctrl.isEditable">\n            <input type=\'text\'\n                name="date_to_key"\n                class="form-control pe-date-field__input "\n                data-ng-class="{\'pe-input--is-disabled\': !$ctrl.isEditable}"\n                data-ng-model="$ctrl.dateTo"\n                data-date-formatter\n                id="customization-end-date"\n                data-ng-disabled="true"\n                data-format-type="short">\n        </div>\n        <span class="help-block pe-datetime__error-msg pe-datetime__msg"\n            data-ng-if="!$ctrl.isToDateValid"\n            data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.wrongdateformat.description">\n        </span>\n        <span data-ng-if="$ctrl.isEndDateInThePast"\n            class="help-block pe-datetime__warning-msg pe-datetime__msg">\n            <span class="hyicon hyicon-msgwarning"></span>\n            <span data-translate="personalization.modal.customizationvariationmanagement.basicinformationtab.details.enddateinthepast.description"></span>\n        </span>\n    </div>\n</div>'),t.put("web/features/personalizationcommons/personalizationsmarteditScrollZone/personalizationsmarteditScrollZoneBottomTemplate.html",'<div class="perso__scrollzone perso__scrollzone--bottom"\n    data-ng-class="$ctrl.isTransparent?\'perso__scrollzone--transparent\':\'perso__scrollzone--normal\'"\n    data-ng-show="$ctrl.scrollZoneVisible && $ctrl.scrollZoneBottom"\n    data-ng-mouseenter="$ctrl.start=true;$ctrl.scrollBottom()"\n    data-ng-mouseleave="$ctrl.stopScroll()">\n</div>'),t.put("web/features/personalizationcommons/personalizationsmarteditScrollZone/personalizationsmarteditScrollZoneTopTemplate.html",'<div class="perso__scrollzone perso__scrollzone--top"\n    data-ng-class="$ctrl.isTransparent?\'perso__scrollzone--transparent\':\'perso__scrollzone--normal\'"\n    data-ng-show="$ctrl.scrollZoneVisible && $ctrl.scrollZoneTop"\n    data-ng-mouseenter="$ctrl.start=true;$ctrl.scrollTop()"\n    data-ng-mouseleave="$ctrl.stopScroll()">\n</div>')}])},function(t,e){function webpackEmptyContext(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,t.exports=webpackEmptyContext,webpackEmptyContext.id=27},function(t,e,n){"use strict";n.r(e);var i=n(0);function importAll(t){t.keys().forEach(function(e){t(e)})}var a=n(1),o={controller:function(){function ManageCustomizationViewController(t,e,n,i,a,o,r,s,l,c,d,m,u,p,g){this.$q=t,this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS=e,this.PERSONALIZATION_MODEL_STATUS_CODES=n,this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS=i,this.PERSONALIZATION_DATE_FORMATS=a,this.MODAL_BUTTON_ACTIONS=o,this.personalizationsmarteditRestService=r,this.personalizationsmarteditDateUtils=s,this.personalizationsmarteditMessageHandler=l,this.personalizationsmarteditCommerceCustomizationService=c,this.personalizationsmarteditUtils=d,this.confirmationModalService=m,this.systemEventService=u,this.$filter=p,this.$log=g,this.initialCustomization={name:"",enabledStartDate:"",enabledEndDate:"",status:"ENABLED",statusBoolean:!0,variations:[]},this.customization={},this.activeTabNumber=0,this.editMode=!1}return ManageCustomizationViewController.$inject=["$q","CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS","PERSONALIZATION_MODEL_STATUS_CODES","CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS","PERSONALIZATION_DATE_FORMATS","MODAL_BUTTON_ACTIONS","personalizationsmarteditRestService","personalizationsmarteditDateUtils","personalizationsmarteditMessageHandler","personalizationsmarteditCommerceCustomizationService","personalizationsmarteditUtils","confirmationModalService","systemEventService","$filter","$log"],ManageCustomizationViewController.prototype.$onInit=function(){var t=this;this.customizationCode?(this.getCustomization(),this.editMode=!0):this.customization=i.copy(this.initialCustomization),this.initTabs(),this.modalManager.setDismissCallback(function(){return t.onCancel()}),this.modalManager.setButtonHandler(function(e){switch(e){case t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK:case t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT:return t.edit.selectedTab.onConfirm();case t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_CANCEL:return t.edit.selectedTab.onCancel();default:t.$log.error(t.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.invalidbuttonid"),e)}}),this.edit={code:"",name:"",selectedTab:this.tabsArr[0]}},ManageCustomizationViewController.prototype.$doCheck=function(){var t=this.edit.selectedTab.isDirty(),e=this.edit.selectedTab.isValid();t?e?this.edit.selectedTab.setEnabled(!0):this.edit.selectedTab.setEnabled(!1):this.editMode&&e?this.edit.selectedTab.setEnabled(!0):this.edit.selectedTab.setEnabled(!1)},ManageCustomizationViewController.prototype.getVariationsForCustomization=function(t){return this.personalizationsmarteditRestService.getVariationsForCustomization(t,{includeFullFields:!0})},ManageCustomizationViewController.prototype.createCommerceCustomizationData=function(t){var e=this;t.forEach(function(t){t.commerceCustomizations=e.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCountMap(t),t.numberOfCommerceActions=e.personalizationsmarteditCommerceCustomizationService.getCommerceActionsCount(t),delete t.actions})},ManageCustomizationViewController.prototype.getCustomization=function(){var t=this,e={code:this.customizationCode};this.personalizationsmarteditRestService.getCustomization(e).then(function(e){t.customization=e,t.customization.enabledStartDate=t.personalizationsmarteditDateUtils.formatDate(t.customization.enabledStartDate,void 0),t.customization.enabledEndDate=t.personalizationsmarteditDateUtils.formatDate(t.customization.enabledEndDate,void 0),t.customization.statusBoolean=t.customization.status===t.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,t.getVariationsForCustomization(t.customizationCode).then(function(e){if(t.createCommerceCustomizationData(e.variations),t.customization.variations=e.variations,i.isDefined(t.variationCode)){var n=t.customization.variations.filter(function(e){return e.code===t.variationCode});if(n.length>0){t.activeTabNumber=1,t.edit.selectedTab=t.tabsArr[1];var a=n[0];t.edit.selectedVariation=a}t.initialCustomization=i.copy(t.customization)}else t.edit.selectedTab=t.tabsArr[0],t.initialCustomization=i.copy(t.customization)},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.gettingsegments"))})},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.gettingcomponents"))})},ManageCustomizationViewController.prototype.initTabs=function(){var t=this;this.tabsArr=[{name:this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.BASIC_INFO_TAB_NAME,active:!0,disabled:!1,heading:this.$filter("translate")("personalization.modal.customizationvariationmanagement.basicinformationtab"),template:"basicInfoTabWrapperTemplate.html",formName:this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.BASIC_INFO_TAB_FORM_NAME,isDirty:function(){return t.isModalDirty()},isValid:function(){return 0===t.isBasicInfoTabValid(t.customization).length},setEnabled:function(e){e?(t.tabsArr[1].disabled=!1,t.modalManager.enableButton(t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT)):(t.tabsArr[1].disabled=!0,t.modalManager.disableButton(t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT))},onConfirm:function(){t.activeTabNumber=1},onCancel:function(){t.onCancel()}},{name:this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.TARGET_GROUP_TAB_NAME,active:!1,disabled:!0,heading:this.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab"),template:"targetGroupTabWrapperTemplate.html",formName:this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.TARGET_GROUP_TAB_FORM_NAME,isDirty:function(){return t.isModalDirty()},isValid:function(){return 0===t.isTargetGroupTabValid(t.customization).length},setEnabled:function(e){e?t.modalManager.enableButton(t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK):t.modalManager.disableButton(t.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK)},onConfirm:function(){t.onSave()},onCancel:function(){t.onCancel()}}]},ManageCustomizationViewController.prototype.selectTab=function(t){switch(this.edit.selectedTab=t,this.activeTabNumber=this.tabsArr.indexOf(t),t.name){case this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.BASIC_INFO_TAB_NAME:this.modalManager.removeButton(this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK),this.modalManager.getButton(this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT)||this.modalManager.addButton({id:this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT,label:"personalization.modal.customizationvariationmanagement.basicinformationtab.button.next"});break;case this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS.TARGET_GROUP_TAB_NAME:this.modalManager.removeButton(this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_NEXT),this.modalManager.getButton(this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK)||this.modalManager.addButton({id:this.CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS.CONFIRM_OK,label:"personalization.modal.customizationvariationmanagement.targetgrouptab.button.submit",action:this.MODAL_BUTTON_ACTIONS.CLOSE})}},ManageCustomizationViewController.prototype.onSave=function(){var t=this;this.customization.enabledStartDate?this.customization.enabledStartDate=this.personalizationsmarteditDateUtils.formatDate(this.customization.enabledStartDate,this.PERSONALIZATION_DATE_FORMATS.MODEL_DATE_FORMAT):this.customization.enabledStartDate=void 0,this.customization.enabledEndDate?this.customization.enabledEndDate=this.personalizationsmarteditDateUtils.formatDate(this.customization.enabledEndDate,this.PERSONALIZATION_DATE_FORMATS.MODEL_DATE_FORMAT):this.customization.enabledEndDate=void 0,this.customization.status=this.customization.statusBoolean?this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED,this.editMode?this.personalizationsmarteditRestService.updateCustomizationPackage(this.customization).then(function(){t.systemEventService.sendSynchEvent("CUSTOMIZATIONS_MODIFIED",{}),t.personalizationsmarteditMessageHandler.sendSuccess(t.$filter("translate")("personalization.info.updatingcustomization"))},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.updatingcustomization"))}):this.personalizationsmarteditRestService.createCustomization(this.customization).then(function(){t.systemEventService.sendSynchEvent("CUSTOMIZATIONS_MODIFIED",{}),t.personalizationsmarteditMessageHandler.sendSuccess(t.$filter("translate")("personalization.info.creatingcustomization"))},function(){t.personalizationsmarteditMessageHandler.sendError(t.$filter("translate")("personalization.error.creatingcustomization"))})},ManageCustomizationViewController.prototype.onCancel=function(){var t=this,e=this.$q.defer();return this.isModalDirty()?this.confirmationModalService.confirm({description:this.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.cancelconfirmation")}).then(function(){t.modalManager.dismiss(),e.resolve()},function(){e.reject()}):(this.modalManager.dismiss(),e.resolve()),e.promise},ManageCustomizationViewController.prototype.isBasicInfoTabValid=function(t){var e=[];return(i.isUndefined(t.name)||""===t.name)&&e.push("name cant be empty"),e},ManageCustomizationViewController.prototype.isTargetGroupTabValid=function(t){var e=[];return i.isArray(t.variations)&&this.personalizationsmarteditUtils.getVisibleItems(t.variations).length>0||e.push("variations cant be empty"),e},ManageCustomizationViewController.prototype.isCustomizationValid=function(t){var e=[];return e.push(this.isBasicInfoTabValid(t)),e.push(this.isTargetGroupTabValid(t)),e},ManageCustomizationViewController.prototype.isModalDirty=function(){return!i.equals(this.initialCustomization,this.customization)},ManageCustomizationViewController}(),templateUrl:"manageCustomizationViewTemplate.html",bindings:{modalManager:"=",customizationCode:"<?",variationCode:"<?"}},r={controller:function(){function BasicInfoTabController(t,e){this.PERSONALIZATION_MODEL_STATUS_CODES=t,this.DATE_CONSTANTS=e,this.datetimeConfigurationEnabled=!1}return BasicInfoTabController.$inject=["PERSONALIZATION_MODEL_STATUS_CODES","DATE_CONSTANTS"],Object.defineProperty(BasicInfoTabController.prototype,"customization",{get:function(){return this._customization},set:function(t){this._customization=t,this.datetimeConfigurationEnabled=this.customization.enabledStartDate||this.customization.enabledEndDate},enumerable:!0,configurable:!0}),BasicInfoTabController.prototype.resetDateTimeConfiguration=function(){this.customization.enabledStartDate=void 0,this.customization.enabledEndDate=void 0},BasicInfoTabController.prototype.customizationStatusChange=function(){this.customization.status=this.customization.statusBoolean?this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED},BasicInfoTabController}(),templateUrl:"basicInfoTabTemplate.html",bindings:{customization:"=?"}},s={controller:function(){function TargetGroupTabController(t,e,n,i,a,o,r,s,l,c,d){this.PERSONALIZATION_MODEL_STATUS_CODES=t,this.CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS=e,this.personalizationsmarteditUtils=n,this.personalizationsmarteditTriggerService=i,this.$filter=a,this.$timeout=o,this.yjQuery=r,this.confirmationModalService=s,this.isBlank=l,this.personalizationsmarteditDateUtils=c,this.triggerTabService=d}return TargetGroupTabController.$inject=["PERSONALIZATION_MODEL_STATUS_CODES","CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS","personalizationsmarteditUtils","personalizationsmarteditTriggerService","$filter","$timeout","yjQuery","confirmationModalService","isBlank","personalizationsmarteditDateUtils","triggerTabService"],TargetGroupTabController.prototype.getActivityActionTextForVariation=function(t){return t.enabled?this.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.disable"):this.$filter("translate")("personalization.modal.customizationvariationmanagement.targetgrouptab.variation.options.enable")},TargetGroupTabController.prototype.getActivityStateForCustomization=function(t){return this.personalizationsmarteditUtils.getActivityStateForCustomization(t)},TargetGroupTabController.prototype.getActivityStateForVariation=function(t,e){return this.personalizationsmarteditUtils.getActivityStateForVariation(t,e)},TargetGroupTabController.prototype.getEnablementTextForVariation=function(t){return"("+this.personalizationsmarteditUtils.getEnablementTextForVariation(t,"personalization.modal.customizationvariationmanagement.targetgrouptab")+")"},TargetGroupTabController.prototype.setSliderConfigForAdd=function(){var t=this;this.sliderPanelConfiguration.modal.save.label="personalization.modal.customizationvariationmanagement.targetgrouptab.addvariation",this.sliderPanelConfiguration.modal.save.isDisabledFn=function(){return!t.canSaveVariation()},this.sliderPanelConfiguration.modal.save.onClick=function(){t.addVariationClick()}},TargetGroupTabController.prototype.setSliderConfigForEditing=function(){var t=this;this.sliderPanelConfiguration.modal.save.label="personalization.modal.customizationvariationmanagement.targetgrouptab.savechanges",this.sliderPanelConfiguration.modal.save.isDisabledFn=function(){return!t.canSaveVariation()},this.sliderPanelConfiguration.modal.save.onClick=function(){t.submitChangesClick()}},TargetGroupTabController.prototype.toggleSliderFullscreen=function(t){var e=this,n=i.element(".sliderPanelParentModal");n.hasClass("modal-fullscreen")||!1===t?n.removeClass("modal-fullscreen"):n.addClass("modal-fullscreen"),this.$timeout(function(){e.yjQuery(window).resize()},0)},TargetGroupTabController.prototype.confirmDefaultTrigger=function(t){var e=this;t&&this.personalizationsmarteditTriggerService.isValidExpression(this.edit.expression[0])?this.confirmationModalService.confirm({description:"personalization.modal.manager.targetgrouptab.defaulttrigger.content"}).then(function(){e.edit.showExpression=!1},function(){e.edit.isDefault=!1}):this.edit.showExpression=!t},TargetGroupTabController.prototype.canSaveVariation=function(){var t=this.triggerTabService.getTriggersTabs(),e=t.every(function(t){return t.isValidOrEmpty()}),n=t.some(function(t){return t.isTriggerDefined()}),i=!this.isBlank(this.edit.name);return i=i&&(this.edit.isDefault||n&&e)},TargetGroupTabController.prototype.addVariationClick=function(){var t=this;this.customization.variations.push({code:this.edit.code,name:this.edit.name,enabled:!0,status:this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,triggers:this.personalizationsmarteditTriggerService.buildTriggers(this.edit,this.edit.selectedVariation.triggers||[]),rank:this.customization.variations.length,isNew:!0}),this.clearEditedVariationDetails(),this.toggleSliderFullscreen(!1),this.$timeout(function(){t.hideSliderPanel()},0)},TargetGroupTabController.prototype.submitChangesClick=function(){var t=this,e=this.personalizationsmarteditTriggerService.buildTriggers(this.edit,this.edit.selectedVariation.triggers||[]);this.edit.selectedVariation.triggers=e,this.edit.selectedVariation.name=this.edit.name,this.edit.selectedVariation=void 0,this.toggleSliderFullscreen(!1),this.$timeout(function(){t.hideSliderPanel()},0)},TargetGroupTabController.prototype.cancelChangesClick=function(){this.isVariationSelected()?this.edit.selectedVariation=void 0:this.clearEditedVariationDetails(),this.toggleSliderFullscreen(!1),this.hideSliderPanel()},TargetGroupTabController.prototype.isVariationSelected=function(){return i.isDefined(this.edit.selectedVariation)},TargetGroupTabController.prototype.clearEditedVariationDetails=function(){this.edit.code="",this.edit.name="",this.edit.expression=[],this.edit.isDefault=!1,this.edit.showExpression=!0},TargetGroupTabController.prototype.setVariationRank=function(t,e,n,i){if(i)n.stopPropagation();else{var a=this.customization.variations.indexOf(t),o=this.personalizationsmarteditUtils.getValidRank(this.customization.variations,t,e),r=this.customization.variations;o>=0&&o<r.length&&(r.splice(o,0,r.splice(a,1)[0]),this.recalculateRanksForVariations())}},TargetGroupTabController.prototype.recalculateRanksForVariations=function(){var t=this;this.customization.variations.forEach(function(e,n){t.customization.variations[n].rank=n})},TargetGroupTabController.prototype.removeVariationClick=function(t){var e=this;this.confirmationModalService.confirm({description:"personalization.modal.manager.targetgrouptab.deletevariation.content"}).then(function(){t.isNew?e.customization.variations.splice(e.customization.variations.indexOf(t),1):t.status="DELETED",e.edit.selectedVariation=void 0,e.recalculateRanksForVariations()})},TargetGroupTabController.prototype.addVariationAction=function(){this.clearEditedVariationDetails(),this.setSliderConfigForAdd(),this.showSliderPanel(),this.edit.selectedVariation={triggers:[]}},TargetGroupTabController.prototype.editVariationAction=function(t){this.setSliderConfigForEditing(),this.edit.selectedVariation=t,this.edit.code=t.code,this.edit.name=t.name,this.edit.isDefault=this.personalizationsmarteditTriggerService.isDefault(t.triggers),this.edit.showExpression=!this.edit.isDefault,this.showSliderPanel()},TargetGroupTabController.prototype.toogleVariationActive=function(t){t.enabled=!t.enabled,t.status=t.enabled?this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED:this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED},TargetGroupTabController.prototype.$onInit=function(){var t=this;this.edit=this.triggerTabService.getTriggerDataState(),this.sliderPanelConfiguration={modal:{showDismissButton:!0,title:"personalization.modal.customizationvariationmanagement.targetgrouptab.slidingpanel.title",cancel:{label:"personalization.modal.customizationvariationmanagement.targetgrouptab.cancelchanges",onClick:function(){t.cancelChangesClick()}},dismiss:{onClick:function(){t.cancelChangesClick()}},save:{}},cssSelector:"#y-modal-dialog"};var e={id:"segmentTrigger",title:"personalization.modal.customizationvariationmanagement.targetgrouptab.segments",templateUrl:"personalizationsmarteditSegmentViewWrapperTemplate.html",isTriggerDefined:function(){return t.personalizationsmarteditTriggerService.isValidExpression(t.edit.expression[0])},isValidOrEmpty:function(){return t.edit.expression=t.edit.expression||[{nodes:[]}],t.personalizationsmarteditTriggerService.isValidExpression(t.edit.expression[0])||0===t.edit.expression.length||0===t.edit.expression[0].nodes.length||t.personalizationsmarteditTriggerService.isDropzone(t.edit.expression[0].nodes[0])}};this.triggerTabService.addTriggerTab(e)},TargetGroupTabController.prototype.$onChanges=function(t){t.variation&&t.variation.currentValue&&this.editVariationAction(t.variation.currentValue)},TargetGroupTabController}(),templateUrl:"targetGroupTabTemplate.html",bindings:{customization:"=?",variation:"<?"}},l=function(){function TriggerService(){this.DEFAULT_TRIGGER="defaultTriggerData",this.SEGMENT_TRIGGER="segmentTriggerData",this.EXPRESSION_TRIGGER="expressionTriggerData",this.supportedTypes=[this.DEFAULT_TRIGGER,this.SEGMENT_TRIGGER,this.EXPRESSION_TRIGGER],this.actions=[{id:"AND",name:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.and"},{id:"OR",name:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.or"},{id:"NOT",name:"personalization.modal.customizationvariationmanagement.targetgrouptab.expression.not"}],this.GROUP_EXPRESSION="groupExpressionData",this.SEGMENT_EXPRESSION="segmentExpressionData",this.NEGATION_EXPRESSION="negationExpressionData",this.CONTAINER_TYPE="container",this.ITEM_TYPE="item",this.DROPZONE_TYPE="dropzone"}return TriggerService.prototype.isContainer=function(t){return this.isElementOfType(t,this.CONTAINER_TYPE)},TriggerService.prototype.isEmptyContainer=function(t){return this.isContainer(t)&&0===t.nodes.length},TriggerService.prototype.isNotEmptyContainer=function(t){return this.isContainer(t)&&t.nodes.length>0},TriggerService.prototype.isDropzone=function(t){return this.isElementOfType(t,this.DROPZONE_TYPE)},TriggerService.prototype.isItem=function(t){return this.isElementOfType(t,this.ITEM_TYPE)},TriggerService.prototype.isValidExpression=function(t){var e=this;return!!t&&(this.isContainer(t)?t.nodes&&t.nodes.length>0&&t.nodes.every(function(t){return e.isValidExpression(t)}):i.isDefined(t.selectedSegment))},TriggerService.prototype.buildTriggers=function(t,e){var n={};if(t=t||{},this.isDefaultData(t))n=this.buildDefaultTrigger();else if(t.expression&&t.expression.length>0){var i=t.expression[0];n=this.isDropzone(i.nodes[0])?{}:this.isExpressionData(i)?this.buildExpressionTrigger(i):this.buildSegmentTrigger(i)}return this.mergeTriggers(e,n)},TriggerService.prototype.buildData=function(t){var e=this,n={},i=this.getBaseData();return t&&t.length>0&&(n=t.filter(function(t){return e.isSupportedTrigger(t)})[0]),this.isDefaultTrigger(n)||(this.isExpressionTrigger(n)?i=this.buildExpressionTriggerData(n):this.isSegmentTrigger(n)&&(i=this.buildSegmentTriggerData(n))),i},TriggerService.prototype.isDefault=function(t){var e=this,n=(t||[]).filter(function(t){return e.isDefaultTrigger(t)})[0];return!(!t||!n)},TriggerService.prototype.getExpressionAsString=function(t){var e=this,n="";if(void 0===t)return n;var i=this.isNegation(t)?"AND":t.operation.id;return n+=this.isNegation(t)?" NOT ":"",n+="(",t.nodes.forEach(function(t,a){e.isDropzone(t)?n+=" [] ":(n+=a>0?" "+i+" ":"",n+=e.isItem(t)?t.selectedSegment.code:e.getExpressionAsString(t))}),n+=")"},TriggerService.prototype.isElementOfType=function(t,e){return!!i.isDefined(t)&&t.type===e},TriggerService.prototype.isNegation=function(t){return this.isContainer(t)&&"NOT"===t.operation.id},TriggerService.prototype.isDefaultData=function(t){return t.isDefault},TriggerService.prototype.isExpressionData=function(t){var e=this;return"NOT"===t.operation.id||t.nodes.some(function(t){return!e.isItem(t)})},TriggerService.prototype.isSupportedTrigger=function(t){return this.supportedTypes.indexOf(t.type)>=0},TriggerService.prototype.isDefaultTrigger=function(t){return this.isElementOfType(t,this.DEFAULT_TRIGGER)},TriggerService.prototype.isSegmentTrigger=function(t){return this.isElementOfType(t,this.SEGMENT_TRIGGER)},TriggerService.prototype.isExpressionTrigger=function(t){return this.isElementOfType(t,this.EXPRESSION_TRIGGER)},TriggerService.prototype.isGroupExpressionData=function(t){return this.isElementOfType(t,this.GROUP_EXPRESSION)},TriggerService.prototype.isSegmentExpressionData=function(t){return this.isElementOfType(t,this.SEGMENT_EXPRESSION)},TriggerService.prototype.isNegationExpressionData=function(t){return this.isElementOfType(t,this.NEGATION_EXPRESSION)},TriggerService.prototype.buildSegmentsForTrigger=function(t){var e=this;return t.nodes.filter(function(t){return e.isItem(t)}).map(function(t){return t.selectedSegment})},TriggerService.prototype.buildExpressionForTrigger=function(t){var e=this;if(this.isNegation(t)){var n=[];return t.nodes.forEach(function(t){n.push(e.buildExpressionForTrigger(t))}),{type:this.NEGATION_EXPRESSION,element:{type:this.GROUP_EXPRESSION,operator:"AND",elements:n}}}if(this.isContainer(t)){var i=[];return t.nodes.forEach(function(t){i.push(e.buildExpressionForTrigger(t))}),{type:this.GROUP_EXPRESSION,operator:t.operation.id,elements:i}}return{type:this.SEGMENT_EXPRESSION,code:t.selectedSegment.code}},TriggerService.prototype.buildDefaultTrigger=function(){return{type:this.DEFAULT_TRIGGER}},TriggerService.prototype.buildExpressionTrigger=function(t){return{type:this.EXPRESSION_TRIGGER,expression:this.buildExpressionForTrigger(t)}},TriggerService.prototype.buildSegmentTrigger=function(t){return{type:this.SEGMENT_TRIGGER,groupBy:t.operation.id,segments:this.buildSegmentsForTrigger(t)}},TriggerService.prototype.mergeTriggers=function(t,e){var n=this;if(!i.isDefined(t))return[e];var a=t.findIndex(function(t){return t.type===e.type});a>=0&&(e.code=t[a].code);var o=t.filter(function(t){return!n.isSupportedTrigger(t)});return i.equals(e,{})||o.push(e),o},TriggerService.prototype.buildContainer=function(t){var e=this.actions.filter(function(e){return e.id===t})[0];return{type:this.CONTAINER_TYPE,operation:e,nodes:[]}},TriggerService.prototype.buildItem=function(t){return{type:this.ITEM_TYPE,operation:"",selectedSegment:{code:t},nodes:[]}},TriggerService.prototype.getBaseData=function(){return[this.buildContainer("AND")]},TriggerService.prototype.buildExpressionFromTrigger=function(t){var e,n=this;if(this.isGroupExpressionData(t))(e=this.buildContainer(t.operator)).nodes=t.elements.map(function(t){return n.buildExpressionFromTrigger(t)});else if(this.isNegationExpressionData(t)){e=this.buildContainer("NOT");var i=this.buildExpressionFromTrigger(t.element);this.isGroupExpressionData(t.element)&&"AND"===t.element.operator?e.nodes=i.nodes:e.nodes.push(i)}else this.isSegmentExpressionData(t)&&(e=this.buildItem(t.code));return e},TriggerService.prototype.buildSegmentTriggerData=function(t){var e=this,n=this.buildContainer(t.groupBy);return t.segments.forEach(function(t){n.nodes.push(e.buildItem(t.code))}),[n]},TriggerService.prototype.buildExpressionTriggerData=function(t){return[this.buildExpressionFromTrigger(t.expression)]},TriggerService}(),c=i.module("personalizationsmarteditManageCustomizationViewModule",["modalServiceModule","coretemplates","ui.select","confirmationModalServiceModule","functionsModule","personalizationsmarteditCommons","personalizationsmarteditDataFactory","sliderPanelModule","seConstantsModule","yjqueryModule","personalizationsmarteditCommonsModule"]).constant("CUSTOMIZATION_VARIATION_MANAGEMENT_TABS_CONSTANTS",{BASIC_INFO_TAB_NAME:"basicinfotab",BASIC_INFO_TAB_FORM_NAME:"form.basicinfotab",TARGET_GROUP_TAB_NAME:"targetgrptab",TARGET_GROUP_TAB_FORM_NAME:"form.targetgrptab"}).constant("CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS",{CONFIRM_OK:"confirmOk",CONFIRM_CANCEL:"confirmCancel",CONFIRM_NEXT:"confirmNext"}).constant("CUSTOMIZATION_VARIATION_MANAGEMENT_SEGMENTTRIGGER_GROUPBY",{CRITERIA_AND:"AND",CRITERIA_OR:"OR"}).constant("DATE_CONSTANTS",{ANGULAR_FORMAT:"short",MOMENT_FORMAT:"M/D/YY h:mm A",MOMENT_ISO:"YYYY-MM-DDTHH:mm:00ZZ",ISO:"yyyy-MM-ddTHH:mm:00Z"}).component("manageCustomizationViewComponent",o).component("basicInfoTabComponent",r).component("targetGroupTabComponent",s).service("personalizationsmarteditTriggerService",l).factory("personalizationsmarteditManager",["modalService","MODAL_BUTTON_ACTIONS","MODAL_BUTTON_STYLES","CUSTOMIZATION_VARIATION_MANAGEMENT_BUTTONS",function(t,e,n,i){"ngInject";return this.openCreateCustomizationModal=function(){return t.open({title:"personalization.modal.customizationvariationmanagement.title",templateInline:'<manage-customization-view-component data-modal-manager="modalManager"/>',controller:["$scope","modalManager",function(t,e){t.modalManager=e}],buttons:[{id:i.CONFIRM_CANCEL,label:"personalization.modal.customizationvariationmanagement.button.cancel",style:n.SECONDARY}],size:"lg sliderPanelParentModal"})},this.openEditCustomizationModal=function(e,i){return t.open({title:"personalization.modal.customizationvariationmanagement.title",templateInline:'<manage-customization-view-component data-modal-manager="modalManager" data-customization-code="customizationCode" data-variation-code="variationCode"/>',controller:["$scope","modalManager",function(t,n){t.customizationCode=e,t.variationCode=i,t.modalManager=n}],buttons:[{id:"confirmCancel",label:"personalization.modal.customizationvariationmanagement.button.cancel",style:n.SECONDARY}],size:"lg sliderPanelParentModal"})},this}]),d=function(){return function Personalization(){this.enabled=!1}}(),m=function(){return function Customize(){this.enabled=!1,this.selectedCustomization=null,this.selectedVariations=null,this.selectedComponents=null}}(),u=function(){return function CombinedView(){this.enabled=!1,this.selectedItems=null,this.customize=new m}}(),p=function(){return function SeData(){this.pageId=null,this.seExperienceData=null,this.seConfigurationData=null}}(),g=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},v=function(){function PersonalizationsmarteditContextUtils(){}return PersonalizationsmarteditContextUtils.prototype.getContextObject=function(){return{personalization:new d,customize:new m,combinedView:new u,seData:new p}},PersonalizationsmarteditContextUtils.prototype.clearCustomizeContext=function(t){var e=t.getCustomize();e.enabled=!1,e.selectedCustomization=null,e.selectedVariations=null,e.selectedComponents=null,t.setCustomize(e)},PersonalizationsmarteditContextUtils.prototype.clearCustomizeContextAndReloadPreview=function(t,e){var n=i.copy(e.getCustomize().selectedVariations);this.clearCustomizeContext(e),i.isObject(n)&&!i.isArray(n)&&t.removePersonalizationDataFromPreview()},PersonalizationsmarteditContextUtils.prototype.clearCombinedViewCustomizeContext=function(t){var e=t.getCombinedView();e.customize.enabled=!1,e.customize.selectedCustomization=null,e.customize.selectedVariations=null,e.customize.selectedComponents=null,(e.selectedItems||[]).forEach(function(t){delete t.highlighted}),t.setCombinedView(e)},PersonalizationsmarteditContextUtils.prototype.clearCombinedViewContext=function(t){var e=t.getCombinedView();e.enabled=!1,e.selectedItems=null,t.setCombinedView(e)},PersonalizationsmarteditContextUtils.prototype.clearCombinedViewContextAndReloadPreview=function(t,e){var n=i.copy(e.getCombinedView().enabled),a=i.copy(e.getCombinedView().selectedItems);this.clearCombinedViewContext(e),n&&a&&t.removePersonalizationDataFromPreview()},PersonalizationsmarteditContextUtils=g([Object(a.SeInjectable)()],PersonalizationsmarteditContextUtils)}(),f=n(2),z=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},h={provide:"PERSONALIZATION_DATE_FORMATS",useValue:{SHORT_DATE_FORMAT:"M/D/YY",MODEL_DATE_FORMAT:"YYYY-MM-DDTHH:mm:SSZ"}},C=function(){function PersonalizationsmarteditDateUtils(t,e,n,i){this.$filter=t,this.DATE_CONSTANTS=e,this.PERSONALIZATION_DATE_FORMATS=n,this.isBlank=i}return PersonalizationsmarteditDateUtils.$inject=["$filter","DATE_CONSTANTS","PERSONALIZATION_DATE_FORMATS","isBlank"],PersonalizationsmarteditDateUtils.prototype.formatDate=function(t,e){return e=e||this.DATE_CONSTANTS.MOMENT_FORMAT,t?(t.match&&t.match(/^(\d{4})\-(\d{2})\-(\d{2})T(\d{2}):(\d{2}):(\d{2})(\+|\-)(\d{4})$/)&&(t=t.slice(0,-2)+":"+t.slice(-2)),f(new Date(t)).format(e)):""},PersonalizationsmarteditDateUtils.prototype.formatDateWithMessage=function(t,e){return e=e||this.PERSONALIZATION_DATE_FORMATS.SHORT_DATE_FORMAT,t?this.formatDate(t,e):this.$filter("translate")("personalization.toolbar.pagecustomizations.nodatespecified")},PersonalizationsmarteditDateUtils.prototype.isDateInThePast=function(t){return!this.isBlank(t)&&f(t,this.DATE_CONSTANTS.MOMENT_FORMAT).isBefore()},PersonalizationsmarteditDateUtils.prototype.isDateValidOrEmpty=function(t){return this.isBlank(t)||f(t,this.DATE_CONSTANTS.MOMENT_FORMAT).isValid()},PersonalizationsmarteditDateUtils.prototype.isDateRangeValid=function(t,e){return!(!this.isBlank(t)&&!this.isBlank(e))||f(new Date(t)).isSameOrBefore(f(new Date(e)))},PersonalizationsmarteditDateUtils.prototype.isDateStrFormatValid=function(t,e){return e=e||this.DATE_CONSTANTS.MOMENT_FORMAT,!this.isBlank(t)&&f(t,e,!0).isValid()},PersonalizationsmarteditDateUtils=z([Object(a.SeInjectable)()],PersonalizationsmarteditDateUtils)}(),b=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},S={provide:"PERSONALIZATION_MODEL_STATUS_CODES",useValue:{ENABLED:"ENABLED",DISABLED:"DISABLED"}},T={provide:"PERSONALIZATION_VIEW_STATUS_MAPPING_CODES",useValue:{ALL:"ALL",ENABLED:"ENABLED",DISABLED:"DISABLED"}},_={provide:"PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING",useValue:{0:{borderClass:"personalizationsmarteditComponentSelected0",listClass:"personalizationsmarteditComponentSelectedList0"},1:{borderClass:"personalizationsmarteditComponentSelected1",listClass:"personalizationsmarteditComponentSelectedList1"},2:{borderClass:"personalizationsmarteditComponentSelected2",listClass:"personalizationsmarteditComponentSelectedList2"},3:{borderClass:"personalizationsmarteditComponentSelected3",listClass:"personalizationsmarteditComponentSelectedList3"},4:{borderClass:"personalizationsmarteditComponentSelected4",listClass:"personalizationsmarteditComponentSelectedList4"},5:{borderClass:"personalizationsmarteditComponentSelected5",listClass:"personalizationsmarteditComponentSelectedList5"},6:{borderClass:"personalizationsmarteditComponentSelected6",listClass:"personalizationsmarteditComponentSelectedList6"},7:{borderClass:"personalizationsmarteditComponentSelected7",listClass:"personalizationsmarteditComponentSelectedList7"},8:{borderClass:"personalizationsmarteditComponentSelected8",listClass:"personalizationsmarteditComponentSelectedList8"},9:{borderClass:"personalizationsmarteditComponentSelected9",listClass:"personalizationsmarteditComponentSelectedList9"},10:{borderClass:"personalizationsmarteditComponentSelected10",listClass:"personalizationsmarteditComponentSelectedList10"},11:{borderClass:"personalizationsmarteditComponentSelected11",listClass:"personalizationsmarteditComponentSelectedList11"},12:{borderClass:"personalizationsmarteditComponentSelected12",listClass:"personalizationsmarteditComponentSelectedList12"},13:{borderClass:"personalizationsmarteditComponentSelected13",listClass:"personalizationsmarteditComponentSelectedList13"},14:{borderClass:"personalizationsmarteditComponentSelected14",listClass:"personalizationsmarteditComponentSelectedList14"}}},y=function(){function PersonalizationsmarteditUtils(t,e,n,i,a,o,r){this.$q=t,this.$filter=e,this.l10nFilter=n,this.PERSONALIZATION_MODEL_STATUS_CODES=i,this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES=a,this.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING=o,this.catalogService=r}return PersonalizationsmarteditUtils.$inject=["$q","$filter","l10nFilter","PERSONALIZATION_MODEL_STATUS_CODES","PERSONALIZATION_VIEW_STATUS_MAPPING_CODES","PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING","catalogService"],PersonalizationsmarteditUtils.prototype.pushToArrayIfValueExists=function(t,e,n){n&&t.push({key:e,value:n})},PersonalizationsmarteditUtils.prototype.getVariationCodes=function(t){return void 0===typeof t||null===t?[]:t.map(function(t){return t.code}).filter(function(t){return void 0!==t})},PersonalizationsmarteditUtils.prototype.getVariationKey=function(t,e){return void 0===t||void 0===e?[]:e.map(function(e){return{variationCode:e.code,customizationCode:t,catalog:e.catalog,catalogVersion:e.catalogVersion}})},PersonalizationsmarteditUtils.prototype.getSegmentTriggerForVariation=function(t){var e=(t.triggers||[]).filter(function(t){return"segmentTriggerData"===t.type});return 0===e.length?{}:e[0]},PersonalizationsmarteditUtils.prototype.isPersonalizationItemEnabled=function(t){return t.status===this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED},PersonalizationsmarteditUtils.prototype.getTranslateFilter=function(){return this.$filter("translate")},PersonalizationsmarteditUtils.prototype.getEnablementTextForCustomization=function(t,e){return e=e||"personalization",this.isPersonalizationItemEnabled(t)?this.getTranslateFilter()(e+".customization.enabled"):this.getTranslateFilter()(e+".customization.disabled")},PersonalizationsmarteditUtils.prototype.getEnablementTextForVariation=function(t,e){return e=e||"personalization",this.isPersonalizationItemEnabled(t)?this.getTranslateFilter()(e+".variation.enabled"):this.getTranslateFilter()(e+".variation.disabled")},PersonalizationsmarteditUtils.prototype.getEnablementActionTextForVariation=function(t,e){return e=e||"personalization",this.isPersonalizationItemEnabled(t)?this.getTranslateFilter()(e+".variation.options.disable"):this.getTranslateFilter()(e+".variation.options.enable")},PersonalizationsmarteditUtils.prototype.getActivityStateForCustomization=function(t){return t.status===this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED?f().isBetween(new Date(t.enabledStartDate),new Date(t.enabledEndDate),"minute","[]")?"perso__status--enabled":"perso__status--ignore":"perso__status--disabled"},PersonalizationsmarteditUtils.prototype.getActivityStateForVariation=function(t,e){return e.enabled?this.getActivityStateForCustomization(t):"perso__status--disabled"},PersonalizationsmarteditUtils.prototype.isItemVisible=function(t){return"DELETED"!==t.status},PersonalizationsmarteditUtils.prototype.getVisibleItems=function(t){var e=this;return t.filter(function(t){return e.isItemVisible(t)})},PersonalizationsmarteditUtils.prototype.getValidRank=function(t,e,n){for(var i=t.indexOf(e),a=n<0?-1:1,o=i+n;o>=0&&o<t.length&&!this.isItemVisible(t[o]);)o+=a;return t[o=(o=o>=t.length?t.length-1:o)<0?0:o].rank},PersonalizationsmarteditUtils.prototype.getStatusesMapping=function(){var t=[];return t.push({code:this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES.ALL,text:"personalization.context.status.all",modelStatuses:[this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED,this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED]}),t.push({code:this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES.ENABLED,text:"personalization.context.status.enabled",modelStatuses:[this.PERSONALIZATION_MODEL_STATUS_CODES.ENABLED]}),t.push({code:this.PERSONALIZATION_VIEW_STATUS_MAPPING_CODES.DISABLED,text:"personalization.context.status.disabled",modelStatuses:[this.PERSONALIZATION_MODEL_STATUS_CODES.DISABLED]}),t},PersonalizationsmarteditUtils.prototype.getClassForElement=function(t){var e=t%Object.keys(this.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING).length;return this.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING[e].listClass},PersonalizationsmarteditUtils.prototype.getLetterForElement=function(t){var e=t%Object.keys(this.PERSONALIZATION_COMBINED_VIEW_CSS_MAPPING).length;return String.fromCharCode("a".charCodeAt(0)+e).toUpperCase()},PersonalizationsmarteditUtils.prototype.getCommerceCustomizationTooltip=function(t,e,n){var a=this;e=e||"",n=n||"\n";var o="";return i.forEach(t.commerceCustomizations,function(t,i){o+=e+a.$filter("translate")("personalization.modal.manager.commercecustomization."+i)+": "+t+n}),o},PersonalizationsmarteditUtils.prototype.getCommerceCustomizationTooltipHTML=function(t){return this.getCommerceCustomizationTooltip(t,"<div>","</div>")},PersonalizationsmarteditUtils.prototype.isItemFromCurrentCatalog=function(t,e){var n=e.seExperienceData.catalogDescriptor;return t.catalog===n.catalogId&&t.catalogVersion===n.catalogVersion},PersonalizationsmarteditUtils.prototype.hasCommerceActions=function(t){return t.numberOfCommerceActions>0},PersonalizationsmarteditUtils.prototype.getCatalogVersionNameByUuid=function(t){var e=this,n=this.$q.defer();return this.catalogService.getCatalogVersionByUuid(t).then(function(t){n.resolve(e.l10nFilter(t.catalogName)+" ("+t.version+")")}),n.promise},PersonalizationsmarteditUtils.prototype.getAndSetCatalogVersionNameL10N=function(t){this.getCatalogVersionNameByUuid(t.catalog+"/"+t.catalogVersion).then(function(e){t.catalogVersionNameL10N=e})},PersonalizationsmarteditUtils=b([Object(a.SeInjectable)()],PersonalizationsmarteditUtils)}(),A=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},E=function(){function DateTimePickerRangeComponent(t,e,n,i,a){this.DATE_CONSTANTS=t,this.personalizationsmarteditDateUtils=e,this.$element=n,this.$scope=i,this.languageService=a,this.placeholderText="personalization.commons.datetimepicker.placeholder",this.isFromDateValid=!1,this.isToDateValid=!1,this.isEndDateInThePast=!1}return DateTimePickerRangeComponent.$inject=["DATE_CONSTANTS","personalizationsmarteditDateUtils","$element","$scope","languageService"],DateTimePickerRangeComponent.prototype.$onInit=function(){this.actionsIfisEditable()},DateTimePickerRangeComponent.prototype.getDateOrDefault=function(t){try{return f(new Date(t))}catch(t){return!1}},DateTimePickerRangeComponent.prototype.actionsIfisEditable=function(){var t=this;this.isEditable&&(this.getFromPickerNode().datetimepicker({format:this.DATE_CONSTANTS.MOMENT_FORMAT,showClear:!0,showClose:!0,useCurrent:!1,keepInvalid:!0,locale:this.languageService.getBrowserLocale().split("-")[0]}).on("dp.change dp.hide",function(t){var e=this.personalizationsmarteditDateUtils.formatDate(t.date,void 0);this.personalizationsmarteditDateUtils.isDateValidOrEmpty(e)&&this.personalizationsmarteditDateUtils.isDateValidOrEmpty(this.dateTo)&&!this.personalizationsmarteditDateUtils.isDateRangeValid(e,this.dateTo)&&(e=i.copy(this.dateTo)),this.dateFrom=e}.bind(this)),this.getToPickerNode().datetimepicker({format:this.DATE_CONSTANTS.MOMENT_FORMAT,showClear:!0,showClose:!0,useCurrent:!1,keepInvalid:!0,locale:this.languageService.getBrowserLocale().split("-")[0]}).on("dp.change dp.hide",function(t){var e=this.personalizationsmarteditDateUtils.formatDate(t.date,void 0);this.personalizationsmarteditDateUtils.isDateValidOrEmpty(e)&&this.personalizationsmarteditDateUtils.isDateValidOrEmpty(this.dateFrom)&&!this.personalizationsmarteditDateUtils.isDateRangeValid(this.dateFrom,e)&&(e=i.copy(this.dateFrom)),this.dateTo=e}.bind(this)),this.$scope.$watch("this.$ctrl.dateFrom",function(){t.isFromDateValid=t.personalizationsmarteditDateUtils.isDateValidOrEmpty(t.dateFrom),t.personalizationsmarteditDateUtils.isDateStrFormatValid(t.dateFrom,t.DATE_CONSTANTS.MOMENT_FORMAT)?t.getToDatetimepicker().minDate(t.getMinToDate(t.dateFrom)):t.getToDatetimepicker().minDate(f())},!0),this.$scope.$watch("this.$ctrl.dateTo",function(){t.personalizationsmarteditDateUtils.isDateValidOrEmpty(t.dateTo)?(t.isToDateValid=!0,t.isEndDateInThePast=t.personalizationsmarteditDateUtils.isDateInThePast(t.dateTo)):(t.isToDateValid=!1,t.isEndDateInThePast=!1),t.personalizationsmarteditDateUtils.isDateStrFormatValid(t.dateTo,t.DATE_CONSTANTS.MOMENT_FORMAT)?t.getFromDatetimepicker().maxDate(t.getDateOrDefault(t.dateTo)):""===t.dateTo&&t.getFromDatetimepicker().maxDate(!1)},!0))},DateTimePickerRangeComponent.prototype.getMinToDate=function(t){return this.personalizationsmarteditDateUtils.isDateInThePast(t)?f():this.getDateOrDefault(t)},DateTimePickerRangeComponent.prototype.getFromPickerNode=function(){return this.$element.querySelectorAll("#date-picker-range-from")},DateTimePickerRangeComponent.prototype.getFromDatetimepicker=function(){return this.getFromPickerNode().datetimepicker().data("DateTimePicker")},DateTimePickerRangeComponent.prototype.getToPickerNode=function(){return this.$element.querySelectorAll("#date-picker-range-to")},DateTimePickerRangeComponent.prototype.getToDatetimepicker=function(){return this.getToPickerNode().datetimepicker().data("DateTimePicker")},DateTimePickerRangeComponent=A([Object(a.SeComponent)({templateUrl:"dateTimePickerRangeTemplate.html",inputs:["name: =","dateFrom: =","dateTo: =","isEditable: =","dateFormat: ="]})],DateTimePickerRangeComponent)}(),I=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},O=function(){function IsDateValidOrEmptyDirective(t){this.personalizationsmarteditDateUtils=t}return IsDateValidOrEmptyDirective.$inject=["personalizationsmarteditDateUtils"],IsDateValidOrEmptyDirective.prototype.isDateInThePast=function(t){return this.personalizationsmarteditDateUtils.isDateValidOrEmpty(t)},IsDateValidOrEmptyDirective=I([Object(a.SeDirective)({require:"ngModel",selector:"[isdatevalidorempty]"})],IsDateValidOrEmptyDirective)}(),w=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},D=function(){function PaginationHelper(t){t=t||{},this.count=t.count||0,this.page=t.page||0,this.totalCount=t.totalCount||0,this.totalPages=t.totalPages||0}return PaginationHelper.$inject=["initialData"],PaginationHelper.prototype.reset=function(){this.count=50,this.page=-1,this.totalPages=1,this.totalCount=0},PaginationHelper.prototype.getCount=function(){return this.count},PaginationHelper.prototype.getPage=function(){return this.page},PaginationHelper.prototype.getTotalCount=function(){return this.totalCount},PaginationHelper.prototype.getTotalPages=function(){return this.totalPages},PaginationHelper=w([Object(a.SeInjectable)()],PaginationHelper)}(),M=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},P=function(){function PersonalizationsmarteditMessageHandler(t){this.alertService=t}return PersonalizationsmarteditMessageHandler.$inject=["alertService"],PersonalizationsmarteditMessageHandler.prototype.sendInformation=function(t){this.alertService.showInfo(t)},PersonalizationsmarteditMessageHandler.prototype.sendError=function(t){this.alertService.showDanger(t)},PersonalizationsmarteditMessageHandler.prototype.sendWarning=function(t){this.alertService.showWarning(t)},PersonalizationsmarteditMessageHandler.prototype.sendSuccess=function(t){this.alertService.showSuccess(t)},PersonalizationsmarteditMessageHandler=M([Object(a.SeInjectable)()],PersonalizationsmarteditMessageHandler)}(),V=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},N=function(){function PersonalizationsmarteditCommerceCustomizationService(){this.nonCommerceActionTypes=["cxCmsActionData"],this.types=[]}return PersonalizationsmarteditCommerceCustomizationService.prototype.isNonCommerceAction=function(t){return this.nonCommerceActionTypes.some(function(e){return e===t.type})},PersonalizationsmarteditCommerceCustomizationService.prototype.isCommerceAction=function(t){return!this.isNonCommerceAction(t)},PersonalizationsmarteditCommerceCustomizationService.prototype.isTypeEnabled=function(t,e){return void 0!==e&&null!==e&&!0===e[t.confProperty]},PersonalizationsmarteditCommerceCustomizationService.prototype.registerType=function(t){var e=t.type,n=!1;this.types.forEach(function(t){t.type===e&&(n=!0)}),n||this.types.push(t)},PersonalizationsmarteditCommerceCustomizationService.prototype.getAvailableTypes=function(t){var e=this;return this.types.filter(function(n){return e.isTypeEnabled(n,t)})},PersonalizationsmarteditCommerceCustomizationService.prototype.isCommerceCustomizationEnabled=function(t){return this.getAvailableTypes(t).length>0},PersonalizationsmarteditCommerceCustomizationService.prototype.getNonCommerceActionsCount=function(t){return(t.actions||[]).filter(this.isNonCommerceAction,this).length},PersonalizationsmarteditCommerceCustomizationService.prototype.getCommerceActionsCountMap=function(t){var e={};return(t.actions||[]).filter(this.isCommerceAction,this).forEach(function(t){var n=t.type.toLowerCase(),i=e[n];void 0===i?i=1:i+=1,e[n]=i}),e},PersonalizationsmarteditCommerceCustomizationService.prototype.getCommerceActionsCount=function(t){return(t.actions||[]).filter(this.isCommerceAction,this).length},PersonalizationsmarteditCommerceCustomizationService=V([Object(a.SeInjectable)()],PersonalizationsmarteditCommerceCustomizationService)}(),x=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},R=function(){function PersonalizationsmarteditScrollZoneComponent(t,e,n,i){this.$scope=t,this.$timeout=e,this.$compile=n,this.yjQuery=i,this.scrollZoneTop=!0,this.scrollZoneBottom=!0,this.start=!1,this.scrollZoneVisible=!1,this.isTransparent=!1,this.elementToScroll={},this.scrollZoneId=""}return PersonalizationsmarteditScrollZoneComponent.$inject=["$scope","$timeout","$compile","yjQuery"],PersonalizationsmarteditScrollZoneComponent.prototype.stopScroll=function(){this.start=!1},PersonalizationsmarteditScrollZoneComponent.prototype.scrollTop=function(){var t=this;this.start&&(this.scrollZoneTop=!(this.elementToScroll.scrollTop()<=2),this.scrollZoneBottom=!0,this.elementToScroll.scrollTop(this.elementToScroll.scrollTop()-15),this.$timeout(function(){t.scrollTop()},100))},PersonalizationsmarteditScrollZoneComponent.prototype.scrollBottom=function(){var t=this;if(this.start){this.scrollZoneTop=!0;var e=this.elementToScroll.get(0).scrollHeight-this.elementToScroll.scrollTop();this.scrollZoneBottom=!(Math.abs(e-this.elementToScroll.outerHeight())<2),this.elementToScroll.scrollTop(this.elementToScroll.scrollTop()+15),this.$timeout(function(){t.scrollBottom()},100)}},PersonalizationsmarteditScrollZoneComponent.prototype.$onChanges=function(t){t.scrollZoneVisible&&(this.start=t.scrollZoneVisible.currentValue,this.scrollZoneTop=!0,this.scrollZoneBottom=!0)},PersonalizationsmarteditScrollZoneComponent.prototype.$onInit=function(){var t=this.$compile('<div id="sliderTopScrollZone'+this.scrollZoneId+'" data-ng-include="\'personalizationsmarteditScrollZoneTopTemplate.html\'"></div>')(this.$scope);i.element("body").append(t);var e=this.$compile('<div id="sliderBottomScrollZone'+this.scrollZoneId+'" data-ng-include="\'personalizationsmarteditScrollZoneBottomTemplate.html\'"></div>')(this.$scope);i.element("body").append(e),this.elementToScroll=this.getElementToScroll()},PersonalizationsmarteditScrollZoneComponent.prototype.$onDestroy=function(){var t=this;i.element("#sliderTopScrollZone"+this.scrollZoneId).scope().$destroy(),i.element("#sliderTopScrollZone"+this.scrollZoneId).remove(),i.element("#sliderBottomScrollZone"+this.scrollZoneId).scope().$destroy(),i.element("#sliderBottomScrollZone"+this.scrollZoneId).remove(),i.element("body").contents().each(function(e){e.nodeType===Node.COMMENT_NODE&&e.data.indexOf("personalizationsmarteditScrollZone")>-1&&t.yjQuery(e).remove()})},PersonalizationsmarteditScrollZoneComponent=x([Object(a.SeComponent)({inputs:["scrollZoneVisible","getElementToScroll: &","isTransparent","scrollZoneId"]})],PersonalizationsmarteditScrollZoneComponent)}(),F=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},k=function(){function PersonalizationsmarteditCommonsModule(){}return PersonalizationsmarteditCommonsModule=F([Object(a.SeModule)({imports:["smarteditServicesModule","yjqueryModule","l10nModule","alertServiceModule"],providers:[D,{provide:"PaginationHelper",useFactory:function(){return function(t){return new D(t)}}},C,v,h,S,T,_,y,P,N],declarations:[O,E,R]})],PersonalizationsmarteditCommonsModule)}(),$=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},U=function(){function MultipleTriggersComponent(t){this.triggerTabService=t}return MultipleTriggersComponent.$inject=["triggerTabService"],MultipleTriggersComponent.prototype.$onInit=function(){this.tabsList=this.triggerTabService.getTriggersTabs()},MultipleTriggersComponent=$([Object(a.SeComponent)({templateUrl:"multipleTriggersComponentTemplate.html"})],MultipleTriggersComponent)}(),L=function(){return function TriggerDataState(){this.state={code:"",name:"",expression:[],isDefault:!1,showExpression:!0}}}(),j=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},Z=function(){function TriggerTabService(){this.tabsList=[],this.triggerDataState=new L}return TriggerTabService.prototype.getTriggersTabs=function(){return this.tabsList},TriggerTabService.prototype.addTriggerTab=function(t){0===this.tabsList.filter(function(e){return e.id===t.id}).length&&this.tabsList.push(t)},TriggerTabService.prototype.removeTriggerTab=function(t){var e=this.tabsList.filter(function(e){return e.id===t.id});if(e.length>0){var n=this.tabsList.indexOf(e[0]);this.tabsList.splice(n,1)}},TriggerTabService.prototype.getTriggerDataState=function(){return this.triggerDataState.state},TriggerTabService=j([Object(a.SeInjectable)()],TriggerTabService)}(),B=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},G=function(){function PersonalizationsmarteditManagementModule(){}return PersonalizationsmarteditManagementModule=B([Object(a.SeModule)({imports:["smarteditServicesModule"],providers:[Z],declarations:[U]})],PersonalizationsmarteditManagementModule)}(),q=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},H=function(){function PersonalizationsmarteditContextService(t,e,n,i,a){this.$q=t,this.sharedDataService=e,this.loadConfigManagerService=n,this.personalizationsmarteditContextServiceProxy=i,this.personalizationsmarteditContextUtils=a;var o=a.getContextObject();this.setPersonalization(o.personalization),this.setCustomize(o.customize),this.setCombinedView(o.combinedView),this.setSeData(o.seData),this.customizeFiltersState={}}return PersonalizationsmarteditContextService.$inject=["$q","sharedDataService","loadConfigManagerService","personalizationsmarteditContextServiceProxy","personalizationsmarteditContextUtils"],PersonalizationsmarteditContextService.prototype.getPersonalization=function(){return this.personalization},PersonalizationsmarteditContextService.prototype.setPersonalization=function(t){this.personalization=t,this.personalizationsmarteditContextServiceProxy.setPersonalization(t)},PersonalizationsmarteditContextService.prototype.getCustomize=function(){return this.customize},PersonalizationsmarteditContextService.prototype.setCustomize=function(t){this.customize=t,this.personalizationsmarteditContextServiceProxy.setCustomize(t)},PersonalizationsmarteditContextService.prototype.getCombinedView=function(){return this.combinedView},PersonalizationsmarteditContextService.prototype.setCombinedView=function(t){this.combinedView=t,this.personalizationsmarteditContextServiceProxy.setCombinedView(t)},PersonalizationsmarteditContextService.prototype.getSeData=function(){return this.seData},PersonalizationsmarteditContextService.prototype.setSeData=function(t){this.seData=t,this.personalizationsmarteditContextServiceProxy.setSeData(t)},PersonalizationsmarteditContextService.prototype.refreshExperienceData=function(){var t=this;return this.sharedDataService.get("experience").then(function(e){var n=t.getSeData();return n.seExperienceData=e,t.setSeData(n),t.$q.when()})},PersonalizationsmarteditContextService.prototype.refreshConfigurationData=function(){var t=this;this.loadConfigManagerService.loadAsObject().then(function(e){var n=t.getSeData();n.seConfigurationData=e,t.setSeData(n)})},PersonalizationsmarteditContextService.prototype.applySynchronization=function(){this.personalizationsmarteditContextServiceProxy.setPersonalization(this.personalization),this.personalizationsmarteditContextServiceProxy.setCustomize(this.customize),this.personalizationsmarteditContextServiceProxy.setCombinedView(this.combinedView),this.personalizationsmarteditContextServiceProxy.setSeData(this.seData),this.refreshExperienceData(),this.refreshConfigurationData()},PersonalizationsmarteditContextService.prototype.getContexServiceProxy=function(){return this.personalizationsmarteditContextServiceProxy},PersonalizationsmarteditContextService.prototype.getCustomizeFiltersState=function(){return this.customizeFiltersState},PersonalizationsmarteditContextService.prototype.setCustomizeFiltersState=function(t){this.customizeFiltersState=t},PersonalizationsmarteditContextService=q([Object(a.SeInjectable)()],PersonalizationsmarteditContextService)}(),W=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},K=function(){function PersonalizationsmarteditContextServiceProxy(){}return PersonalizationsmarteditContextServiceProxy.prototype.setPersonalization=function(t){"proxyFunction"},PersonalizationsmarteditContextServiceProxy.prototype.setCustomize=function(t){"proxyFunction"},PersonalizationsmarteditContextServiceProxy.prototype.setCombinedView=function(t){"proxyFunction"},PersonalizationsmarteditContextServiceProxy.prototype.setSeData=function(t){"proxyFunction"},PersonalizationsmarteditContextServiceProxy=W([Object(a.GatewayProxied)("setPersonalization","setCustomize","setCombinedView","setSeData"),Object(a.SeInjectable)()],PersonalizationsmarteditContextServiceProxy)}(),Y=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},X=function(){function PersonalizationsmarteditContextServiceReverseProxy(t){this.personalizationsmarteditContextService=t}return PersonalizationsmarteditContextServiceReverseProxy.$inject=["personalizationsmarteditContextService"],PersonalizationsmarteditContextServiceReverseProxy.prototype.applySynchronization=function(){this.personalizationsmarteditContextService.applySynchronization()},PersonalizationsmarteditContextServiceReverseProxy.prototype.setPageId=function(t){var e=this.personalizationsmarteditContextService.getSeData();e.pageId=t,this.personalizationsmarteditContextService.setSeData(e)},PersonalizationsmarteditContextServiceReverseProxy=Y([Object(a.GatewayProxied)("applySynchronization","setPageId"),Object(a.SeInjectable)()],PersonalizationsmarteditContextServiceReverseProxy)}(),Q=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},J=function(){function PersonalizationsmarteditRestService(t,e,n,i,a,o){this.restServiceFactory=t,this.personalizationsmarteditUtils=e,this.$http=n,this.$q=i,this.yjQuery=a,this.personalizationsmarteditContextService=o}var t;return PersonalizationsmarteditRestService.$inject=["restServiceFactory","personalizationsmarteditUtils","$http","$q","yjQuery","personalizationsmarteditContextService"],t=PersonalizationsmarteditRestService,PersonalizationsmarteditRestService.prototype.extendRequestParamObjWithCatalogAwarePathVariables=function(t,e){e=e||{};var n=this.personalizationsmarteditContextService.getSeData().seExperienceData,a={catalogId:e.catalog||n.catalogDescriptor.catalogId,catalogVersion:e.catalogVersion||n.catalogDescriptor.catalogVersion};return t=i.extend(t,a)},PersonalizationsmarteditRestService.prototype.extendRequestParamObjWithCustomizatonCode=function(t,e){var n={customizationCode:e};return t=i.extend(t,n)},PersonalizationsmarteditRestService.prototype.extendRequestParamObjWithVariationCode=function(t,e){var n={variationCode:e};return t=i.extend(t,n)},PersonalizationsmarteditRestService.prototype.getParamsAction=function(t,e,n,i,a,o){var r=[];return this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"oldComponentId",t),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"newComponentId",e),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"slotId",n),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"containerId",i),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"variationId",o),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r,"customizationId",a),{params:{entry:r}}},PersonalizationsmarteditRestService.prototype.getPathVariablesObjForModifyingActionURI=function(t,e,n,i){var a=this.personalizationsmarteditContextService.getSeData().seExperienceData;return{customizationCode:t,variationCode:e,actionId:n,catalogId:(i=i||{}).catalog||a.catalogDescriptor.catalogId,catalogVersion:i.catalogVersion||a.catalogDescriptor.catalogVersion}},PersonalizationsmarteditRestService.prototype.prepareURI=function(t,e){return t.replace(/((?:\:)(\w*)(?:\/))/g,function(t,n,i){return e[i]+"/"})},PersonalizationsmarteditRestService.prototype.getParamsForCustomizations=function(t){return{code:i.isDefined(t.code)?t.code:void 0,pageId:i.isDefined(t.pageId)?t.pageId:void 0,pageCatalogId:i.isDefined(t.pageCatalogId)?t.pageCatalogId:void 0,name:i.isDefined(t.name)?t.name:void 0,negatePageId:i.isDefined(t.negatePageId)?t.negatePageId:void 0,catalogs:i.isDefined(t.catalogs)?t.catalogs:void 0,statuses:i.isDefined(t.statuses)?t.statuses.join(","):void 0}},PersonalizationsmarteditRestService.prototype.getActionsDetails=function(e){var n=this.restServiceFactory.get(t.ACTIONS_DETAILS);return e=this.extendRequestParamObjWithCatalogAwarePathVariables(e),n.get(e)},PersonalizationsmarteditRestService.prototype.getCustomizations=function(e){e=e||{};var n={},i=this.restServiceFactory.get(t.CUSTOMIZATIONS);return(n=this.extendRequestParamObjWithCatalogAwarePathVariables(n,e)).pageSize=e.currentSize||10,n.currentPage=e.currentPage||0,this.yjQuery.extend(n,this.getParamsForCustomizations(e)),i.get(n)},PersonalizationsmarteditRestService.prototype.getComponenentsIdsForVariation=function(e,n,i,a){var o=this.personalizationsmarteditContextService.getSeData().seExperienceData,r=this.restServiceFactory.get(t.CXCMSC_ACTIONS_FROM_VARIATIONS),s=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"customization",e),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"variations",n),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"catalog",i||o.catalogDescriptor.catalogId),this.personalizationsmarteditUtils.pushToArrayIfValueExists(s,"catalogVersion",a||o.catalogDescriptor.catalogVersion);var l={params:{entry:s}};return r.save(l)},PersonalizationsmarteditRestService.prototype.getCxCmsActionsOnPageForCustomization=function(t,e){var n={type:"CXCMSACTION",catalogs:"ALL",fields:"FULL",pageId:this.personalizationsmarteditContextService.getSeData().pageId,pageCatalogId:this.personalizationsmarteditContextService.getSeData().seExperienceData.pageContext.catalogId,customizationCode:t.code||"",currentPage:e||0};return this.getActionsDetails(n)},PersonalizationsmarteditRestService.prototype.getSegments=function(e){return this.restServiceFactory.get(t.SEGMENTS).get(e)},PersonalizationsmarteditRestService.prototype.getCustomization=function(e){var n=this.restServiceFactory.get(t.CUSTOMIZATION,"customizationCode"),i=this.extendRequestParamObjWithCustomizatonCode({},e.code);return i=this.extendRequestParamObjWithCatalogAwarePathVariables(i,e),n.get(i)},PersonalizationsmarteditRestService.prototype.createCustomization=function(e){return this.restServiceFactory.get(t.CUSTOMIZATION_PACKAGES).save(this.extendRequestParamObjWithCatalogAwarePathVariables(e))},PersonalizationsmarteditRestService.prototype.updateCustomization=function(e){var n=this.restServiceFactory.get(t.CUSTOMIZATION,"customizationCode");return e.customizationCode=e.code,n.update(this.extendRequestParamObjWithCatalogAwarePathVariables(e))},PersonalizationsmarteditRestService.prototype.updateCustomizationPackage=function(e){var n=this.restServiceFactory.get(t.CUSTOMIZATION_PACKAGE,"customizationCode");return e.customizationCode=e.code,n.update(this.extendRequestParamObjWithCatalogAwarePathVariables(e))},PersonalizationsmarteditRestService.prototype.deleteCustomization=function(e){var n={customizationCode:e};return this.restServiceFactory.get(t.CUSTOMIZATION,"customizationCode").remove(this.extendRequestParamObjWithCatalogAwarePathVariables(n))},PersonalizationsmarteditRestService.prototype.getVariation=function(e,n){var i=this.restServiceFactory.get(t.VARIATION,"variationCode"),a=this.extendRequestParamObjWithVariationCode({},n);return a=this.extendRequestParamObjWithCatalogAwarePathVariables(a),a=this.extendRequestParamObjWithCustomizatonCode(a,e),i.get(a)},PersonalizationsmarteditRestService.prototype.editVariation=function(e,n){var i=this.restServiceFactory.get(t.VARIATION,"variationCode");return n=this.extendRequestParamObjWithCatalogAwarePathVariables(n),(n=this.extendRequestParamObjWithCustomizatonCode(n,e)).variationCode=n.code,i.update(n)},PersonalizationsmarteditRestService.prototype.deleteVariation=function(e,n){var i=this.restServiceFactory.get(t.VARIATION,"variationCode"),a=this.extendRequestParamObjWithVariationCode({},n);return a=this.extendRequestParamObjWithCatalogAwarePathVariables(a),a=this.extendRequestParamObjWithCustomizatonCode(a,e),i.remove(a)},PersonalizationsmarteditRestService.prototype.createVariationForCustomization=function(e,n){var i=this.restServiceFactory.get(t.VARIATIONS);return n=this.extendRequestParamObjWithCatalogAwarePathVariables(n),n=this.extendRequestParamObjWithCustomizatonCode(n,e),i.save(n)},PersonalizationsmarteditRestService.prototype.getVariationsForCustomization=function(e,n){var i=this.restServiceFactory.get(t.VARIATIONS),a={},o=n||{};return a=this.extendRequestParamObjWithCatalogAwarePathVariables(a,o),(a=this.extendRequestParamObjWithCustomizatonCode(a,e)).fields=t.VARIATION_FOR_CUSTOMIZATION_DEFAULT_FIELDS,void 0!==o.includeFullFields&&o.includeFullFields&&(a.fields=t.FULL_FIELDS),i.get(a)},PersonalizationsmarteditRestService.prototype.replaceComponentWithContainer=function(e,n,i){var a=this.restServiceFactory.get(t.ADD_CONTAINER),o=this.extendRequestParamObjWithCatalogAwarePathVariables({},i),r=this.getParamsAction(e,null,n,null,null,null);return this.personalizationsmarteditUtils.pushToArrayIfValueExists(r.params.entry,"catalog",o.catalogId),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r.params.entry,"catalogVersion",o.catalogVersion),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r.params.entry,"slotCatalog",i.slotCatalog),this.personalizationsmarteditUtils.pushToArrayIfValueExists(r.params.entry,"oldComponentCatalog",i.oldComponentCatalog),a.save(r)},PersonalizationsmarteditRestService.prototype.getActions=function(e,n,a){var o=this.restServiceFactory.get(t.ACTIONS),r=this.getPathVariablesObjForModifyingActionURI(e,n,void 0,a),s={fields:t.FULL_FIELDS};return s=i.extend(s,r),o.get(s)},PersonalizationsmarteditRestService.prototype.createActions=function(e,n,i,a){var o=this.getPathVariablesObjForModifyingActionURI(e,n,void 0,a),r=this.prepareURI(t.ACTIONS,o);return this.$http({url:r,method:"PATCH",data:i,headers:{"Content-Type":"application/json;charset=utf-8"}})},PersonalizationsmarteditRestService.prototype.addActionToContainer=function(e,n,a,o,r,s){var l=this.restServiceFactory.get(t.ACTIONS),c=this.getPathVariablesObjForModifyingActionURI(o,r,void 0,s),d={type:"cxCmsActionData",containerId:a,componentId:e,componentCatalog:n};return d=i.extend(d,c),l.save(d)},PersonalizationsmarteditRestService.prototype.editAction=function(e,n,a,o,r,s){var l=this.restServiceFactory.get(t.ACTION,"actionId"),c=this.getPathVariablesObjForModifyingActionURI(e,n,a,s);return l.get(c).then(function(t){return(t=i.extend(t,c)).componentId=o,t.componentCatalog=r,l.update(t)})},PersonalizationsmarteditRestService.prototype.deleteAction=function(e,n,i,a){var o=this.restServiceFactory.get(t.ACTION,"actionId"),r=this.getPathVariablesObjForModifyingActionURI(e,n,i,a);return o.remove(r)},PersonalizationsmarteditRestService.prototype.deleteActions=function(e,n,i,a){var o=this.getPathVariablesObjForModifyingActionURI(e,n,void 0,a),r=this.prepareURI(t.ACTIONS,o);return this.$http({url:r,method:"DELETE",data:i,headers:{"Content-Type":"application/json;charset=utf-8"}})},PersonalizationsmarteditRestService.prototype.getComponents=function(e){var n=this.personalizationsmarteditContextService.getSeData().seExperienceData,a=this.restServiceFactory.get(t.CATALOGS),o={siteId:n.siteDescriptor.uid};return o=i.extend(o,e),a.get(this.extendRequestParamObjWithCatalogAwarePathVariables(o,e))},PersonalizationsmarteditRestService.prototype.getComponent=function(e){var n=this.personalizationsmarteditContextService.getSeData().seExperienceData,i=this.restServiceFactory.get(t.CATALOG,"itemUuid"),a={itemUuid:e,siteId:n.siteDescriptor.uid};return i.get(a)},PersonalizationsmarteditRestService.prototype.getNewComponentTypes=function(){return this.restServiceFactory.get(t.COMPONENT_TYPES).get()},PersonalizationsmarteditRestService.prototype.updateCustomizationRank=function(e,n){var i=this.personalizationsmarteditContextService.getSeData().seExperienceData,a=this.restServiceFactory.get(t.UPDATE_CUSTOMIZATION_RANK),o=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(o,"customization",e),this.personalizationsmarteditUtils.pushToArrayIfValueExists(o,"increaseValue",n),this.personalizationsmarteditUtils.pushToArrayIfValueExists(o,"catalog",i.catalogDescriptor.catalogId),this.personalizationsmarteditUtils.pushToArrayIfValueExists(o,"catalogVersion",i.catalogDescriptor.catalogVersion);var r={params:{entry:o}};return a.save(r)},PersonalizationsmarteditRestService.prototype.checkVersionConflict=function(e){var n=this.personalizationsmarteditContextService.getSeData().seExperienceData,i=this.restServiceFactory.get(t.CHECK_VERSION),a=[];this.personalizationsmarteditUtils.pushToArrayIfValueExists(a,"versionId",e),this.personalizationsmarteditUtils.pushToArrayIfValueExists(a,"catalog",n.catalogDescriptor.catalogId),this.personalizationsmarteditUtils.pushToArrayIfValueExists(a,"catalogVersion",n.catalogDescriptor.catalogVersion);var o={params:{entry:a}};return i.save(o)},PersonalizationsmarteditRestService.CUSTOMIZATIONS="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/customizations",PersonalizationsmarteditRestService.CUSTOMIZATION=t.CUSTOMIZATIONS+"/:customizationCode",PersonalizationsmarteditRestService.CUSTOMIZATION_PACKAGES="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/customizationpackages",PersonalizationsmarteditRestService.CUSTOMIZATION_PACKAGE=t.CUSTOMIZATION_PACKAGES+"/:customizationCode",PersonalizationsmarteditRestService.ACTIONS_DETAILS="/personalizationwebservices/v1/catalogs/:catalogId/catalogVersions/:catalogVersion/actions",PersonalizationsmarteditRestService.VARIATIONS=t.CUSTOMIZATION+"/variations",PersonalizationsmarteditRestService.VARIATION=t.VARIATIONS+"/:variationCode",PersonalizationsmarteditRestService.ACTIONS=t.VARIATION+"/actions",PersonalizationsmarteditRestService.ACTION=t.ACTIONS+"/:actionId",PersonalizationsmarteditRestService.CXCMSC_ACTIONS_FROM_VARIATIONS="/personalizationwebservices/v1/query/cxcmscomponentsfromvariations",PersonalizationsmarteditRestService.SEGMENTS="/personalizationwebservices/v1/segments",PersonalizationsmarteditRestService.CATALOGS="/cmswebservices/v1/sites/:siteId/cmsitems",PersonalizationsmarteditRestService.CATALOG=t.CATALOGS+"/:itemUuid",PersonalizationsmarteditRestService.ADD_CONTAINER="/personalizationwebservices/v1/query/cxReplaceComponentWithContainer",PersonalizationsmarteditRestService.COMPONENT_TYPES="/cmswebservices/v1/types?category=COMPONENT",PersonalizationsmarteditRestService.UPDATE_CUSTOMIZATION_RANK="/personalizationwebservices/v1/query/cxUpdateCustomizationRank",PersonalizationsmarteditRestService.CHECK_VERSION="/personalizationwebservices/v1/query/cxCmsPageVersionCheck",PersonalizationsmarteditRestService.VARIATION_FOR_CUSTOMIZATION_DEFAULT_FIELDS="variations(active,actions,enabled,code,name,rank,status,catalog,catalogVersion)",PersonalizationsmarteditRestService.FULL_FIELDS="FULL",PersonalizationsmarteditRestService=t=Q([Object(a.SeInjectable)()],PersonalizationsmarteditRestService)}(),tt=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},et=function(){function PersonalizationsmarteditServicesModule(){}return PersonalizationsmarteditServicesModule=tt([Object(a.SeModule)({imports:["sharedDataServiceModule","loadConfigModule","smarteditServicesModule","yjqueryModule","personalizationsmarteditCommons","personalizationsmarteditCommonsModule"],providers:[J,H,K,X]})],PersonalizationsmarteditServicesModule)}(),nt=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},it=function(){function VersionCheckerService(t,e,n){this.$q=t,this.personalizationsmarteditRestService=e,this.pageVersionSelectionService=n}return VersionCheckerService.$inject=["$q","personalizationsmarteditRestService","pageVersionSelectionService"],VersionCheckerService.prototype.setVersion=function(t){this.version=t},VersionCheckerService.prototype.provideTranlationKey=function(t){return this.version=this.version||this.pageVersionSelectionService.getSelectedPageVersion(),this.version?this.personalizationsmarteditRestService.checkVersionConflict(this.version.uid).then(function(e){return e.result?t:"personalization.se.cms.actionitem.page.version.rollback.confirmation"},function(){return t}):this.$q.when(t)},VersionCheckerService=nt([Object(a.SeInjectable)()],VersionCheckerService)}(),at=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r},ot=function(){function VersioningModule(){}return VersioningModule=at([Object(a.SeModule)({imports:["smarteditServicesModule"],providers:[it]})],VersioningModule)}();n.d(e,"Personalizationsmarteditcontainermodule",function(){return st});var rt=function(t,e,n,i){var a,o=arguments.length,r=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,n,i);else for(var s=t.length-1;s>=0;s--)(a=t[s])&&(r=(o<3?a(r):o>3?a(e,n,r):a(e,n))||r);return o>3&&r&&Object.defineProperty(e,n,r),r};!function doImport(){importAll(n(3)),importAll(n(23)),importAll(n(27))}();var st=function(){function Personalizationsmarteditcontainermodule(){}return Personalizationsmarteditcontainermodule=rt([Object(a.SeModule)({imports:["personalizationsmarteditcontainerTemplates","ui.bootstrap","personalizationsmarteditCommons","functionsModule","personalizationsmarteditPreviewServiceModule","personalizationsmarteditManagerViewModule","personalizationsmarteditContextMenu","featureServiceModule","perspectiveServiceModule","personalizationsmarteditCombinedViewModule","personalizationsmarteditSegmentViewModule","personalizationsmarteditToolbarContextModule","seConstantsModule","personalizationsmarteditRulesAndPermissionsRegistrationModule","yjqueryModule","smarteditCommonsModule","personalizationsmarteditCustomizeViewModule","smarteditRootModule","experienceServiceModule",c.name,k,G,et,ot],config:["$provide",function(t){"ngInject";t.decorator("rollbackPageVersionService",["$delegate","$log","versionCheckerService",function(t,e,n){var i=t.rollbackPageVersion;t.rollbackPageVersion=function rollbackWrapper(){return n.setVersion(arguments[0]),i.apply(t,arguments)};var a=t.showConfirmationModal;return t.showConfirmationModal=function modalWrapper(){var e=arguments;return n.provideTranlationKey(e[1]).then(function(n){return e[1]=n,a.apply(t,e)})},t}])}],initialize:["yjQuery","domain","$q","personalizationsmarteditContextServiceReverseProxy","personalizationsmarteditContextService","personalizationsmarteditContextModal","personalizationsmarteditContextUtils","personalizationsmarteditPreviewService","personalizationsmarteditMessageHandler","personalizationsmarteditRestService","personalizationsmarteditUtils","EVENTS","SWITCH_LANGUAGE_EVENT","EVENT_PERSPECTIVE_UNLOADING","EVENT_PERSPECTIVE_ADDED","crossFrameEventService","featureService","perspectiveService","smarteditBootstrapGateway","systemEventService","experienceService","personalizationsmarteditDateUtils",function(t,e,n,a,o,r,s,l,c,d,m,u,p,g,v,f,z,h,C,b,S,T){"ngInject";!function(e){var n=t("<link rel='stylesheet' type='text/css' href='"+e+"'>");t("head").append(n)}(e+"/personalizationsmartedit/css/style.css"),z.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"personalizationsmartedit.container.pagecustomizations.toolbar",type:"TEMPLATE",nameI18nKey:"personalization.toolbar.pagecustomizations",priority:4,section:"left",include:"personalizationsmarteditCustomizeViewWrapperTemplate.html",keepAliveOnClose:!1,permissions:["se.edit.page"]}),z.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"personalizationsmartedit.container.combinedview.toolbar",type:"TEMPLATE",nameI18nKey:"personalization.toolbar.combinedview.name",priority:6,section:"left",include:"personalizationsmarteditCombinedViewMenuTemplate.html",keepAliveOnClose:!1,permissions:["se.read.page"]}),z.addToolbarItem({toolbarId:"smartEditPerspectiveToolbar",key:"personalizationsmartedit.container.manager.toolbar",type:"TEMPLATE",nameI18nKey:"personalization.toolbar.library.name",priority:8,section:"left",include:"manageCustomizationViewMenuTemplate.html",keepAliveOnClose:!1,permissions:["se.edit.page"]}),z.register({key:"personalizationsmartedit.context.service",nameI18nKey:"personalization.context.service.name",descriptionI18nKey:"personalization.context.service.description",enablingCallback:function(){var t=o.getPersonalization();t.enabled=!0,o.setPersonalization(t)},disablingCallback:function(){var t=o.getPersonalization();t.enabled=!1,o.setPersonalization(t)},permissions:["se.edit.page"]}),h.register({key:"personalizationsmartedit.perspective",nameI18nKey:"personalization.perspective.name",features:["personalizationsmartedit.context.service","personalizationsmartedit.container.pagecustomizations.toolbar","personalizationsmartedit.container.manager.toolbar","personalizationsmartedit.container.combinedview.toolbar","personalizationsmarteditSharedSlot","personalizationsmarteditComponentLightUp","personalizationsmarteditCombinedViewComponentLightUp","personalizationsmartedit.context.add.action","personalizationsmartedit.context.edit.action","personalizationsmartedit.context.delete.action","personalizationsmartedit.context.info.action","personalizationsmartedit.context.component.edit.action","personalizationsmartedit.context.show.action.list","se.contextualMenu","se.emptySlotFix","externalcomponentbutton","personalizationsmarteditExternalComponentDecorator"],perspectives:[],permissions:["se.personalization.open"]});f.subscribe(g,function(t,e){"personalizationsmartedit.perspective"===e&&(s.clearCombinedViewCustomizeContext(o),s.clearCustomizeContextAndReloadPreview(l,o),s.clearCombinedViewContextAndReloadPreview(l,o))});var _=function(){s.clearCombinedViewCustomizeContext(o),s.clearCustomizeContext(o),s.clearCombinedViewContext(o)};b.registerEventHandler(u.EXPERIENCE_UPDATE,function(){return _(),n.when()}),b.registerEventHandler(v,function(){return l.removePersonalizationDataFromPreview(),n.when()}),b.registerEventHandler(p,function(){var t=o.getCombinedView();return i.forEach(t.selectedItems,function(t){m.getAndSetCatalogVersionNameL10N(t.variation)}),o.setCombinedView(t),n.when()}),C.subscribe("smartEditReady",function(t,e){var n=o.getCustomize().selectedCustomization,i=o.getCombinedView().customize.selectedCustomization,a=o.getCombinedView().selectedItems;S.getCurrentExperience().then(function(t){!t.variations&&(n||i||a)&&_()}),o.refreshExperienceData().then(function(){var t=o.getSeData().seExperienceData;if("personalizationsmartedit.perspective"===(h.getActivePerspective()||{}).key&&t.pageContext.catalogVersionUuid!==t.catalogDescriptor.catalogVersionUuid){c.sendWarning({message:"personalization.warning.pagefromparent",timeout:-1})}}).finally(function(){o.applySynchronization()})})}]})],Personalizationsmarteditcontainermodule)}()}]);