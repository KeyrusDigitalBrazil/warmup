!function(e){var t={};function __webpack_require__(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,__webpack_require__),o.l=!0,o.exports}__webpack_require__.m=e,__webpack_require__.c=t,__webpack_require__.d=function(e,t,n){__webpack_require__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.t=function(e,t){if(1&t&&(e=__webpack_require__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)__webpack_require__.d(n,o,function(t){return e[t]}.bind(null,o));return n},__webpack_require__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __webpack_require__.d(t,"a",t),t},__webpack_require__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__webpack_require__.p="",__webpack_require__(__webpack_require__.s=42)}([function(e,t){e.exports=smarteditcommons},function(e,t){e.exports=angular},function(e,t,n){var o={"./components/externalComponent/externalComponentButton.js":3,"./components/externalComponent/externalComponentDecorator.js":4,"./components/slotShared/slotSharedButton.js":5,"./components/slotSharedDisabled/externalSlotDisabledDecorator.js":6,"./components/slotSharedDisabled/sharedSlotDisabledDecorator.js":7,"./components/slotSharedDisabled/slotDisabledComponent.js":8,"./components/slotUnshared/slotUnsharedButton.js":9,"./components/slotVisibility/hiddenComponentMenu/hiddenComponentMenu.js":10,"./components/slotVisibility/slotVisibilityButton.js":11,"./components/slotVisibility/slotVisibilityComponent.js":12,"./components/synchronize/slots/slotSyncButton.js":13,"./components/synchronize/slots/slotSynchronizationPanel.js":14,"./components/synchronize/slots/syncIndicatorDecorator/syncIndicatorDecorator.js":15,"./services/componentInfoService.js":16,"./services/componentVisibilityAlertService.js":17,"./services/contextualMenuDropdownService.js":18,"./services/dragAndDrop/cmsDragAndDropService.js":19,"./services/dragAndDrop/componentEditingFacadeService.js":20,"./services/dragAndDrop/slotRestrictionsService.js":21,"./services/editorEnablerService.js":22,"./services/editorModalService.js":23,"./services/pageContentSlotsService.js":24,"./services/removeComponentService.js":25,"./services/slotSharedService.js":26,"./services/slotSynchronizationService.js":27,"./services/slotUnsharedService.js":28,"./services/slotVisibilityService.js":29,"./templates.js":30};function webpackContext(e){var t=webpackContextResolve(e);return n(t)}function webpackContextResolve(e){var t=o[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}webpackContext.keys=function webpackContextKeys(){return Object.keys(o)},webpackContext.resolve=webpackContextResolve,e.exports=webpackContext,webpackContext.id=2},function(e,t){angular.module("externalComponentButtonModule",["l10nModule","smarteditServicesModule"]).controller("externalComponentButtonController",["l10nFilter","catalogService",function(e,t){this.$onInit=function(){return this.isReady=!1,t.getCatalogVersionByUuid(this.catalogVersionUuid).then(function(t){this.catalogVersion=e(t.catalogName)+" ("+t.version+")",this.isReady=!0}.bind(this))}}]).component("externalComponentButton",{templateUrl:"externalComponentButtonTemplate.html",controller:"externalComponentButtonController",controllerAs:"ctrl",bindings:{catalogVersionUuid:"<"}})},function(e,t){angular.module("externalComponentDecoratorModule",["functionsModule","cmsSmarteditServicesModule","yPopoverModule"]).controller("externalComponentDecoratorController",["$element","$translate","$log","l10nFilter","CONTENT_SLOT_TYPE","componentHandlerService","catalogService","cMSModesService",function(e,t,n,o,i,s,r,a){this.$onInit=function(){var t=s.getParentSlotForComponent(e);this.isExtenalSlot=s.isExternalComponent(t,i),this.isReady=!1,a.isVersioningPerspectiveActive().then(function(e){this.isVersioningPerspective=e,r.getCatalogVersionByUuid(this.componentAttributes.smarteditCatalogVersionUuid).then(function(e){this.catalogVersionText=o(e.catalogName)+" ("+e.version+")",this.isReady=!0}.bind(this),function(){n.error("externalComponentDecorator - cannot find catalog version for uuid",this.componentAttributes.smarteditCatalogVersionUuid)}.bind(this))}.bind(this))},this.getTooltipTemplate=function(){return"<div class='external-component-decorator__tooltip'>"+t.instant("se.cms.from.external.catalog.version",{catalogVersion:this.catalogVersionText})+"</div>"}}]).directive("externalComponentDecorator",function(){return{templateUrl:"externalComponentDecoratorTemplate.html",restrict:"C",transclude:!0,replace:!1,controller:"externalComponentDecoratorController",controllerAs:"ctrl",scope:{},bindToController:{active:"=",componentAttributes:"<"}}})},function(e,t){angular.module("slotSharedButtonModule",["slotSharedServiceModule","translationServiceModule","smarteditServicesModule","seConstantsModule","hasOperationPermissionModule"]).controller("slotSharedButtonController",["slotSharedService","$window","crossFrameEventService","EVENT_OUTER_FRAME_CLICKED",function(e,t,n,o){this.slotSharedFlag=!1,this.buttonName="slotSharedButton",this.isPopupOpened=!1,this.isPopupOpenedPreviousValue=!1,this.$onInit=function(){this.slotAttributes={smarteditComponentId:this.componentAttributes.smarteditComponentId,contentSlotUuid:this.componentAttributes.smarteditComponentUuid,componentType:this.componentAttributes.smarteditComponentType,catalogVersionUuid:this.componentAttributes.smarteditCatalogVersionUuid},e.isSlotShared(this.slotId).then(function(e){this.slotSharedFlag=e}.bind(this)),this.unregFn=n.subscribe(o,function(){this.isPopupOpened=!1}.bind(this))},this.$doCheck=function(){this.isPopupOpenedPreviousValue!==this.isPopupOpened&&(this.setRemainOpen({button:this.buttonName,remainOpen:this.isPopupOpened}),this.isPopupOpenedPreviousValue=this.isPopupOpened)},this.convertToNonSharedSlotAndCloneComponents=function(){e.convertSharedSlotToNonSharedSlot(this.slotAttributes,!0).then(function(){this.isPopupOpened=!1,t.location.reload()}.bind(this))},this.convertToNonSharedSlotAndRemoveComponents=function(){e.convertSharedSlotToNonSharedSlot(this.slotAttributes,!1).then(function(){this.isPopupOpened=!1,t.location.reload()}.bind(this))},this.$onDestroy=function(){this.unregFn()}}]).component("slotSharedButton",{templateUrl:"slotSharedButtonTemplate.html",controller:"slotSharedButtonController",controllerAs:"ctrl",bindings:{setRemainOpen:"&",slotId:"@",componentAttributes:"<"}})},function(e,t){angular.module("externalSlotDisabledDecoratorModule",["slotDisabledDecoratorModule"]).directive("externalSlotDisabledDecorator",function(){return{templateUrl:"externalSlotDisabledDecoratorTemplate.html",transclude:!0,restrict:"C",controllerAs:"ctrl",controller:function(){},scope:{},bindToController:{active:"=",componentAttributes:"<"}}})},function(e,t){angular.module("sharedSlotDisabledDecoratorModule",["slotDisabledDecoratorModule"]).directive("sharedSlotDisabledDecorator",function(){return{templateUrl:"sharedSlotDisabledDecoratorTemplate.html",transclude:!0,restrict:"C",controllerAs:"ctrl",controller:function(){},scope:{},bindToController:{active:"=",componentAttributes:"<"}}})},function(e,t){angular.module("slotDisabledDecoratorModule",["yPopoverModule","l10nModule","cmsSmarteditServicesModule"]).controller("slotDisabledComponentController",["$translate","componentHandlerService","catalogService","l10nFilter","cMSModesService",function(e,t,n,o,i){var s="hyicon-globe",r="hyicon-linked";this.$onInit=function(){this.isReady=!1,this._checkIfSlotIsInherited(),this._getSourceCatalogName(),this._isVersioningPerspectiveActive()},this._checkIfSlotIsInherited=function(){var e=this.componentAttributes.smarteditCatalogVersionUuid;t.getCatalogVersionUUIDFromPage().then(function(t){this.isExternalSlot=e!==t}.bind(this))},this._getSourceCatalogName=function(){var e=this.componentAttributes.smarteditCatalogVersionUuid;n.getCatalogVersionByUuid(e).then(function(e){this.catalogName=e.catalogName}.bind(this))},this._isVersioningPerspectiveActive=function(){i.isVersioningPerspectiveActive().then(function(e){this.isVersioningPerspective=e,this.isReady=!0}.bind(this))},this.getPopoverMessage=function(){var t;t=this.isVersioningPerspective?this.isExternalSlot?"se.cms.versioning.global.shared.slot.from.label":"se.cms.versioning.shared.slot.from.label":this.isExternalSlot?"se.cms.externalsharedslot.decorator.label":"se.cms.sharedslot.decorator.label";var n={catalogName:o(this.catalogName),slotId:this.componentAttributes.smarteditComponentId};return e.instant(t,n)},this.getSlotIconClass=function(){var e="";return this.active?e=this.isExternalSlot?s:r:void 0!==this.isExternalSlot&&(e=this.isExternalSlot?s:r),e},this.getOuterSlotClass=function(){return this.getSlotIconClass()===s?"disabled-shared-slot__icon--outer-globe":""}.bind(this)}]).component("slotDisabledComponent",{templateUrl:"slotDisabledTemplate.html",controller:"slotDisabledComponentController",controllerAs:"ctrl",bindings:{active:"=",componentAttributes:"<"}})},function(e,t){angular.module("slotUnsharedButtonModule",["slotUnsharedServiceModule","translationServiceModule","confirmationModalServiceModule","smarteditServicesModule","seConstantsModule","hasOperationPermissionModule"]).controller("slotUnsharedButtonController",["$scope","$window","EVENT_OUTER_FRAME_CLICKED","slotUnsharedService","confirmationModalService","crossFrameEventService",function(e,t,n,o,i,s){this.revertToSharedSlot=function(){i.confirm({title:"se.cms.slot.unshared.revert.to.shared.title",templateUrl:"revertToSharedSlotConfirmationTemplate.html"}).then(function(){o.revertToSharedSlot(this.slotUuid).then(function(){this.isPopupOpened=!1,t.location.reload()}.bind(this))}.bind(this))},this.$onInit=function(){this.slotUnsharedFlag=!1,this.buttonName="slotUnsharedButton",this.isPopupOpened=!1,this.isPopupOpenedOldValue=this.isPopupOpened,o.isSlotUnshared(this.slotUid).then(function(e){this.slotUnsharedFlag=e}.bind(this)),this.unregFn=s.subscribe(n,function(){this.isPopupOpened=!1}.bind(this))},this.$doCheck=function(){this.isPopupOpenedOldValue!==this.isPopupOpened&&(this.isPopupOpenedOldValue=this.isPopupOpened,this.setRemainOpen({button:this.buttonName,remainOpen:this.isPopupOpened}))},this.$onDestroy=function(){this.unregFn()}}]).component("slotUnsharedButton",{templateUrl:"slotUnsharedButtonTemplate.html",controller:"slotUnsharedButtonController",controllerAs:"ctrl",bindings:{setRemainOpen:"&",slotUuid:"@",slotUid:"@"}})},function(e,t){angular.module("hiddenComponentMenuModule",["yPopupOverlayModule","yLoDashModule"]).constant("HIDDEN_COMPONENT_OPENED_EVENT","HIDDEN_COMPONENT_OPENED_EVENT").controller("hiddenComponentMenuController",["lodash","hiddenComponentMenuService","systemEventService","componentHandlerService","HIDDEN_COMPONENT_OPENED_EVENT","CONTENT_SLOT_TYPE",function(e,t,n,o,i,s){this.$onInit=function(){var r=o.getOriginalComponent(this.slotId,s);this.slotUuid=o.getUuid(r),this.isMenuOpen=!1,t.getItemsForHiddenComponent(this.component,this.slotId).then(function(t){this.configuration=e.cloneDeep(t.configuration),this.configuration.slotUuid=this.slotUuid,this.menuItems=e.cloneDeep(t.buttons)}.bind(this)),this.unRegRemoveComponentOpenedEvent=n.subscribe(i,this.onOtherMenuOpening)},this.$onDestroy=function(){this.unRegRemoveComponentOpenedEvent()},this.popupConfig={templateUrl:"hiddenComponentMenuItemsTemplate.html",halign:"left",valign:"bottom"},this.onButtonClick=function(e){e.stopPropagation(),this.isMenuOpen=!this.isMenuOpen,this.isMenuOpen&&n.publishAsync(i,{componentId:this.component.uid,slotId:this.slotId})}.bind(this),this.onMenuHide=function(){this.isMenuOpen=!1}.bind(this),this.onOtherMenuOpening=function(e,t){var n=this.component.uid===t.componentId,o=this.slotId===t.slotId;n&&o||(this.isMenuOpen=!1)}.bind(this),this.executeItemCallback=function(e,t){e.action&&(e.action.callback(this.configuration,t),this.isMenuOpen=!1)}}]).component("hiddenComponentMenu",{templateUrl:"hiddenComponentMenuTemplate.html",transclude:!1,controller:"hiddenComponentMenuController",controllerAs:"ctrl",bindings:{component:"<",slotId:"<"}})},function(e,t){angular.module("slotVisibilityButtonModule",["cmssmarteditTemplates","slotVisibilityServiceModule","slotVisibilityComponentModule","seConstantsModule"]).controller("slotVisibilityButtonController",["slotVisibilityService","$scope","sharedDataService","$translate","crossFrameEventService","EVENT_OUTER_FRAME_CLICKED",function(e,t,n,o,i,s){this.buttonName="slotVisibilityButton",this.eyeOnImageUrl="/cmssmartedit/images/visibility_slot_menu_on.png",this.eyeOffImageUrl="/cmssmartedit/images/visibility_slot_menu_off.png",this.eyeImageUrl=this.eyeOffImageUrl,this.closeImageUrl="/cmssmartedit/images/close_button.png",this.buttonVisible=!1,this.hiddenComponents=[],this.isComponentListOpened=!1,t.$watch("ctrl.isComponentListOpened",function(e,t){this.eyeImageUrl=e?this.eyeOnImageUrl:this.eyeOffImageUrl,e!==t&&this.setRemainOpen({button:this.buttonName,remainOpen:this.isComponentListOpened})}.bind(this)),this.markExternalComponents=function(e,t){t.forEach(function(t){t.isExternal=t.catalogVersion!==e.pageContext.catalogVersionUuid})},this.getTemplateInfoForExternalComponent=function(){return"<div>"+o.instant("se.cms.slotvisibility.external.component")+"</div>"},this.onInsideClick=function(e){e.stopPropagation()},this.$onInit=function(){e.getHiddenComponents(this.slotId).then(function(e){n.get("experience").then(function(t){this.hiddenComponents=e,this.markExternalComponents(t,this.hiddenComponents),this.hiddenComponentCount=e.length,this.hiddenComponentCount>0&&(this.buttonVisible=!0)}.bind(this))}.bind(this)),this.unregFn=i.subscribe(s,function(){this.isComponentListOpened=!1}.bind(this))},this.$onDestroy=function(){this.unregFn()}}]).component("slotVisibilityButton",{templateUrl:"slotVisibilityButtonTemplate.html",transclude:!0,controller:"slotVisibilityButtonController",controllerAs:"ctrl",bindings:{setRemainOpen:"&",slotId:"@",initButton:"@"}})},function(e,t){angular.module("slotVisibilityComponentModule",["componentVisibilityAlertServiceModule","editorModalServiceModule","catalogVersionPermissionModule","hiddenComponentMenuModule"]).controller("slotVisibilityComponentController",["componentVisibilityAlertService","editorModalService","catalogService","catalogVersionPermissionService",function(e,t,n,o){this.openEditorModal=function(){t.openAndRerenderSlot(this.component.typeCode,this.component.uuid,"visible").then(function(t){e.checkAndAlertOnComponentVisibility({itemId:t.uuid,itemType:t.itemtype,catalogVersion:t.catalogVersion,restricted:t.restricted,slotId:this.slotId,visible:t.visible})}.bind(this))},this.$onInit=function(){this.isReady=!1,this.imageRoot="/cmssmartedit/images",n.getCatalogVersionByUuid(this.component.catalogVersion).then(function(e){o.hasWritePermission(e.catalogId,e.version).then(function(e){this.readOnly=!e||this.component.isExternal,this.componentVisibilitySwitch=this.component.visible?"se.cms.component.visibility.status.on":"se.cms.component.visibility.status.off",this.componentRestrictionsCount="("+(this.component.restrictions?this.component.restrictions.length:0)+")",this.imageSrc=this.imageRoot+"/"+(this.readOnly?"component_external.png":"component_default.png"),this.isReady=!0}.bind(this))}.bind(this))}}]).component("slotVisibilityComponent",{templateUrl:"slotVisibilityComponentTemplate.html",transclude:!1,controller:"slotVisibilityComponentController",controllerAs:"ctrl",bindings:{component:"=",slotId:"@",componentId:"@"}})},function(e,t){angular.module("slotSyncButtonModule",["slotSynchronizationPanelModule","slotSynchronizationServiceModule","seConstantsModule"]).controller("slotSyncButtonController",["$scope","$translate","SYNCHRONIZATION_POLLING","SYNCHRONIZATION_STATUSES","EVENT_OUTER_FRAME_CLICKED","catalogService","slotSynchronizationService","componentHandlerService","crossFrameEventService",function(e,t,n,o,i,s,r,a,c){e.$watch("ctrl.isPopupOpened",function(){this.setRemainOpen({button:this.buttonName,remainOpen:this.isPopupOpened})}.bind(this)),this.statusIsInSync=function(e){return e.status&&e.status===o.IN_SYNC},this.getSyncStatus=function(){a.getPageUUID().then(function(e){r.getSyncStatus(e,this.slotId).then(function(e){this.isSlotInSync=this.statusIsInSync(e),this.newPageIsNotSynchronized=!e.lastSyncStatus,this.ready=!0}.bind(this))}.bind(this))}.bind(this),this.updateStatus=function(e,t){var n=(t.selectedDependencies||[]).concat(t.sharedDependencies||[]).find(function(e){return e.itemId===this.slotId}.bind(this))||{};this.isSlotInSync=this.statusIsInSync(n)};var l=this.getSyncStatus;this.$onInit=function(){this.buttonName="slotSyncButton",this.isPopupOpened=!1,this.newPageIsNotSynchronized=!1,this.ready=!1,this.isSlotInSync=!0,this.getSyncStatus(),this.unRegisterSyncPolling=c.subscribe(n.FAST_FETCH,l),this.newPageIsNotSynchronizedTemplate="<div class='se-ypopover--inner-content'>"+t.instant("se.cms.slot.sync.from.page.level")+"</div>",this.unregFn=c.subscribe(i,function(){this.isPopupOpened=!1}.bind(this))},this.$onDestroy=function(){this.unRegisterSyncPolling(),this.unregFn()}}]).component("slotSyncButton",{templateUrl:"slotSyncButtonTemplate.html",controller:"slotSyncButtonController",controllerAs:"ctrl",bindings:{setRemainOpen:"&",slotId:"@"}})},function(e,t){angular.module("slotSynchronizationPanelModule",["synchronizationPanelModule","slotSynchronizationServiceModule"]).controller("slotSynchronizationPanelController",["slotSynchronizationService","componentHandlerService",function(e,t){this.getSyncStatus=function(){return t.getPageUID().then(function(t){return e.getSyncStatus(t,this.slotId)}.bind(this))}.bind(this),this.performSync=function(t){return e.performSync(t)}}]).component("slotSynchronizationPanel",{templateUrl:"slotSynchronizationPanelTemplate.html",controller:"slotSynchronizationPanelController",controllerAs:"slotSync",bindings:{slotId:"<"}})},function(e,t){angular.module("syncIndicatorDecoratorModule",["slotSynchronizationServiceModule"]).controller("syncIndicatorController",["$q","catalogService","slotSynchronizationService","crossFrameEventService","componentHandlerService","SYNCHRONIZATION_STATUSES","SYNCHRONIZATION_POLLING",function(e,t,n,o,i,s,r){this.isVersionNonActive=!1,this.unRegisterSyncPolling=angular.noop,this.$onInit=function(){this.syncStatus={status:s.UNAVAILABLE},i.getPageUUID().then(function(e){this.pageUUID=e,this.unRegisterSyncPolling=o.subscribe(r.FAST_FETCH,this.fetchSyncStatus.bind(this)),t.isContentCatalogVersionNonActive().then(function(e){this.isVersionNonActive=e,this.isVersionNonActive&&this.fetchSyncStatus()}.bind(this))}.bind(this))},this.$onDestroy=function(){this.unRegisterSyncPolling()},this.fetchSyncStatus=function(){return this.isVersionNonActive?n.getSyncStatus(this.pageUUID,this.componentAttributes.smarteditComponentId).then(function(e){this.syncStatus=e}.bind(this),function(){this.syncStatus.status=s.UNAVAILABLE}.bind(this)):e.when()}.bind(this)}]).directive("syncIndicator",[function(){return{templateUrl:"syncIndicatorDecoratorTemplate.html",restrict:"C",transclude:!0,replace:!1,controller:"syncIndicatorController",controllerAs:"ctrl",bindToController:{active:"=",componentAttributes:"<"}}}])},function(e,t){angular.module("componentInfoServiceModule",["yjqueryModule","yLoDashModule","cmsitemsRestServiceModule","renderServiceInterfaceModule"]).service("componentInfoService",["$log","$q","yjQuery","lodash","crossFrameEventService","cmsitemsRestService","UUID_ATTRIBUTE","EVENTS","OVERLAY_RERENDERED_EVENT",function(e,t,n,o,i,s,r,a,c){var l={},d={};this.getById=function(e){if(l[e])return t.when(l[e]);var n=d[e]||t.defer();return d[e]||(d[e]=n),n.promise},this._getComponentsDataByUUIDs=function(t){s.getByIds(t).then(function(e){e.response.forEach(function(e){l[e.uuid]=e,d[e.uuid]&&(d[e.uuid].resolve(e),delete d[e.uuid])})},function(n){e.error("componentInfoService::_getComponentsDataByUUIDs error:",n.message),t.forEach(function(e){d[e]&&(d[e].reject(n),delete d[e])})})},this._onComponentsAdded=function(e){var t=o.map(e,function(e){return n(e).attr(r)}).filter(function(e){return!o.includes(Object.keys(l),e)});t.length&&this._getComponentsDataByUUIDs(t)},this._onComponentsRemoved=function(e){e.filter(function(e){return!n.find("["+r+"='"+n(e).attr(r)+"']").length}).filter(function(e){return o.includes(Object.keys(l),n(e).attr(r))}).map(function(e){return n(e).attr(r)}).forEach(function(e){delete l[e]})},this._clearCache=function(){l={},d={}},i.subscribe(c,function(e,t){t&&(t.addedComponents&&t.addedComponents.length&&this._onComponentsAdded(t.addedComponents),t.removedComponents&&t.removedComponents.length&&this._onComponentsRemoved(t.removedComponents))}.bind(this)),i.subscribe(a.PAGE_CHANGE,this._clearCache.bind(this)),i.subscribe(a.USER_HAS_CHANGED,this._clearCache.bind(this))}])},function(e,t){angular.module("componentVisibilityAlertServiceModule",["componentVisibilityAlertServiceInterfaceModule"]).factory("componentVisibilityAlertService",["ComponentVisibilityAlertServiceInterface","extend","gatewayProxy",function(e,t,n){var o=function(){this.gatewayId="ComponentVisibilityAlertService",n.initForService(this,["checkAndAlertOnComponentVisibility"])};return new(o=t(e,o))}])},function(e,t){angular.module("contextualMenuDropdownServiceModule",["contextualMenuDecoratorModule","smarteditServicesModule"]).run(["contextualMenuDropdownService",function(e){e._registerIsOpenEvent()}]).service("contextualMenuDropdownService",["systemEventService","CTX_MENU_DROPDOWN_IS_OPEN","CLOSE_CTX_MENU","DRAG_AND_DROP_EVENTS",function(e,t,n,o){var i;this._registerIsOpenEvent=function(){e.subscribe(t,function(){this._registerDragStarted()}.bind(this))},this._registerDragStarted=function(){i=e.subscribe(o.DRAG_STARTED,this._triggerCloseOperation)},this._triggerCloseOperation=function(){e.publishAsync(n),i&&i()}.bind(this)}])},function(e,t){angular.module("cmsDragAndDropServiceModule",["yjqueryModule","dragAndDropServiceModule","yLoDashModule","smarteditCommonsModule","slotRestrictionsServiceModule","componentEditingFacadeModule","translationServiceModule","removeComponentServiceModule","cmsSmarteditServicesModule","browserServiceModule","seConstantsModule"]).constant("DRAG_AND_DROP_EVENTS",{DRAG_STARTED:"CMS_DRAG_STARTED",DRAG_STOPPED:"CMS_DRAG_STOPPED",DRAG_OVER:"CMS_DRAG_OVER",DRAG_LEAVE:"CMS_DRAG_LEAVE"}).service("cmsDragAndDropService",["$q","$window","$translate","$timeout","yjQuery","lodash","dragAndDropService","componentHandlerService","systemEventService","gatewayFactory","slotRestrictionsService","alertService","assetsService","browserService","componentEditingFacade","waitDialogService","DRAG_AND_DROP_EVENTS","COMPONENT_REMOVED_EVENT","CONTENT_SLOT_TYPE","OVERLAY_RERENDERED_EVENT","CONTRACT_CHANGE_LISTENER_PROCESS_EVENTS","SMARTEDIT_COMPONENT_PROCESS_STATUS","CONTRACT_CHANGE_LISTENER_COMPONENT_PROCESS_STATUS",function(e,t,n,o,i,s,r,a,c,l,d,u,p,h,m,g,S,v,y,f,_,C,b){var I=".smartEditComponentX[data-smartedit-component-type='ContentSlot']",E=".smartEditComponentX[data-smartedit-component-type!='ContentSlot']",T="overlayDnd",O="overlayDropzone",R="overlayDropzone--full",A="overlayDropzone--top",P="overlayDropzone--bottom",M="overlayDropzone--left",N="overlayDropzone--right",D="overlayDropzone--hovered",U="smarteditoverlay_dndRendering",x="component_dragged",w="component_dragged_hovered",V="over-slot-enabled",L="over-slot-disabled";this._cachedSlots={},this._highlightedSlot=null,this._highlightedComponent=null,this._highlightedHint=null,this._dragInfo=null,this._overlayRenderedUnSubscribeFn=null,this._componentRemovedUnSubscribeFn=null,this._gateway=l.createGateway("cmsDragAndDrop"),this.register=function(){r.register({id:"se.cms.dragAndDrop",sourceSelector:["#smarteditoverlay .smartEditComponentX[data-smartedit-component-type!='ContentSlot'] .movebutton",".movebutton"],targetSelector:"#smarteditoverlay .smartEditComponentX[data-smartedit-component-type='ContentSlot']",startCallback:this.onStart,dragEnterCallback:this.onDragEnter,dragOverCallback:this.onDragOver,dropCallback:this.onDrop,outCallback:this.onDragLeave,stopCallback:this.onStop,enableScrolling:!0,helper:this._getDragImageSrc})},this.unregister=function(){r.unregister(["se.cms.dragAndDrop"]),d.emptyCache(),this._overlayRenderedUnSubscribeFn&&this._overlayRenderedUnSubscribeFn(),this._componentRemovedUnSubscribeFn&&this._componentRemovedUnSubscribeFn()},this.apply=function(){r.apply("se.cms.dragAndDrop"),this._addUIHelpers(),this._overlayRenderedUnSubscribeFn=c.subscribe(f,this._onOverlayUpdate),this._componentRemovedUnSubscribeFn=c.subscribe(v,this._onOverlayUpdate),this._gateway.subscribe(S.DRAG_STARTED,function(e,t){r.markDragStarted(),this._initializeDragOperation(t)}.bind(this)),this._gateway.subscribe(S.DRAG_STOPPED,function(){r.markDragStopped(),this._cleanDragOperation()}.bind(this))},this.update=function(){r.update("se.cms.dragAndDrop"),this._addUIHelpers(),this._cacheElements()},this._onOverlayUpdate=function(){return this.update(),e.when()}.bind(this),this.onStart=function(e){var t=this._getSelector(e.target);t.attr("data-component-id")||(t=i(t).closest("[data-component-id]"));var n=t.closest(E),o=n.closest(I),s=n.length>0?a.getId(n):t.attr("data-component-id"),r=n.length>0?a.getSlotOperationRelatedUuid(n):t.attr("data-component-uuid"),c=n.length>0?a.getType(n):t.attr("data-component-type"),l=n.length>0?a.getSlotOperationRelatedId(n):t.attr("data-component-id"),d=n.length>0?a.getSlotOperationRelatedType(n):t.attr("data-component-type"),u=n.length>0?a.getId(o):t.attr("data-slot-id"),p={componentId:s,componentUuid:r,componentType:c,slotUuid:n.length>0?a.getId(o):t.attr("data-slot-uuid"),slotId:u,slotOperationRelatedId:l,slotOperationRelatedType:d};n.addClass(x),this._initializeDragOperation(p),this._toggleKeepVisibleComponentAndSlot(!0)}.bind(this),this.onDragEnter=function(e){this._highlightSlot(e)}.bind(this),this.onDragOver=function(e){this._highlightSlot(e).then(function(){if(this._highlightedSlot&&this._highlightedSlot.isAllowed){var t=a.getId(this._highlightedSlot.original);if(!this._highlightedHint||!this._isMouseInRegion(e,this._highlightedHint)){this._highlightedHint&&this._clearHighlightedHint();var n=this._cachedSlots[t];n.components.length>0&&(this._highlightedComponent&&this._isMouseInRegion(e,this._highlightedComponent)||(this._clearHighlightedComponent(),s.forEach(n.components,function(t){if(this._isMouseInRegion(e,t))return this._highlightedComponent=t,!1}.bind(this))),this._highlightedComponent&&s.forEach(this._highlightedComponent.hints,function(t){if(this._isMouseInRegion(e,t))return this._highlightedHint=t,!1}.bind(this))),this._highlightedComponent&&this._highlightedComponent.id===this._dragInfo.slotOperationRelatedId?this._highlightedComponent.original.addClass(w):this._highlightedHint&&this._highlightedHint.original.addClass(D)}}}.bind(this))}.bind(this),this.onDrop=function(e){if(this._highlightedSlot){var t=this._dragInfo.slotId,o=a.getId(this._highlightedSlot.original),i=a.getUuid(this._highlightedSlot.original),s=this._dragInfo.componentId,r=this._dragInfo.slotOperationRelatedId||this._dragInfo.componentId,c=this._dragInfo.slotOperationRelatedType||this._dragInfo.componentType;if(!this._highlightedSlot.isAllowed){var l=n.instant("se.drag.and.drop.not.valid.component.type",{slotUID:o,componentUID:r});return void u.showDanger({message:l})}if(this._highlightedHint||0===this._highlightedSlot.components.length){var d,p=this._highlightedHint?this._highlightedHint.position:0;if(g.showWaitModal(),t)t===o&&a.getComponentPositionInSlot(t,s)<p&&p--,d=m.moveComponent(t,o,r,p);else if(s){var h={componentId:s,componentUuid:this._dragInfo.componentUuid,componentType:c},S={targetSlotId:o,dragInfo:h,position:p};d=this._dragInfo.cloneOnDrop?m.cloneExistingComponentToSlot(S):m.addExistingComponentToSlot(o,h,p)}else{var v={targetSlotId:o,targetSlotUUId:i},y=a.getCatalogVersionUuid(this._highlightedSlot.original);d=m.addNewComponentToSlot(v,y,c,p)}d.then(function(){this._scrollToModifiedSlot(o)}.bind(this),function(){this.onStop(e)}.bind(this)).finally(function(){g.hideWaitModal()})}}}.bind(this),this.onDragLeave=function(e){if(this._highlightedSlot){var t=a.getId(this._highlightedSlot.original),n=this._cachedSlots[t];this._isMouseInRegion(e,n)||this._clearHighlightedSlot()}}.bind(this),this.onStop=function(e){var t=this._getSelector(e.target).closest(E);this._toggleKeepVisibleComponentAndSlot(!1),this._cleanDragOperation(t),c.publish(_.RESTART_PROCESS)}.bind(this),this._getDragImageSrc=function(){var e="";return h.isSafari()&&(e=p.getAssetsRoot()+"/images/contextualmenu_move_on.png"),e},this._initializeDragOperation=function(e){this._dragInfo=e,this._cacheElements(),a.getOverlay().addClass(U),c.publishAsync(S.DRAG_STARTED)},this._cleanDragOperation=function(e){this._clearHighlightedSlot(),e&&e.removeClass(x),a.getOverlay().removeClass(U),c.publishAsync(S.DRAG_STOPPED),this._dragInfo=null,this._cachedSlots={},this._highlightedSlot=null},this._highlightSlot=function(t){var n,o=i(t.target).closest(I),r=a.getId(o);if(this._highlightedSlot&&(n=a.getId(this._highlightedSlot.original))!==r&&this._clearHighlightedSlot(),!this._highlightedSlot||void 0===this._highlightedSlot.isAllowed){this._highlightedSlot=this._cachedSlots[r];var l=s.cloneDeep(this._dragInfo);return l.componentId=this._dragInfo.slotOperationRelatedId||this._dragInfo.componentId,l.componentType=this._dragInfo.slotOperationRelatedType||this._dragInfo.componentType,l.cloneOnDrop&&delete l.componentId,d.isComponentAllowedInSlot(this._highlightedSlot,l).then(function(e){d.isSlotEditable(r).then(function(i){this._highlightedSlot&&this._highlightedSlot.id===r&&(this._highlightedSlot.isAllowed=e&&i||this._dragInfo.slotId===r,this._highlightedSlot.isAllowed?o.addClass(V):o.addClass(L),"dragenter"!==t.type||n&&n===r||this._highlightedSlot&&this._highlightedSlot.id===r&&(c.publish(r+"_SHOW_SLOT_MENU",r),c.publish(S.DRAG_OVER,r)))}.bind(this))}.bind(this))}return e.when()},this._addUIHelpers=function(){var e=a.getOverlay();e.find("."+T).remove(),e.find(I).each(function(){var e=i(this),t=e[0].offsetHeight,n=e[0].offsetWidth,o=a.getId(e);d.getSlotRestrictions(o);var s=e.find(E);if(0===s.length){var r=i("<div></div>");r.addClass(T);var c=i("<div></div>");c.addClass(O),c.addClass(R),r.height(t),r.width(n),r.append(c),e.append(r)}else s.each(function(){var e=i(this),t=e[0].offsetHeight,o=e[0].offsetWidth,s=i("<div></div>");s.addClass(T),s.height(t),s.width(o);var r=i("<div></div>"),a=i("<div></div>");r.addClass(O),a.addClass(O),o===n?(r.addClass(A),a.addClass(P)):(r.addClass(M),a.addClass(N)),s.append(r),s.append(a),e.append(s)})})},this._cacheElements=function(){var e=a.getOverlay();if(e){var t=this,n=this._getWindowScrolling();e.find(I).each(function(){var e=i(this),o=a.getId(e),s=a.getUuid(e),r={id:o,uuid:s,original:e,components:[],rect:t._getElementRects(e,n)},c=e.children(E);if(0===c.length){var l=e.find(".overlayDropzone");r.hint=l.length>0?{original:l,rect:t._getElementRects(l,n)}:null}else c.each(function(){var e=i(this),s=a.getId(e),c=a.getComponentPositionInSlot(o,s),l={id:a.getSlotOperationRelatedId(e),type:a.getSlotOperationRelatedType(e),original:e,position:c,hints:[],rect:t._getElementRects(e,n)},d=c++;e.find(".overlayDropzone").each(function(){var e=i(this),o={original:e,position:d++,rect:t._getElementRects(e,n)};l.hints.push(o)}),r.components.push(l)});t._cachedSlots[r.id]=r})}},this._clearHighlightedHint=function(){this._highlightedHint&&(this._highlightedHint.original.removeClass(D),this._highlightedHint=null)},this._clearHighlightedComponent=function(){this._clearHighlightedHint(),this._highlightedComponent&&(this._highlightedComponent.original.removeClass(w),this._highlightedComponent=null)},this._clearHighlightedSlot=function(){this._clearHighlightedComponent(),this._highlightedSlot&&(this._highlightedSlot.original.removeClass(V),this._highlightedSlot.original.removeClass(L),c.publish("HIDE_SLOT_MENU"),c.publish(S.DRAG_LEAVE)),this._highlightedSlot=null},this._isMouseInRegion=function(e,t){var n=t.rect;return e.pageX>=n.left&&e.pageX<=n.right&&e.pageY>=n.top&&e.pageY<=n.bottom},this._getElementRects=function(e,t){var n=e[0].getBoundingClientRect();return{left:n.left,right:n.right,bottom:n.bottom+t,top:n.top+t}},this._getWindowScrolling=function(){return t.scrollY||t.pageYOffset},this._scrollToModifiedSlot=function(e){var t=a.getComponentInOverlay(e,y);t&&t.length>0&&t[0].scrollIntoView()},this._getSelector=function(e){return i(e)},this._toggleKeepVisibleComponentAndSlot=function(e){if(this._dragInfo){var t=e?b.KEEP_VISIBLE:b.PROCESS;i.each(a.getComponentUnderSlot(this._dragInfo.componentId,this._dragInfo.componentType,this._dragInfo.slotId),function(e,n){n.dataset[C]=t}),i.each(a.getComponent(this._dragInfo.slotId,y),function(e,n){n.dataset[C]=t})}}}])},function(e,t){angular.module("componentEditingFacadeModule",["alertServiceModule","componentServiceModule","componentVisibilityAlertServiceModule","editorModalServiceModule","renderServiceModule","slotVisibilityServiceModule","translationServiceModule","functionsModule"]).service("componentEditingFacade",["$log","$q","$translate","copy","ComponentService","componentHandlerService","restServiceFactory","editorModalService","renderService","alertService","PAGES_CONTENT_SLOT_COMPONENT_RESOURCE_URI","componentVisibilityAlertService","slotVisibilityService","sharedDataService",function(e,t,n,o,i,s,r,a,c,l,d,u,p,h){var m;function _generateAndAlertErrorMessage(e,t,n,o){n&&n.data&&n.data.errors&&n.data.errors.length>0?l.showDanger({message:"se.cms.draganddrop.error",messagePlaceholders:{sourceComponentId:e,targetSlotId:t,detailedError:n.data.errors[0].message}}):o&&l.showDanger(o)}function _renderSlots(n,o,i,s){return c.renderSlots(n).then(function(){return p.reloadSlotsInfo().then(function(){return s&&function _generateAndAlertSuccessMessage(e,t){l.showSuccess({message:"se.cms.draganddrop.success",messagePlaceholders:{sourceComponentId:e,targetSlotId:t}})}(o,i),t.when()},function(n){return e.error("componentEditingFacadeModule._renderSlots::slotVisibilityService.reloadSlotsInfo"),e.error(n),t.reject(n)})},function(n){return e.error("componentEditingFacadeModule._renderSlots::renderService.renderSlots - targetSlotId:",i),e.error(n),_generateAndAlertErrorMessage(o,i,n),t.reject(n)})}this.addNewComponentToSlot=function(e,t,n,o){var i={smarteditComponentType:n,catalogVersionUuid:t};return a.open(i,e.targetSlotUUId,o).then(function(t){return _renderSlots([e.targetSlotId],t.uid,e.targetSlotId,!0)})},this.addExistingComponentToSlot=function(e,n,o){return s.getPageUID().then(function(s){return i.addExistingComponent(s,n.componentId,e,o).then(function(){return i.loadComponentItem(n.componentUuid).then(function(t){return u.checkAndAlertOnComponentVisibility({itemId:n.componentUuid,itemType:n.componentType,catalogVersion:t.catalogVersion,restricted:t.restricted,slotId:e,visible:t.visible}),_renderSlots(e,n.componentId,e,!0)},function(o){return _generateAndAlertErrorMessage(n.componentId,e,o),t.reject()})},function(o){return _generateAndAlertErrorMessage(n.componentId,e,o),t.reject()})})},this.cloneExistingComponentToSlot=function(e){return i.loadComponentItem(e.dragInfo.componentUuid).then(function(t){return h.get("experience").then(function(i){var s=o(t);s.componentUuid=s.uuid,s.cloneComponent=!0,s.catalogVersion=i.pageContext.catalogVersionUuid,s.name=n.instant("se.cms.component.name.clone.of.prefix")+" "+s.name,delete s.uuid,delete s.uid,delete s.slots,delete s.restrictions,delete s.creationtime,delete s.modifiedtime;var r={smarteditComponentType:e.dragInfo.componentType,catalogVersionUuid:i.pageContext.catalogVersionUuid,content:o(s),initialDirty:!0};return a.open(r,e.targetSlotId,e.position).then(function(t){return u.checkAndAlertOnComponentVisibility({itemId:t.uuid,itemType:t.itemtype,catalogVersion:t.catalogVersion,restricted:t.restricted,slotId:e.targetSlotId,visible:t.visible}),_renderSlots(e.targetSlotId,t.uid,e.targetSlotId,!0)})})},function(n){return _generateAndAlertErrorMessage(e.dragInfo.componentId,e.targetSlotId,n),t.reject()})},this.moveComponent=function(e,n,o,i){var a=d+"/pages/:pageId/contentslots/:currentSlotId/components/:componentId";return m=m||r.get(a,"componentId"),s.getPageUID().then(function(s){return m.update({pageId:s,currentSlotId:e,componentId:o,slotId:n,position:i}).then(function(){return _renderSlots([e,n],o,n)},function(e){return _generateAndAlertErrorMessage(o,n,e,{message:"se.cms.draganddrop.move.failed",messagePlaceholders:{slotID:n,componentID:o}}),t.reject()})})}}])},function(e,t){angular.module("slotRestrictionsServiceModule",["yLoDashModule","slotSharedServiceModule","functionsModule","cmsSmarteditServicesModule"]).service("slotRestrictionsService",["$q","$log","lodash","isBlank","gatewayProxy","crossFrameEventService","EVENTS","componentHandlerService","slotSharedService","restServiceFactory","pageContentSlotsComponentsRestService","typePermissionsRestService","CONTENT_SLOT_TYPE_RESTRICTION_RESOURCE_URI","CONTENT_SLOT_TYPE",function(e,t,n,o,i,s,r,a,c,l,d,u,p,h){var m,g={},S=null;this.getAllComponentTypesSupportedOnPage=function(){var o=a.getFromSelector(a.getAllSlotsSelector()),i=Array.prototype.slice.call(o.map(function(){return a.getId(a.getFromSelector(this))}));return e.all(i.map(function(e){return this.getSlotRestrictions(e)}.bind(this))).then(function(e){return n.flatten(e)},function(e){t.info(e)})},this.getSlotRestrictions=function(n){return m=m||l.get(p),this._getPageUID(S).then(function(o){S=o;var i=this._getEntryId(S,n);return g[i]?e.when(g[i]):this._isExternalSlot(n)?(g[i]=[],e.when(g[i])):m.get({pageUid:S,slotUid:n}).then(function(e){return g[i]=e.validComponentTypes,g[i]}.bind(this),function(e){t.info(e)})}.bind(this))},this.isComponentAllowedInSlot=function(e,t){return this.getSlotRestrictions(e.id).then(function(o){return d.getComponentsForSlot(e.id).then(function(i){return(e.id===t.slotId||!i.some(function(e){return e.uid===t.componentId}))&&n.includes(o,t.componentType)})})},this.isSlotEditable=function(e){return u.hasUpdatePermissionForTypes([h]).then(function(t){return c.isSlotShared(e).then(function(n){var o=t[h];if(n){var i=this._isExternalSlot(e);o=o&&!i&&!c.areSharedSlotsDisabled()}return o}.bind(this))}.bind(this))},this.emptyCache=function(){g={},S=null},this._getEntryId=function(e,t){return e+"_"+t},this._isExternalSlot=function(e){return a.isExternalComponent(e,h)},this._getPageUID=function(t){return o(t)?a.getPageUID():e.when(t)},s.subscribe(r.PAGE_CHANGE,function(){this.emptyCache()}.bind(this)),i.initForService(this,["getAllComponentTypesSupportedOnPage","getSlotRestrictions"],"SLOT_RESTRICTIONS")}])},function(e,t){angular.module("editorEnablerServiceModule",["componentVisibilityAlertServiceModule","editorModalServiceModule","slotRestrictionsServiceModule","cmsSmarteditServicesModule"]).factory("editorEnablerService",["componentVisibilityAlertService","componentHandlerService","editorModalService","featureService","slotRestrictionsService","typePermissionsRestService",function(e,t,n,o,i,s){function EditorEnablerService(){}return EditorEnablerService.prototype._key="se.cms.edit",EditorEnablerService.prototype._nameI18nKey="se.cms.contextmenu.nameI18nKey.edit",EditorEnablerService.prototype._i18nKey="se.cms.contextmenu.title.edit",EditorEnablerService.prototype._descriptionI18nKey="se.cms.contextmenu.descriptionI18n.edit",EditorEnablerService.prototype._editDisplayClass="editbutton",EditorEnablerService.prototype._editDisplayIconClass="hyicon hyicon-edit",EditorEnablerService.prototype._editDisplaySmallIconClass="hyicon hyicon-edit",EditorEnablerService.prototype._editButtonCallback=function(t){var o=t.slotUuid;n.open(t.componentAttributes).then(function(t){e.checkAndAlertOnComponentVisibility({itemId:t.uuid,itemType:t.itemtype,catalogVersion:t.catalogVersion,restricted:t.restricted,slotId:o,visible:t.visible})})},EditorEnablerService.prototype._condition=function(e){var n=t.getParentSlotForComponent(e.element);return i.isSlotEditable(n).then(function(n){return s.hasUpdatePermissionForTypes([e.componentType]).then(function(o){return o[e.componentType]&&n&&!t.isExternalComponent(e.componentId,e.componentType)}.bind(this))})},EditorEnablerService.prototype.enableForComponents=function(e){var t={key:this._key,nameI18nKey:this._nameI18nKey,descriptionI18nKey:this._descriptionI18nKey,regexpKeys:e,displayClass:this._editDisplayClass,displayIconClass:this._editDisplayIconClass,displaySmallIconClass:this._editDisplaySmallIconClass,i18nKey:this._i18nKey,callback:this._editButtonCallback,condition:this._condition,permissions:["se.context.menu.edit.component"]};o.addContextualMenuButton(t)},new EditorEnablerService}])},function(e,t){angular.module("editorModalServiceModule",[]).factory("editorModalService",["gatewayProxy",function(e){function EditorModalService(){this.gatewayId="EditorModal",e.initForService(this,["open","openAndRerenderSlot"])}return EditorModalService.prototype.open=function(){},EditorModalService.prototype.openAndRerenderSlot=function(){},new EditorModalService}])},function(e,t){angular.module("pageContentSlotsServiceModule",["resourceModule","smarteditServicesModule","cmsResourceLocationsModule","yLoDashModule"]).service("pageContentSlotsService",["$q","lodash","restServiceFactory","crossFrameEventService","EVENTS","componentHandlerService","PAGES_CONTENT_SLOT_RESOURCE_URI",function(e,t,n,o,i,s,r){var a,c=n.get(r);this._reloadPageContentSlots=function(){return s.getPageUID().then(function(n){return a=c.get({pageId:n}).then(function(n){return e.when(t.uniq(n.pageContentSlotList||[]))})})},this.getPageContentSlots=function(){return a?e.when(a):this._reloadPageContentSlots()},this.getSlotStatus=function(n){return(a?e.when(a):this._reloadPageContentSlots()).then(function(e){var o=t.first(e.filter(function(e){return e.slotId===n}));return o?o.slotStatus:void 0})},o.subscribe(i.PAGE_CHANGE,function(){this._reloadPageContentSlots()}.bind(this))}])},function(e,t){angular.module("removeComponentServiceModule",["smarteditServicesModule","renderServiceModule","removeComponentServiceInterfaceModule","experienceInterceptorModule","functionsModule","resourceLocationsModule"]).constant("COMPONENT_REMOVED_EVENT","componentRemovedEvent").factory("removeComponentService",["restServiceFactory","renderService","extend","gatewayProxy","$q","$log","RemoveComponentServiceInterface","experienceInterceptor","systemEventService","PAGES_CONTENT_SLOT_COMPONENT_RESOURCE_URI","COMPONENT_REMOVED_EVENT",function(e,t,n,o,i,s,r,a,c,l,d){var u=function(e){this.gatewayId=e,o.initForService(this,["removeComponent"])};u=n(r,u);var p=e.get(l+"/contentslots/:slotId/components/:componentId","componentId");return u.prototype.removeComponent=function(e){return p.remove({slotId:e.slotId,componentId:e.slotOperationRelatedId}).then(function(){t.renderSlots(e.slotId),c.publishAsync(d)})},new u("RemoveComponent")}])},function(e,t){angular.module("slotSharedServiceModule",["pageContentSlotsServiceModule","yLoDashModule","cmsitemsRestServiceModule"]).service("slotSharedService",["pageContentSlotsService","lodash","cmsitemsRestService","componentHandlerService","$translate","confirmationModalService",function(e,t,n,o,i,s){this.isSlotShared=function(n){return e.getPageContentSlots().then(function(e){var o=t.first(e.filter(function(e){return e.slotId===n}));return o?o.slotShared:void 0})},this.setSharedSlotEnablementStatus=function(e){this.disableShareSlotStatus=e},this.areSharedSlotsDisabled=function(){return this.disableShareSlotStatus},this.convertSharedSlotToNonSharedSlot=function(e,t){return this._validateComponentAttributes(e),this._constructCmsItemParameter(e,t).then(function(e){var o={title:"se.cms.slot.shared.convert.to.unshared.confirmation.title"};return o.description=t?"se.cms.slot.shared.convert.to.unshared.clone.components.confirmation.message":"se.cms.slot.shared.convert.to.unshared.remove.components.confirmation.message",s.confirm(o).then(function(){return n.create(e)})})},this._constructCmsItemParameter=function(e,t){return i("se.cms.slot.shared.clone").then(function(n){return o.getPageUID().then(function(o){return{name:o+"-"+e.smarteditComponentId+"-"+n,smarteditComponentId:e.smarteditComponentId,contentSlotUuid:e.contentSlotUuid,itemtype:e.componentType,catalogVersion:e.catalogVersionUuid,pageUuid:o,cloneComponents:t}})}.bind(this))},this._validateComponentAttributes=function(e){if(!e)throw new Error("Parameter: componentAttributes needs to be supplied!");for(var t=["smarteditComponentId","contentSlotUuid","componentType","catalogVersionUuid"],n=0;n<t.length;n++){var o=t[n];if(!e[o])throw new Error("Parameter: componentAttributes."+o+" needs to be supplied!")}}}])},function(e,t){angular.module("slotSynchronizationServiceModule",[]).constant("SYNCHRONIZATION_SLOTS_SELECT_ALL_COMPONENTS_LABEL","se.cms.synchronization.slots.select.all.components").service("slotSynchronizationService",["SYNCHRONIZATION_SLOTS_SELECT_ALL_COMPONENTS_LABEL","syncPollingService",function(e,t){this.getSyncStatus=function(n,o){return t.getSyncStatus(n).then(function(t){var n=(t.selectedDependencies||[]).concat(t.sharedDependencies||[]).find(function(e){return e.name===o})||{};return n.selectAll=e,n})},this.performSync=function(e,n){return t.performSync(e,n)}}])},function(e,t){angular.module("slotUnsharedServiceModule",["cmsitemsRestServiceModule","pageContentSlotsServiceModule"]).service("slotUnsharedService",["$q","cmsitemsRestService","pageContentSlotsService",function(e,t,n){this.isSlotUnshared=function(e){return n.getSlotStatus(e).then(function(e){return"OVERRIDE"===e})},this.revertToSharedSlot=function(e){return t.delete(e)}}])},function(e,t){angular.module("slotVisibilityServiceModule",["resourceModule","cmsSmarteditServicesModule"]).service("slotVisibilityService",["$log","$q","componentHandlerService","pageInfoService","pageContentSlotsComponentsRestService",function(e,t,n,o,i){var s=function(e){return Object.keys(e).forEach(function(t){var o=[];n.getOriginalComponentsWithinSlot(t).get().forEach(function(e){o.push(n.getId(e))});var i=e[t].filter(function(e){return-1===o.indexOf(e.uid)});e[t]=i}),e};this.reloadSlotsInfo=function(){return o.getPageUID().then(function(e){return i.clearCache(),i.getSlotsToComponentsMapForPageUid(e)}.bind(this),function(t){throw e.error("slotVisibilityService::reloadSlotsInfo - failed call to pageInfoService.getPageUID"),t})};this.getHiddenComponents=function(t){return function(t){return t?this.reloadSlotsInfo():o.getPageUID().then(function(e){return i.getSlotsToComponentsMapForPageUid(e)}.bind(this),function(t){throw e.error("slotVisibilityService::reloadSlotsInfo - failed call to pageInfoService.getPageUID"),t})}(!1).then(s).then(function(e){return e[t]||[]},function(){return[]})}}])},function(e,t){angular.module("cmssmarteditTemplates",[]).run(["$templateCache",function(e){"use strict";e.put("web/features/cmssmartedit/components/externalComponent/externalComponentButtonTemplate.html",'<div class="cms-external-component-button"\n    data-ng-if="ctrl.isReady">\n    {{ctrl.catalogVersion}}\n</div>'),e.put("web/features/cmssmartedit/components/externalComponent/externalComponentDecoratorTemplate.html",'<div data-ng-class="{\'cms-external-component-decorator\': !ctrl.isExtenalSlot, \'disabled-shared-slot-hovered\': ctrl.active && !ctrl.isExtenalSlot, \'cms-external-component-decorator--versioning\': ctrl.isVersioningPerspective}">\n    <div class="contextualMenuOverlay"\n        data-ng-if="!ctrl.isExtenalSlot && ctrl.isReady">\n        <span data-ng-if="!ctrl.active || ctrl.isVersioningPerspective"\n            data-y-popover\n            data-placement="\'bottom\'"\n            data-template="ctrl.getTooltipTemplate()"\n            data-trigger="\'hover\'"\n            class="hyicon hyicon-globe hyicon-globe--normal"\n            data-ng-class="{\'hyicon-globe--version\': ctrl.isVersioningPerspective}"></span>\n    </div>\n    <div class="yWrapperData"\n        data-ng-class="{\'disabled-shared-slot-versioning-mode\': ctrl.isVersioningPerspective && !ctrl.isExtenalSlot}"\n        data-ng-transclude>\n    </div>\n</div>'),e.put("web/features/cmssmartedit/components/slotShared/slotSharedButtonTemplate.html",'<div class="shared-slot-button-template"\n    data-ng-if="ctrl.slotSharedFlag">\n    <div class="btn-group se-slot-ctx-menu__btn-group"\n        data-uib-dropdown\n        data-dropdown-append-to="\'#smarteditoverlay\'"\n        data-auto-close="outsideClick"\n        data-is-open="ctrl.isPopupOpened">\n        <button type="button"\n            data-uib-dropdown-toggle\n            class="btn btn-primary shared-slot-button-template__btn se-slot-ctx-menu__divider"\n            data-ng-class="{\'ySESharedSlotOpen\': ctrl.isPopupOpened}"\n            id="sharedSlotButton-{{::ctrl.slotId}}">\n            <span class="hyicon hyicon-linked se-slot-ctx-menu__icon-shared"></span>\n        </button>\n        <div class="dropdown-menu dropdown-menu-right btn-block shared-slot__dropdown"\n            data-uib-dropdown-menu>\n            <div class="shared-slot__header"\n                data-translate="se.sharedslot.decorator.label"></div>\n            <div class="shared-slot__divider"></div>\n            <div class="shared-slot__description"\n                data-translate="se.cms.slot.shared.popover.message"></div>\n            <div class="shared-slot__divider"></div>\n            <div class="shared-slot__body"\n                has-operation-permission="\'se.shared.slot.override.options\'">\n                <div class="shared-slot__sub-header"\n                    data-translate="se.cms.slot.shared.popover.convertoptions.title"></div>\n                <a class="shared-slot__link"\n                    data-ng-click="ctrl.convertToNonSharedSlotAndCloneComponents()"\n                    data-translate="se.cms.slot.shared.popover.button.clonecomponents">\n                </a>\n                <div class="shared-slot__link-description"\n                    data-translate="se.cms.slot.shared.popover.text.clonecomponents"></div>\n                <a class="shared-slot__link"\n                    data-ng-click="ctrl.convertToNonSharedSlotAndRemoveComponents()"\n                    data-translate="se.cms.slot.shared.popover.button.removecomponents">\n                </a>\n                <div class="shared-slot__link-description"\n                    data-translate="se.cms.slot.shared.popover.text.removecomponents"></div>\n            </div>\n        </div>\n    </div>\n</div>'),e.put("web/features/cmssmartedit/components/slotShared/slotSharedTemplate.html",'<slot-shared-button data-slot-id="{{::ctrl.smarteditComponentId}}"\n    data-component-attributes="ctrl.componentAttributes"\n    data-set-remain-open="ctrl.setRemainOpen(button, remainOpen)">\n</slot-shared-button>'),e.put("web/features/cmssmartedit/components/slotSharedDisabled/externalSlotDisabledDecoratorTemplate.html",'<div class="se-decorator-wrap">\n    <slot-disabled-component data-active="ctrl.active"\n        data-component-attributes="ctrl.componentAttributes" />\n    <div ng-transclude></div>\n</div>'),e.put("web/features/cmssmartedit/components/slotSharedDisabled/sharedSlotDisabledDecoratorTemplate.html",'<div class="se-decorator-wrap">\n    <slot-disabled-component data-active="ctrl.active"\n        data-component-attributes="ctrl.componentAttributes" />\n    <div ng-transclude></div>\n</div>'),e.put("web/features/cmssmartedit/components/slotSharedDisabled/slotDisabledTemplate.html",'<div class="disabled-shared-slot popoveredElement external-shared-slot"\n    data-ng-class="{ \'disabled-shared-slot-hovered\': ctrl.active, \'external-shared-slot\': ctrl.isExternalSlot, \'disabled-shared-slot-versioning-mode\': ctrl.isVersioningPerspective, \'disabled-shared-slot\': !ctrl.isVersioningPerspective}"\n    data-popover-content="{{ctrl.getPopoverMessage()}}">\n    <div class="disabled-shared-slot__icon--outer disabled-shared-slot__icon--outer-linked"\n        data-ng-class="[ctrl.getOuterSlotClass(), { \'disabled-shared-slot__icon--outer-hovered\': ctrl.active && !ctrl.isVersioningPerspective}]">\n        <span class="hyicon shared_slot_disabled_icon disabled-shared-slot__icon--inner"\n            data-ng-class="ctrl.getSlotIconClass()">\n        </span>\n    </div>\n</div>'),e.put("web/features/cmssmartedit/components/slotUnshared/slotUnsharedButtonTemplate.html",'<div class="slot-unshared-button-template"\n    data-ng-if="ctrl.slotUnsharedFlag">\n    <div class="btn-group se-slot-ctx-menu__btn-group"\n        data-uib-dropdown\n        data-dropdown-append-to="\'#smarteditoverlay\'"\n        data-auto-close="outsideClick"\n        data-is-open="ctrl.isPopupOpened">\n        <button type="button"\n            data-uib-dropdown-toggle\n            class="btn btn-primary shared-slot-button-template__btn se-slot-ctx-menu__divider"\n            data-ng-class="{\'ySESharedSlotOpen\': ctrl.isPopupOpened}"\n            id="slot-unshared-button-{{::ctrl.slotUid}}">\n            <span class="hyicon hyicon-unlinked se-slot-ctx-menu__icon-unshared"></span>\n        </button>\n        <div class="dropdown-menu dropdown-menu-right se-toolbar-menu-content shared-slot__dropdown"\n            data-uib-dropdown-menu>\n            <div class="shared-slot__header"\n                data-translate="se.cms.unshared.slot.header">\n            </div>\n            <div class="shared-slot__divider"></div>\n            <div class="shared-slot__body">\n                <div class="shared-slot__link-description shared-slot__link-description__unshared"\n                    data-translate="se.cms.slot.unshared.popover.message"></div>\n                <a class="shared-slot__link"\n                    data-ng-click="ctrl.revertToSharedSlot()"\n                    has-operation-permission="\'se.revert.to.shared.slot.link\'">\n                    {{\'se.cms.slot.unshared.revert.to.shared.title\' | translate}}\n                </a>\n            </div>\n        </div>\n    </div>\n</div>'),e.put("web/features/cmssmartedit/components/slotUnshared/slotUnsharedButtonWrapperTemplate.html",'<slot-unshared-button data-slot-uuid="{{::ctrl.componentAttributes.smarteditComponentUuid}}"\n    data-slot-uid="{{::ctrl.smarteditComponentId}}"\n    data-set-remain-open="ctrl.setRemainOpen(button, remainOpen)"></slot-unshared-button>'),e.put("web/features/cmssmartedit/components/slotVisibility/hiddenComponentMenu/hiddenComponentMenuItemsTemplate.html",'<div class="se-hidden-component-menu">\n    <div class="se-hidden-component-menu__item"\n        data-ng-repeat="dropdownItem in ctrl.menuItems"\n        data-ng-click="ctrl.executeItemCallback(dropdownItem, $event)">\n        <span class="se-hidden-component-menu__item-icon"\n            data-ng-class="[dropdownItem.displayIconClass]"></span>\n        <span class="se-hidden-component-menu__item-link">\n            {{ dropdownItem.i18nKey | translate }}\n        </span>\n    </div>\n</div>'),e.put("web/features/cmssmartedit/components/slotVisibility/hiddenComponentMenu/hiddenComponentMenuTemplate.html",'<div class="se-hidden-component-menu__popup-anchor"\n    data-ng-click="ctrl.onButtonClick($event)"\n    y-popup-overlay="ctrl.popupConfig"\n    y-popup-overlay-trigger="{{ctrl.isMenuOpen}}"\n    y-popup-overlay-on-hide="ctrl.onMenuHide()">\n    <span data-ng-if="ctrl.menuItems.length > 0"\n        class="hyicon hyicon-more se-hidden-component-menu__icon"></span>\n</div>'),e.put("web/features/cmssmartedit/components/slotVisibility/slotVisibilityButtonTemplate.html",'<div class="slot-visibility-button-template">\n    <div class="btn-group slot-visibility-button-template__btn-group"\n        data-uib-dropdown\n        data-dropdown-append-to="\'#smarteditoverlay\'"\n        data-is-open="ctrl.isComponentListOpened">\n        <button type="button"\n            data-uib-dropdown-toggle\n            class="btn btn-primary slot-visibility-button-template__btn se-slot-ctx-menu__divider"\n            data-ng-if="ctrl.buttonVisible"\n            data-ng-class="{\'ySEVisibilityOpen\': ctrl.isComponentListOpened}"\n            id="slot-visibility-button-{{::ctrl.slotId}}">\n            <img class="slot-visibility-button-template__btn__img "\n                data-ng-src="{{ ctrl.eyeImageUrl }}" />{{ ::ctrl.hiddenComponentCount }}\n        </button>\n        <ul class="dropdown-menu dropdown-menu-right slot-visibility-button-template__menu"\n            data-uib-dropdown-menu\n            data-ng-click="ctrl.onInsideClick($event)"\n            role="menu"\n            id="slot-visibility-list-{{::ctrl.slotId}}">\n            <li class="slot-visibility-button-template__menu__title"\n                data-translate="se.cms.slotvisibility.list.title"></li>\n            <li class="slot-visibility-component slot-visibility-button-template__menu__component"\n                data-ng-repeat="component in ctrl.hiddenComponents track by $index">\n\n                <span data-y-popover\n                    data-ng-if="component.isExternal"\n                    data-trigger="\'hover\'"\n                    data-template="ctrl.getTemplateInfoForExternalComponent()">\n                    <slot-visibility-component data-component="component"\n                        data-component-id="{{::component.uid}}"\n                        data-slot-id="{{::ctrl.slotId}}"></slot-visibility-component>\n                </span>\n\n                <slot-visibility-component data-component="component"\n                    data-ng-if="!component.isExternal"\n                    data-component-id="{{::component.uid}}"\n                    data-slot-id="{{::ctrl.slotId}}"></slot-visibility-component>\n            </li>\n        </ul>\n    </div>\n</div>'),e.put("web/features/cmssmartedit/components/slotVisibility/slotVisibilityComponentTemplate.html",'<div class="slot-visibility-component--wrapper"\n    data-ng-class="{\'slot-visibility-component--wrapper__external\': ctrl.readOnly}">\n    <div class="slot-visiblity-component-template"\n        data-ng-if="ctrl.isReady">\n        <div class="slot-visiblity-component-template__icon">\n            <img data-ng-src="{{ctrl.imageSrc}}"\n                class="slot-visiblity-component-template__icon__image"\n                alt="{{::ctrl.component.typeCode}}" />\n        </div>\n        <div class="slot-visiblity-component-template__text-wrapper">\n            <a href="#"\n                data-ng-if="!ctrl.readOnly"\n                class="slot-visiblity-component-template__text slot-visiblity-component-template__text__name"\n                data-ng-click="ctrl.openEditorModal()">{{ ::ctrl.component.name }}</a>\n            <a data-ng-if="ctrl.readOnly"\n                class="slot-visiblity-component-template__text slot-visiblity-component-template__text__name">{{ ::ctrl.component.name }}</a>\n            <p class="slot-visiblity-component-template__text slot-visiblity-component-template__text__type">{{ ::ctrl.component.typeCode }}</p>\n            <p class="slot-visiblity-component-template__text slot-visiblity-component-template__text__visibility">{{\'se.genericeditor.tab.visibility.title\' | translate}} {{ctrl.componentVisibilitySwitch | translate}} / {{ctrl.componentRestrictionsCount}} {{\'se.cms.restrictions.editor.tab\' | translate}}</p>\n        </div>\n        <span data-ng-if="ctrl.component.isExternal === true"\n            class="hyicon hyicon-globe slot-visiblity-component--globe-icon"></span>\n    </div>\n    <hidden-component-menu class="slot-visiblity-component--hidden-menu"\n        data-slot-id="ctrl.slotId"\n        data-component="ctrl.component"></hidden-component-menu>\n</div>'),e.put("web/features/cmssmartedit/components/slotVisibility/slotVisibilityWidgetTemplate.html",'<slot-visibility-button data-slot-id="{{::ctrl.smarteditComponentId}}"\n    data-set-remain-open="ctrl.setRemainOpen(button, remainOpen)" />'),e.put("web/features/cmssmartedit/components/synchronize/slots/slotSyncButtonTemplate.html",'<div class="slot-sync-button-template"\n    data-ng-if="ctrl.ready">\n    <div class="btn-group se-slot-ctx-menu__btn-group"\n        data-uib-dropdown\n        data-dropdown-append-to="\'#smarteditoverlay\'"\n        data-auto-close="outsideClick"\n        data-is-open="ctrl.isPopupOpened">\n\n        <span data-y-popover\n            class="se-slot-ctx-menu__popover"\n            data-trigger="\'hover\'"\n            data-template="ctrl.newPageIsNotSynchronizedTemplate"\n            data-ng-if="ctrl.newPageIsNotSynchronized"\n            data-placement="\'bottom\'">\n        </span>\n\n        <button type="button"\n            data-uib-dropdown-toggle\n            class="btn btn-primary se-slot-ctx-menu__btn se-slot-ctx-menu__divider"\n            data-ng-class="{\'ySESyncOpen\': ctrl.isPopupOpened, \'se-slot-ctx-menu__btn--disabled\': ctrl.newPageIsNotSynchronized }"\n            id="slot-sync-button-{{::ctrl.slotId}}">\n            <span class="hyicon hyicon-sync se-slot-ctx-menu__btn__sync"></span>\n            <span data-ng-if="!ctrl.isSlotInSync"\n                class="hyicon hyicon-caution se-slot-ctx-menu__btn__caution"></span>\n        </button>\n        <ul class="dropdown-menu dropdown-menu-right btn-block se-toolbar-menu-content se-toolbar-menu-content__page-sync slot-sync-button-template__menu"\n            data-uib-dropdown-menu\n            role="menu">\n            <li role="menuitem">\n                <div class="se-toolbar-menu-content--wrapper">\n                    <div class="slot-sync__header"\n                        data-translate="se.cms.synchronization.slot.header">\n                    </div>\n                    <div class="se-toolbar-menu-content--body">\n                        <slot-synchronization-panel data-ng-if="ctrl.isPopupOpened"\n                            data-slot-id="ctrl.slotId"></slot-synchronization-panel>\n                    </div>\n                </div>\n            </li>\n        </ul>\n    </div>\n</div>'),e.put("web/features/cmssmartedit/components/synchronize/slots/slotSynchronizationPanelTemplate.html",'<div data-page-sensitive>\n    <synchronization-panel data-item-id="slotSync.slotId"\n        data-get-sync-status="slotSync.getSyncStatus"\n        data-perform-sync="slotSync.performSync">\n    </synchronization-panel>\n</div>'),e.put("web/features/cmssmartedit/components/synchronize/slots/slotSyncTemplate.html",'<slot-sync-button data-slot-id="{{::ctrl.smarteditComponentId}}"\n    data-set-remain-open="ctrl.setRemainOpen(button, remainOpen)"></slot-sync-button>'),e.put("web/features/cmssmartedit/components/synchronize/slots/syncIndicatorDecorator/syncIndicatorDecoratorTemplate.html",'<div class="sync-indicator-decorator"\n    data-ng-class="ctrl.syncStatus.status"\n    data-sync-status="{{ctrl.syncStatus.status}}">\n    <div class="yWrapperData"\n        data-ng-transclude></div>\n</div>')}])},function(e,t,n){var o={"./components/synchronize/synchronizationPanel.js":32,"./dao/cmswebservices/sites/cmsitemsRestService.js":33,"./dao/resource.js":34,"./dao/resourceLocations.js":35,"./services/componentService.js":36,"./services/componentVisibilityAlertServiceInterface.js":37,"./services/removeComponentServiceInterface.js":38,"./services/synchronizationService.js":39,"./templates.js":40};function webpackContext(e){var t=webpackContextResolve(e);return n(t)}function webpackContextResolve(e){var t=o[e];if(!(t+1)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return t}webpackContext.keys=function webpackContextKeys(){return Object.keys(o)},webpackContext.resolve=webpackContextResolve,e.exports=webpackContext,webpackContext.id=31},function(e,t){angular.module("synchronizationPanelModule",["yHelpModule","translationServiceModule","alertServiceModule","timerModule","alertsBoxModule","yMessageModule","smarteditServicesModule","l10nModule"]).controller("SynchronizationPanelController",["$q","$attrs","$translate","isBlank","EVENT_CONTENT_CATALOG_UPDATE","SYNCHRONIZATION_POLLING","SYNCHRONIZATION_STATUSES","alertService","systemEventService","timerService","crossFrameEventService","catalogService","l10nFilter","sharedDataService","waitDialogService",function(e,t,n,o,i,s,r,a,c,l,d,u,p,h,m){this.syncPendingItems=[],this.selectedItems=[],this.showItemList=!0,this.refreshInterval=s.SLOW_POLLING_TIME,this.getRows=function(){return this.syncStatus?[this.syncStatus].concat(this.syncStatus.selectedDependencies):[]},this.api={selectAll:function(){if(!this.syncStatus)throw new Error("Synchronization status is not available. The 'selectAll' function should be used with 'onSyncStatusReady' event.");this.syncStatus.selected=!0,this.selectionChange(0)}.bind(this),displayItemList:function(e){this.showItemList=e}.bind(this),disableItem:null},this.selectionChange=function(e){this.syncStatus.selectedDependencies.forEach(function(t){t.selected=0===e&&t.status!==r.IN_SYNC&&!t.isExternal||t.selected}.bind(this)),this.selectedItems=this.getRows().filter(function(e){return e.selected}),this.onSelectedItemsUpdate&&this.onSelectedItemsUpdate(this.selectedItems)},this.preserveSelection=function(e){var t=(e||[]).map(function(e){return e.itemId},[]);this.getRows().forEach(function(e){e.selected=t.indexOf(e.itemId)>-1&&e.status!==r.IN_SYNC})},this.isDisabled=function(e){return!(!this.api.disableItem||!this.api.disableItem(e))||(e!==this.syncStatus&&this.syncStatus.selected||e.status===r.IN_SYNC)}.bind(this),this.isSyncButtonDisabled=function(){return 0===this.selectedItems.length||0!==this.syncPendingItems.length},this.isInSync=function(e){return e.status===r.IN_SYNC},this.isOutOfSync=function(e){return e.status===r.NOT_IN_SYNC},this.isInProgress=function(e){return e.status===r.IN_PROGRESS},this.isSyncFailed=function(e){return e.status===r.SYNC_FAILED},this.hasHelp=function(e){return e.dependentItemTypesOutOfSync&&e.dependentItemTypesOutOfSync.length>0},this.buildInfoTemplate=function(e){if(e&&e.dependentItemTypesOutOfSync&&!e.isExternal){var t=e.dependentItemTypesOutOfSync.reduce(function(e,t){return e+="<div>"+n.instant(t.i18nKey)+"</div>"},"");return t?"<div>"+t+"</div>":""}if(e.isExternal)return e.catalogVersionNameTemplate},this.fetchSyncStatus=function(e,t){if(!t||t.itemId===this.itemId)return this.getSyncStatus(this.itemId).then(function(e){h.get("experience").then(function(t){var n=e.catalogVersionUuid;this.syncStatus=e,this.preserveSelection(this.selectedItems),this.selectionChange(),this._updateStatus(),this.markExternalComponents(n,this.getRows()),this.setTemplateExternalCatalogVersionName(t,this.getRows()),0===this.syncPendingItems.length&&(this.refreshInterval=s.SLOW_POLLING_TIME,this.resynchTimer.restart(this.refreshInterval),c.publishAsync(s.SLOW_DOWN,this.itemId)),"function"==typeof this.onSyncStatusReady&&this.onSyncStatusReady({$syncStatus:e})}.bind(this))}.bind(this))},this.markExternalComponents=function(e,t){t.forEach(function(t){t.isExternal=t.catalogVersionUuid!==e})},this.getInfoTitle=function(e){if(!e.isExternal)return"se.cms.synchronization.panel.update.title"},this.getTemplateInfoForExternalComponent=function(){return"<div>"+n.instant("se.cms.synchronization.slot.external.component")+"</div>"},this.setTemplateExternalCatalogVersionName=function(e,t){t.forEach(function(t){t.catalogVersionNameTemplate="<span></span>",u.getCatalogVersionByUuid(t.catalogVersionUuid,e.siteDescriptor.uid).then(function(e){t.catalogVersionNameTemplate="<div>"+p(e.catalogName)+"</div>"})})},this._updateStatus=function(){var e=!1,t="",o=this.syncPendingItems.length;this.getRows().forEach(function(n){this.syncPendingItems.indexOf(n.itemId)>-1&&n.status===r.SYNC_FAILED&&(t=" "+t+n.itemId,e=!0),this.syncPendingItems.indexOf(n.itemId)>-1&&n.status!==r.IN_PROGRESS&&this.syncPendingItems.splice(this.syncPendingItems.indexOf(n.itemId),1);var s=o&&0===this.syncPendingItems.length;(s||0===o)&&(s&&(c.publishAsync(i),o=0),m.hideWaitModal()),n.status===r.IN_PROGRESS&&-1===this.syncPendingItems.indexOf(n.itemId)&&this.syncPendingItems.push(n.itemId)}.bind(this)),e&&a.showDanger({message:n.instant("se.cms.synchronization.panel.failure.message",{items:t})})},this.$onInit=function(){this.syncItems=function(){var t=this.getRows().filter(function(e){return e.selected}).map(function(e){return{itemId:e.itemId,itemType:e.itemType}});return Array.prototype.push.apply(this.syncPendingItems,t.map(function(e){return e.itemId})),this.selectedItems.length?(m.showWaitModal("se.sync.synchronizing"),this.performSync(t).then(function(){this.refreshInterval=s.FAST_POLLING_TIME,this.resynchTimer.restart(this.refreshInterval),c.publishAsync(s.SPEED_UP,this.itemId)}.bind(this))):e.when()}.bind(this),"function"==typeof this.getApi&&this.getApi({$api:this.api}),this.unsubscribeFastFetch=d.subscribe(s.FAST_FETCH,this.fetchSyncStatus.bind(this)),this.fetchSyncStatus(),this.resynchTimer=l.createTimer(this.fetchSyncStatus.bind(this),this.refreshInterval),this.resynchTimer.start()},this.$onDestroy=function(){this.resynchTimer.teardown(),this.unsubscribeFastFetch(),c.publishAsync(s.SLOW_DOWN,this.itemId)},this.$postLink=function(){this.showSyncButton=o(t.syncItems)}}]).component("synchronizationPanel",{templateUrl:"synchronizationPanelTemplate.html",controller:"SynchronizationPanelController",controllerAs:"sync",bindings:{itemId:"<",getSyncStatus:"<",performSync:"<",headerTemplateUrl:"<?",syncItems:"=?",onSelectedItemsUpdate:"<?",onSyncStatusReady:"&?",getApi:"&?"}})},function(e,t){angular.module("cmsitemsRestServiceModule",["functionsModule","resourceLocationsModule","smarteditServicesModule","yLoDashModule"]).provider("cmsitemsUri",["CONTEXT_SITE_ID",function(e){this.uri="/cmswebservices/v1/sites/"+e+"/cmsitems",this.$get=function(){return this.uri}.bind(this)}]).provider("cmsitemsUuidsUri",["CONTEXT_SITE_ID",function(e){this.uri="/cmswebservices/v1/sites/"+e+"/cmsitems/uuids",this.$get=function(){return this.uri}.bind(this)}]).service("cmsitemsRestService",["lodash","restServiceFactory","cmsitemsUri","cmsitemsUuidsUri","catalogService","operationContextService","OPERATION_CONTEXT",function(e,t,n,o,i,s,r){var a=t.get(n),c=t.get(n+"/:itemUuid"),l=t.get(o);s.register(n.replace(/CONTEXT_SITE_ID/,":CONTEXT_SITE_ID"),r.CMS),this.create=function(e){return i.getCatalogVersionUUid().then(function(t){return e.catalogVersion=e.catalogVersion||t,void 0===e.onlyOneRestrictionMustApply&&(e.onlyOneRestrictionMustApply=!1),a.save(e)})},this.getById=function(e){return a.getById(e)},this.getByIdAndVersion=function(e,t){return c.get({itemUuid:e,versionId:t})},this.get=function(t){return i.retrieveUriContext().then(function(n){var o={catalogId:t.catalogId||n.CURRENT_CONTEXT_CATALOG,catalogVersion:t.catalogVersion||n.CURRENT_CONTEXT_CATALOG_VERSION};return t=e.merge(o,t),a.get(t)})},this.getByIds=function(e){return i.getCatalogVersionUUid().then(function(t){return l.save({catalogVersion:t,uuids:e})})},this.update=function(e){return a.update(e)},this.delete=function(e){return a.remove({identifier:e})},this._getByUIdAndType=function(e,t){return this.get({pageSize:100,currentPage:0,mask:e,typeCode:t}).then(function(t){return t.response.find(function(t){return t.uid===e})})}}])},function(e,t){angular.module("resourceModule",["smarteditServicesModule","resourceLocationsModule","cmsResourceLocationsModule","functionsModule"]).factory("itemsResource",["restServiceFactory","ITEMS_RESOURCE_URI","URIBuilder",function(e,t,n){return{getItemResource:function(){return e.get(t)},getItemResourceByContext:function(o){return e.get(new n(t).replaceParams(o).build())}}}]).factory("pagesContentSlotsComponentsResource",["restServiceFactory","PAGES_CONTENT_SLOT_COMPONENT_RESOURCE_URI",function(e,t){return e.get(t)}]).factory("navigationNodeRestService",["restServiceFactory","NAVIGATION_MANAGEMENT_RESOURCE_URI",function(e,t){return e.get(t)}]).factory("synchronizationResource",["restServiceFactory","URIBuilder","GET_PAGE_SYNCHRONIZATION_RESOURCE_URI","POST_PAGE_SYNCHRONIZATION_RESOURCE_URI",function(e,t,n,o){return{getPageSynchronizationGetRestService:function(o){var i=new t(n).replaceParams(o).build();return e.get(i)},getPageSynchronizationPostRestService:function(n){var i=new t(o).replaceParams(n).build();return e.get(i)}}}])},function(e,t){!function(){var e="CURRENT_CONTEXT_CATALOG",t="CURRENT_CONTEXT_CATALOG_VERSION",n="CURRENT_CONTEXT_SITE_ID",o="CURRENT_PAGE_CONTEXT_CATALOG";angular.module("cmsResourceLocationsModule",[]).constant("CONTEXT_SITE_ID",n).constant("CONTEXT_CATALOG",e).constant("CONTEXT_CATALOG_VERSION",t).constant("PAGE_CONTEXT_SITE_ID","CURRENT_PAGE_CONTEXT_SITE_ID").constant("PAGE_CONTEXT_CATALOG",o).constant("PAGE_CONTEXT_CATALOG_VERSION","CURRENT_PAGE_CONTEXT_CATALOG_VERSION").constant("TYPES_RESOURCE_URI","/cmswebservices/v1/types").constant("ITEMS_RESOURCE_URI","/cmswebservices/v1/sites/"+n+"/catalogs/"+e+"/versions/"+t+"/items").constant("PAGES_CONTENT_SLOT_COMPONENT_RESOURCE_URI","/cmswebservices/v1/sites/CURRENT_PAGE_CONTEXT_SITE_ID/catalogs/"+o+"/versions/CURRENT_PAGE_CONTEXT_CATALOG_VERSION/pagescontentslotscomponents").constant("CONTENT_SLOT_TYPE_RESTRICTION_RESOURCE_URI","/cmswebservices/v1/catalogs/"+o+"/versions/CURRENT_PAGE_CONTEXT_CATALOG_VERSION/pages/:pageUid/contentslots/:slotUid/typerestrictions").constant("PAGES_LIST_RESOURCE_URI","/cmswebservices/v1/sites/"+n+"/catalogs/"+e+"/versions/"+t+"/pages").constant("PAGE_LIST_PATH","/pages/:siteId/:catalogId/:catalogVersion").constant("TRASHED_PAGE_LIST_PATH","/trashedpages/:siteId/:catalogId/:catalogVersion").constant("PAGES_CONTENT_SLOT_RESOURCE_URI","/cmswebservices/v1/sites/CURRENT_PAGE_CONTEXT_SITE_ID/catalogs/"+o+"/versions/CURRENT_PAGE_CONTEXT_CATALOG_VERSION/pagescontentslots").constant("PAGE_TEMPLATES_URI","/cmswebservices/v1/sites/:"+n+"/catalogs/:"+e+"/versions/:"+t+"/pagetemplates").constant("NAVIGATION_MANAGEMENT_PAGE_PATH","/navigations/:siteId/:catalogId/:catalogVersion").constant("NAVIGATION_MANAGEMENT_RESOURCE_URI","/cmswebservices/v1/sites/:"+n+"/catalogs/:"+e+"/versions/:"+t+"/navigations").constant("NAVIGATION_MANAGEMENT_ENTRIES_RESOURCE_URI","/cmswebservices/v1/sites/:"+n+"/catalogs/:"+e+"/versions/:"+t+"/navigations/:navigationUid/entries").constant("NAVIGATION_MANAGEMENT_ENTRY_TYPES_RESOURCE_URI","/cmswebservices/v1/navigationentrytypes").constant("CONTEXTUAL_PAGES_RESOURCE_URI","/cmswebservices/v1/sites/"+n+"/catalogs/"+e+"/versions/"+t+"/pages").constant("CONTEXTUAL_PAGES_RESTRICTIONS_RESOURCE_URI","/cmswebservices/v1/sites/CURRENT_PAGE_CONTEXT_SITE_ID/catalogs/"+o+"/versions/CURRENT_PAGE_CONTEXT_CATALOG_VERSION/pagesrestrictions").constant("PAGES_RESTRICTIONS_RESOURCE_URI","/cmswebservices/v1/sites/:siteUID/catalogs/:catalogId/versions/:catalogVersion/pagesrestrictions").constant("UPDATE_PAGES_RESTRICTIONS_RESOURCE_URI","/cmswebservices/v1/sites/"+n+"/catalogs/"+e+"/versions/"+t+"/pagesrestrictions/pages").constant("RESTRICTION_TYPES_URI","/cmswebservices/v1/restrictiontypes").constant("PAGE_TYPES_RESTRICTION_TYPES_URI","/cmswebservices/v1/pagetypesrestrictiontypes").constant("PAGEINFO_RESOURCE_URI","/cmswebservices/v1/sites/"+n+"/catalogs/"+e+"/versions/"+t+"/pages/:pageUid").constant("PAGE_TYPES_URI","/cmswebservices/v1/pagetypes").constant("GET_PAGE_SYNCHRONIZATION_RESOURCE_URI","/cmssmarteditwebservices/v1/sites/CURRENT_PAGE_CONTEXT_SITE_ID/catalogs/"+o+"/versions/CURRENT_PAGE_CONTEXT_CATALOG_VERSION/synchronizations/versions/:target/pages/:pageUid").constant("POST_PAGE_SYNCHRONIZATION_RESOURCE_URI","/cmssmarteditwebservices/v1/sites/"+n+"/catalogs/"+e+"/versions/"+t+"/synchronizations/versions/:target")}()},function(e,t){angular.module("componentServiceModule",["smarteditServicesModule","cmsSmarteditServicesModule","resourceLocationsModule","cmsitemsRestServiceModule","slotRestrictionsServiceModule"]).service("ComponentService",["$q","restServiceFactory","TYPES_RESOURCE_URI","PAGES_CONTENT_SLOT_COMPONENT_RESOURCE_URI","CONTEXT_CATALOG","CONTEXT_CATALOG_VERSION","cmsitemsRestService","catalogService","slotRestrictionsService","pageInfoService","pageContentSlotsComponentsRestService","typePermissionsRestService",function(e,t,n,o,i,s,r,a,c,l,d,u){var p=t.get(n),h=r,m=t.get(o);this.createNewComponent=function(e,t){var n={};if(n.name=e.name,n.slotId=e.targetSlotId,n.pageId=e.pageId,n.position=e.position,n.typeCode=e.componentType,n.itemtype=e.componentType,n.catalogVersion=e.catalogVersionUuid,"object"==typeof t)for(var o in t)t.hasOwnProperty(o)&&(n[o]=t[o]);else if(t)throw"ComponentService.createNewComponent() - Illegal componentPayload - ["+t+"]";return h.create(n)},this.updateComponent=function(e){return h.update(e)},this.addExistingComponent=function(e,t,n,o){var i={};return i.pageId=e,i.slotId=n,i.componentId=t,i.position=o,m.save(i)},this.loadComponentTypes=function(){return p.get({category:"COMPONENT"})},this.getSupportedComponentTypesForCurrentPage=function(){return e.all([this.loadComponentTypes(),c.getAllComponentTypesSupportedOnPage()]).then(function(e){var t=e[1],n=e[0].componentTypes.filter(function(e){return t.indexOf(e.code)>-1}),o=n.map(function(e){return e.code});return u.hasCreatePermissionForTypes(o).then(function(e){return n.filter(function(t){return e[t.code]})})}.bind(this))}.bind(this),this.loadComponentItem=function(e){return h.getById(e)},this.loadPagedComponentItems=function(e,t,n){return a.retrieveUriContext().then(function(o){var r={pageSize:t,currentPage:n,mask:e,sort:"name",typeCode:"AbstractCMSComponent",catalogId:o[i],catalogVersion:o[s]};return h.get(r)})},this.loadPagedComponentItemsByCatalogVersion=function(e){var t={pageSize:e.pageSize,currentPage:e.page,mask:e.mask,sort:"name",typeCode:"AbstractCMSComponent",catalogId:e.catalogId,catalogVersion:e.catalogVersion};return h.get(t)},this.getSlotsForComponent=function(e){var t=[];return this._getContentSlotsForComponents().then(function(n){return Object.keys(n).forEach(function(o){n[o].find(function(t){return t.uuid===e})&&t.push(o)}),t}.bind(this))},this._getContentSlotsForComponents=function(){return l.getPageUID().then(function(e){return d.getSlotsToComponentsMapForPageUid(e)})}}])},function(e,t){angular.module("componentVisibilityAlertServiceInterfaceModule",[]).factory("ComponentVisibilityAlertServiceInterface",function(){var e=function(){};return e.prototype.checkAndAlertOnComponentVisibility=function(){},e})},function(e,t){angular.module("removeComponentServiceInterfaceModule",[]).factory("RemoveComponentServiceInterface",function(){function RemoveComponentServiceInterface(){}return RemoveComponentServiceInterface.prototype.removeComponent=function(){},RemoveComponentServiceInterface})},function(e,t){angular.module("synchronizationServiceModule",["smarteditServicesModule","resourceLocationsModule","alertServiceModule","authenticationModule","timerModule","smarteditCommonsModule","cmsConstantsModule"]).constant("CATALOG_SYNC_INTERVAL_IN_MILLISECONDS",5e3).service("synchronizationService",["restServiceFactory","timerService","$q","$translate","alertService","authenticationService","operationContextService","crossFrameEventService","OPERATION_CONTEXT","CATALOG_SYNC_INTERVAL_IN_MILLISECONDS","SYNCHRONIZATION_EVENT",function(e,t,n,o,i,s,r,a,c,l,d){var u={},p=[],h=e.get("/cmswebservices/v1/catalogs/:catalog/synchronizations/targetversions/:target"),m=e.get("/cmswebservices/v1/catalogs/:catalog/versions/:source/synchronizations/versions/:target","catalog");r.register("/cmswebservices/v1/catalogs/:catalog/synchronizations/targetversions/:target",c.CMS),r.register("/cmswebservices/v1/catalogs/:catalog/versions/:source/synchronizations/versions/:target",c.CMS),this.updateCatalogSync=function(e){var t=this._getJobKey(e.catalogId,e.sourceCatalogVersion,e.targetCatalogVersion);return this.addCatalogSyncRequest(t),m.update({catalog:e.catalogId,source:e.sourceCatalogVersion,target:e.targetCatalogVersion}).then(function(e){return e}.bind(this),function(t){var n=o.instant("sync.running.error.msg",{catalogName:e.name});return"Conflict"===t.statusText&&i.showDanger({message:n}),!1}.bind(this))},this.getCatalogSyncStatus=function(e){return e.sourceCatalogVersion?this.getSyncJobInfoBySourceAndTarget(e):this.getLastSyncJobInfoByTarget(e)},this.getSyncJobInfoBySourceAndTarget=function(e){return m.get({catalog:e.catalogId,source:e.sourceCatalogVersion,target:e.targetCatalogVersion})},this.getLastSyncJobInfoByTarget=function(e){return h.get({catalog:e.catalogId,target:e.targetCatalogVersion})},this.startAutoGetSyncData=function(e,n){var o=e.catalogId,i=e.sourceCatalogVersion,s=e.targetCatalogVersion,r=this._getJobKey(o,i,s),a=t.createTimer(this._autoSyncCallback.bind(this,e,n,r),l);a.start(),u[r]=a},this._autoSyncCallback=function(e,t,n){s.isAuthenticated("/cmswebservices").then(function(o){o||this.stopAutoGetSyncData(e),this.getCatalogSyncStatus(e).then(this.syncRequestedCallback(e)).then(t).then(function(){u[n]||this.startAutoGetSyncData(e,t)}.bind(this))}.bind(this))},this.syncRequestedCallback=function(e){var t=this._getJobKey(e.catalogId,e.sourceCatalogVersion,e.targetCatalogVersion);return function(n){return this.catalogSyncInProgress(t)&&(this.catalogSyncFinished(n)&&(this.removeCatalogSyncRequest(t),a.publish(d.CATALOG_SYNCHRONIZED,e)),(u[t].discardWhenNextSynced&&this.catalogSyncFinished(n)||this.catalogSyncAborted(n))&&(u[t].stop(),u[t]=void 0,this.removeCatalogSyncRequest(t))),n}.bind(this)},this.catalogSyncInProgress=function(e){return p.indexOf(e)>-1},this.catalogSyncFinished=function(e){return"FINISHED"===e.syncStatus},this.catalogSyncAborted=function(e){return"ABORTED"===e.syncStatus},this.removeCatalogSyncRequest=function(e){var t=p.indexOf(e);t>-1&&p.splice(t,1)},this.addCatalogSyncRequest=function(e){-1===p.indexOf(e)&&p.push(e)},this.stopAutoGetSyncData=function(e){var t=this._getJobKey(e.catalogId,e.sourceCatalogVersion,e.targetCatalogVersion);u[t]&&(p.indexOf(t)>-1?u[t].discardWhenNextSynced=!0:(u[t].stop(),u[t]=void 0))},this._getJobKey=function(e,t,n){return e+"_"+t+"_"+n}}])},function(e,t){angular.module("cmscommonsTemplates",[]).run(["$templateCache",function(e){"use strict";e.put("web/features/cmscommons/components/synchronize/synchronizationPanelTemplate.html",'<div class="se-sync-panel">\n\n    <div class="se-sync-panel__sync-status"\n        data-ng-if="sync.headerTemplateUrl"\n        data-ng-include="sync.headerTemplateUrl">\n    </div>\n\n    <div class="se-sync-panel__sync-info"\n        data-ng-show="sync.showItemList">\n        <div data-ng-repeat="dependency in sync.getRows()"\n            data-ng-class="{active: $index==0, \'se-sync-panel--item__external\': dependency.isExternal}"\n            class="se-sync-panel__sync-info__row">\n\n            <div class="checkbox se-sync-panel__sync-info__checkbox se-nowrap-ellipsis">\n                <input type="checkbox"\n                    data-ng-if="!dependency.isExternal"\n                    data-ng-model="dependency.selected"\n                    data-ng-disabled="sync.isDisabled(dependency)"\n                    data-ng-change="sync.selectionChange($index)"\n                    id="sync-info__checkbox_{{$index}}">\n                <label data-ng-if="$index===0"\n                    for="sync-info__checkbox_{{$index}}"\n                    class="se-sync-panel__sync-info__checkbox-label se-nowrap-ellipsis"\n                    title="{{::dependency.selectAll | translate}}">\n                    {{::dependency.selectAll | translate}}</label>\n\n                <label data-ng-if="$index!==0 && !dependency.isExternal"\n                    for="sync-info__checkbox_{{$index}}"\n                    class="se-sync-panel__sync-info__checkbox-label se-nowrap-ellipsis"\n                    title="{{::dependency.name | translate}}">\n                    {{::dependency.name | translate}}</label>\n\n                <label data-ng-if="$index!==0 && dependency.isExternal"\n                    data-y-popover\n                    data-trigger="\'hover\'"\n                    data-template="sync.getTemplateInfoForExternalComponent()"\n                    for="sync-info__checkbox_{{$index}}"\n                    class="se-sync-panel__sync-info__checkbox-label se-nowrap-ellipsis">\n                    {{::dependency.name | translate}}\n                </label>\n            </div>\n\n            <span data-ng-if="sync.buildInfoTemplate(dependency)"\n                data-y-popover\n                data-trigger="\'hover\'"\n                data-title="sync.getInfoTitle(dependency)"\n                data-template="sync.buildInfoTemplate(dependency)"\n                data-ng-class="{\'pull-right se-sync-panel__sync-info__right-icon\': true, \'se-sync-panel--icon-globe\': dependency.isExternal} ">\n                <span data-status="{{dependency.status}}"\n                    data-ng-if="!dependency.isExternal"\n                    data-ng-class="{\'hyicon hyicon__se-sync-panel__sync-info\':true, \'hyicon-done hyicon__se-sync-panel__sync-done\':sync.isInSync(dependency), \'hyicon-sync hyicon__se-sync-panel__sync-not\':!sync.isInSync(dependency)}"></span>\n                <span data-ng-if="dependency.isExternal"\n                    class="hyicon hyicon-globe"></span>\n            </span>\n\n            <span data-ng-if="!sync.buildInfoTemplate(dependency)"\n                class="pull-right se-sync-panel__sync-info__right-icon">\n                <span data-status="{{dependency.status}}"\n                    data-ng-class="{\'hyicon hyicon__se-sync-panel__sync-info\':true, \'hyicon-done hyicon__se-sync-panel__sync-done\':sync.isInSync(dependency), \'hyicon-sync hyicon__se-sync-panel__sync-not\':!sync.isInSync(dependency)}"></span>\n            </span>\n        </div>\n    </div>\n\n    <div class="se-sync-panel__footer"\n        data-ng-if="sync.showSyncButton">\n        <button class="btn btn-lg btn-primary se-sync-panel__footer__btn"\n            data-ng-disabled="sync.isSyncButtonDisabled()"\n            data-ng-click="sync.syncItems()"\n            data-translate="se.cms.actionitem.page.sync"></button>\n    </div>\n\n</div>')}])},function(e,t){function webpackEmptyContext(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}webpackEmptyContext.keys=function(){return[]},webpackEmptyContext.resolve=webpackEmptyContext,e.exports=webpackEmptyContext,webpackEmptyContext.id=41},function(e,t,n){"use strict";function importAll(e){e.keys().forEach(function(t){e(t)})}n.r(t);var o=n(1);var i,s,r=n(0),a=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},c=function(){function HiddenComponentMenuService(e,t,n){this.$q=e,this.contextualMenuService=t,this.slotContainerService=n,this.MENU_ITEM_EXTERNAL="externalcomponentbutton",this.MENU_ITEM_CLONE="clonecomponentbutton",this.MENU_ITEM_REMOVE="se.cms.remove",this.allowedItems={},this._setDefaultItemsAllowed()}return HiddenComponentMenuService.$inject=["$q","contextualMenuService","slotContainerService"],HiddenComponentMenuService.prototype.allowItemsInHiddenComponentMenu=function(e){var t=this;e.forEach(function(e){t.allowedItems[e]=!0})},HiddenComponentMenuService.prototype.removeAllowedItemsInHiddenComponentMenu=function(e){var t=this;e.forEach(function(e){delete t.allowedItems[e]})},HiddenComponentMenuService.prototype.getAllowedItemsInHiddenComponentMenu=function(){return Object.keys(this.allowedItems)},HiddenComponentMenuService.prototype.getItemsForHiddenComponent=function(e,t){var n=this;return this._validateComponent(e),this._buildComponentInfo(t,e).then(function(t){return n._getAllowedItemsForComponent(e,t)})},HiddenComponentMenuService.prototype._validateComponent=function(e){if(!e)throw new Error("HiddenComponentMenuService - Component cannot be null.");if(!e.uid)throw new Error("HiddenComponentMenuService - Component needs a uid.");if(!e.typeCode)throw new Error("HiddenComponentMenuService - Component needs a type code.");if(!e.uuid)throw new Error("HiddenComponentMenuService - Component needs a uuid.")},HiddenComponentMenuService.prototype._setDefaultItemsAllowed=function(){this.allowItemsInHiddenComponentMenu([this.MENU_ITEM_EXTERNAL,this.MENU_ITEM_CLONE,this.MENU_ITEM_REMOVE])},HiddenComponentMenuService.prototype._buildComponentInfo=function(e,t){return this.slotContainerService.getComponentContainer(e,t.uuid).then(function(n){return{componentType:t.typeCode,componentId:t.uid,componentAttributes:{smarteditCatalogVersionUuid:t.catalogVersion,smarteditComponentId:t.uid,smarteditComponentType:t.componentType,smarteditComponentUuid:t.uuid,smarteditElementUuid:null},containerType:n?n.containerType:null,containerId:n?n.containerId:null,element:null,isComponentHidden:!0,slotId:e,iLeftBtns:0}})},HiddenComponentMenuService.prototype._getAllowedItemsForComponent=function(e,t){var n=this,i=[],s=[],r=this.contextualMenuService.getContextualMenuByType(e.typeCode);return(r=o.copy(r)).filter(function(e){return n.allowedItems[e.key]}).forEach(function(e){var o=n.$q.defer();s.push(o.promise),n.$q.when(!e.condition||e.condition(t)).then(function(t){t&&i.push(e),o.resolve()})}),this.$q.all(s).then(function(){return{buttons:i,configuration:t}})},HiddenComponentMenuService=a([Object(r.SeInjectable)()],HiddenComponentMenuService)}(),l=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},d=function(){function SlotContainerService(e,t,n,o,i,s,r){this.$q=e,this.lodash=t,this.experienceService=o;var a="/cmswebservices/v1/sites/"+i+"/catalogs/"+s+"/versions/"+r+"/pagescontentslotscontainers?pageId=:pageId";this.containersRestService=n.get(a)}return SlotContainerService.$inject=["$q","lodash","restServiceFactory","experienceService","PAGE_CONTEXT_SITE_ID","PAGE_CONTEXT_CATALOG","PAGE_CONTEXT_CATALOG_VERSION"],SlotContainerService.prototype.getComponentContainer=function(e,t){var n=this;return this.loadContainersInPageInfo().then(function(o){var i=o.filter(function(o){return o.slotId===e&&n.lodash.includes(o.components,t)});return i.length>0?i[0]:null})},SlotContainerService.prototype.loadContainersInPageInfo=function(){var e=this;return this.containersInPage?this.$q.when(this.containersInPage):this.experienceService.getCurrentExperience().then(function(t){return e.containersRestService.get({pageId:t.pageId})}).then(function(t){return e.containersInPage=t.pageContentSlotContainerList,e.containersInPage})},SlotContainerService=l([Object(r.SeInjectable)()],SlotContainerService)}();!function(e){e.ContentPage="ContentPage",e.CategoryPage="CategoryPage",e.ProductPage="ProductPage"}(i||(i={})),function(e){e.ACTIVE="ACTIVE",e.DELETED="DELETED"}(s||(s={}));var u,p=function(){function AssetsService(e){this.TEST_ASSETS_KEY="testAssets",this.TEST_ASSETS_SRC="/web/webroot",this.PROD_ASSETS_SRC="/cmssmartedit",this.$injector=e}return AssetsService.prototype.getAssetsRoot=function(){var e=!1;if(this.getInjector().has(this.TEST_ASSETS_KEY)){var t=this.getInjector().get(this.TEST_ASSETS_KEY);e="boolean"==typeof t&&t}return e?this.TEST_ASSETS_SRC:this.PROD_ASSETS_SRC},AssetsService.prototype.getInjector=function(){return this.$injector},AssetsService.$inject=["$injector"],AssetsService}(),h=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},m=function(){function CMSModesService(e){this.perspectiveService=e}var e;return CMSModesService.$inject=["perspectiveService"],e=CMSModesService,CMSModesService.prototype.isVersioningPerspectiveActive=function(){return this.perspectiveService.getActivePerspectiveKey().then(function(t){return t===e.VERSIONING_PERSPECTIVE_KEY})},CMSModesService.VERSIONING_PERSPECTIVE_KEY="se.cms.perspective.versioning",CMSModesService=e=h([Object(r.SeInjectable)()],CMSModesService)}(),g=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};!function(e){e.CREATE="create",e.READ="read",e.CHANGE="change",e.REMOVE="remove"}(u||(u={}));var S=function(){function TypePermissionsRestService(e,t,n,o){this.$log=e,this.$q=t,this.sessionService=n,this.URI="/permissionswebservices/v1/permissions/principals/:user/types",this.resource=o.get(this.URI)}return TypePermissionsRestService.$inject=["$log","$q","sessionService","restServiceFactory"],TypePermissionsRestService.prototype.hasCreatePermissionForTypes=function(e){return this._getPermissionsForTypesAndName(e,u.CREATE)},TypePermissionsRestService.prototype.hasReadPermissionForTypes=function(e){return this._getPermissionsForTypesAndName(e,u.READ)},TypePermissionsRestService.prototype.hasUpdatePermissionForTypes=function(e){return this._getPermissionsForTypesAndName(e,u.CHANGE)},TypePermissionsRestService.prototype.hasDeletePermissionForTypes=function(e){return this._getPermissionsForTypesAndName(e,u.REMOVE)},TypePermissionsRestService.prototype.hasAllPermissionsForTypes=function(e){var t=this,n={};return this._getAllPermissionsForTypes(e).then(function(e){return e.reduce(function(e,n){return n.permissions&&(e[n.id]={},e[n.id][u.READ]=t._getPermissionByNameAndResult(n,u.READ),e[n.id][u.CHANGE]=t._getPermissionByNameAndResult(n,u.CHANGE),e[n.id][u.CREATE]=t._getPermissionByNameAndResult(n,u.CREATE),e[n.id][u.REMOVE]=t._getPermissionByNameAndResult(n,u.REMOVE)),e},n)})},TypePermissionsRestService.prototype._getPermissionByNameAndResult=function(e,t){return JSON.parse(e.permissions.find(function(e){return e.key===t}).value)},TypePermissionsRestService.prototype._getPermissionsForTypesAndName=function(e,t){var n=this;return this._getAllPermissionsForTypes(e).then(function(e){return e.reduce(function(e,o){return o.permissions&&(e[o.id]=n._getPermissionByNameAndResult(o,t)),e},{})})},TypePermissionsRestService.prototype._getAllPermissionsForTypes=function(e){var t=this;return e.length<=0?this.$q.when([]):this.sessionService.getCurrentUsername().then(function(n){return n?t.resource.get({user:n,types:e.join(","),permissionNames:u.CREATE+","+u.CHANGE+","+u.READ+","+u.REMOVE}).then(function(e){return e.permissionsList||[]},function(n){return n&&t.$log.error("TypePermissionsRestService - no composed types "+e+" exist"),t.$q.reject(n)}):[]})},g([Object(r.Cached)({actions:[r.rarelyChangingContent],tags:[r.authorizationEvictionTag]})],TypePermissionsRestService.prototype,"_getAllPermissionsForTypes",null),TypePermissionsRestService=g([Object(r.SeInjectable)()],TypePermissionsRestService)}(),v=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},y=function(){function VersionExperienceInterceptor(e,t,n){this.TYPES_RESOURCE_URI=e,this.interceptorHelper=t,this.sharedDataService=n,this.request=this.request.bind(this)}var e;return VersionExperienceInterceptor.$inject=["TYPES_RESOURCE_URI","interceptorHelper","sharedDataService"],e=VersionExperienceInterceptor,VersionExperienceInterceptor.prototype.request=function(t){var n=this;return this.isGET(t)&&this.isPreviewDataTypeResourceEndpoint(t.url)?this.interceptorHelper.handleRequest(t,function(){return n.sharedDataService.get("experience").then(function(n){return n.versionId&&(t.url=t.url.replace(e.MODE_DEFAULT,e.MODE_PREVIEW_VERSION)),t})}):t},VersionExperienceInterceptor.prototype.isGET=function(e){return"GET"===e.method},VersionExperienceInterceptor.prototype.isPreviewDataTypeResourceEndpoint=function(t){return t.indexOf(this.TYPES_RESOURCE_URI)>-1&&t.indexOf(e.PREVIEW_DATA_TYPE)>-1},VersionExperienceInterceptor.MODE_DEFAULT="DEFAULT",VersionExperienceInterceptor.MODE_PREVIEW_VERSION="PREVIEWVERSION",VersionExperienceInterceptor.PREVIEW_DATA_TYPE="PreviewData",VersionExperienceInterceptor=e=v([Object(r.SeInjectable)()],VersionExperienceInterceptor)}(),f=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},_=(function(){function VersionExperienceInterceptorModule(){}VersionExperienceInterceptorModule=f([Object(r.SeModule)({imports:["interceptorHelperModule"],providers:[y],config:["$httpProvider",function(e){"ngInject";e.interceptors.push(r.diNameUtils.buildServiceName(y))}]})],VersionExperienceInterceptorModule)}(),function(){function IPageContentSlotsComponentsRestService(){}return IPageContentSlotsComponentsRestService.prototype.clearCache=function(){"proxyFunction"},IPageContentSlotsComponentsRestService.prototype.getSlotsToComponentsMapForPageUid=function(e){"proxyFunction";return null},IPageContentSlotsComponentsRestService.prototype.getComponentsForSlot=function(e){"proxyFunction";return null},IPageContentSlotsComponentsRestService}()),C={UNAVAILABLE:"UNAVAILABLE",IN_SYNC:"IN_SYNC",NOT_SYNC:"NOT_SYNC",IN_PROGRESS:"IN_PROGRESS",SYNC_FAILED:"SYNC_FAILED"},b={SLOW_POLLING_TIME:2e4,FAST_POLLING_TIME:2e3,SPEED_UP:"syncPollingSpeedUp",SLOW_DOWN:"syncPollingSlowDown",FAST_FETCH:"syncFastFetch",FETCH_SYNC_STATUS_ONCE:"fetchSyncStatusOnce"},I={CATALOG_SYNCHRONIZED:"CATALOG_SYNCHRONIZED_EVENT"},E=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},T=function(){function CmsConstantsModule(){}return CmsConstantsModule=E([Object(r.SeModule)({providers:[r.diNameUtils.makeValueProvider({DEFAULT_SYNCHRONIZATION_STATUSES:C}),r.diNameUtils.makeValueProvider({DEFAULT_SYNCHRONIZATION_POLLING:b}),r.diNameUtils.makeValueProvider({DEFAULT_SYNCHRONIZATION_EVENT:I})]})],CmsConstantsModule)}(),O=function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function __(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}}(),R=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},A=function(e){function PageContentSlotsComponentsRestService(t,n,o,i,s,r,a){var c=e.call(this)||this;c.pageInfoService=n,c.cmsitemsRestService=o,c.lodash=i;var l="/cmswebservices/v1/sites/"+s+"/catalogs/"+r+"/versions/"+a+"/pagescontentslotscomponents?pageId=:pageId";return c.pagesContentSlotsComponentsRestService=t.get(l),c}return O(PageContentSlotsComponentsRestService,e),PageContentSlotsComponentsRestService.$inject=["restServiceFactory","pageInfoService","cmsitemsRestService","lodash","PAGE_CONTEXT_SITE_ID","PAGE_CONTEXT_CATALOG","PAGE_CONTEXT_CATALOG_VERSION"],PageContentSlotsComponentsRestService.prototype.clearCache=function(){},PageContentSlotsComponentsRestService.prototype.getComponentsForSlot=function(e){var t=this;return this.pageInfoService.getPageUID().then(function(n){return t.getSlotsToComponentsMapForPageUid(n).then(function(t){return t[e]||[]})})},PageContentSlotsComponentsRestService.prototype.getSlotsToComponentsMapForPageUid=function(e){var t=this;return this.getCachedSlotsToComponentsMapForPageUid(e).then(function(e){return t.lodash.cloneDeep(e)})},PageContentSlotsComponentsRestService.prototype.getCachedSlotsToComponentsMapForPageUid=function(e){var t=this;return this.pagesContentSlotsComponentsRestService.get({pageId:e}).then(function(e){var n=e.pageContentSlotComponentList,o=n.map(function(e){return e.componentUuid});return t.cmsitemsRestService.getByIds(o).then(function(e){var t=(e.response||[]).reduce(function(e,t){return e[t.uuid]=t,e},{});return n.reduce(function(e,n){return e[n.slotId]=e[n.slotId]||[],t[n.componentUuid]&&e[n.slotId].push(t[n.componentUuid]),e},{})})})},R([Object(r.InvalidateCache)(r.pageChangeEvictionTag)],PageContentSlotsComponentsRestService.prototype,"clearCache",null),R([Object(r.Cached)({actions:[r.rarelyChangingContent],tags:[r.pageChangeEvictionTag]})],PageContentSlotsComponentsRestService.prototype,"getCachedSlotsToComponentsMapForPageUid",null),PageContentSlotsComponentsRestService=R([Object(r.GatewayProxied)("clearCache","getSlotsToComponentsMapForPageUid"),Object(r.SeInjectable)()],PageContentSlotsComponentsRestService)}(_),P=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},M=function(){function SyncPollingService(e,t){this.systemEventService=e,this.SYNCHRONIZATION_POLLING=t}return SyncPollingService.$inject=["systemEventService","SYNCHRONIZATION_POLLING"],SyncPollingService.prototype.registerSyncPollingEvents=function(){this.systemEventService.subscribe(this.SYNCHRONIZATION_POLLING.SPEED_UP,this.changePollingSpeed.bind(this)),this.systemEventService.subscribe(this.SYNCHRONIZATION_POLLING.SLOW_DOWN,this.changePollingSpeed.bind(this))},SyncPollingService.prototype.changePollingSpeed=function(e,t){"proxyFunction";return null},SyncPollingService.prototype._fetchSyncStatus=function(e,t){"proxyFunction";return null},SyncPollingService.prototype.getSyncStatus=function(e,t){"proxyFunction";return null},SyncPollingService.prototype.performSync=function(e,t){"proxyFunction";return null},SyncPollingService=P([Object(r.GatewayProxied)("getSyncStatus","_fetchSyncStatus","changePollingSpeed","registerSyncPollingEvents","performSync"),Object(r.SeInjectable)()],SyncPollingService)}(),N=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},D=function(){function SynchronizationPollingServiceModule(){}return SynchronizationPollingServiceModule=N([Object(r.SeModule)({imports:[T],providers:[M],initialize:["syncPollingService",function(e){"ngInject";e.registerSyncPollingEvents()}]})],SynchronizationPollingServiceModule)}(),U=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r},x=function(){function CmsSmarteditServicesModule(){}return CmsSmarteditServicesModule=U([Object(r.SeModule)({imports:["yLoDashModule",D,"smarteditServicesModule"],providers:[d,c,p,m,A,S]})],CmsSmarteditServicesModule)}();n.d(t,"Cmssmartedit",function(){return V});var w=function(e,t,n,o){var i,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,o);else for(var a=e.length-1;a>=0;a--)(i=e[a])&&(r=(s<3?i(r):s>3?i(t,n,r):i(t,n))||r);return s>3&&r&&Object.defineProperty(t,n,r),r};!function doImport(){importAll(n(2)),importAll(n(31)),importAll(n(41))}(),function deprecatedSince_6_7_doImport(){o.module("AssetsServiceModule",["cmsSmarteditServicesModule"]),o.module("cms.smartedit.services",["cmsSmarteditServicesModule"])}();var V=function(){function Cmssmartedit(){}return Cmssmartedit=w([Object(r.SeModule)({imports:[x,"cmsResourceLocationsModule","resourceLocationsModule","decoratorServiceModule","removeComponentServiceModule","experienceInterceptorModule","editorEnablerServiceModule","alertServiceModule","translationServiceModule","slotVisibilityButtonModule","slotVisibilityServiceModule","cmssmarteditTemplates","cmscommonsTemplates","smarteditServicesModule","slotSharedButtonModule","cmsDragAndDropServiceModule","syncIndicatorDecoratorModule","slotSyncButtonModule","confirmationModalServiceModule","sharedSlotDisabledDecoratorModule","externalSlotDisabledDecoratorModule","slotRestrictionsServiceModule","slotSharedServiceModule","contextualMenuDropdownServiceModule","externalComponentDecoratorModule","externalComponentButtonModule","componentEditingFacadeModule","cmsitemsRestServiceModule","slotUnsharedButtonModule","componentInfoServiceModule"],initialize:["$rootScope","$q","$translate","alertService","assetsService","cmsDragAndDropService","componentHandlerService","confirmationModalService","contextualMenuService","decoratorService","editorEnablerService","featureService","removeComponentService","slotRestrictionsService","slotSharedService","slotVisibilityService","componentEditingFacade","cmsitemsRestService","componentInfoService","typePermissionsRestService",function(e,t,n,o,i,s,r,a,c,l,d,u,p,h,m,g,S,v,y,f){"ngInject";d.enableForComponents(["^((?!Slot).)*$"]),l.addMappings({"^((?!Slot).)*$":["se.contextualMenu","externalComponentDecorator"],"^.*Slot$":["se.slotContextualMenu","se.basicSlotContextualMenu","syncIndicator","sharedSlotDisabledDecorator","externalSlotDisabledDecorator"]}),u.addContextualMenuButton({key:"externalcomponentbutton",nameI18nKey:"se.cms.contextmenu.title.externalcomponent",i18nKey:"se.cms.contextmenu.title.externalcomponentbutton",regexpKeys:["^((?!Slot).)*$"],condition:function(e){var t=r.getParentSlotForComponent(e.element);return h.isSlotEditable(t).then(function(t){if(!t)return!1;var n=e.componentAttributes&&e.componentAttributes.smarteditCatalogVersionUuid;return n?r.getCatalogVersionUUIDFromPage().then(function(e){return n!==e}):r.isExternalComponent(e.componentId,e.componentType)})},action:{template:'<external-component-button data-catalog-version-uuid="ctrl.componentAttributes.smarteditCatalogVersionUuid"></external-component-button>'},displayClass:"externalcomponentbutton",displayIconClass:"hyicon hyicon-globe",displaySmallIconClass:"hyicon hyicon-globe"}),u.addContextualMenuButton({key:"se.cms.dragandropbutton",nameI18nKey:"se.cms.contextmenu.title.dragndrop",i18nKey:"se.cms.contextmenu.title.dragndrop",regexpKeys:["^((?!Slot).)*$"],condition:function(e){var t=r.getParentSlotForComponent(e.element);return h.isSlotEditable(t).then(function(t){return!!t&&f.hasUpdatePermissionForTypes([e.componentType]).then(function(t){return t[e.componentType]})})},action:{callbacks:{mousedown:function(){s.update()}}},displayClass:"movebutton",displayIconClass:"hyicon hyicon-dragdroplg",displaySmallIconClass:"hyicon hyicon-dragdroplg",permissions:["se.context.menu.drag.and.drop.component"]}),u.register({key:"se.cms.html5DragAndDrop",nameI18nKey:"se.cms.dragAndDrop.name",descriptionI18nKey:"se.cms.dragAndDrop.description",enablingCallback:function(){s.register(),s.apply()},disablingCallback:function(){s.unregister()}}),u.addContextualMenuButton({key:"se.cms.remove",i18nKey:"se.cms.contextmenu.title.remove",nameI18nKey:"se.cms.contextmenu.title.remove",regexpKeys:["^((?!Slot).)*$"],condition:function(e){if(!e.isComponentHidden){var t=r.getParentSlotForComponent(e.element);return h.isSlotEditable(t).then(function(t){return!!t&&f.hasDeletePermissionForTypes([e.componentType]).then(function(t){return t[e.componentType]})})}return f.hasDeletePermissionForTypes([e.componentType]).then(function(t){return t[e.componentType]})},action:{callback:function(e,t){var i,s;e.element?(i=r.getSlotOperationRelatedId(e.element),s=r.getSlotOperationRelatedType(e.element)):(i=e.containerId?e.containerId:e.componentId,s=e.containerId&&e.containerType?e.containerType:e.componentType);var c={description:"se.cms.contextmenu.removecomponent.confirmation.message",title:"se.cms.contextmenu.removecomponent.confirmation.title"};a.confirm(c).then(function(){p.removeComponent({slotId:e.slotId,componentId:e.componentId,componentType:e.componentType,slotOperationRelatedId:i,slotOperationRelatedType:s}).then(function(){g.reloadSlotsInfo(),n("se.cms.alert.component.removed.from.slot",{componentID:i,slotID:e.slotId}).then(function(e){o.showSuccess({message:e}),t.preventDefault(),t.stopPropagation()})})})}},displayClass:"removebutton",displayIconClass:"hyicon hyicon-removelg",displaySmallIconClass:"hyicon hyicon-removelg",permissions:["se.context.menu.remove.component"]}),u.addContextualMenuButton({key:"se.slotContextualMenuVisibility",nameI18nKey:"slotcontextmenu.title.visibility",regexpKeys:["^.*ContentSlot$"],action:{templateUrl:"slotVisibilityWidgetTemplate.html"},permissions:["se.slot.context.menu.visibility"]}),u.addContextualMenuButton({key:"se.slotSharedButton",nameI18nKey:"slotcontextmenu.title.shared.button",regexpKeys:["^.*Slot$"],action:{templateUrl:"slotSharedTemplate.html"},permissions:["se.slot.context.menu.shared.icon"]}),u.addContextualMenuButton({key:"slotUnsharedButton",nameI18nKey:"slotcontextmenu.title.unshared.button",regexpKeys:["^.*Slot$"],action:{templateUrl:"slotUnsharedButtonWrapperTemplate.html"},permissions:["se.slot.context.menu.unshared.icon"]}),u.addContextualMenuButton({key:"se.slotSyncButton",nameI18nKey:"slotcontextmenu.title.sync.button",regexpKeys:["^.*Slot$"],action:{templateUrl:"slotSyncTemplate.html"},permissions:["se.sync.slot.context.menu"]}),u.addDecorator({key:"syncIndicator",nameI18nKey:"syncIndicator",permissions:["se.sync.slot.indicator"]}),u.register({key:"disableSharedSlotEditing",nameI18nKey:"se.cms.disableSharedSlotEditing",descriptionI18nKey:"se.cms.disableSharedSlotEditing.description",enablingCallback:function(){m.setSharedSlotEnablementStatus(!0)},disablingCallback:function(){m.setSharedSlotEnablementStatus(!1)}}),u.addDecorator({key:"sharedSlotDisabledDecorator",nameI18nKey:"se.cms.shared.slot.disabled.decorator",displayCondition:function(e,n){return t.all([h.isSlotEditable(n),r.isExternalComponent(n,e)]).then(function(e){return!e[0]&&!e[1]})}}),u.addDecorator({key:"externalSlotDisabledDecorator",nameI18nKey:"se.cms.external.slot.disabled.decorator",displayCondition:function(e,n){return t.when(r.isExternalComponent(n,e))}}),u.addDecorator({key:"externalComponentDecorator",nameI18nKey:"se.cms.external.component.decorator",displayCondition:function(e,n){return t.when(r.isExternalComponent(n,e))}}),u.addContextualMenuButton({key:"clonecomponentbutton",nameI18nKey:"se.cms.contextmenu.title.clone.component",i18nKey:"se.cms.contextmenu.title.clone.component",regexpKeys:["^((?!Slot).)*$"],condition:function(e){var n=e.componentAttributes.smarteditComponentUuid;if(!e.isComponentHidden){var o=r.getParentSlotForComponent(e.element);return h.isSlotEditable(o).then(function(o){return!!o&&f.hasCreatePermissionForTypes([e.componentType]).then(function(o){return o[e.componentType]?y.getById(n).then(function(e){return e.cloneable}):t.when(!1)})})}return v.getById(n).then(function(e){return e.cloneable})},action:{callback:function(e){var t=r.getComponentPositionInSlot(e.slotId,e.componentAttributes.smarteditComponentId);S.cloneExistingComponentToSlot({targetSlotId:e.slotId,dragInfo:{componentId:e.componentAttributes.smarteditComponentId,componentType:e.componentType,componentUuid:e.componentAttributes.smarteditComponentUuid},position:t+1})}},displayClass:"clonebutton",displayIconClass:"hyicon hyicon-clone",displaySmallIconClass:"hyicon hyicon-clone",permissions:["se.clone.component"]})}]})],Cmssmartedit)}()}]);